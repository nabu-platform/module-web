'use strict';(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define(b):(a=a||self,a.Vue=b())})(this,function(){function a(f){return void 0===f||null===f}function b(f){return void 0!==f&&null!==f}function c(f){return"string"===typeof f||"number"===typeof f||"symbol"===typeof f||"boolean"===typeof f}function d(f){return null!==f&&"object"===typeof f}function e(f){return Cb.call(f).slice(8,-1)}function g(f){return"[object Object]"===
Cb.call(f)}function k(f){var h=parseFloat(String(f));return 0<=h&&Math.floor(h)===h&&isFinite(f)}function m(f){return b(f)&&"function"===typeof f.then&&"function"===typeof f.catch}function p(f){return null==f?"":Array.isArray(f)||g(f)&&f.toString===Cb?JSON.stringify(f,null,2):String(f)}function q(f){var h=parseFloat(f);return isNaN(h)?f:h}function t(f,h){var l=Object.create(null);f=f.split(",");for(var n=0;n<f.length;n++)l[f[n]]=!0;return h?function(r){return l[r.toLowerCase()]}:function(r){return l[r]}}
function u(f,h){if(f.length&&(h=f.indexOf(h),-1<h))return f.splice(h,1)}function w(f,h){return yg.call(f,h)}function y(f){var h=Object.create(null);return function(l){return h[l]||(h[l]=f(l))}}function B(f,h){function l(n){var r=arguments.length;return r?1<r?f.apply(h,arguments):f.call(h,n):f.call(h)}l._length=f.length;return l}function F(f,h){return f.bind(h)}function C(f,h){h=h||0;for(var l=f.length-h,n=Array(l);l--;)n[l]=f[l+h];return n}function A(f,h){for(var l in h)f[l]=h[l];return f}function O(f){for(var h=
{},l=0;l<f.length;l++)f[l]&&A(h,f[l]);return h}function H(f,h,l){}function ca(f,h){if(f===h)return!0;var l=d(f),n=d(h);if(l&&n)try{var r=Array.isArray(f),v=Array.isArray(h);if(r&&v)return f.length===h.length&&f.every(function(D,E){return ca(D,h[E])});if(f instanceof Date&&h instanceof Date)return f.getTime()===h.getTime();if(r||v)return!1;var x=Object.keys(f),z=Object.keys(h);return x.length===z.length&&x.every(function(D){return ca(f[D],h[D])})}catch(D){return!1}else return l||n?!1:String(f)===String(h)}
function P(f,h){for(var l=0;l<f.length;l++)if(ca(f[l],h))return l;return-1}function M(f){var h=!1;return function(){h||(h=!0,f.apply(this,arguments))}}function K(f){f=(f+"").charCodeAt(0);return 36===f||95===f}function Q(f,h,l,n){Object.defineProperty(f,h,{value:l,enumerable:!!n,writable:!0,configurable:!0})}function Z(f){if(!zg.test(f)){var h=f.split(".");return function(l){for(var n=0;n<h.length;n++){if(!l)return;l=l[h[n]]}return l}}}function aa(f){return"function"===typeof f&&/native code/.test(f.toString())}
function S(f){Qb.push(f);Fa.target=f}function la(){Qb.pop();Fa.target=Qb[Qb.length-1]}function pa(f){return new Ea(void 0,void 0,void 0,String(f))}function ya(f){var h=new Ea(f.tag,f.data,f.children&&f.children.slice(),f.text,f.elm,f.context,f.componentOptions,f.asyncFactory);h.ns=f.ns;h.isStatic=f.isStatic;h.key=f.key;h.isComment=f.isComment;h.fnContext=f.fnContext;h.fnOptions=f.fnOptions;h.fnScopeId=f.fnScopeId;h.asyncMeta=f.asyncMeta;h.isCloned=!0;return h}function Ta(f,h){if(d(f)&&!(f instanceof
Ea)){var l;w(f,"__ob__")&&f.__ob__ instanceof Rb?l=f.__ob__:Ua&&!Db()&&(Array.isArray(f)||g(f))&&Object.isExtensible(f)&&!f._isVue&&(l=new Rb(f));h&&l&&l.vmCount++;return l}}function ta(f,h,l,n,r){var v=new Fa,x=Object.getOwnPropertyDescriptor(f,h);if(!x||!1!==x.configurable){var z=x&&x.get,D=x&&x.set;z&&!D||2!==arguments.length||(l=f[h]);var E=!r&&Ta(l);Object.defineProperty(f,h,{enumerable:!0,configurable:!0,get:function(){var I=z?z.call(f):l;Fa.target&&(v.depend(),E&&(E.dep.depend(),Array.isArray(I)&&
wa(I)));return I},set:function(I){var N=z?z.call(f):l;I===N||I!==I&&N!==N||(n&&n(),z&&!D)||(D?D.call(f,I):l=I,E=!r&&Ta(I),v.notify())}})}}function ea(f,h,l){(a(f)||c(f))&&U("Cannot set reactive property on undefined, null, or primitive value: "+f);if(Array.isArray(f)&&k(h))return f.length=Math.max(f.length,h),f.splice(h,1,l),l;if(h in f&&!(h in Object.prototype))return f[h]=l;var n=f.__ob__;if(f._isVue||n&&n.vmCount)return U("Avoid adding reactive properties to a Vue instance or its root $data at runtime - declare it upfront in the data option."),
l;if(!n)return f[h]=l;ta(n.value,h,l);n.dep.notify();return l}function sa(f,h){(a(f)||c(f))&&U("Cannot delete reactive property on undefined, null, or primitive value: "+f);if(Array.isArray(f)&&k(h))f.splice(h,1);else{var l=f.__ob__;f._isVue||l&&l.vmCount?U("Avoid deleting properties on a Vue instance or its root $data - just set it to null."):w(f,h)&&(delete f[h],l&&l.dep.notify())}}function wa(f){for(var h,l=0,n=f.length;l<n;l++)(h=f[l])&&h.__ob__&&h.__ob__.dep.depend(),Array.isArray(h)&&wa(h)}
function ub(f,h){if(!h)return f;for(var l,n,r,v=Sb?Reflect.ownKeys(h):Object.keys(h),x=0;x<v.length;x++)l=v[x],"__ob__"!==l&&(n=f[l],r=h[l],w(f,l)?n!==r&&g(n)&&g(r)&&ub(n,r):ea(f,l,r));return f}function yc(f,h,l){return l?function(){var n="function"===typeof h?h.call(l,l):h,r="function"===typeof f?f.call(l,l):f;return n?ub(n,r):r}:h?f?function(){return ub("function"===typeof h?h.call(this,this):h,"function"===typeof f?f.call(this,this):f)}:h:f}function Ag(f,h){if(f=h?f?f.concat(h):Array.isArray(h)?
h:[h]:f){h=[];for(var l=0;l<f.length;l++)-1===h.indexOf(f[l])&&h.push(f[l]);f=h}return f}function Bg(f,h,l,n){f=Object.create(f||null);return h?(zc(n,h,l),A(f,h)):f}function Cg(f){for(var h in f.components)Ac(h)}function Ac(f){(new RegExp("^[a-zA-Z][\\-\\.0-9_"+Bc.source+"]*$")).test(f)||U('Invalid component name: "'+f+'". Component names should conform to valid custom element name in html5 specification.');(Ud(f)||ra.isReservedTag(f))&&U("Do not use built-in or reserved HTML elements as component id: "+
f)}function Dg(f,h){var l=f.props;if(l){var n={},r;if(Array.isArray(l))for(r=l.length;r--;)if(h=l[r],"string"===typeof h){var v=Ga(h);n[v]={type:null}}else U("props must be strings when using array syntax.");else if(g(l))for(r in l)h=l[r],v=Ga(r),n[v]=g(h)?h:{type:h};else U('Invalid value for option "props": expected an Array or an Object, but got '+e(l)+".",h);f.props=n}}function Eg(f,h){var l=f.inject;if(l)if(f=f.inject={},Array.isArray(l))for(var n=0;n<l.length;n++)f[l[n]]={from:l[n]};else if(g(l))for(n in l)h=
l[n],f[n]=g(h)?A({from:n},h):{from:h};else U('Invalid value for option "inject": expected an Array or an Object, but got '+e(l)+".",h)}function Fg(f){if(f=f.directives)for(var h in f){var l=f[h];"function"===typeof l&&(f[h]={bind:l,update:l})}}function zc(f,h,l){g(h)||U('Invalid value for option "'+f+'": expected an Object, but got '+e(h)+".",l)}function jb(f,h,l){function n(D){x[D]=(Na[D]||Vd)(f[D],h[D],l,D)}Cg(h);"function"===typeof h&&(h=h.options);Dg(h,l);Eg(h,l);Fg(h);if(!h._base&&(h.extends&&
(f=jb(f,h.extends,l)),h.mixins))for(var r=0,v=h.mixins.length;r<v;r++)f=jb(f,h.mixins[r],l);var x={},z;for(z in f)n(z);for(z in h)w(f,z)||n(z);return x}function Cc(f,h,l,n){if("string"===typeof l){var r=f[h];if(w(r,l))return r[l];var v=Ga(l);if(w(r,v))return r[v];var x=Wd(v);if(w(r,x))return r[x];r=r[l]||r[v]||r[x];n&&!r&&U("Failed to resolve "+h.slice(0,-1)+": "+l,f);return r}}function Dc(f,h,l,n){var r,v=h[f],x=!w(l,f);l=l[f];h=Xd(Boolean,v.type);if(-1<h)if(x&&!w(v,"default"))l=!1;else if(""===
l||l===Za(f)){var z=Xd(String,v.type);if(0>z||h<z)l=!0}void 0===l&&(w(v,"default")?(l=v.default,d(l)&&U('Invalid default value for prop "'+f+'": Props with type Object/Array must use a factory function to return the default value.',n),l=n&&n.$options.propsData&&void 0===n.$options.propsData[f]&&void 0!==n._props[f]?n._props[f]:"function"===typeof l&&"Function"!==vb(v.type)?l.call(n):l):l=void 0,h=Ua,Ua=!0,Ta(l),Ua=h);h=l;if(v.required&&x)U('Missing required prop: "'+f+'"',n);else if(null!=h||v.required){z=
v.type;var D=!z||!0===z;x=[];if(z){Array.isArray(z)||(z=[z]);for(var E=0;E<z.length&&!D;E++){var I=h,N=z[E];D=vb(N);if(Gg.test(D)){var W=typeof I;(r=W===D.toLowerCase())||"object"!==W||(r=I instanceof N)}else r="Object"===D?g(I):"Array"===D?Array.isArray(I):I instanceof N;x.push(D||"");D=r}}D?(v=v.validator)&&(v(h)||U('Invalid prop: custom validator check failed for prop "'+f+'".',n)):(v=U,f='Invalid prop: type check failed for prop "'+f+'". Expected '+x.map(Wd).join(", "),z=x[0],E=e(h),D=Yd(h,z),
h=Yd(h,E),1===x.length&&Zd(z)&&!Hg(z,E)&&(f+=" with value "+D),f+=", got "+E+" ",Zd(E)&&(f+="with value "+h+"."),v(f,n))}return l}function vb(f){return(f=f&&f.toString().match(/^\s*function (\w+)/))?f[1]:""}function Xd(f,h){if(!Array.isArray(h))return vb(h)===vb(f)?0:-1;for(var l=0,n=h.length;l<n;l++){var r=f;if(vb(h[l])===vb(r))return l}return-1}function Yd(f,h){return"String"===h?'"'+f+'"':"Number"===h?""+Number(f):""+f}function Zd(f){return["string","number","boolean"].some(function(h){return f.toLowerCase()===
h})}function Hg(){for(var f=[],h=arguments.length;h--;)f[h]=arguments[h];return f.some(function(l){return"boolean"===l.toLowerCase()})}function Va(f,h,l){S();try{if(h)for(var n=h;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var v=0;v<r.length;v++)try{if(!1===r[v].call(n,f,h,l))return}catch(x){$d(x,n,"errorCaptured hook")}}$d(f,h,l)}finally{la()}}function Tb(f,h,l,n,r){var v;try{(v=l?f.apply(h,l):f.call(h))&&!v._isVue&&m(v)&&!v._handled&&(v.catch(function(x){return Va(x,n,r+" (Promise/async)")}),
v._handled=!0)}catch(x){Va(x,n,r)}return v}function $d(f,h,l){if(ra.errorHandler)try{return ra.errorHandler.call(null,f,h,l)}catch(n){n!==f&&ae(n,null,"config.errorHandler")}ae(f,h,l)}function ae(f,h,l){U("Error in "+l+': "'+f.toString()+'"',h);if((Aa||Ec)&&"undefined"!==typeof console)console.error(f);else throw f;}function Ub(){Fc=!1;for(var f=Gc.slice(0),h=Gc.length=0;h<f.length;h++)f[h]()}function Hc(f,h){var l;Gc.push(function(){if(f)try{f.call(h)}catch(n){Va(n,h,"nextTick")}else l&&l(h)});Fc||
(Fc=!0,Ic());if(!f&&"undefined"!==typeof Promise)return new Promise(function(n){l=n})}function Vb(f){Jc(f,be);be.clear()}function Jc(f,h){var l=Array.isArray(f);if(!(!l&&!d(f)||Object.isFrozen(f)||f instanceof Ea)){if(f.__ob__){var n=f.__ob__.dep.id;if(h.has(n))return;h.add(n)}if(l)for(l=f.length;l--;)Jc(f[l],h);else for(n=Object.keys(f),l=n.length;l--;)Jc(f[n[l]],h)}}function Kc(f,h){function l(){var n=arguments,r=l.fns;if(Array.isArray(r)){r=r.slice();for(var v=0;v<r.length;v++)Tb(r[v],null,n,h,
"v-on handler")}else return Tb(r,null,arguments,h,"v-on handler")}l.fns=f;return l}function Lc(f,h,l,n,r,v){var x;for(x in f){var z=f[x];var D=h[x];var E=ce(x);a(z)?U('Invalid handler for event "'+E.name+'": got '+String(z),v):a(D)?(a(z.fns)&&(z=f[x]=Kc(z,v)),!0===E.once&&(z=f[x]=r(E.name,z,E.capture)),l(E.name,z,E.capture,E.passive,E.params)):z!==D&&(D.fns=z,f[x]=D)}for(x in h)a(f[x])&&(E=ce(x),n(E.name,h[x],E.capture))}function hb(f,h,l){function n(){l.apply(this,arguments);u(v.fns,n)}f instanceof
Ea&&(f=f.data.hook||(f.data.hook={}));var r=f[h];if(a(r))var v=Kc([n]);else b(r.fns)&&!0===r.merged?(v=r,v.fns.push(n)):v=Kc([r,n]);v.merged=!0;f[h]=v}function de(f,h,l,n,r){if(b(h)){if(w(h,l))return f[l]=h[l],r||delete h[l],!0;if(w(h,n))return f[l]=h[n],r||delete h[n],!0}return!1}function Mc(f){return c(f)?[pa(f)]:Array.isArray(f)?ee(f):void 0}function Eb(f){return b(f)&&b(f.text)&&!1===f.isComment}function ee(f,h){var l=[],n;for(n=0;n<f.length;n++){var r=f[n];if(!a(r)&&"boolean"!==typeof r){var v=
l.length-1;var x=l[v];Array.isArray(r)?0<r.length&&(r=ee(r,(h||"")+"_"+n),Eb(r[0])&&Eb(x)&&(l[v]=pa(x.text+r[0].text),r.shift()),l.push.apply(l,r)):c(r)?Eb(x)?l[v]=pa(x.text+r):""!==r&&l.push(pa(r)):Eb(r)&&Eb(x)?l[v]=pa(x.text+r.text):(!0===f._isVList&&b(r.tag)&&a(r.key)&&b(h)&&(r.key="__vlist"+h+"_"+n+"__"),l.push(r))}}return l}function Ig(f){var h=fe(f.$options.inject,f);h&&(Ua=!1,Object.keys(h).forEach(function(l){ta(f,l,h[l],function(){U('Avoid mutating an injected value directly since the changes will be overwritten whenever the provided component re-renders. injection being mutated: "'+
l+'"',f)})}),Ua=!0)}function fe(f,h){if(f){for(var l=Object.create(null),n=Sb?Reflect.ownKeys(f):Object.keys(f),r=0;r<n.length;r++){var v=n[r];if("__ob__"!==v){for(var x=f[v].from,z=h;z;){if(z._provided&&w(z._provided,x)){l[v]=z._provided[x];break}z=z.$parent}z||("default"in f[v]?(x=f[v].default,l[v]="function"===typeof x?x.call(h):x):U('Injection "'+v+'" not found',h))}}return l}}function Nc(f,h){if(!f||!f.length)return{};for(var l={},n=0,r=f.length;n<r;n++){var v=f[n],x=v.data;x&&x.attrs&&x.attrs.slot&&
delete x.attrs.slot;v.context!==h&&v.fnContext!==h||!x||null==x.slot?(l.default||(l.default=[])).push(v):(x=x.slot,x=l[x]||(l[x]=[]),"template"===v.tag?x.push.apply(x,v.children||[]):x.push(v))}for(var z in l)l[z].every(Jg)&&delete l[z];return l}function Jg(f){return f.isComment&&!f.asyncFactory||" "===f.text}function Wb(f,h,l){var n=0<Object.keys(h).length,r=f?!!f.$stable:!n,v=f&&f.$key;if(f){if(f._normalized)return f._normalized;if(r&&l&&l!==Oa&&v===l.$key&&!n&&!l.$hasNormal)return l;l={};for(var x in f)f[x]&&
"$"!==x[0]&&(l[x]=Kg(h,x,f[x]))}else l={};for(var z in h)z in l||(l[z]=Lg(h,z));f&&Object.isExtensible(f)&&(f._normalized=l);Q(l,"$stable",r);Q(l,"$key",v);Q(l,"$hasNormal",n);return l}function Kg(f,h,l){var n=function(){var r=arguments.length?l.apply(null,arguments):l({});return(r=r&&"object"===typeof r&&!Array.isArray(r)?[r]:Mc(r))&&(0===r.length||1===r.length&&r[0].isComment)?void 0:r};l.proxy&&Object.defineProperty(f,h,{get:n,enumerable:!0,configurable:!0});return n}function Lg(f,h){return function(){return f[h]}}
function Mg(f,h){var l;if(Array.isArray(f)||"string"===typeof f){var n=Array(f.length);var r=0;for(l=f.length;r<l;r++)n[r]=h(f[r],r)}else if("number"===typeof f)for(n=Array(f),r=0;r<f;r++)n[r]=h(r+1,r);else if(d(f))if(Sb&&f[Symbol.iterator])for(n=[],f=f[Symbol.iterator](),r=f.next();!r.done;)n.push(h(r.value,n.length)),r=f.next();else{var v=Object.keys(f);n=Array(v.length);r=0;for(l=v.length;r<l;r++){var x=v[r];n[r]=h(f[x],x,r)}}b(n)||(n=[]);n._isVList=!0;return n}function Ng(f,h,l,n){var r=this.$scopedSlots[f];
r?(l=l||{},n&&(d(n)||U("slot v-bind without argument expects an Object",this),l=A(A({},n),l)),f=r(l)||h):f=this.$slots[f]||h;return(l=l&&l.slot)?this.$createElement("template",{slot:l},f):f}function Og(f){return Cc(this.$options,"filters",f,!0)||ge}function he(f,h){return Array.isArray(f)?-1===f.indexOf(h):f!==h}function Pg(f,h,l,n,r){l=ra.keyCodes[h]||l;if(r&&n&&!ra.keyCodes[h])return he(r,n);if(l)return he(l,f);if(n)return Za(n)!==h}function Qg(f,h,l,n,r){if(l)if(d(l)){Array.isArray(l)&&(l=O(l));
var v,x=function(D){if("class"===D||"style"===D||ie(D))v=f;else{var E=f.attrs&&f.attrs.type;v=n||ra.mustUseProp(h,E,D)?f.domProps||(f.domProps={}):f.attrs||(f.attrs={})}E=Ga(D);var I=Za(D);E in v||I in v||(v[D]=l[D],r&&((f.on||(f.on={}))["update:"+D]=function(N){l[D]=N}))},z;for(z in l)x(z)}else U("v-bind without argument expects an Object or Array value",this);return f}function Rg(f,h){var l=this._staticTrees||(this._staticTrees=[]),n=l[f];if(n&&!h)return n;n=l[f]=this.$options.staticRenderFns[f].call(this._renderProxy,
null,this);je(n,"__static__"+f,!1);return n}function Sg(f,h,l){je(f,"__once__"+h+(l?"_"+l:""),!0);return f}function je(f,h,l){if(Array.isArray(f))for(var n=0;n<f.length;n++){if(f[n]&&"string"!==typeof f[n]){var r=f[n],v=h+"_"+n,x=l;r.isStatic=!0;r.key=v;r.isOnce=x}}else f.isStatic=!0,f.key=h,f.isOnce=l}function Tg(f,h){if(h)if(g(h)){var l=f.on=f.on?A({},f.on):{},n;for(n in h){var r=l[n],v=h[n];l[n]=r?[].concat(r,v):v}}else U("v-on without argument expects an Object value",this);return f}function ke(f,
h,l,n){h=h||{$stable:!l};for(var r=0;r<f.length;r++){var v=f[r];Array.isArray(v)?ke(v,h,l):v&&(v.proxy&&(v.fn.proxy=!0),h[v.key]=v.fn)}n&&(h.$key=n);return h}function Ug(f,h){for(var l=0;l<h.length;l+=2){var n=h[l];"string"===typeof n&&n?f[h[l]]=h[l+1]:""!==n&&null!==n&&U("Invalid value for dynamic directive argument (expected string or null): "+n,this)}return f}function Vg(f,h){return"string"===typeof f?h+f:f}function le(f){f._o=Sg;f._n=q;f._s=p;f._l=Mg;f._t=Ng;f._q=ca;f._i=P;f._m=Rg;f._f=Og;f._k=
Pg;f._b=Qg;f._v=pa;f._e=kb;f._u=ke;f._g=Tg;f._d=Ug;f._p=Vg}function Oc(f,h,l,n,r){var v=this,x=r.options;if(w(n,"_uid")){var z=Object.create(n);z._original=n}else z=n,n=n._original;r=!0===x._compiled;var D=!r;this.data=f;this.props=h;this.children=l;this.parent=n;this.listeners=f.on||Oa;this.injections=fe(x.inject,n);this.slots=function(){v.$slots||Wb(f.scopedSlots,v.$slots=Nc(l,n));return v.$slots};Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Wb(f.scopedSlots,this.slots())}});
r&&(this.$options=x,this.$slots=this.slots(),this.$scopedSlots=Wb(f.scopedSlots,this.$slots));this._c=x._scopeId?function(E,I,N,W){(E=Xb(z,E,I,N,W,D))&&!Array.isArray(E)&&(E.fnScopeId=x._scopeId,E.fnContext=n);return E}:function(E,I,N,W){return Xb(z,E,I,N,W,D)}}function me(f,h,l,n,r){f=ya(f);f.fnContext=l;f.fnOptions=n;(f.devtoolsMeta=f.devtoolsMeta||{}).renderContext=r;h.slot&&((f.data||(f.data={})).slot=h.slot);return f}function ne(f,h,l,n,r){if(!a(f)){var v=l.$options._base;d(f)&&(f=v.extend(f));
if("function"!==typeof f)U("Invalid Component definition: "+String(f),l);else{if(a(f.cid)){var x=f;f=Wg(x,v);if(void 0===f)return f=x,x=kb(),x.asyncFactory=f,x.asyncMeta={data:h,context:l,children:n,tag:r},x}h=h||{};Pc(f);if(b(h.model)){var z=f.options;v=h;var D=z.model&&z.model.prop||"value";z=z.model&&z.model.event||"input";(v.attrs||(v.attrs={}))[D]=v.model.value;D=v.on||(v.on={});var E=D[z];v=v.model.callback;if(b(E)){if(Array.isArray(E)?-1===E.indexOf(v):E!==v)D[z]=[v].concat(E)}else D[z]=v}E=
h;v=f;var I=v.options.props;if(a(I))var N=void 0;else{z={};D=E.attrs;E=E.props;if(b(D)||b(E))for(N in I){I=Za(N);var W=N.toLowerCase();N!==W&&D&&w(D,W)&&Fb('Prop "'+W+'" is passed to component '+lb(r||v)+', but the declared prop name is "'+N+'". Note that HTML attributes are case-insensitive and camelCased props need to use their kebab-case equivalents when using in-DOM templates. You should probably use "'+I+'" instead of "'+N+'".');de(z,E,N,I,!0)||de(z,D,N,I,!1)}N=z}if(!0===f.options.functional){r=
f.options;x={};v=r.props;if(b(v))for(var fa in v)x[fa]=Dc(fa,v,N||Oa);else{if(b(h.attrs)){fa=h.attrs;for(var ia in fa)x[Ga(ia)]=fa[ia]}if(b(h.props)){ia=h.props;for(var L in ia)x[Ga(L)]=ia[L]}}l=new Oc(h,x,n,l,f);n=r.render.call(null,l._c,l);if(n instanceof Ea)l=me(n,h,l.parent,r,l);else if(Array.isArray(n)){n=Mc(n)||[];f=Array(n.length);for(x=0;x<n.length;x++)f[x]=me(n[x],h,l.parent,r,l);l=f}else l=void 0;return l}L=h.on;h.on=h.nativeOn;!0===f.options.abstract&&(ia=h.slot,h={},ia&&(h.slot=ia));ia=
h.hook||(h.hook={});for(fa=0;fa<oe.length;fa++)v=oe[fa],z=ia[v],D=Qc[v],z===D||z&&z._merged||(ia[v]=z?Xg(D,z):D);ia=f.options.name||r;return new Ea("vue-component-"+f.cid+(ia?"-"+ia:""),h,void 0,void 0,void 0,l,{Ctor:f,propsData:N,listeners:L,tag:r,children:n},x)}}}function Xg(f,h){var l=function(n,r){f(n,r);h(n,r)};l._merged=!0;return l}function Xb(f,h,l,n,r,v){if(Array.isArray(l)||c(l))r=n,n=l,l=void 0;!0===v&&(r=pe);return Yg(f,h,l,n,r)}function Yg(f,h,l,n,r){if(b(l)&&b(l.__ob__))return U("Avoid using observed data object as vnode data: "+
JSON.stringify(l)+"\nAlways create fresh vnode data objects in each render!",f),kb();b(l)&&b(l.is)&&(h=l.is);if(!h)return kb();b(l)&&b(l.key)&&!c(l.key)&&U("Avoid using non-primitive value as key, use string/number value instead.",f);Array.isArray(n)&&"function"===typeof n[0]&&(l=l||{},l.scopedSlots={default:n[0]},n.length=0);if(r===pe)n=Mc(n);else if(r===Zg)a:for(r=0;r<n.length;r++)if(Array.isArray(n[r])){n=Array.prototype.concat.apply([],n);break a}if("string"===typeof h){var v;var x=f.$vnode&&
f.$vnode.ns||ra.getTagNamespace(h);r=ra.isReservedTag(h)?new Ea(ra.parsePlatformTagName(h),l,n,void 0,void 0,f):l&&l.pre||!b(v=Cc(f.$options,"components",h))?new Ea(h,l,n,void 0,void 0,f):ne(v,l,f,n,h)}else r=ne(h,l,f,n);return Array.isArray(r)?r:b(r)?(b(x)&&qe(r,x),b(l)&&(f=l,d(f.style)&&Vb(f.style),d(f.class)&&Vb(f.class)),r):kb()}function qe(f,h,l){f.ns=h;"foreignObject"===f.tag&&(h=void 0,l=!0);if(b(f.children))for(var n=0,r=f.children.length;n<r;n++){var v=f.children[n];b(v.tag)&&(a(v.ns)||!0===
l&&"svg"!==v.tag)&&qe(v,h,l)}}function $g(f){f._vnode=null;f._staticTrees=null;var h=f.$options,l=f.$vnode=h._parentVnode;f.$slots=Nc(h._renderChildren,l&&l.context);f.$scopedSlots=Oa;f._c=function(n,r,v,x){return Xb(f,n,r,v,x,!1)};f.$createElement=function(n,r,v,x){return Xb(f,n,r,v,x,!0)};l=l&&l.data;ta(f,"$attrs",l&&l.attrs||Oa,function(){!Gb&&U("$attrs is readonly.",f)},!0);ta(f,"$listeners",h._parentListeners||Oa,function(){!Gb&&U("$listeners is readonly.",f)},!0)}function Rc(f,h){if(f.__esModule||
Sb&&"Module"===f[Symbol.toStringTag])f=f.default;return d(f)?h.extend(f):f}function Wg(f,h){if(!0===f.error&&b(f.errorComp))return f.errorComp;if(b(f.resolved))return f.resolved;var l=Sc;l&&b(f.owners)&&-1===f.owners.indexOf(l)&&f.owners.push(l);if(!0===f.loading&&b(f.loadingComp))return f.loadingComp;if(l&&!b(f.owners)){var n=f.owners=[l],r=!0,v=null,x=null;l.$on("hook:destroyed",function(){return u(n,l)});var z=function(N){for(var W=0,fa=n.length;W<fa;W++)n[W].$forceUpdate();N&&(n.length=0,null!==
v&&(clearTimeout(v),v=null),null!==x&&(clearTimeout(x),x=null))},D=M(function(N){f.resolved=Rc(N,h);r?n.length=0:z(!0)}),E=M(function(N){U("Failed to resolve async component: "+String(f)+(N?"\nReason: "+N:""));b(f.errorComp)&&(f.error=!0,z(!0))}),I=f(D,E);d(I)&&(m(I)?a(f.resolved)&&I.then(D,E):m(I.component)&&(I.component.then(D,E),b(I.error)&&(f.errorComp=Rc(I.error,h)),b(I.loading)&&(f.loadingComp=Rc(I.loading,h),0===I.delay?f.loading=!0:v=setTimeout(function(){v=null;a(f.resolved)&&a(f.error)&&
(f.loading=!0,z(!1))},I.delay||200)),b(I.timeout)&&(x=setTimeout(function(){x=null;a(f.resolved)&&E("timeout ("+I.timeout+"ms)")},I.timeout))));r=!1;return f.loading?f.loadingComp:f.resolved}}function re(f){if(Array.isArray(f))for(var h=0;h<f.length;h++){var l=f[h];if(b(l)&&(b(l.componentOptions)||l.isComment&&l.asyncFactory))return l}}function se(f,h){mb.$on(f,h)}function te(f,h){mb.$off(f,h)}function ue(f,h){var l=mb;return function r(){null!==h.apply(null,arguments)&&l.$off(f,r)}}function ve(f){var h=
nb;nb=f;return function(){nb=h}}function ah(f,h,l){f.$el=h;f.$options.render||(f.$options.render=kb,f.$options.template&&"#"!==f.$options.template.charAt(0)||f.$options.el||h?U("You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.",f):U("Failed to mount component: template or render function not defined.",f));Ra(f,"beforeMount");new Sa(f,ra.performance&&Ha?function(){var n=
f._name,r=f._uid,v="vue-perf-start:"+r;r="vue-perf-end:"+r;Ha(v);var x=f._render();Ha(r);Yb("vue "+n+" render",v,r);Ha(v);f._update(x,l);Ha(r);Yb("vue "+n+" patch",v,r)}:function(){f._update(f._render(),l)},H,{before:function(){f._isMounted&&!f._isDestroyed&&Ra(f,"beforeUpdate")}},!0);l=!1;null==f.$vnode&&(f._isMounted=!0,Ra(f,"mounted"));return f}function we(f){for(;f&&=f.$parent;)if(f._inactive)return!0;return!1}function Tc(f,h){if(h){if(f._directInactive=!1,we(f))return}else if(f._directInactive)return;
if(f._inactive||null===f._inactive){f._inactive=!1;for(h=0;h<f.$children.length;h++)Tc(f.$children[h]);Ra(f,"activated")}}function xe(f,h){if(h&&(f._directInactive=!0,we(f)))return;if(!f._inactive){f._inactive=!0;for(h=0;h<f.$children.length;h++)xe(f.$children[h]);Ra(f,"deactivated")}}function Ra(f,h){S();var l=f.$options[h],n=h+" hook";if(l)for(var r=0,v=l.length;r<v;r++)Tb(l[r],f,null,f,n);f._hasHookEvent&&f.$emit("hook:"+h);la()}function ye(){ze=Uc();Vc=!0;$a.sort(function(l,n){return l.id-n.id});
for(wb=0;wb<$a.length;wb++){var f=$a[wb];f.before&&f.before();var h=f.id;Hb[h]=null;f.run();if(null!=Hb[h]&&(Zb[h]=(Zb[h]||0)+1,100<Zb[h])){U("You may have an infinite update loop "+(f.user?'in watcher with expression "'+f.expression+'"':"in a component render function."),f.vm);break}}f=Wc.slice();h=$a.slice();wb=$a.length=Wc.length=0;Hb={};Zb={};Xc=Vc=!1;bh(f);ch(h);$b&&ra.devtools&&$b.emit("flush")}function ch(f){for(var h=f.length;h--;){var l=f[h],n=l.vm;n._watcher===l&&n._isMounted&&!n._isDestroyed&&
Ra(n,"updated")}}function bh(f){for(var h=0;h<f.length;h++)f[h]._inactive=!0,Tc(f[h],!0)}function Yc(f,h,l){Wa.get=function(){return this[h][l]};Wa.set=function(n){this[h][l]=n};Object.defineProperty(f,l,Wa)}function dh(f,h){var l=f.$options.propsData||{},n=f._props={},r=f.$options._propKeys=[],v=!f.$parent;v||(Ua=!1);var x=function(D){r.push(D);var E=Dc(D,h,l,f),I=Za(D);(ie(I)||ra.isReservedAttr(I))&&U('"'+I+'" is a reserved attribute and cannot be used as component prop.',f);ta(n,D,E,function(){v||
Gb||U("Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop's value. Prop being mutated: \""+D+'"',f)});D in f||Yc(f,"_props",D)},z;for(z in h)x(z);Ua=!0}function Ae(f,h){f._computedWatchers||(f._computedWatchers=Object.create(null));var l=f._computedWatchers,n=Db(),r;for(r in h){var v=h[r],x="function"===typeof v?v:v.get;null==x&&U('Getter is missing for computed property "'+r+'".',
f);n||(l[r]=new Sa(f,x||H,H,eh));r in f?r in f.$data?U('The computed property "'+r+'" is already defined in data.',f):f.$options.props&&r in f.$options.props&&U('The computed property "'+r+'" is already defined as a prop.',f):Be(f,r,v)}}function Be(f,h,l){var n=!Db();"function"===typeof l?(Wa.get=n?Ce(h):De(l),Wa.set=H):(Wa.get=l.get?n&&!1!==l.cache?Ce(h):De(l.get):H,Wa.set=l.set||H);Wa.set===H&&(Wa.set=function(){U('Computed property "'+h+'" was assigned to but it has no setter.',this)});Object.defineProperty(f,
h,Wa)}function Ce(f){return function(){var h=this._computedWatchers&&this._computedWatchers[f];if(h)return h.dirty&&h.evaluate(),Fa.target&&h.depend(),h.value}}function De(f){return function(){return f.call(this,this)}}function Ee(f,h){for(var l in h){var n=h[l];if(Array.isArray(n))for(var r=0;r<n.length;r++)Zc(f,l,n[r]);else Zc(f,l,n)}}function Zc(f,h,l,n){g(l)&&(n=l,l=l.handler);"string"===typeof l&&(l=f[l]);return f.$watch(h,l,n)}function Pc(f){var h=f.options;if(f.super){var l=Pc(f.super);if(l!==
f.superOptions){f.superOptions=l;var n;h=f.options;var r=f.sealedOptions,v;for(v in h)h[v]!==r[v]&&(n||={},n[v]=h[v]);n&&A(f.extendOptions,n);h=f.options=jb(l,f.extendOptions);h.name&&(h.components[h.name]=f)}}return h}function va(f){this instanceof va||U("Vue is a constructor and should be called with the `new` keyword");this._init(f)}function fh(f){f.use=function(h){var l=this._installedPlugins||(this._installedPlugins=[]);if(-1<l.indexOf(h))return this;var n=C(arguments,1);n.unshift(this);"function"===
typeof h.install?h.install.apply(h,n):"function"===typeof h&&h.apply(null,n);l.push(h);return this}}function gh(f){f.mixin=function(h){this.options=jb(this.options,h);return this}}function hh(f){f.cid=0;var h=1;f.extend=function(l){l=l||{};var n=this,r=n.cid,v=l._Ctor||(l._Ctor={});if(v[r])return v[r];var x=l.name||n.options.name;x&&Ac(x);var z=function(D){this._init(D)};z.prototype=Object.create(n.prototype);z.prototype.constructor=z;z.cid=h++;z.options=jb(n.options,l);z["super"]=n;z.options.props&&
ih(z);z.options.computed&&jh(z);z.extend=n.extend;z.mixin=n.mixin;z.use=n.use;ac.forEach(function(D){z[D]=n[D]});x&&(z.options.components[x]=z);z.superOptions=n.options;z.extendOptions=l;z.sealedOptions=A({},z.options);return v[r]=z}}function ih(f){var h=f.options.props,l;for(l in h)Yc(f.prototype,"_props",l)}function jh(f){var h=f.options.computed,l;for(l in h)Be(f.prototype,l,h[l])}function kh(f){ac.forEach(function(h){f[h]=function(l,n){return n?("component"===h&&Ac(l),"component"===h&&g(n)&&(n.name=
n.name||l,n=this.options._base.extend(n)),"directive"===h&&"function"===typeof n&&(n={bind:n,update:n}),this.options[h+"s"][l]=n):this.options[h+"s"][l]}})}function Fe(f){return f&&(f.Ctor.options.name||f.tag)}function bc(f,h){return Array.isArray(f)?-1<f.indexOf(h):"string"===typeof f?-1<f.split(",").indexOf(h):"[object RegExp]"===Cb.call(f)?f.test(h):!1}function Ge(f,h){var l=f.cache,n=f.keys;f=f._vnode;for(var r in l){var v=l[r];v&&(v=Fe(v.componentOptions))&&!h(v)&&$c(l,r,n,f)}}function $c(f,
h,l,n){var r=f[h];!r||n&&r.tag===n.tag||r.componentInstance.$destroy();f[h]=null;u(l,h)}function He(f,h){return{staticClass:ad(f.staticClass,h.staticClass),class:b(f.class)?[f.class,h.class]:h.class}}function ad(f,h){return f?h?f+" "+h:f:h||""}function bd(f){if(Array.isArray(f)){for(var h="",l,n=0,r=f.length;n<r;n++)b(l=bd(f[n]))&&""!==l&&(h&&(h+=" "),h+=l);return h}if(d(f)){l="";for(h in f)f[h]&&(l&&(l+=" "),l+=h);return l}return"string"===typeof f?f:""}function Ie(f){if(cd(f))return"svg";if("math"===
f)return"math"}function dd(f){if("string"===typeof f){var h=document.querySelector(f);return h?h:(U("Cannot find element: "+f),document.createElement("div"))}return f}function ed(f){return f&&f.replace?f.replace("\x26#39;","'"):f}function xb(f,h){var l=f.data.ref;if(b(l)){var n=f.componentInstance||f.elm,r=f.context.$refs;h?Array.isArray(r[l])?u(r[l],n):r[l]===n&&(r[l]=void 0):f.data.refInFor?Array.isArray(r[l])?0>r[l].indexOf(n)&&r[l].push(n):r[l]=[n]:r[l]=n}}function ob(f,h){var l;if(l=f.key===
h.key){if(l=f.tag===h.tag&&f.isComment===h.isComment&&b(f.data)===b(h.data))if("input"!==f.tag)l=!0;else{var n;l=b(n=f.data)&&b(n=n.attrs)&&n.type;var r=b(n=h.data)&&b(n=n.attrs)&&n.type;l=l===r||fd(l)&&fd(r)}l=l||!0===f.isAsyncPlaceholder&&f.asyncFactory===h.asyncFactory&&a(h.asyncFactory.error)}return l}function gd(f,h){(f.data.directives||h.data.directives)&&lh(f,h)}function lh(f,h){var l=f===pb,n=h===pb,r=Je(f.data.directives,f.context),v=Je(h.data.directives,h.context),x=[],z=[],D;for(D in v){var E=
r[D];var I=v[D];E?(I.oldValue=E.value,I.oldArg=E.arg,Ib(I,"update",h,f),I.def&&I.def.componentUpdated&&z.push(I)):(Ib(I,"bind",h,f),I.def&&I.def.inserted&&x.push(I))}x.length&&(E=function(){for(var N=0;N<x.length;N++)Ib(x[N],"inserted",h,f)},l?hb(h,"insert",E):E());z.length&&hb(h,"postpatch",function(){for(var N=0;N<z.length;N++)Ib(z[N],"componentUpdated",h,f)});if(!l)for(D in r)v[D]||Ib(r[D],"unbind",f,f,n)}function Je(f,h){var l=Object.create(null);if(!f)return l;var n;for(n=0;n<f.length;n++){var r=
f[n];r.modifiers||(r.modifiers=mh);l[r.rawName||r.name+"."+Object.keys(r.modifiers||{}).join(".")]=r;r.def=Cc(h.$options,"directives",r.name,!0)}return l}function Ib(f,h,l,n,r){var v=f.def&&f.def[h];if(v)try{v(l.elm,f,l,n,r)}catch(x){Va(x,l.context,"directive "+f.name+" "+h+" hook")}}function Ke(f,h){var l=h.componentOptions;if(!b(l)||!1!==l.Ctor.options.inheritAttrs)if(!a(f.data.attrs)||!a(h.data.attrs)){var n;l=h.elm;f=f.data.attrs||{};var r=h.data.attrs||{};b(r.__ob__)&&(r=h.data.attrs=A({},r));
for(n in r){h=r[n];var v=f[n];v!==h&&Le(l,n,h)}(ab||hd)&&r.value!==f.value&&Le(l,"value",r.value);for(n in f)a(r[n])&&(id(n)?l.removeAttributeNS("http://www.w3.org/1999/xlink",Me(n)):Ne(n)||l.removeAttribute(n))}}function Le(f,h,l){if(-1<f.tagName.indexOf("-"))Oe(f,h,l);else if(nh(h))null==l||!1===l?f.removeAttribute(h):(l="allowfullscreen"===h&&"EMBED"===f.tagName?"true":h,f.setAttribute(h,l));else if(Ne(h)){var n=f.setAttribute;l=null==l||!1===l||"false"===l?"false":"contenteditable"===h&&oh(l)?
l:"true";n.call(f,h,l)}else id(h)?null==l||!1===l?f.removeAttributeNS("http://www.w3.org/1999/xlink",Me(h)):f.setAttributeNS("http://www.w3.org/1999/xlink",h,l):Oe(f,h,l)}function Oe(f,h,l){if(null==l||!1===l)f.removeAttribute(h);else{if(ab&&!yb&&"TEXTAREA"===f.tagName&&"placeholder"===h&&""!==l&&!f.__ieph){var n=function(r){r.stopImmediatePropagation();f.removeEventListener("input",n)};f.addEventListener("input",n);f.__ieph=!0}f.setAttribute(h,ed(l))}}function Pe(f,h){var l=h.elm,n=h.data;f=f.data;
if(!(a(n.staticClass)&&a(n.class)&&(a(f)||a(f.staticClass)&&a(f.class)))){n=h.data;for(f=h;b(h.componentInstance);)(h=h.componentInstance._vnode)&&h.data&&(n=He(h.data,n));for(;b(f=f.parent);)f&&f.data&&(n=He(n,f.data));h=n.staticClass;n=n.class;h=b(h)||b(n)?ad(h,bd(n)):"";n=l._transitionClasses;b(n)&&(h=ad(h,bd(n)));h!==l._prevClass&&(l.setAttribute("class",h),l._prevClass=h)}}function jd(f){function h(){(N||=[]).push(f.slice(E,I).trim());E=I+1}var l=!1,n=!1,r=!1,v=!1,x=0,z=0,D=0,E=0,I,N;for(I=0;I<
f.length;I++){var W=fa;var fa=f.charCodeAt(I);if(l)39===fa&&92!==W&&(l=!1);else if(n)34===fa&&92!==W&&(n=!1);else if(r)96===fa&&92!==W&&(r=!1);else if(v)47===fa&&92!==W&&(v=!1);else if(124!==fa||124===f.charCodeAt(I+1)||124===f.charCodeAt(I-1)||x||z||D){switch(fa){case 34:n=!0;break;case 39:l=!0;break;case 96:r=!0;break;case 40:D++;break;case 41:D--;break;case 91:z++;break;case 93:z--;break;case 123:x++;break;case 125:x--}if(47===fa){W=I-1;for(var ia=void 0;0<=W&&(ia=f.charAt(W)," "===ia);W--);ia&&
ph.test(ia)||(v=!0)}}else if(void 0===L){E=I+1;var L=f.slice(0,I).trim()}else h()}void 0===L?L=f.slice(0,I).trim():0!==E&&h();if(N)for(I=0;I<N.length;I++)L=qh(L,N[I]);return L}function qh(f,h){var l=h.indexOf("(");if(0>l)return'_f("'+h+'")('+f+")";var n=h.slice(0,l);h=h.slice(l+1);return'_f("'+n+'")('+f+(")"!==h?","+h:h)}function cc(f,h){console.error("[Vue compiler]: "+f)}function Jb(f,h){return f?f.map(function(l){return l[h]}).filter(function(l){return l}):[]}function qb(f,h,l,n,r){(f.props||(f.props=
[])).push(Kb({name:h,value:l,dynamic:r},n));f.plain=!1}function kd(f,h,l,n,r){(r?f.dynamicAttrs||(f.dynamicAttrs=[]):f.attrs||(f.attrs=[])).push(Kb({name:h,value:l,dynamic:r},n));f.plain=!1}function ld(f,h,l,n){f.attrsMap[h]=l;f.attrsList.push(Kb({name:h,value:l},n))}function bb(f,h,l,n,r,v,x,z){n=n||Oa;v&&n.prevent&&n.passive&&v("passive and prevent can't be used together. Passive handler can't prevent default event.",x);n.right?z?h="("+h+")\x3d\x3d\x3d'click'?'contextmenu':("+h+")":"click"===h&&
(h="contextmenu",delete n.right):n.middle&&(z?h="("+h+")\x3d\x3d\x3d'click'?'mouseup':("+h+")":"click"===h&&(h="mouseup"));n.capture&&(delete n.capture,h=z?"_p("+h+',"!")':"!"+h);n.once&&(delete n.once,h=z?"_p("+h+',"~")':"~"+h);n.passive&&(delete n.passive,h=z?"_p("+h+',"\x26")':"\x26"+h);n.native?(delete n.native,v=f.nativeEvents||(f.nativeEvents={})):v=f.events||(f.events={});l=Kb({value:l.trim(),dynamic:z},x);n!==Oa&&(l.modifiers=n);n=v[h];Array.isArray(n)?r?n.unshift(l):n.push(l):v[h]=n?r?[l,
n]:[n,l]:l;f.plain=!1}function dc(f,h){return f.rawAttrsMap[":"+h]||f.rawAttrsMap["v-bind:"+h]||f.rawAttrsMap[h]}function Pa(f,h,l){var n=xa(f,":"+h)||xa(f,"v-bind:"+h);if(null!=n)return jd(n);if(!1!==l&&(f=xa(f,h),null!=f))return JSON.stringify(f)}function xa(f,h,l){var n;if(null!=(n=f.attrsMap[h]))for(var r=f.attrsList,v=0,x=r.length;v<x;v++)if(r[v].name===h){r.splice(v,1);break}l&&delete f.attrsMap[h];return n}function Qe(f,h){f=f.attrsList;for(var l=0,n=f.length;l<n;l++){var r=f[l];if(h.test(r.name))return f.splice(l,
1),r}}function Kb(f,h){h&&(null!=h.start&&(f.start=h.start),null!=h.end&&(f.end=h.end));return f}function Re(f,h,l){l=l||{};var n=l.number,r="$$v";l.trim&&(r="(typeof $$v \x3d\x3d\x3d 'string'? $$v.trim(): $$v)");n&&(r="_n("+r+")");l=ib(h,r);f.model={value:"("+h+")",expression:JSON.stringify(h),callback:"function ($$v) {"+l+"}"}}function ib(f,h){var l=f.trim();Lb=l.length;if(0>l.indexOf("[")||l.lastIndexOf("]")<Lb-1)Ia=l.lastIndexOf("."),l=-1<Ia?{exp:l.slice(0,Ia),key:'"'+l.slice(Ia+1)+'"'}:{exp:l,
key:null};else{ec=l;for(Ia=fc=md=0;!(Ia>=Lb);)if(Mb=ec.charCodeAt(++Ia),34===Mb||39===Mb)Se(Mb);else if(91===Mb){var n=1;for(fc=Ia;!(Ia>=Lb);){var r=ec.charCodeAt(++Ia);if(34===r||39===r)Se(r);else if(91===r&&n++,93===r&&n--,0===n){md=Ia;break}}}l={exp:l.slice(0,fc),key:l.slice(fc+1,md)}}return null===l.key?f+"\x3d"+h:"$set("+l.exp+", "+l.key+", "+h+")"}function Se(f){for(var h=f;!(Ia>=Lb)&&(f=ec.charCodeAt(++Ia),f!==h););}function rh(f,h,l){var n=Nb;return function v(){null!==h.apply(null,arguments)&&
Te(f,v,l,n)}}function sh(f,h,l,n){if(th){var r=ze,v=h;h=v._wrapper=function(x){if(x.target===x.currentTarget||x.timeStamp>=r||0>=x.timeStamp||x.target.ownerDocument!==document)return v.apply(this,arguments)}}Nb.addEventListener(f,h,Ue?{capture:l,passive:n}:l)}function Te(f,h,l,n){(n||Nb).removeEventListener(f,h._wrapper||h,l)}function Ve(f,h){if(!a(f.data.on)||!a(h.data.on)){var l=h.data.on||{};f=f.data.on||{};Nb=h.elm;if(b(l.__r)){var n=ab?"change":"input";l[n]=[].concat(l.__r,l[n]||[]);delete l.__r}b(l.__c)&&
(l.change=[].concat(l.__c,l.change||[]),delete l.__c);Lc(l,f,sh,Te,rh,h.context);Nb=void 0}}function We(f,h){if(!a(f.data.domProps)||!a(h.data.domProps)){var l,n=h.elm;f=f.data.domProps||{};var r=h.data.domProps||{};b(r.__ob__)&&(r=h.data.domProps=A({},r));for(l in f)l in r||(n[l]="");for(l in r){var v=r[l];if("textContent"===l||"innerHTML"===l){h.children&&(h.children.length=0);if(v===f[l])continue;1===n.childNodes.length&&n.removeChild(n.childNodes[0])}if("value"===l&&"PROGRESS"!==n.tagName){n._value=
v;v=a(v)?"":String(v);var x=n,z=v,D;if(D=!x.composing){if(!(D="OPTION"===x.tagName)){D=!0;try{D=document.activeElement!==x}catch(E){}D=D&&x.value!==z}if(!D)a:{D=x.value;x=x._vModifiers;if(b(x)){if(x.number){D=q(D)!==q(z);break a}if(x.trim){D=D.trim()!==z.trim();break a}}D=D!==z}}D&&(n.value=v)}else if("innerHTML"===l&&cd(n.tagName)&&a(n.innerHTML)){gc=gc||document.createElement("div");gc.innerHTML="\x3csvg\x3e"+v+"\x3c/svg\x3e";for(v=gc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;v.firstChild;)n.appendChild(v.firstChild)}else if(v!==
f[l])try{n[l]=v}catch(E){}}}}function nd(f){var h=Xe(f.style);return f.staticStyle?A(f.staticStyle,h):h}function Xe(f){return Array.isArray(f)?O(f):"string"===typeof f?Ye(f):f}function Ze(f,h){var l=h.data;f=f.data;if(!(a(l.staticStyle)&&a(l.style)&&a(f.staticStyle)&&a(f.style))){var n,r;l=h.elm;var v=f.normalizedStyle||f.style||{};f=f.staticStyle||v;v=Xe(h.data.style)||{};h.data.normalizedStyle=b(v.__ob__)?A({},v):v;v={};for(var x=h;x.componentInstance;)(x=x.componentInstance._vnode)&&x.data&&(n=
nd(x.data))&&A(v,n);for((n=nd(h.data))&&A(v,n);h=h.parent;)h.data&&(n=nd(h.data))&&A(v,n);for(r in f)a(v[r])&&$e(l,r,"");for(r in v)n=v[r],n!==f[r]&&$e(l,r,null==n?"":n);if(navigator.userAgent.match(/Nabu-Renderer/)){n="";for(r in v)""!=n&&(n+=";"),n+=r+":"+v[r];l.setAttribute("style",n)}}}function af(f,h){if(h&&=h.trim())if(f.classList)-1<h.indexOf(" ")?h.split(bf).forEach(function(n){return f.classList.add(n)}):f.classList.add(h);else{var l=" "+(f.getAttribute("class")||"")+" ";0>l.indexOf(" "+
h+" ")&&f.setAttribute("class",(l+h).trim())}}function cf(f,h){if(h&&=h.trim())if(f.classList)-1<h.indexOf(" ")?h.split(bf).forEach(function(n){return f.classList.remove(n)}):f.classList.remove(h),f.classList.length||f.removeAttribute("class");else{var l=" "+(f.getAttribute("class")||"")+" ";for(h=" "+h+" ";0<=l.indexOf(h);)l=l.replace(h," ");(l=l.trim())?f.setAttribute("class",l):f.removeAttribute("class")}}function df(f){if(f){if("object"===typeof f){var h={};!1!==f.css&&A(h,ef(f.name||"v"));A(h,
f);return h}if("string"===typeof f)return ef(f)}}function ff(f){gf(function(){gf(f)})}function rb(f,h){var l=f._transitionClasses||(f._transitionClasses=[]);0>l.indexOf(h)&&(l.push(h),af(f,h))}function cb(f,h){f._transitionClasses&&u(f._transitionClasses,h);cf(f,h)}function hf(f,h,l){h=jf(f,h);var n=h.type,r=h.timeout,v=h.propCount;if(!n)return l();var x="transition"===n?hc:kf,z=0,D=function(E){E.target===f&&++z>=v&&(f.removeEventListener(x,D),l())};setTimeout(function(){z<v&&(f.removeEventListener(x,
D),l())},r+1);f.addEventListener(x,D)}function jf(f,h){f=window.getComputedStyle(f);var l=(f[ic+"Delay"]||"").split(", "),n=(f[ic+"Duration"]||"").split(", ");l=lf(l,n);var r=(f[od+"Delay"]||"").split(", "),v=(f[od+"Duration"]||"").split(", "),x=lf(r,v),z=r=0;if("transition"===h){if(0<l){var D="transition";r=l;z=n.length}}else"animation"===h?0<x&&(D="animation",r=x,z=v.length):(r=Math.max(l,x),z=(D=0<r?l>x?"transition":"animation":null)?"transition"===D?n.length:v.length:0);h="transition"===D&&uh.test(f[ic+
"Property"]);return{type:D,timeout:r,propCount:z,hasTransform:h}}function lf(f,h){for(;f.length<h.length;)f=f.concat(f);return Math.max.apply(null,h.map(function(l,n){return 1E3*Number(l.slice(0,-1).replace(",","."))+1E3*Number(f[n].slice(0,-1).replace(",","."))}))}function pd(f,h){var l=f.elm;b(l._leaveCb)&&(l._leaveCb.cancelled=!0,l._leaveCb());var n=df(f.data.transition);if(!a(n)&&!b(l._enterCb)&&1===l.nodeType){var r=n.css,v=n.type,x=n.enterClass,z=n.enterToClass,D=n.enterActiveClass,E=n.appearClass,
I=n.appearToClass,N=n.appearActiveClass,W=n.beforeEnter,fa=n.enter,ia=n.afterEnter,L=n.enterCancelled,V=n.beforeAppear,ma=n.appear,Y=n.afterAppear,da=n.appearCancelled;n=n.duration;for(var ja=nb,T=nb.$vnode;T&&T.parent;)ja=T.context,T=T.parent;ja=!ja._isMounted||!f.isRootInsert;if(!ja||ma||""===ma){var qa=ja&&E?E:x,za=ja&&N?N:D,Ja=ja&&I?I:z;x=ja?V||W:W;var G=ja?"function"===typeof ma?ma:fa:fa,J=ja?Y||ia:ia,R=ja?da||L:L,ba=q(d(n)?n.enter:n);null!=ba&&mf(ba,"enter",f);var ha=!1!==r&&!yb,ka=qd(G),na=
l._enterCb=M(function(){ha&&(cb(l,Ja),cb(l,za));na.cancelled?(ha&&cb(l,qa),R&&R(l)):J&&J(l);l._enterCb=null});f.data.show||hb(f,"insert",function(){var X=l.parentNode;(X=X&&X._pending&&X._pending[f.key])&&X.tag===f.tag&&X.elm._leaveCb&&X.elm._leaveCb();G&&G(l,na)});x&&x(l);ha&&(rb(l,qa),rb(l,za),ff(function(){cb(l,qa);na.cancelled||(rb(l,Ja),ka||("number"!==typeof ba||isNaN(ba)?hf(l,v,na):setTimeout(na,ba)))}));f.data.show&&(h&&h(),G&&G(l,na));ha||ka||na()}}}function nf(f,h){function l(){Y.cancelled||
(!f.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[f.key]=f),E&&E(n),L&&(rb(n,x),rb(n,D),ff(function(){cb(n,x);Y.cancelled||(rb(n,z),V||("number"!==typeof ma||isNaN(ma)?hf(n,v,Y):setTimeout(Y,ma)))})),I&&I(n,Y),L||V||Y())}var n=f.elm;b(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var r=df(f.data.transition);if(a(r)||1!==n.nodeType)return h();if(!b(n._leaveCb)){var v=r.type,x=r.leaveClass,z=r.leaveToClass,D=r.leaveActiveClass,E=r.beforeLeave,I=r.leave,N=r.afterLeave,
W=r.leaveCancelled,fa=r.delayLeave,ia=r.duration,L=!1!==r.css&&!yb,V=qd(I),ma=q(d(ia)?ia.leave:ia);b(ma)&&mf(ma,"leave",f);var Y=n._leaveCb=M(function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[f.key]=null);L&&(cb(n,z),cb(n,D));Y.cancelled?(L&&cb(n,x),W&&W(n)):(h(),N&&N(n));n._leaveCb=null});fa?fa(l):l()}}function mf(f,h,l){"number"!==typeof f?U("\x3ctransition\x3e explicit "+h+" duration is not a valid number - got "+JSON.stringify(f)+".",l.context):isNaN(f)&&U("\x3ctransition\x3e explicit "+
h+" duration is NaN - the duration expression might be incorrect.",l.context)}function qd(f){if(a(f))return!1;var h=f.fns;return b(h)?qd(Array.isArray(h)?h[0]:h):1<(f._length||f.length)}function of(f,h){!0!==h.data.show&&pd(h)}function pf(f,h,l){qf(f,h,l);(ab||hd)&&setTimeout(function(){qf(f,h,l)},0)}function qf(f,h,l){var n=h.value,r=f.multiple;if(r&&!Array.isArray(n))U('\x3cselect multiple v-model\x3d"'+h.expression+'"\x3e expects an Array value for its binding, but got '+Object.prototype.toString.call(n).slice(8,
-1),l);else{for(var v=0,x=f.options.length;v<x;v++)if(l=f.options[v],r)h=-1<P(n,jc(l)),l.selected!==h&&(l.selected=h);else if(ca(jc(l),n)){f.selectedIndex!==v&&(f.selectedIndex=v);return}r||(f.selectedIndex=-1)}}function rf(f,h){return h.every(function(l){return!ca(l,f)})}function jc(f){return"_value"in f?f._value:f.value}function vh(f){f.target.composing=!0}function sf(f){f.target.composing&&(f.target.composing=!1,rd(f.target,"input"))}function rd(f,h){var l=document.createEvent("HTMLEvents");l.initEvent(h,
!0,!0);f.dispatchEvent(l)}function sd(f){return!f.componentInstance||f.data&&f.data.transition?f:sd(f.componentInstance._vnode)}function td(f){var h=f&&f.componentOptions;return h&&h.Ctor.options.abstract?td(re(h.children)):f}function tf(f){var h={},l=f.$options,n;for(n in l.propsData)h[n]=f[n];f=l._parentListeners;for(var r in f)h[Ga(r)]=f[r];return h}function uf(f,h){if(/\d-keep-alive$/.test(h.tag))return f("keep-alive",{props:h.componentOptions.propsData})}function wh(f){for(;f=f.parent;)if(f.data.transition)return!0}
function xh(f){f.elm._moveCb&&f.elm._moveCb();f.elm._enterCb&&f.elm._enterCb()}function yh(f){f.data.newPos=f.elm.getBoundingClientRect()}function zh(f){var h=f.data.pos,l=f.data.newPos,n=h.left-l.left;h=h.top-l.top;if(n||h)f.data.moved=!0,f=f.elm.style,f.transform=f.WebkitTransform="translate("+n+"px,"+h+"px)",f.transitionDuration="0s"}function kc(f,h){h=h?Ah(h):Bh;if(h.test(f)){for(var l=[],n=[],r=h.lastIndex=0,v,x;v=h.exec(f);)x=v.index,x>r&&(n.push(r=f.slice(r,x)),l.push(JSON.stringify(r))),r=
jd(v[1].trim()),l.push("_s("+r+")"),n.push({"@binding":r}),r=x+v[0].length;r<f.length&&(n.push(r=f.slice(r)),l.push(JSON.stringify(r)));return{expression:l.join("+"),tokens:n}}}function Ch(f,h){return f.replace(h?Dh:Eh,function(l){return Fh[l]})}function Gh(f,h){function l(Y){I+=Y;f=f.substring(Y)}function n(){var Y=f.match(vf);if(Y){var da={tagName:Y[1],attrs:[],start:I};l(Y[0].length);for(var ja;!(Y=f.match(Hh))&&(ja=f.match(Ih)||f.match(Jh));)ja.start=I,l(ja[0].length),ja.end=I,da.attrs.push(ja);
if(Y)return da.unarySlash=Y[1],l(Y[0].length),da.end=I,da}}function r(Y){var da=Y.tagName,ja=Y.unarySlash;z&&("p"===W&&Kh(da)&&v(W),E(da)&&W===da&&v(da));ja=D(da)||!!ja;for(var T=Y.attrs.length,qa=Array(T),za=0;za<T;za++){var Ja=Y.attrs[za];qa[za]={name:Ja[1],value:Ch(Ja[3]||Ja[4]||Ja[5]||"","a"===da&&"href"===Ja[1]?h.shouldDecodeNewlinesForHref:h.shouldDecodeNewlines)};h.outputSourceRange&&(qa[za].start=Ja.start+Ja[0].match(/^\s*/).length,qa[za].end=Ja.end)}ja||(x.push({tag:da,lowerCasedTag:da.toLowerCase(),
attrs:qa,start:Y.start,end:Y.end}),W=da);h.start&&h.start(da,qa,ja,Y.start,Y.end)}function v(Y,da,ja){var T;null==da&&(da=I);null==ja&&(ja=I);if(Y){var qa=Y.toLowerCase();for(T=x.length-1;0<=T&&x[T].lowerCasedTag!==qa;T--);}else T=0;if(0<=T){for(qa=x.length-1;qa>=T;qa--)(qa>T||!Y&&h.warn)&&h.warn("tag \x3c"+x[qa].tag+"\x3e has no matching end tag.",{start:x[qa].start,end:x[qa].end}),h.end&&h.end(x[qa].tag,da,ja);W=(x.length=T)&&x[T-1].tag}else"br"===qa?h.start&&h.start(Y,[],!0,da,ja):"p"===qa&&(h.start&&
h.start(Y,[],!1,da,ja),h.end&&h.end(Y,da,ja))}for(var x=[],z=h.expectHTML,D=h.isUnaryTag||Qa,E=h.canBeLeftOpenTag||Qa,I=0,N,W;f;){N=f;if(W&&wf(W)){var fa=0,ia=W.toLowerCase(),L=xf[ia]||(xf[ia]=new RegExp("([\\s\\S]*?)(\x3c/"+ia+"[^\x3e]*\x3e)","i"));L=f.replace(L,function(Y,da,ja){fa=ja.length;wf(ia)||"noscript"===ia||(da=da.replace(/<!\--([\s\S]*?)--\x3e/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]\x3e/g,"$1"));yf(ia,da)&&(da=da.slice(1));h.chars&&h.chars(da);return""});I+=f.length-L.length;f=L;v(ia,
I-fa,I)}else{L=f.indexOf("\x3c");if(0===L){if(zf.test(f)){var V=f.indexOf("--\x3e");if(0<=V){h.shouldKeepComment&&h.comment(f.substring(4,V),I,I+V+3);l(V+3);continue}}if(Af.test(f)&&(V=f.indexOf("]\x3e"),0<=V)){l(V+2);continue}if(V=f.match(Lh)){l(V[0].length);continue}if(V=f.match(Bf)){N=I;l(V[0].length);v(V[1],N,I);continue}if(V=n()){r(V);yf(V.tagName,f)&&l(1);continue}}var ma=V=void 0;ma=void 0;if(0<=L){for(ma=f.slice(L);!(Bf.test(ma)||vf.test(ma)||zf.test(ma)||Af.test(ma));){ma=ma.indexOf("\x3c",
1);if(0>ma)break;L+=ma;ma=f.slice(L)}V=f.substring(0,L)}0>L&&(V=f);V&&l(V.length);h.chars&&V&&h.chars(V,I-V.length,I)}if(f===N){h.chars&&h.chars(f);!x.length&&h.warn&&h.warn('Mal-formatted tag at end of template: "'+f+'"',{start:I+f.length});break}}v()}function ud(f,h,l){for(var n={},r=0,v=h.length;r<v;r++)!n[h[r].name]||ab||hd||ua("duplicate attribute: "+h[r].name,h[r]),n[h[r].name]=h[r].value;return{type:1,tag:f,attrsList:h,attrsMap:n,rawAttrsMap:{},parent:l,children:[]}}function Mh(f,h){function l(L,
V){ia||(ia=!0,ua(L,V))}function n(L){r(L);W||L.processed||(L=lc(L,h));z.length||L===I||(I.if&&(L.elseif||L.else)?(v(L),zb(I,{exp:L.elseif,block:L})):l("Component template should contain exactly one root element. If you are using v-if on multiple elements, use v-else-if to chain them instead.",{start:L.start}));if(N&&!L.forbidden)if(L.elseif||L.else)Nh(L,N);else{if(L.slotScope){var V=L.slotTarget||'"default"';(N.scopedSlots||(N.scopedSlots={}))[V]=L}N.children.push(L);L.parent=N}L.children=L.children.filter(function(ma){return!ma.slotScope});
r(L);L.pre&&(W=!1);vd(L.tag)&&(fa=!1);for(V=0;V<wd.length;V++)wd[V](L,h)}function r(L){if(!fa)for(var V;(V=L.children[L.children.length-1])&&3===V.type&&" "===V.text;)L.children.pop()}function v(L){"slot"!==L.tag&&"template"!==L.tag||l("Cannot use \x3c"+L.tag+"\x3e as component root element because it may contain multiple nodes.",{start:L.start});L.attrsMap.hasOwnProperty("v-for")&&l("Cannot use v-for on stateful component root element because it renders multiple elements.",L.rawAttrsMap["v-for"])}
ua=h.warn||cc;vd=h.isPreTag||Qa;xd=h.mustUseProp||Qa;Cf=h.getTagNamespace||Qa;var x=h.isReservedTag||Qa;yd=function(L){return!!L.component||!x(L.tag)};zd=Jb(h.modules,"transformNode");Ad=Jb(h.modules,"preTransformNode");wd=Jb(h.modules,"postTransformNode");Bd=h.delimiters;var z=[],D=!1!==h.preserveWhitespace,E=h.whitespace,I,N,W=!1,fa=!1,ia=!1;Gh(f,{warn:ua,expectHTML:h.expectHTML,isUnaryTag:h.isUnaryTag,canBeLeftOpenTag:h.canBeLeftOpenTag,shouldDecodeNewlines:h.shouldDecodeNewlines,shouldDecodeNewlinesForHref:h.shouldDecodeNewlinesForHref,
shouldKeepComment:h.comments,outputSourceRange:h.outputSourceRange,start:function(L,V,ma,Y,da){var ja=N&&N.ns||Cf(L);ab&&"svg"===ja&&(V=Oh(V));var T=ud(L,V,N);ja&&(T.ns=ja);h.outputSourceRange&&(T.start=Y,T.end=da,T.rawAttrsMap=T.attrsList.reduce(function(qa,za){qa[za.name]=za;return qa},{}));V.forEach(function(qa){Ph.test(qa.name)&&ua("Invalid dynamic argument expression: attribute names cannot contain spaces, quotes, \x3c, \x3e, / or \x3d.",{start:qa.start+qa.name.indexOf("["),end:qa.start+qa.name.length})});
"style"!==T.tag&&("script"!==T.tag||T.attrsMap.type&&"text/javascript"!==T.attrsMap.type)||Db()||(T.forbidden=!0,ua("Templates should only be responsible for mapping the state to the UI. Avoid placing tags with side-effects in your templates, such as \x3c"+L+"\x3e, as they will not be parsed.",{start:T.start}));for(L=0;L<Ad.length;L++)T=Ad[L](T,h)||T;W||(Qh(T),T.pre&&(W=!0));vd(T.tag)&&(fa=!0);W?Rh(T):T.processed||(Df(T),Sh(T),Th(T));I||(I=T,v(I));ma?n(T):(N=T,z.push(T))},end:function(L,V,ma){L=z[z.length-
1];--z.length;N=z[z.length-1];h.outputSourceRange&&(L.end=ma);n(L)},chars:function(L,V,ma){if(!N)L===f?l("Component template requires a root element, rather than just text.",{start:V}):(L=L.trim())&&l('text "'+L+'" outside root element will be ignored.',{start:V});else if(!ab||"textarea"!==N.tag||N.attrsMap.placeholder!==L){var Y=N.children;if(L=fa||L.trim()?"script"===N.tag||"style"===N.tag?L:Uh(L):Y.length?E?"condense"===E?Vh.test(L)?"":" ":" ":D?" ":"":""){fa||"condense"!==E||(L=L.replace(Wh," "));
var da,ja;!W&&" "!==L&&(da=kc(L,Bd))?ja={type:2,expression:da.expression,tokens:da.tokens,text:L}:" "===L&&Y.length&&" "===Y[Y.length-1].text||(ja={type:3,text:L});ja&&(h.outputSourceRange&&(ja.start=V,ja.end=ma),Y.push(ja))}}},comment:function(L,V,ma){N&&(L={type:3,text:L,isComment:!0},h.outputSourceRange&&(L.start=V,L.end=ma),N.children.push(L))}});return I}function Qh(f){null!=xa(f,"v-pre")&&(f.pre=!0)}function Rh(f){var h=f.attrsList,l=h.length;if(l){f=f.attrs=Array(l);for(var n=0;n<l;n++)f[n]=
{name:h[n].name,value:JSON.stringify(h[n].value)},null!=h[n].start&&(f[n].start=h[n].start,f[n].end=h[n].end)}else f.pre||(f.plain=!0)}function lc(f,h){var l=f,n=Pa(l,"key");if(n){"template"===l.tag&&ua("\x3ctemplate\x3e cannot be keyed. Place the key on real elements instead.",dc(l,"key"));if(l.for){var r=l.iterator2||l.iterator1,v=l.parent;r&&r===n&&v&&"transition-group"===v.tag&&ua("Do not use v-for index as key on \x3ctransition-group\x3e children, this is the same as not using keys.",dc(l,"key"),
!0)}l.key=n}f.plain=!f.key&&!f.scopedSlots&&!f.attrsList.length;l=f;if(n=Pa(l,"ref")){l.ref=n;a:{for(n=l;n;){if(void 0!==n.for){n=!0;break a}n=n.parent}n=!1}l.refInFor=n}Xh(f);l=f;"slot"===l.tag&&(l.slotName=Pa(l,"name"),l.key&&ua("`key` does not work on \x3cslot\x3e because slots are abstract outlets and can possibly expand into multiple elements. Use the key on a wrapping element instead.",dc(l,"key")));l=f;if(n=Pa(l,"is"))l.component=n;null!=xa(l,"inline-template")&&(l.inlineTemplate=!0);for(l=
0;l<zd.length;l++)f=zd[l](f,h)||f;h=f;l=h.attrsList;var x,z,D;n=0;for(r=l.length;n<r;n++){var E=x=l[n].name;v=l[n].value;if(mc.test(E))if(h.hasBindings=!0,(z=Yh(E.replace(mc,"")))&&(E=E.replace(Ef,"")),Ff.test(E)){E=E.replace(Ff,"");v=jd(v);(D=nc.test(E))&&(E=E.slice(1,-1));0===v.trim().length&&ua('The value for a v-bind expression cannot be empty. Found in "v-bind:'+E+'"');if(z&&(z.prop&&!D&&(E=Ga(E),"innerHtml"===E&&(E="innerHTML")),z.camel&&!D&&(E=Ga(E)),z.sync)){var I=ib(v,"$event");D?bb(h,'"update:"+('+
E+")",I,null,!1,ua,l[n],!0):(bb(h,"update:"+Ga(E),I,null,!1,ua,l[n]),Za(E)!==Ga(E)&&bb(h,"update:"+Za(E),I,null,!1,ua,l[n]))}z&&z.prop||!h.component&&xd(h.tag,h.attrsMap.type,E)?qb(h,E,v,l[n],D):kd(h,E,v,l[n],D)}else if(Cd.test(E))E=E.replace(Cd,""),(D=nc.test(E))&&(E=E.slice(1,-1)),bb(h,E,v,z,!1,ua,l[n],D);else{E=E.replace(mc,"");var N=(I=E.match(Zh))&&I[1];D=!1;N&&(E=E.slice(0,-(N.length+1)),nc.test(N)&&(N=N.slice(1,-1),D=!0));I=h;var W=E,fa=v,ia=l[n];(I.directives||(I.directives=[])).push(Kb({name:W,
rawName:x,value:fa,arg:N,isDynamicArg:D,modifiers:z},ia));I.plain=!1;if("model"===E)for(z=E=h;z;)z.for&&z.alias===v&&ua("\x3c"+E.tag+' v-model\x3d"'+v+'"\x3e: You are binding v-model directly to a v-for iteration alias. This will not be able to modify the v-for source array because writing to the alias is like modifying a function local variable. Consider using an array of objects and use v-model on an object property instead.',E.rawAttrsMap["v-model"]),z=z.parent}else kc(v,Bd)&&ua(E+'\x3d"'+v+'": Interpolation inside attributes has been removed. Use v-bind or the colon shorthand instead. For example, instead of \x3cdiv id\x3d"{{ val }}"\x3e, use \x3cdiv :id\x3d"val"\x3e.',
l[n]),kd(h,E,JSON.stringify(v),l[n]),!h.component&&"muted"===E&&xd(h.tag,h.attrsMap.type,E)&&qb(h,E,"true",l[n])}return f}function Df(f){var h;if(h=xa(f,"v-for")){var l=h.match($h);if(l){var n={};n.for=l[2].trim();l=l[1].trim().replace(ai,"");var r=l.match(Gf);r?(n.alias=l.replace(Gf,"").trim(),n.iterator1=r[1].trim(),r[2]&&(n.iterator2=r[2].trim())):n.alias=l}else n=void 0;n?A(f,n):ua("Invalid v-for expression: "+h,f.rawAttrsMap["v-for"])}}function Sh(f){var h=xa(f,"v-if");if(h)f.if=h,zb(f,{exp:h,
block:f});else if(null!=xa(f,"v-else")&&(f.else=!0),h=xa(f,"v-else-if"))f.elseif=h}function Nh(f,h){a:{h=h.children;for(var l=h.length;l--;)if(1===h[l].type){h=h[l];break a}else" "!==h[l].text&&ua('text "'+h[l].text.trim()+'" between v-if and v-else(-if) will be ignored.',h[l]),h.pop();h=void 0}h&&h.if?zb(h,{exp:f.elseif,block:f}):ua("v-"+(f.elseif?'else-if\x3d"'+f.elseif+'"':"else")+" used on element \x3c"+f.tag+"\x3e without corresponding v-if.",f.rawAttrsMap[f.elseif?"v-else-if":"v-else"])}function zb(f,
h){f.ifConditions||(f.ifConditions=[]);f.ifConditions.push(h)}function Th(f){null!=xa(f,"v-once")&&(f.once=!0)}function Xh(f){var h;if("template"===f.tag)(h=xa(f,"scope"))&&ua('the "scope" attribute for scoped slots have been deprecated and replaced by "slot-scope" since 2.5. The new "slot-scope" attribute can also be used on plain elements in addition to \x3ctemplate\x3e to denote scoped slots.',f.rawAttrsMap.scope,!0),f.slotScope=h||xa(f,"slot-scope");else if(h=xa(f,"slot-scope"))f.attrsMap["v-for"]&&
ua("Ambiguous combined usage of slot-scope and v-for on \x3c"+f.tag+"\x3e (v-for takes higher priority). Use a wrapper \x3ctemplate\x3e for the scoped slot to make it clearer.",f.rawAttrsMap["slot-scope"],!0),f.slotScope=h;if(h=Pa(f,"slot"))f.slotTarget='""'===h?'"default"':h,f.slotTargetDynamic=!(!f.attrsMap[":slot"]&&!f.attrsMap["v-bind:slot"]),"template"===f.tag||f.slotScope||kd(f,"slot",h,dc(f,"slot"));if("template"===f.tag){if(h=Qe(f,Dd)){(f.slotTarget||f.slotScope)&&ua("Unexpected mixed usage of different slot syntaxes.",
f);f.parent&&!yd(f.parent)&&ua("\x3ctemplate v-slot\x3e can only appear at the root level inside the receiving the component",f);var l=Hf(h),n=l.dynamic;f.slotTarget=l.name;f.slotTargetDynamic=n;f.slotScope=h.value||"_empty_"}}else if(h=Qe(f,Dd)){yd(f)||ua("v-slot can only be used on components or \x3ctemplate\x3e.",h);(f.slotScope||f.slotTarget)&&ua("Unexpected mixed usage of different slot syntaxes.",f);f.scopedSlots&&ua("To avoid scope ambiguity, the default slot should also use \x3ctemplate\x3e syntax when there are other named slots.",
h);l=f.scopedSlots||(f.scopedSlots={});var r=Hf(h);n=r.name;r=r.dynamic;var v=l[n]=ud("template",[],f);v.slotTarget=n;v.slotTargetDynamic=r;v.children=f.children.filter(function(x){if(!x.slotScope)return x.parent=v,!0});v.slotScope=h.value||"_empty_";f.children=[];f.plain=!1}}function Hf(f){var h=f.name.replace(Dd,"");h||("#"!==f.name[0]?h="default":ua("v-slot shorthand syntax requires a slot name.",f));return nc.test(h)?{name:h.slice(1,-1),dynamic:!0}:{name:'"'+h+'"',dynamic:!1}}function Yh(f){if(f=
f.match(Ef)){var h={};f.forEach(function(l){h[l.slice(1)]=!0});return h}}function Oh(f){for(var h=[],l=0;l<f.length;l++){var n=f[l];bi.test(n.name)||(n.name=n.name.replace(ci,""),h.push(n))}return h}function Ed(f){return ud(f.tag,f.attrsList.slice(),f.parent)}function Fd(f){if(2===f.type)var h=!1;else if(3===f.type)h=!0;else{if(h=!f.pre){if(!(h=f.hasBindings||f.if||f.for||Ud(f.tag)||!Gd(f.tag)))b:{for(h=f;h.parent;){h=h.parent;if("template"!==h.tag)break;if(h.for){h=!0;break b}}h=!1}h=h||!Object.keys(f).every(If)}h=
!h}f.static=h;if(1===f.type&&(Gd(f.tag)||"slot"===f.tag||null!=f.attrsMap["inline-template"])){h=0;for(var l=f.children.length;h<l;h++){var n=f.children[h];Fd(n);n.static||(f.static=!1)}if(f.ifConditions)for(h=1,l=f.ifConditions.length;h<l;h++)n=f.ifConditions[h].block,Fd(n),n.static||(f.static=!1)}}function Hd(f,h){if(1===f.type){if(f.static||f.once)f.staticInFor=h;if(f.static&&f.children.length&&(1!==f.children.length||3!==f.children[0].type))f.staticRoot=!0;else{f.staticRoot=!1;if(f.children)for(var l=
0,n=f.children.length;l<n;l++)Hd(f.children[l],h||!!f.for);if(f.ifConditions)for(l=1,n=f.ifConditions.length;l<n;l++)Hd(f.ifConditions[l].block,h)}}}function Jf(f,h){h=h?"nativeOn:":"on:";var l="",n="",r;for(r in f){var v=Kf(f[r]);f[r]&&f[r].dynamic?n+=r+","+v+",":l+='"'+r+'":'+v+","}l="{"+l.slice(0,-1)+"}";return n?h+"_d("+l+",["+n.slice(0,-1)+"])":h+l}function Kf(f){if(!f)return"function(){}";if(Array.isArray(f))return"["+f.map(function(E){return Kf(E)}).join(",")+"]";var h=Lf.test(f.value),l=di.test(f.value),
n=Lf.test(f.value.replace(ei,""));if(f.modifiers){var r="",v="",x=[],z;for(z in f.modifiers)if(Mf[z])v+=Mf[z],Nf[z]&&x.push(z);else if("exact"===z){var D=f.modifiers;v+=db(["ctrl","shift","alt","meta"].filter(function(E){return!D[E]}).map(function(E){return"$event."+E+"Key"}).join("||"))}else x.push(z);x.length&&(r+="if(!$event.type.indexOf('key')\x26\x26"+x.map(fi).join("\x26\x26")+")return null;");v&&(r+=v);return"function($event){"+r+(h?"return "+f.value+"($event)":l?"return ("+f.value+")($event)":
n?"return "+f.value:f.value)+"}"}return h||l?f.value:"function($event){"+(n?"return "+f.value:f.value)+"}"}function fi(f){var h=parseInt(f,10);if(h)return"$event.keyCode!\x3d\x3d"+h;h=Nf[f];var l=gi[f];return"_k($event.keyCode,"+JSON.stringify(f)+","+JSON.stringify(h)+",$event.key,"+JSON.stringify(l)+")"}function Of(f,h){h=new hi(h);return{render:"with(this){return "+(f?eb(f,h):'_c("div")')+"}",staticRenderFns:h.staticRenderFns}}function eb(f,h){f.parent&&(f.pre=f.pre||f.parent.pre);if(f.staticRoot&&
!f.staticProcessed)return Pf(f,h);if(f.once&&!f.onceProcessed)return Qf(f,h);if(f.for&&!f.forProcessed)return Rf(f,h);if(f.if&&!f.ifProcessed)return Id(f,h);if("template"!==f.tag||f.slotTarget||h.pre){if("slot"===f.tag)return ii(f,h);if(f.component){var l=f.component;var n=f.inlineTemplate?null:Ab(f,h,!0);l="_c("+l+","+Sf(f,h)+(n?","+n:"")+")"}else{if(!f.plain||f.pre&&h.maybeComponent(f))l=Sf(f,h);n=f.inlineTemplate?null:Ab(f,h,!0);l="_c('"+f.tag+"'"+(l?","+l:"")+(n?","+n:"")+")"}for(n=0;n<h.transforms.length;n++)l=
h.transforms[n](f,l);return l}return Ab(f,h)||"void 0"}function Pf(f,h){f.staticProcessed=!0;var l=h.pre;f.pre&&(h.pre=f.pre);h.staticRenderFns.push("with(this){return "+eb(f,h)+"}");h.pre=l;return"_m("+(h.staticRenderFns.length-1)+(f.staticInFor?",true":"")+")"}function Qf(f,h){f.onceProcessed=!0;if(f.if&&!f.ifProcessed)return Id(f,h);if(f.staticInFor){for(var l="",n=f.parent;n;){if(n.for){l=n.key;break}n=n.parent}return l?"_o("+eb(f,h)+","+h.onceId++ +","+l+")":(h.warn("v-once can only be used inside v-for that is keyed. ",
f.rawAttrsMap["v-once"]),eb(f,h))}return Pf(f,h)}function Id(f,h,l,n){f.ifProcessed=!0;return Tf(f.ifConditions.slice(),h,l,n)}function Tf(f,h,l,n){function r(x){return l?l(x,h):x.once?Qf(x,h):eb(x,h)}if(!f.length)return n||"_e()";var v=f.shift();return v.exp?"("+v.exp+")?"+r(v.block)+":"+Tf(f,h,l,n):""+r(v.block)}function Rf(f,h,l,n){var r=f.for,v=f.alias,x=f.iterator1?","+f.iterator1:"",z=f.iterator2?","+f.iterator2:"";h.maybeComponent(f)&&"slot"!==f.tag&&"template"!==f.tag&&!f.key&&h.warn("\x3c"+
f.tag+' v-for\x3d"'+v+" in "+r+'"\x3e: component lists rendered with v-for should have explicit keys. See https://vuejs.org/guide/list.html#key for more info.',f.rawAttrsMap["v-for"],!0);f.forProcessed=!0;return(n||"_l")+"(("+r+"),function("+v+x+z+"){return "+(l||eb)(f,h)+"})"}function Sf(f,h){var l="{",n;if(n=f.directives){var r="directives:[",v=!1,x;var z=0;for(x=n.length;z<x;z++){var D=n[z];var E=!0;var I=h.directives[D.name];I&&(E=!!I(f,D,h.warn));E&&(v=!0,r+='{name:"'+D.name+'",rawName:"'+D.rawName+
'"'+(D.value?",value:("+D.value+"),expression:"+JSON.stringify(D.value):"")+(D.arg?",arg:"+(D.isDynamicArg?D.arg:'"'+D.arg+'"'):"")+(D.modifiers?",modifiers:"+JSON.stringify(D.modifiers):"")+"},")}n=v?r.slice(0,-1)+"]":void 0}else n=void 0;n&&(l+=n+",");f.key&&(l+="key:"+f.key+",");f.ref&&(l+="ref:"+f.ref+",");f.refInFor&&(l+="refInFor:true,");f.pre&&(l+="pre:true,");f.component&&(l+='tag:"'+f.tag+'",');for(n=0;n<h.dataGenFns.length;n++)l+=h.dataGenFns[n](f);f.attrs&&(l+="attrs:"+oc(f.attrs)+",");
f.props&&(l+="domProps:"+oc(f.props)+",");f.events&&(l+=Jf(f.events,!1)+",");f.nativeEvents&&(l+=Jf(f.nativeEvents,!0)+",");f.slotTarget&&!f.slotScope&&(l+="slot:"+f.slotTarget+",");f.scopedSlots&&(l+=ji(f,f.scopedSlots,h)+",");f.model&&(l+="model:{value:"+f.model.value+",callback:"+f.model.callback+",expression:"+f.model.expression+"},");f.inlineTemplate&&(h=ki(f,h))&&(l+=h+",");l=l.replace(/,$/,"")+"}";f.dynamicAttrs&&(l="_b("+l+',"'+f.tag+'",'+oc(f.dynamicAttrs)+")");f.wrapData&&(l=f.wrapData(l));
f.wrapListeners&&(l=f.wrapListeners(l));return l}function ki(f,h){var l=f.children[0];1===f.children.length&&1===l.type||h.warn("Inline-template components must have exactly one child element.",{start:f.start});if(l&&1===l.type)return f=Of(l,h.options),"inlineTemplate:{render:function(){"+f.render+"},staticRenderFns:["+f.staticRenderFns.map(function(n){return"function(){"+n+"}"}).join(",")+"]}"}function ji(f,h,l){var n=f.for||Object.keys(h).some(function(v){v=h[v];return v.slotTargetDynamic||v.if||
v.for||Uf(v)}),r=!!f.if;if(!n)for(f=f.parent;f;){if(f.slotScope&&"_empty_"!==f.slotScope||f.for){n=!0;break}f.if&&(r=!0);f=f.parent}f=Object.keys(h).map(function(v){return Jd(h[v],l)}).join(",");return"scopedSlots:_u(["+f+"]"+(n?",null,true":"")+(!n&&r?",null,false,"+li(f):"")+")"}function li(f){for(var h=5381,l=f.length;l;)h=33*h^f.charCodeAt(--l);return h>>>0}function Uf(f){return 1===f.type?"slot"===f.tag?!0:f.children.some(Uf):!1}function Jd(f,h){var l=f.attrsMap["slot-scope"];if(f.if&&!f.ifProcessed&&
!l)return Id(f,h,Jd,"null");if(f.for&&!f.forProcessed)return Rf(f,h,Jd);var n="_empty_"===f.slotScope?"":String(f.slotScope);h="function("+n+"){return "+("template"===f.tag?f.if&&l?"("+f.if+")?"+(Ab(f,h)||"undefined")+":undefined":Ab(f,h)||"undefined":eb(f,h))+"}";return"{key:"+(f.slotTarget||'"default"')+",fn:"+h+(n?"":",proxy:true")+"}"}function Ab(f,h,l,n,r){f=f.children;if(f.length){var v=f[0];if(1===f.length&&v.for&&"template"!==v.tag&&"slot"!==v.tag)return r=l?h.maybeComponent(v)?",1":",0":
"",""+(n||eb)(v,h)+r;n=l?mi(f,h.maybeComponent):0;var x=r||ni;return"["+f.map(function(z){return x(z,h)}).join(",")+"]"+(n?","+n:"")}}function mi(f,h){for(var l=0,n=0;n<f.length;n++){var r=f[n];if(1===r.type){if(Vf(r)||r.ifConditions&&r.ifConditions.some(function(v){return Vf(v.block)})){l=2;break}if(h(r)||r.ifConditions&&r.ifConditions.some(function(v){return h(v.block)}))l=1}}return l}function Vf(f){return void 0!==f.for||"template"===f.tag||"slot"===f.tag}function ni(f,h){return 1===f.type?eb(f,
h):3===f.type&&f.isComment?"_e("+JSON.stringify(f.text)+")":"_v("+(2===f.type?f.expression:Wf(JSON.stringify(f.text)))+")"}function ii(f,h){var l=f.slotName||'"default"';h=Ab(f,h);l="_t("+l+(h?","+h:"");var n=f.attrs||f.dynamicAttrs?oc((f.attrs||[]).concat(f.dynamicAttrs||[]).map(function(r){return{name:Ga(r.name),value:r.value,dynamic:r.dynamic}})):null;f=f.attrsMap["v-bind"];!n&&!f||h||(l+=",null");n&&(l+=","+n);f&&(l+=(n?"":",null")+","+f);return l+")"}function oc(f){for(var h="",l="",n=0;n<f.length;n++){var r=
f[n],v=Wf(r.value);r.dynamic?l+=r.name+","+v+",":h+='"'+r.name+'":'+v+","}h="{"+h.slice(0,-1)+"}";return l?"_d("+h+",["+l.slice(0,-1)+"])":h}function Wf(f){return f.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function oi(f,h){f&&Xf(f,h)}function Xf(f,h){if(1===f.type){for(var l in f.attrsMap)if(mc.test(l)){var n=f.attrsMap[l];if(n){var r=f.rawAttrsMap[l];if("v-for"===l){var v=f;n='v-for\x3d"'+n+'"';var x=h;pc(v.for||"",n,x,r);Kd(v.alias,"v-for alias",n,x,r);Kd(v.iterator1,"v-for iterator",
n,x,r);Kd(v.iterator2,"v-for iterator",n,x,r)}else if(Cd.test(l)){v=n;n=l+'\x3d"'+n+'"';x=h;var z=v.replace(Yf,""),D=z.match(pi);D&&"$"!==z.charAt(D.index-1)&&x('avoid using JavaScript unary operator as property name: "'+D[0]+'" in expression '+n.trim(),r);pc(v,n,x,r)}else pc(n,l+'\x3d"'+n+'"',h,r)}}if(f.children)for(l=0;l<f.children.length;l++)Xf(f.children[l],h)}else 2===f.type&&pc(f.expression,f.text,h,f)}function Kd(f,h,l,n,r){if("string"===typeof f)try{new Function("var "+f+"\x3d_")}catch(v){n("invalid "+
h+' "'+f+'" in expression: '+l.trim(),r)}}function pc(f,h,l,n){try{new Function("return "+f)}catch(v){var r=f.replace(Yf,"").match(qi);r?l('avoid using JavaScript keyword as property name: "'+r[0]+'"\n  Raw expression: '+h.trim(),n):l("invalid expression: "+v.message+" in\n\n    "+f+"\n\n  Raw expression: "+h.trim()+"\n",n)}}function qc(f,h){var l="";if(0<h)for(;;){h&1&&(l+=f);h>>>=1;if(0>=h)break;f+=f}return l}function Zf(f,h){try{return new Function(f)}catch(l){return h.push({err:l,code:f}),H}}
function ri(f){var h=Object.create(null);return function(l,n,r){n=A({},n);var v=n.warn||U;delete n.warn;try{new Function("return 1")}catch(E){E.toString().match(/unsafe-eval|CSP/)&&v("It seems you are using the standalone build of Vue.js in an environment with Content Security Policy that prohibits unsafe-eval. The template compiler cannot work in this environment. Consider relaxing the policy to allow unsafe-eval or pre-compiling your templates into render functions.")}var x=n.delimiters?String(n.delimiters)+
l:l;if(h[x])return h[x];var z=f(l,n);z.errors&&z.errors.length&&(n.outputSourceRange?z.errors.forEach(function(E){var I="Error compiling template:\n\n"+E.msg+"\n\n";var N=E.start;E=E.end;void 0===N&&(N=0);void 0===E&&(E=l.length);for(var W=l.split(/\r?\n/),fa=0,ia=[],L=0;L<W.length;L++)if(fa+=W[L].length+1,fa>=N){for(var V=L-2;V<=L+2||E>fa;V++)if(!(0>V||V>=W.length)){ia.push(""+(V+1)+qc(" ",3-String(V+1).length)+"|  "+W[V]);var ma=W[V].length;if(V===L){var Y=N-(fa-ma)+1;ma=E>fa?ma-Y:E-N;ia.push("   |  "+
qc(" ",Y)+qc("^",ma))}else V>L&&(E>fa&&ia.push("   |  "+qc("^",Math.min(E-fa,ma))),fa+=ma+1)}break}N=ia.join("\n");v(I+N,r)}):v("Error compiling template:\n\n"+l+"\n\n"+z.errors.map(function(E){return"- "+E}).join("\n")+"\n",r));z.tips&&z.tips.length&&(n.outputSourceRange?z.tips.forEach(function(E){return Fb(E.msg,r)}):z.tips.forEach(function(E){return Fb(E,r)}));n={};var D=[];n.render=Zf(z.render,D);n.staticRenderFns=z.staticRenderFns.map(function(E){return Zf(E,D)});z.errors&&z.errors.length||!D.length||
v("Failed to generate render function:\n\n"+D.map(function(E){return E.err.toString()+" in\n\n"+E.code+"\n"}).join("\n"),r);return h[x]=n}}function $f(f){rc=rc||document.createElement("div");rc.innerHTML=f?'\x3ca href\x3d"\n"/\x3e':'\x3cdiv a\x3d"\n"/\x3e';return 0<rc.innerHTML.indexOf("\x26#10;")}var Oa=Object.freeze({}),Cb=Object.prototype.toString,Ud=t("slot,component",!0),ie=t("key,ref,slot,slot-scope,is"),yg=Object.prototype.hasOwnProperty,si=/-(\w)/g,Ga=y(function(f){return f.replace(si,function(h,
l){return l?l.toUpperCase():""})}),Wd=y(function(f){return f.charAt(0).toUpperCase()+f.slice(1)}),ti=/\B([A-Z])/g,Za=y(function(f){return f.replace(ti,"-$1").toLowerCase()}),ui=Function.prototype.bind?F:B,Qa=function(f,h,l){return!1},ge=function(f){return f},ac=["component","directive","filter"],ag="beforeCreate created beforeMount mounted beforeUpdate updated beforeDestroy destroyed activated deactivated errorCaptured serverPrefetch".split(" "),ra={optionMergeStrategies:Object.create(null),silent:application&&
application.configuration&&application.configuration.development,productionTip:application&&application.configuration&&application.configuration.development,devtools:application&&application.configuration&&application.configuration.development,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:Qa,isReservedAttr:Qa,isUnknownElement:Qa,getTagNamespace:H,parsePlatformTagName:ge,mustUseProp:Qa,async:!0,_lifecycleHooks:ag},Bc=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/,
zg=new RegExp("[^"+Bc.source+".$_\\d]"),wi="__proto__"in{},Aa="undefined"!==typeof window,Ec="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,xi=Ec&&WXEnvironment.platform.toLowerCase(),Ba=Aa&&window.navigator.userAgent.toLowerCase(),ab=Ba&&/msie|trident/.test(Ba),yb=Ba&&0<Ba.indexOf("msie 9.0"),hd=Ba&&0<Ba.indexOf("edge/");Ba&&Ba.indexOf("android");var yi=Ba&&/iphone|ipad|ipod|ios/.test(Ba)||"ios"===xi;Ba&&/chrome\/\d+/.test(Ba);Ba&&/phantomjs/.test(Ba);var bg=Ba&&Ba.match(/firefox\/(\d+)/),
Ld={}.watch,Ue=!1;if(Aa)try{var cg={};Object.defineProperty(cg,"passive",{get:function(){Ue=!0}});window.addEventListener("test-passive",null,cg)}catch(f){}var Md,Db=function(){void 0===Md&&(Md=Aa||Ec||"undefined"===typeof global?!1:global.process&&"server"===global.process.env.VUE_ENV);return Md},$b=Aa&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__,Sb="undefined"!==typeof Symbol&&aa(Symbol)&&"undefined"!==typeof Reflect&&aa(Reflect.ownKeys);var Nd="undefined"!==typeof Set&&aa(Set)?Set:function(){function f(){this.set=
Object.create(null)}f.prototype.has=function(h){return!0===this.set[h]};f.prototype.add=function(h){this.set[h]=!0};f.prototype.clear=function(){this.set=Object.create(null)};return f}();var U=H,Fb=H,Od=H,lb=H,dg="undefined"!==typeof console,zi=/(?:^|[-_])(\w)/g,Ai=function(f){return f.replace(zi,function(h){return h.toUpperCase()}).replace(/[-_]/g,"")};U=function(f,h){var l=h?Od(h):"";ra.warnHandler?ra.warnHandler.call(null,f,h,l):dg&&!ra.silent&&console.error("[Vue warn]: "+f+l)};Fb=function(f,
h){dg&&!ra.silent&&console.warn("[Vue tip]: "+f+(h?Od(h):""))};lb=function(f,h){if(f.$root===f)return"\x3cRoot\x3e";var l="function"===typeof f&&null!=f.cid?f.options:f._isVue?f.$options||f.constructor.options:f;f=l.name||l._componentTag;l=l.__file;!f&&l&&(f=(f=l.match(/([^/\\]+)\.vue$/))&&f[1]);return(f?"\x3c"+Ai(f)+"\x3e":"\x3cAnonymous\x3e")+(l&&!1!==h?" at "+l:"")};Od=function(f){if(f._isVue&&f.$parent){for(var h=[],l=0;f;){if(0<h.length){var n=h[h.length-1];if(n.constructor===f.constructor){l++;
f=f.$parent;continue}else 0<l&&(h[h.length-1]=[n,l],l=0)}h.push(f);f=f.$parent}return"\n\nfound in\n\n"+h.map(function(r,v){if(0===v)var x="---\x3e ";else{x=" ";v=5+2*v;for(var z="";v;)1===v%2&&(z+=x),1<v&&(x+=x),v>>=1;x=z}return""+x+(Array.isArray(r)?lb(r[0])+"... ("+r[1]+" recursive calls)":lb(r))}).join("\n")}return"\n\n(found in "+lb(f)+")"};var Bi=0,Fa=function(){this.id=Bi++;this.subs=[]};Fa.prototype.addSub=function(f){this.subs.push(f)};Fa.prototype.removeSub=function(f){u(this.subs,f)};Fa.prototype.depend=
function(){Fa.target&&Fa.target.addDep(this)};Fa.prototype.notify=function(){var f=this.subs.slice();ra.async||f.sort(function(n,r){return n.id-r.id});for(var h=0,l=f.length;h<l;h++)f[h].update()};Fa.target=null;var Qb=[],Ea=function(f,h,l,n,r,v,x,z){this.tag=f;this.data=h;this.children=l;this.text=n;this.elm=r;this.ns=void 0;this.context=v;this.fnScopeId=this.fnOptions=this.fnContext=void 0;this.key=h&&h.key;this.componentOptions=x;this.parent=this.componentInstance=void 0;this.isStatic=this.raw=
!1;this.isRootInsert=!0;this.isOnce=this.isCloned=this.isComment=!1;this.asyncFactory=z;this.asyncMeta=void 0;this.isAsyncPlaceholder=!1},eg={child:{configurable:!0}};eg.child.get=function(){return this.componentInstance};Object.defineProperties(Ea.prototype,eg);var kb=function(f){void 0===f&&(f="");var h=new Ea;h.text=f;h.isComment=!0;return h},fg=Array.prototype,sc=Object.create(fg);"push pop shift unshift splice sort reverse".split(" ").forEach(function(f){var h=fg[f];Q(sc,f,function(){for(var l=
[],n=arguments.length;n--;)l[n]=arguments[n];n=h.apply(this,l);var r=this.__ob__;switch(f){case "push":case "unshift":var v=l;break;case "splice":v=l.slice(2)}v&&r.observeArray(v);r.dep.notify();return n})});var gg=Object.getOwnPropertyNames(sc),Ua=!0,Rb=function(f){this.value=f;this.dep=new Fa;this.vmCount=0;Q(f,"__ob__",this);if(Array.isArray(f)){if(wi)f.__proto__=sc;else for(var h=0,l=gg.length;h<l;h++){var n=gg[h];Q(f,n,sc[n])}this.observeArray(f)}else this.walk(f)};Rb.prototype.walk=function(f){for(var h=
Object.keys(f),l=0;l<h.length;l++)ta(f,h[l])};Rb.prototype.observeArray=function(f){for(var h=0,l=f.length;h<l;h++)Ta(f[h])};var Na=ra.optionMergeStrategies;Na.el=Na.propsData=function(f,h,l,n){l||U('option "'+n+'" can only be used during instance creation with the `new` keyword.');return Vd(f,h)};Na.data=function(f,h,l){return l?yc(f,h,l):h&&"function"!==typeof h?(U('The "data" option should be a function that returns a per-instance value in component definitions.',l),f):yc(f,h)};ag.forEach(function(f){Na[f]=
Ag});ac.forEach(function(f){Na[f+"s"]=Bg});Na.watch=function(f,h,l,n){f===Ld&&(f=void 0);h===Ld&&(h=void 0);if(!h)return Object.create(f||null);zc(n,h,l);if(!f)return h;l={};A(l,f);for(var r in h)f=l[r],n=h[r],f&&!Array.isArray(f)&&(f=[f]),l[r]=f?f.concat(n):Array.isArray(n)?n:[n];return l};Na.props=Na.methods=Na.inject=Na.computed=function(f,h,l,n){h&&application&&application.configuration&&application.configuration.development&&zc(n,h,l);if(!f)return h;l=Object.create(null);A(l,f);h&&A(l,h);return l};
Na.provide=yc;var Vd=function(f,h){return void 0===h?f:h},Gg=/^(String|Number|Boolean|Function|Symbol)$/,Pd=!1,Gc=[],Fc=!1;if("undefined"!==typeof Promise&&aa(Promise)&&!navigator.userAgent.match(/Nabu-Renderer/)){var Ci=Promise.resolve();var Ic=function(){Ci.then(Ub);yi&&setTimeout(H)};Pd=!0}else if(ab||"undefined"===typeof MutationObserver||!aa(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Ic="undefined"!==typeof setImmediate&&aa(setImmediate)?function(){setImmediate(Ub)}:
function(){setTimeout(Ub,0)};else{var tc=1,Di=new MutationObserver(Ub),hg=document.createTextNode(String(tc));Di.observe(hg,{characterData:!0});Ic=function(){tc=(tc+1)%2;hg.data=String(tc)};Pd=!0}var fb=Aa&&window.performance;if(fb&&fb.mark&&fb.measure&&fb.clearMarks&&fb.clearMeasures){var Ha=function(f){return fb.mark(f)};var Yb=function(f,h,l){fb.measure(f,h,l);fb.clearMarks(h);fb.clearMarks(l)}}var Ei=t("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,require"),
ig=function(f,h){U('Property or method "'+h+'" is not defined on the instance but referenced during render. Make sure that this property is reactive, either in the data option, or for class-based components, by initializing the property. See: https://vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.',f)},jg=function(f,h){U('Property "'+h+'" must be accessed with "$data.'+h+'" because properties starting with "$" or "_" are not proxied in the Vue instance to prevent conflicts with Vue internalsSee: https://vuejs.org/v2/api/#data',
f)},Qd="undefined"!==typeof Proxy&&aa(Proxy);navigator.userAgent.match(/Nabu-Renderer/)&&(Qd=!1);if(Qd){var Fi=t("stop,prevent,self,ctrl,shift,alt,meta,exact");ra.keyCodes=new Proxy(ra.keyCodes,{set:function(f,h,l){if(Fi(h))return U("Avoid overwriting built-in modifier in config.keyCodes: ."+h),!1;f[h]=l;return!0}})}var Gi={has:function(f,h){var l=h in f,n=Ei(h)||"string"===typeof h&&"_"===h.charAt(0)&&!(h in f.$data);l||n||(h in f.$data?jg(f,h):ig(f,h));return l||!n}},Hi={get:function(f,h){"string"!==
typeof h||h in f||(h in f.$data?jg(f,h):ig(f,h));return f[h]}};var Ii=function(f){if(Qd){var h=f.$options;f._renderProxy=new Proxy(f,h.render&&h.render._withStripped?Hi:Gi)}else f._renderProxy=f};var be=new Nd,ce=y(function(f){var h="\x26"===f.charAt(0);f=h?f.slice(1):f;var l="~"===f.charAt(0);f=l?f.slice(1):f;var n="!"===f.charAt(0);f=n?f.slice(1):f;return{name:f,once:l,capture:n,passive:h}});le(Oc.prototype);var Qc={init:function(f,h){if(f.componentInstance&&!f.componentInstance._isDestroyed&&f.data.keepAlive)Qc.prepatch(f,
f);else{var l={_isComponent:!0,_parentVnode:f,parent:nb};var n=f.data.inlineTemplate;b(n)&&(l.render=n.render,l.staticRenderFns=n.staticRenderFns);l=new f.componentOptions.Ctor(l);(f.componentInstance=l).$mount(h?f.elm:void 0,h)}},prepatch:function(f,h){var l=h.componentOptions;f=h.componentInstance=f.componentInstance;var n=l.propsData,r=l.listeners;l=l.children;Gb=!0;var v=h.data.scopedSlots,x=f.$scopedSlots;v=!!(v&&!v.$stable||x!==Oa&&!x.$stable||v&&f.$scopedSlots.$key!==v.$key);v=!!(l||f.$options._renderChildren||
v);f.$options._parentVnode=h;f.$vnode=h;f._vnode&&(f._vnode.parent=h);f.$options._renderChildren=l;f.$attrs=h.data.attrs||Oa;f.$listeners=r||Oa;if(n&&f.$options.props){Ua=!1;x=f._props;for(var z=f.$options._propKeys||[],D=0;D<z.length;D++){var E=z[D];x[E]=Dc(E,f.$options.props,n,f)}Ua=!0;f.$options.propsData=n}r=r||Oa;n=f.$options._parentListeners;f.$options._parentListeners=r;mb=f;Lc(r,n||{},se,te,ue,f);mb=void 0;v&&(f.$slots=Nc(l,h.context),f.$forceUpdate());Gb=!1},insert:function(f){var h=f.context,
l=f.componentInstance;l._isMounted||(l._isMounted=!0,Ra(l,"mounted"));f.data.keepAlive&&(h._isMounted?(l._inactive=!1,Wc.push(l)):Tc(l,!0))},destroy:function(f){var h=f.componentInstance;h._isDestroyed||(f.data.keepAlive?xe(h,!0):h.$destroy())}},oe=Object.keys(Qc),Zg=1,pe=2,Sc=null,mb,nb=null,Gb=!1,$a=[],Wc=[],Hb={},Zb={},Xc=!1,Vc=!1,wb=0,ze=0,Uc=Date.now;if(Aa&&!ab){var Rd=window.performance;Rd&&"function"===typeof Rd.now&&Uc()>document.createEvent("Event").timeStamp&&(Uc=function(){return Rd.now()})}var Ji=
0,Sa=function(f,h,l,n,r){this.vm=f;r&&(f._watcher=this);f._watchers.push(this);n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1;this.cb=l;this.id=++Ji;this.active=!0;this.dirty=this.lazy;this.deps=[];this.newDeps=[];this.depIds=new Nd;this.newDepIds=new Nd;this.expression=h.toString();"function"===typeof h?this.getter=h:(this.getter=Z(h),this.getter||(this.getter=H,U('Failed watching path: "'+h+'" Watcher only accepts simple dot-delimited paths. For full control, use a function instead.',
f)));this.value=this.lazy?void 0:this.get()};Sa.prototype.get=function(){S(this);var f=this.vm;try{var h=this.getter.call(f,f)}catch(l){if(this.user)Va(l,f,'getter for watcher "'+this.expression+'"');else throw l;}finally{this.deep&&Vb(h),la(),this.cleanupDeps()}return h};Sa.prototype.addDep=function(f){var h=f.id;this.newDepIds.has(h)||(this.newDepIds.add(h),this.newDeps.push(f),this.depIds.has(h)||f.addSub(this))};Sa.prototype.cleanupDeps=function(){for(var f=this.deps.length;f--;){var h=this.deps[f];
this.newDepIds.has(h.id)||h.removeSub(this)}f=this.depIds;this.depIds=this.newDepIds;this.newDepIds=f;this.newDepIds.clear();f=this.deps;this.deps=this.newDeps;this.newDeps=f;this.newDeps.length=0};Sa.prototype.update=function(){if(this.lazy)this.dirty=!0;else if(this.sync)this.run();else{var f=this.id;if(null==Hb[f]){Hb[f]=!0;if(Vc){for(f=$a.length-1;f>wb&&$a[f].id>this.id;)f--;$a.splice(f+1,0,this)}else $a.push(this);Xc||(Xc=!0,ra.async?Hc(ye):ye())}}};Sa.prototype.run=function(){if(this.active){var f=
this.get();if(f!==this.value||d(f)||this.deep){var h=this.value;this.value=f;if(this.user)try{this.cb.call(this.vm,f,h)}catch(l){Va(l,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,f,h)}}};Sa.prototype.evaluate=function(){this.value=this.get();this.dirty=!1};Sa.prototype.depend=function(){for(var f=this.deps.length;f--;)this.deps[f].depend()};Sa.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||u(this.vm._watchers,this);for(var f=this.deps.length;f--;)this.deps[f].removeSub(this);
this.active=!1}};var Wa={enumerable:!0,configurable:!0,get:H,set:H},eh={lazy:!0},Ki=0;(function(f){f.prototype._init=function(h){this._uid=Ki++;if(ra.performance&&Ha){var l="vue-perf-start:"+this._uid;var n="vue-perf-end:"+this._uid;Ha(l)}this._isVue=!0;if(h&&h._isComponent){var r=this.$options=Object.create(this.constructor.options),v=h._parentVnode;r.parent=h.parent;r._parentVnode=v;v=v.componentOptions;r.propsData=v.propsData;r._parentListeners=v.listeners;r._renderChildren=v.children;r._componentTag=
v.tag;h.render&&(r.render=h.render,r.staticRenderFns=h.staticRenderFns)}else this.$options=jb(Pc(this.constructor),h||{},this);Ii(this);this._self=this;h=this.$options;if((r=h.parent)&&!h.abstract){for(;r.$options.abstract&&r.$parent;)r=r.$parent;r.$children.push(this)}this.$root=(this.$parent=r)?r.$root:this;this.$children=[];this.$refs={};this._inactive=this._watcher=null;this._isBeingDestroyed=this._isDestroyed=this._isMounted=this._directInactive=!1;this._events=Object.create(null);this._hasHookEvent=
!1;if(h=this.$options._parentListeners)mb=this,Lc(h,{},se,te,ue,this),mb=void 0;$g(this);Ra(this,"beforeCreate");Ig(this);this._watchers=[];h=this.$options;h.props&&dh(this,h.props);if(h.methods){r=h.methods;v=this.$options.props;for(var x in r)"function"!==typeof r[x]&&U('Method "'+x+'" has type "'+typeof r[x]+'" in the component definition. Did you reference the function correctly?',this),v&&w(v,x)&&U('Method "'+x+'" has already been defined as a prop.',this),x in this&&K(x)&&U('Method "'+x+'" conflicts with an existing Vue instance method. Avoid defining component methods that start with _ or $.'),
this[x]="function"!==typeof r[x]?H:ui(r[x],this)}if(h.data){x=this.$options.data;if("function"===typeof x)a:{S();try{var z=x.call(this,this);break a}catch(I){Va(I,this,"data()");z={};break a}finally{la()}z=void 0}else z=x||{};x=this._data=z;g(x)||(x={},U("data functions should return an object:\nhttps://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function",this));z=Object.keys(x);r=this.$options.props;v=this.$options.methods;for(var D=z.length;D--;){var E=z[D];v&&w(v,E)&&U('Method "'+E+'" has already been defined as a data property.',
this);r&&w(r,E)||K(E)||Yc(this,"_data",E)}Ta(x,!0)}else Ta(this._data={},!0);h.computed&&Ae(this,h.computed);h.watch&&h.watch!==Ld&&Ee(this,h.watch);if(z=this.$options.provide)this._provided="function"===typeof z?z.call(this):z;Ra(this,"created");ra.performance&&Ha&&(this._name=lb(this,!1),Ha(n),Yb("vue "+this._name+" init",l,n));this.$options.el&&this.$mount(this.$options.el)}})(va);(function(f){var h={get:function(){return this._data}},l={get:function(){return this._props}};h.set=function(){U("Avoid replacing instance root $data. Use nested data properties instead.",
this)};l.set=function(){U("$props is readonly.",this)};Object.defineProperty(f.prototype,"$data",h);Object.defineProperty(f.prototype,"$props",l);f.prototype.$set=ea;f.prototype.$delete=sa;f.prototype.$watch=function(n,r,v){if(g(r))return Zc(this,n,r,v);v=v||{};v.user=!0;var x=new Sa(this,n,r,v);if(v.immediate)try{r.call(this,x.value)}catch(z){Va(z,this,'callback for immediate watcher "'+x.expression+'"')}return function(){x.teardown()}}})(va);(function(f){var h=/^hook:/;f.prototype.$on=function(l,
n){if(Array.isArray(l))for(var r=0,v=l.length;r<v;r++)this.$on(l[r],n);else(this._events[l]||(this._events[l]=[])).push(n),h.test(l)&&(this._hasHookEvent=!0);return this};f.prototype.$once=function(l,n){function r(){v.$off(l,r);n.apply(v,arguments)}var v=this;r.fn=n;v.$on(l,r);return v};f.prototype.$off=function(l,n){if(!arguments.length)return this._events=Object.create(null),this;if(Array.isArray(l)){for(var r=0,v=l.length;r<v;r++)this.$off(l[r],n);return this}r=this._events[l];if(!r)return this;
if(!n)return this._events[l]=null,this;for(var x=r.length;x--;)if(v=r[x],v===n||v.fn===n){r.splice(x,1);break}return this};f.prototype.$emit=function(l){var n=l.toLowerCase();n!==l&&this._events[n]&&Fb('Event "'+n+'" is emitted in component '+lb(this)+' but the handler is registered for "'+l+'". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "'+Za(l)+'" instead of "'+l+'".');if(n=this._events[l]){n=
1<n.length?C(n):n;for(var r=C(arguments,1),v='event handler for "'+l+'"',x=0,z=n.length;x<z;x++)Tb(n[x],this,r,this,v)}else if(this.$options&&this.$options.events&&this.$options.events[l]){r=[];for(x=1;x<arguments.length;x++)r.push(arguments[x]);this.$options.events[l].apply(this,r)}return this}})(va);(function(f){f.prototype._update=function(h,l){var n=this.$el,r=this._vnode,v=ve(this);this._vnode=h;this.$el=r?this.__patch__(r,h):this.__patch__(this.$el,h,l,!1);v();n&&(n.__vue__=null);this.$el&&
(this.$el.__vue__=this);this.$vnode&&this.$parent&&this.$vnode===this.$parent._vnode&&(this.$parent.$el=this.$el)};f.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()};f.prototype.$destroy=function(){if(!this._isBeingDestroyed){Ra(this,"beforeDestroy");this._isBeingDestroyed=!0;var h=this.$parent;!h||h._isBeingDestroyed||this.$options.abstract||u(h.$children,this);this._watcher&&this._watcher.teardown();for(h=this._watchers.length;h--;)this._watchers[h].teardown();this._data.__ob__&&
this._data.__ob__.vmCount--;this._isDestroyed=!0;this.__patch__(this._vnode,null);Ra(this,"destroyed");this.$off();this.$el&&(this.$el.__vue__=null);this.$vnode&&(this.$vnode.parent=null)}}})(va);(function(f){le(f.prototype);f.prototype.$nextTick=function(h){return Hc(h,this)};f.prototype._render=function(){var h=this.$options,l=h.render;if(h=h._parentVnode)this.$scopedSlots=Wb(h.data.scopedSlots,this.$slots,this.$scopedSlots);this.$vnode=h;try{Sc=this;var n=l.call(this._renderProxy,this.$createElement)}catch(r){if(Va(r,
this,"render"),this.$options.renderError)try{n=this.$options.renderError.call(this._renderProxy,this.$createElement,r)}catch(v){Va(v,this,"renderError"),n=this._vnode}else n=this._vnode}finally{Sc=null}Array.isArray(n)&&1===n.length&&(n=n[0]);n instanceof Ea||(Array.isArray(n)&&U("Multiple root nodes returned from render function. Render function should return a single root node.",this),n=kb());n.parent=h;return n}})(va);var kg=[String,RegExp,Array],Li={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:kg,
exclude:kg,max:[String,Number]},created:function(){this.cache=Object.create(null);this.keys=[]},destroyed:function(){for(var f in this.cache)$c(this.cache,f,this.keys)},mounted:function(){var f=this;this.$watch("include",function(h){Ge(f,function(l){return bc(h,l)})});this.$watch("exclude",function(h){Ge(f,function(l){return!bc(h,l)})})},render:function(){var f=this.$slots.default,h=re(f),l=h&&h.componentOptions;if(l){var n=Fe(l),r=this.include,v=this.exclude;if(r&&(!n||!bc(r,n))||v&&n&&bc(v,n))return h;
n=this.cache;r=this.keys;l=null==h.key?l.Ctor.cid+(l.tag?"::"+l.tag:""):h.key;n[l]?(h.componentInstance=n[l].componentInstance,u(r,l),r.push(l)):(n[l]=h,r.push(l),this.max&&r.length>parseInt(this.max)&&$c(n,r[0],r,this._vnode));h.data.keepAlive=!0}return h||f&&f[0]}}};(function(f){Object.defineProperty(f,"config",{get:function(){return ra},set:function(){U("Do not replace the Vue.config object, set individual fields instead.")}});f.util={initComputed:Ae,initWatch:Ee,warn:U,extend:A,mergeOptions:jb,
defineReactive:ta};f.set=ea;f.delete=sa;f.nextTick=Hc;f.observable=function(h){Ta(h);return h};f.options=Object.create(null);ac.forEach(function(h){f.options[h+"s"]=Object.create(null)});f.options._base=f;A(f.options.components,Li);fh(f);gh(f);hh(f);kh(f)})(va);Object.defineProperty(va.prototype,"$isServer",{get:Db});Object.defineProperty(va.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}});Object.defineProperty(va,"FunctionalRenderContext",{value:Oc});va.version=
"2.6.10";var Mi=t("style,class"),Ni=t("input,textarea,option,select,progress"),lg=function(f,h,l){return"value"===l&&Ni(f)&&"button"!==h||"selected"===l&&"option"===f||"checked"===l&&"input"===f||"muted"===l&&"video"===f},Ne=t("contenteditable,draggable,spellcheck"),oh=t("events,caret,typing,plaintext-only"),nh=t("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),
id=function(f){return":"===f.charAt(5)&&"xlink"===f.slice(0,5)},Me=function(f){return id(f)?f.slice(6,f.length):""},Oi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Pi=t("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),
cd=t("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Sd=function(f){return Pi(f)||cd(f)},uc=Object.create(null),fd=t("text,number,password,search,email,tel,url"),Qi=Object.freeze({createElement:function(f,h){var l=document.createElement(f);if("select"!==f)return l;h.data&&h.data.attrs&&void 0!==h.data.attrs.multiple&&l.setAttribute("multiple",
"multiple");return l},createElementNS:function(f,h){return document.createElementNS(Oi[f],h)},createTextNode:function(f){return document.createTextNode(ed(f))},createComment:function(f){return document.createComment(f)},insertBefore:function(f,h,l){f.insertBefore(h,l)},removeChild:function(f,h){f.removeChild(h)},appendChild:function(f,h){f.appendChild(h)},parentNode:function(f){return f.parentNode},nextSibling:function(f){return f.nextSibling},tagName:function(f){return f.tagName},setTextContent:function(f,
h){f.textContent=ed(h)},setStyleScope:function(f,h){f.setAttribute(h,"")}}),pb=new Ea("",{},[]),Ob=["create","activate","update","remove","destroy"],Ri={create:gd,update:gd,destroy:function(f){gd(f,pb)}},mh=Object.create(null),Si=[{create:function(f,h){xb(h)},update:function(f,h){f.data.ref!==h.data.ref&&(xb(f,!0),xb(h))},destroy:function(f){xb(f,!0)}},Ri],Ti={create:Ke,update:Ke},Ui={create:Pe,update:Pe},ph=/[\w).+\-_$\]]/,Lb,ec,Mb,Ia,fc,md,vc,Nb,th=Pd&&!(bg&&53>=Number(bg[1])),Vi={create:Ve,update:Ve},
gc,Wi={create:We,update:We},Ye=y(function(f){var h={},l=/:(.+)/;f.split(/;(?![^(]*\))/g).forEach(function(n){n&&(n=n.split(l),1<n.length&&(h[n[0].trim()]=n[1].trim()))});return h}),Xi=/^--/,mg=/\s*!important$/,$e=function(f,h,l){if(Xi.test(h))f.style.setProperty(h,l);else if(mg.test(l))f.style.setProperty(Za(h),l.replace(mg,""),"important");else if(h=Yi(h),Array.isArray(l))for(var n=0,r=l.length;n<r;n++)f.style[h]=l[n];else f.style[h]=l},ng=["Webkit","Moz","ms"],wc,Yi=y(function(f){wc=wc||document.createElement("div").style;
f=Ga(f);if("filter"!==f&&f in wc)return f;f=f.charAt(0).toUpperCase()+f.slice(1);for(var h=0;h<ng.length;h++){var l=ng[h]+f;if(l in wc)return l}}),Zi={create:Ze,update:Ze},bf=/\s+/,ef=y(function(f){return{enterClass:f+"-enter",enterToClass:f+"-enter-to",enterActiveClass:f+"-enter-active",leaveClass:f+"-leave",leaveToClass:f+"-leave-to",leaveActiveClass:f+"-leave-active"}}),og=Aa&&!yb,ic="transition",hc="transitionend",od="animation",kf="animationend";og&&(void 0===window.ontransitionend&&void 0!==
window.onwebkittransitionend&&(ic="WebkitTransition",hc="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(od="WebkitAnimation",kf="webkitAnimationEnd"));var gf=Aa?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(f){return f()},uh=/\b(transform|all)(,|$)/,$i=[Ti,Ui,Vi,Wi,Zi,Aa?{create:of,activate:of,remove:function(f,h){!0!==f.data.show?nf(f,h):h()}}:{}].concat(Si),aj=function(f){function h(G,J){function R(){0===
--R.listeners&&l(G)}R.listeners=J;return R}function l(G){var J=T.parentNode(G);b(J)&&T.removeChild(J,G)}function n(G,J){return!J&&!G.ns&&!(ra.ignoredElements.length&&ra.ignoredElements.some(function(R){return"[object RegExp]"===Cb.call(R)?R.test(G.tag):R===G.tag}))&&ra.isUnknownElement(G.tag)}function r(G,J,R,ba,ha,ka,na){b(G.elm)&&b(ka)&&(G=ka[na]=ya(G));G.isRootInsert=!ha;var X;a:{ha=G;ka=ha.data;if(b(ka)&&(na=b(ha.componentInstance)&&ka.keepAlive,b(ka=ka.hook)&&b(ka=ka.init)&&ka(ha,!1),b(ha.componentInstance))){v(ha,
J);x(R,ha.elm,ba);if(!0===na){for(ka=ha;ka.componentInstance;)if(ka=ka.componentInstance._vnode,b(X=ka.data)&&b(X=X.transition)){for(X=0;X<da.activate.length;++X)da.activate[X](pb,ka);J.push(ka);break}x(R,ha.elm,ba)}X=!0;break a}X=void 0}X||(X=G.data,ha=G.children,ka=G.tag,b(ka)?(X&&X.pre&&qa++,n(G,qa)&&U("Unknown custom element: \x3c"+ka+'\x3e - did you register the component correctly? For recursive components, make sure to provide the "name" option.',G.context),G.elm=G.ns?T.createElementNS(G.ns,
ka):T.createElement(ka,G),I(G),z(G,ha,J),b(X)&&E(G,J),x(R,G.elm,ba),X&&X.pre&&qa--):(G.elm=!0===G.isComment?T.createComment(G.text):T.createTextNode(G.text),x(R,G.elm,ba)))}function v(G,J){b(G.data.pendingInsert)&&(J.push.apply(J,G.data.pendingInsert),G.data.pendingInsert=null);G.elm=G.componentInstance.$el;D(G)?(E(G,J),I(G)):(xb(G),J.push(G))}function x(G,J,R){b(G)&&(b(R)?T.parentNode(R)===G&&T.insertBefore(G,J,R):T.appendChild(G,J))}function z(G,J,R){if(Array.isArray(J)){ia(J);for(var ba=0;ba<J.length;++ba)r(J[ba],
R,G.elm,null,!0,J,ba)}else c(G.text)&&T.appendChild(G.elm,T.createTextNode(String(G.text)))}function D(G){for(;G.componentInstance;)G=G.componentInstance._vnode;return b(G.tag)}function E(G,J){for(var R=0;R<da.create.length;++R)da.create[R](pb,G);Y=G.data.hook;b(Y)&&(b(Y.create)&&Y.create(pb,G),b(Y.insert)&&J.push(G))}function I(G){var J;if(b(J=G.fnScopeId))T.setStyleScope(G.elm,J);else for(var R=G;R;)b(J=R.context)&&b(J=J.$options._scopeId)&&T.setStyleScope(G.elm,J),R=R.parent;b(J=nb)&&J!==G.context&&
J!==G.fnContext&&b(J=J.$options._scopeId)&&T.setStyleScope(G.elm,J)}function N(G){var J,R=G.data;if(b(R))for(b(J=R.hook)&&b(J=J.destroy)&&J(G),J=0;J<da.destroy.length;++J)da.destroy[J](G);if(b(G.children))for(J=0;J<G.children.length;++J)N(G.children[J])}function W(G,J,R,ba){for(;R<=ba;++R)G=J[R],b(G)&&(b(G.tag)?(fa(G),N(G)):l(G.elm))}function fa(G,J){if(b(J)||b(G.data)){var R,ba=da.remove.length+1;b(J)?J.listeners+=ba:J=h(G.elm,ba);b(R=G.componentInstance)&&b(R=R._vnode)&&b(R.data)&&fa(R,J);for(R=
0;R<da.remove.length;++R)da.remove[R](G,J);b(R=G.data.hook)&&b(R=R.remove)?R(G,J):J()}else l(G.elm)}function ia(G){for(var J={},R=0;R<G.length;R++){var ba=G[R],ha=ba.key;b(ha)&&(J[ha]?U("Duplicate keys detected: '"+ha+"'. This may cause an update error.",ba.context):J[ha]=!0)}}function L(G,J,R,ba,ha,ka){if(G!==J)if(b(J.elm)&&b(ba)&&(J=ba[ha]=ya(J)),ba=J.elm=G.elm,!0===G.isAsyncPlaceholder)b(J.asyncFactory.resolved)?ma(G.elm,J,R):J.isAsyncPlaceholder=!0;else if(!0!==J.isStatic||!0!==G.isStatic||J.key!==
G.key||!0!==J.isCloned&&!0!==J.isOnce){var na;ha=J.data;b(ha)&&b(na=ha.hook)&&b(na=na.prepatch)&&na(G,J);var X=G.children,oa=J.children;if(b(ha)&&D(J)){for(na=0;na<da.update.length;++na)da.update[na](G,J);b(na=ha.hook)&&b(na=na.update)&&na(G,J)}if(a(J.text))if(b(X)&&b(oa)){if(X!==oa){var Xa=0,Ca=0,gb=X.length-1,Ka=X[0],Ya=X[gb],Da=oa.length-1,La=oa[0],Bb=oa[Da],Ma;ka=!ka;for(ia(oa);Xa<=gb&&Ca<=Da;)if(a(Ka))Ka=X[++Xa];else if(a(Ya))Ya=X[--gb];else if(ob(Ka,La))L(Ka,La,R,oa,Ca),Ka=X[++Xa],La=oa[++Ca];
else if(ob(Ya,Bb))L(Ya,Bb,R,oa,Da),Ya=X[--gb],Bb=oa[--Da];else if(ob(Ka,Bb))L(Ka,Bb,R,oa,Da),ka&&T.insertBefore(ba,Ka.elm,T.nextSibling(Ya.elm)),Ka=X[++Xa],Bb=oa[--Da];else{if(ob(Ya,La))L(Ya,La,R,oa,Ca),ka&&T.insertBefore(ba,Ya.elm,Ka.elm),Ya=X[--gb];else{if(a(Pb)){var sb=X;var Td=gb,tb={};for(Ma=Xa;Ma<=Td;++Ma){var Pb=sb[Ma].key;b(Pb)&&(tb[Pb]=Ma)}Pb=tb}if(b(La.key))Ma=Pb[La.key];else a:{Ma=La;sb=X;Td=gb;for(tb=Xa;tb<Td;tb++){var pg=sb[tb];if(b(pg)&&ob(Ma,pg)){Ma=tb;break a}}Ma=void 0}a(Ma)?r(La,
R,ba,Ka.elm,!1,oa,Ca):(sb=X[Ma],ob(sb,La)?(L(sb,La,R,oa,Ca),X[Ma]=void 0,ka&&T.insertBefore(ba,sb.elm,Ka.elm)):r(La,R,ba,Ka.elm,!1,oa,Ca))}La=oa[++Ca]}if(Xa>gb)for(X=a(oa[Da+1])?null:oa[Da+1].elm;Ca<=Da;++Ca)r(oa[Ca],R,ba,X,!1,oa,Ca);else Ca>Da&&W(ba,X,Xa,gb)}}else if(b(oa))for(ia(oa),b(G.text)&&T.setTextContent(ba,""),Da=0,Ca=oa.length-1;Da<=Ca;++Da)r(oa[Da],R,ba,null,!1,oa,Da);else b(X)?W(ba,X,0,X.length-1):b(G.text)&&T.setTextContent(ba,"");else G.text!==J.text&&T.setTextContent(ba,J.text);b(ha)&&
b(na=ha.hook)&&b(na=na.postpatch)&&na(G,J)}else J.componentInstance=G.componentInstance}function V(G,J,R){if(!0===R&&b(G.parent))G.parent.data.pendingInsert=J;else for(G=0;G<J.length;++G)J[G].data.hook.insert(J[G])}function ma(G,J,R,ba){var ha,ka=J.tag,na=J.data,X=J.children;ba=ba||na&&na.pre;J.elm=G;if(!0===J.isComment&&b(J.asyncFactory))return J.isAsyncPlaceholder=!0;var oa=ba;oa=b(J.tag)?0===J.tag.indexOf("vue-component")||!n(J,oa)&&J.tag.toLowerCase()===(G.tagName&&G.tagName.toLowerCase()):G.nodeType===
(J.isComment?8:3);if(!oa)return!1;if(b(na)&&(b(ha=na.hook)&&b(ha=ha.init)&&ha(J,!0),b(ha=J.componentInstance)))return v(J,R),!0;if(b(ka)){if(b(X))if(G.hasChildNodes())if(b(ha=na)&&b(ha=ha.domProps)&&b(ha=ha.innerHTML)){if(ha!==G.innerHTML)return"undefined"===typeof console||za||(za=!0,console.warn("Parent: ",G),console.warn("server innerHTML: ",ha),console.warn("client innerHTML: ",G.innerHTML)),!1}else{ha=!0;ka=G.firstChild;for(oa=0;oa<X.length;oa++){if(!ka||!ma(ka,X[oa],R,ba)){ha=!1;break}ka=ka.nextSibling}if(!ha||
ka)return"undefined"===typeof console||za||(za=!0,console.warn("Parent: ",G),console.warn("Mismatching childNodes vs. VNodes: ",G.childNodes,X)),!1}else z(J,X,R);if(b(na)){G=!1;for(var Xa in na)if(!Ja(Xa)){G=!0;E(J,R);break}!G&&na["class"]&&Vb(na["class"])}}else G.data!==J.text&&(G.data=J.text);return!0}var Y,da={},ja=f.modules,T=f.nodeOps;for(Y=0;Y<Ob.length;++Y)for(da[Ob[Y]]=[],f=0;f<ja.length;++f)b(ja[f][Ob[Y]])&&da[Ob[Y]].push(ja[f][Ob[Y]]);var qa=0,za=!1,Ja=t("attrs,class,staticClass,staticStyle,key");
return function(G,J,R,ba){if(a(J))b(G)&&N(G);else{var ha=!1,ka=[];if(a(G))ha=!0,r(J,ka);else{var na=b(G.nodeType);if(!na&&ob(G,J))L(G,J,ka,null,null,ba);else{if(na){1===G.nodeType&&G.hasAttribute("data-server-rendered")&&(G.removeAttribute("data-server-rendered"),R=!0);if(!0===R){if(ma(G,J,ka))return V(J,ka,!0),G;U("The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside \x3cp\x3e, or missing \x3ctbody\x3e. Bailing hydration and performing full client-side render.")}G=
new Ea(T.tagName(G).toLowerCase(),{},[],void 0,G)}ba=G.elm;R=T.parentNode(ba);r(J,ka,ba._leaveCb?null:R,T.nextSibling(ba));if(b(J.parent))for(ba=J.parent,na=D(J);ba;){for(var X=0;X<da.destroy.length;++X)da.destroy[X](ba);ba.elm=J.elm;if(na){for(X=0;X<da.create.length;++X)da.create[X](pb,ba);X=ba.data.hook.insert;if(X.merged)for(var oa=1;oa<X.fns.length;oa++)X.fns[oa]()}else xb(ba);ba=ba.parent}b(R)?W(R,[G],0,0):b(G.tag)&&N(G)}}V(J,ka,ha);return J.elm}}}({nodeOps:Qi,modules:$i});yb&&document.addEventListener("selectionchange",
function(){var f=document.activeElement;f&&f.vmodel&&rd(f,"input")});var qg={inserted:function(f,h,l,n){if("select"===l.tag)n.elm&&!n.elm._vOptions?hb(l,"postpatch",function(){qg.componentUpdated(f,h,l)}):pf(f,h,l.context),f._vOptions=[].map.call(f.options,jc);else if("textarea"===l.tag||fd(f.type))f._vModifiers=h.modifiers,h.modifiers.lazy||(f.addEventListener("compositionstart",vh),f.addEventListener("compositionend",sf),f.addEventListener("change",sf),yb&&(f.vmodel=!0))},componentUpdated:function(f,
h,l){if("select"===l.tag){pf(f,h,l.context);var n=f._vOptions,r=f._vOptions=[].map.call(f.options,jc);r.some(function(v,x){return!ca(v,n[x])})&&(f.multiple?h.value.some(function(v){return rf(v,r)}):h.value!==h.oldValue&&rf(h.value,r))&&rd(f,"change")}}},bj={model:qg,show:{bind:function(f,h,l){h=h.value;l=sd(l);var n=l.data&&l.data.transition,r=f.__vOriginalDisplay="none"===f.style.display?"":f.style.display;h&&n?(l.data.show=!0,pd(l,function(){f.style.display=r})):f.style.display=h?r:"none"},update:function(f,
h,l){var n=h.value;!n!==!h.oldValue&&(l=sd(l),l.data&&l.data.transition?(l.data.show=!0,n?pd(l,function(){f.style.display=f.__vOriginalDisplay}):nf(l,function(){f.style.display="none"})):f.style.display=n?f.__vOriginalDisplay:"none")},unbind:function(f,h,l,n,r){r||(f.style.display=f.__vOriginalDisplay)}}},rg={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,
appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]},cj=function(f){return f.tag||f.isComment&&f.asyncFactory},dj=function(f){return"show"===f.name},ej={name:"transition",props:rg,abstract:!0,render:function(f){var h=this,l=this.$slots.default;if(l&&(l=l.filter(cj),l.length)){1<l.length&&U("\x3ctransition\x3e can only be used on a single element. Use \x3ctransition-group\x3e for lists.",this.$parent);var n=this.mode;n&&"in-out"!==n&&"out-in"!==n&&U("invalid \x3ctransition\x3e mode: "+
n,this.$parent);l=l[0];if(wh(this.$vnode))return l;var r=td(l);if(!r)return l;if(this._leaving)return uf(f,l);var v="__transition-"+this._uid+"-";r.key=null==r.key?r.isComment?v+"comment":v+r.tag:c(r.key)?0===String(r.key).indexOf(v)?r.key:v+r.key:r.key;v=(r.data||(r.data={})).transition=tf(this);var x=this._vnode,z=td(x);r.data.directives&&r.data.directives.some(dj)&&(r.data.show=!0);if(!(!z||!z.data||z.key===r.key&&z.tag===r.tag||z.isComment&&z.asyncFactory||z.componentInstance&&z.componentInstance._vnode.isComment)){z=
z.data.transition=A({},v);if("out-in"===n)return this._leaving=!0,hb(z,"afterLeave",function(){h._leaving=!1;h.$forceUpdate()}),uf(f,l);if("in-out"===n){if(r.isComment&&r.asyncFactory)return x;var D;f=function(){D()};hb(v,"afterEnter",f);hb(v,"enterCancelled",f);hb(z,"delayLeave",function(E){D=E})}}return l}}},sg=A({tag:String,moveClass:String},rg);delete sg.mode;var fj={Transition:ej,TransitionGroup:{props:sg,beforeMount:function(){var f=this,h=this._update;this._update=function(l,n){var r=ve(f);
f.__patch__(f._vnode,f.kept,!1,!0);f._vnode=f.kept;r();h.call(f,l,n)}},render:function(f){for(var h=this.tag||this.$vnode.data.tag||"span",l=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],v=this.children=[],x=tf(this),z=0;z<r.length;z++){var D=r[z];if(D.tag)if(null!=D.key&&0!==String(D.key).indexOf("__vlist"))v.push(D),l[D.key]=D,(D.data||(D.data={})).transition=x;else{var E=D.componentOptions;U("\x3ctransition-group\x3e children must be keyed: \x3c"+(E?E.Ctor.options.name||
E.tag||"":D.tag)+"\x3e")}}if(n){r=[];z=[];for(D=0;D<n.length;D++)E=n[D],E.data.transition=x,E.data.pos=E.elm.getBoundingClientRect(),l[E.key]?r.push(E):z.push(E);this.kept=f(h,null,r);this.removed=z}return f(h,null,v)},updated:function(){var f=this.prevChildren,h=this.moveClass||(this.name||"v")+"-move";f.length&&this.hasMove(f[0].elm,h)&&(f.forEach(xh),f.forEach(yh),f.forEach(zh),this._reflow=document.body.offsetHeight,f.forEach(function(l){if(l.data.moved){var n=l.elm;l=n.style;rb(n,h);l.transform=
l.WebkitTransform=l.transitionDuration="";n.addEventListener(hc,n._moveCb=function x(v){if(!v||v.target===n)if(!v||/transform$/.test(v.propertyName))n.removeEventListener(hc,x),n._moveCb=null,cb(n,h)})}}))},methods:{hasMove:function(f,h){if(!og)return!1;if(this._hasMove)return this._hasMove;var l=f.cloneNode();f._transitionClasses&&f._transitionClasses.forEach(function(n){cf(l,n)});af(l,h);l.style.display="none";this.$el.appendChild(l);f=jf(l);this.$el.removeChild(l);return this._hasMove=f.hasTransform}}}};
va.config.mustUseProp=lg;va.config.isReservedTag=Sd;va.config.isReservedAttr=Mi;va.config.getTagNamespace=Ie;va.config.isUnknownElement=function(f){if(!Aa)return!0;if(Sd(f))return!1;f=f.toLowerCase();if(null!=uc[f])return uc[f];var h=document.createElement(f);return-1<f.indexOf("-")?uc[f]=h.constructor===window.HTMLUnknownElement||h.constructor===window.HTMLElement:uc[f]=/HTMLUnknownElement/.test(h.toString())};A(va.options.directives,bj);A(va.options.components,fj);va.prototype.__patch__=Aa?aj:H;
va.prototype.$mount=function(f,h){f=f&&Aa?dd(f):void 0;return ah(this,f,h)};Aa&&setTimeout(function(){if(ra.devtools)if($b)$b.emit("init",va);else console[console.info?"info":"log"]("Download the Vue Devtools extension for a better development experience:\nhttps://github.com/vuejs/vue-devtools");if(!1!==ra.productionTip&&"undefined"!==typeof console)console[console.info?"info":"log"]("You are running Vue in development mode.\nMake sure to turn on production mode when deploying for production.\nSee more tips at https://vuejs.org/guide/deployment.html")},
0);var Bh=/\{\{((?:.|\r?\n)+?)\}\}/g,tg=/[-.*+?$^{}()|[\]\/\\]/g,Ah=y(function(f){var h=f[0].replace(tg,"\\$\x26");f=f[1].replace(tg,"\\$\x26");return new RegExp(h+"((?:.|\\n)+?)"+f,"g")}),xc,gj=t("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),hj=t("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),Kh=t("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),
Jh=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Ih=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,ug="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+Bc.source+"]*",vg="((?:"+ug+"\\:)?"+ug+")",vf=new RegExp("^\x3c"+vg),Hh=/^\s*(\/?)>/,Bf=new RegExp("^\x3c\\/"+vg+"[^\x3e]*\x3e"),Lh=/^<!DOCTYPE [^>]+>/i,zf=/^<!\--/,Af=/^<!\[/,wf=t("script,style,textarea",!0),xf={},Fh={"\x26lt;":"\x3c","\x26gt;":"\x3e","\x26quot;":'"',"\x26amp;":"\x26",
"\x26#10;":"\n","\x26#9;":"\t","\x26#39;":"'"},Eh=/&(?:lt|gt|quot|amp|#39);/g,Dh=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,ij=t("pre,textarea",!0),yf=function(f,h){return f&&ij(f)&&"\n"===h[0]},Cd=/^@|^v-on:/,mc=/^v-|^@|^:/,$h=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Gf=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,ai=/^\(|\)$/g,nc=/^\[.*\]$/,Zh=/:(.*)$/,Ff=/^:|^\.|^v-bind:/,Ef=/\.[^.\]]+(?=[^\]]*$)/g,Dd=/^v-slot(:|$)|^#/,Vh=/[\r\n]/,Wh=/\s+/g,Ph=/[\s"'<>\/=]/,Uh=y(function(f){xc=xc||document.createElement("div");xc.innerHTML=
f;return xc.textContent}),ua,Bd,zd,Ad,wd,vd,xd,Cf,yd,bi=/^xmlns:NS\d+/,ci=/^NS\d+:/,wg=[{staticKeys:["staticClass"],transformNode:function(f,h){var l=h.warn||cc,n=xa(f,"class");n&&kc(n,h.delimiters)&&l('class\x3d"'+n+'": Interpolation inside attributes has been removed. Use v-bind or the colon shorthand instead. For example, instead of \x3cdiv class\x3d"{{ val }}"\x3e, use \x3cdiv :class\x3d"val"\x3e.',f.rawAttrsMap["class"]);n&&(f.staticClass=JSON.stringify(n));if(h=Pa(f,"class",!1))f.classBinding=
h},genData:function(f){var h="";f.staticClass&&(h+="staticClass:"+f.staticClass+",");f.classBinding&&(h+="class:"+f.classBinding+",");return h}},{staticKeys:["staticStyle"],transformNode:function(f,h){var l=h.warn||cc,n=xa(f,"style");n&&(kc(n,h.delimiters)&&l('style\x3d"'+n+'": Interpolation inside attributes has been removed. Use v-bind or the colon shorthand instead. For example, instead of \x3cdiv style\x3d"{{ val }}"\x3e, use \x3cdiv :style\x3d"val"\x3e.',f.rawAttrsMap.style),f.staticStyle=JSON.stringify(Ye(n)));
if(h=Pa(f,"style",!1))f.styleBinding=h},genData:function(f){var h="";f.staticStyle&&(h+="staticStyle:"+f.staticStyle+",");f.styleBinding&&(h+="style:("+f.styleBinding+"),");return h}},{preTransformNode:function(f,h){if("input"===f.tag){var l=f.attrsMap;if(l["v-model"]){if(l[":type"]||l["v-bind:type"])var n=Pa(f,"type");l.type||n||!l["v-bind"]||(n="("+l["v-bind"]+").type");if(n){var r=(l=xa(f,"v-if",!0))?"\x26\x26("+l+")":"",v=null!=xa(f,"v-else",!0),x=xa(f,"v-else-if",!0),z=Ed(f);Df(z);ld(z,"type",
"checkbox");lc(z,h);z.processed=!0;z.if="("+n+")\x3d\x3d\x3d'checkbox'"+r;zb(z,{exp:z.if,block:z});var D=Ed(f);xa(D,"v-for",!0);ld(D,"type","radio");lc(D,h);zb(z,{exp:"("+n+")\x3d\x3d\x3d'radio'"+r,block:D});f=Ed(f);xa(f,"v-for",!0);ld(f,":type",n);lc(f,h);zb(z,{exp:l,block:f});v?z.else=!0:x&&(z.elseif=x);return z}}}}}],jj={expectHTML:!0,modules:wg,directives:{model:function(f,h,l){vc=l;l=h.value;var n=h.modifiers;h=f.tag;var r=f.attrsMap.type;"input"===h&&"file"===r&&vc("\x3c"+f.tag+' v-model\x3d"'+
l+'" type\x3d"file"\x3e:\nFile inputs are read only. Use a v-on:change listener instead.',f.rawAttrsMap["v-model"]);if(f.component)return Re(f,l,n),!1;if("select"===h)h='var $$selectedVal \x3d Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val \x3d "_value" in o ? o._value : o.value;return '+((n&&n.number?"_n(val)":"val")+"});"),h=h+" "+ib(l,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),bb(f,"change",h,null,!0);else if("input"===
h&&"checkbox"===r){h=n&&n.number;n=Pa(f,"value")||"null";r=Pa(f,"true-value")||"true";var v=Pa(f,"false-value")||"false";qb(f,"checked","Array.isArray("+l+")?_i("+l+","+n+")\x3e-1"+("true"===r?":("+l+")":":_q("+l+","+r+")"));bb(f,"change","var $$a\x3d"+l+",$$el\x3d$event.target,$$c\x3d$$el.checked?("+r+"):("+v+");if(Array.isArray($$a)){var $$v\x3d"+(h?"_n("+n+")":n)+",$$i\x3d_i($$a,$$v);if($$el.checked){$$i\x3c0\x26\x26("+ib(l,"$$a.concat([$$v])")+")}else{$$i\x3e-1\x26\x26("+ib(l,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+
")}}else{"+ib(l,"$$c")+"}",null,!0)}else if("input"===h&&"radio"===r)h=n&&n.number,n=Pa(f,"value")||"null",n=h?"_n("+n+")":n,qb(f,"checked","_q("+l+","+n+")"),bb(f,"change",ib(l,n),null,!0);else if("input"===h||"textarea"===h){h=f.attrsMap.type;r=f.attrsMap["v-bind:value"]||f.attrsMap[":value"];v=f.attrsMap["v-bind:type"]||f.attrsMap[":type"];r&&!v&&(v=f.attrsMap["v-bind:value"]?"v-bind:value":":value",vc(v+'\x3d"'+r+'" conflicts with v-model on the same element because the latter already expands to a value binding internally',
f.rawAttrsMap[v]));r=n||{};var x=r.lazy;n=r.number;r=r.trim;v=!x&&"range"!==h;h=x?"change":"range"===h?"__r":"input";x="$event.target.value";r&&(x="$event.target.value.trim()");n&&(x="_n("+x+")");x=ib(l,x);v&&(x="if($event.target.composing)return;"+x);qb(f,"value","("+l+")");bb(f,h,x,null,!0);(r||n)&&bb(f,"blur","$forceUpdate()")}else if(ra.isReservedTag(h))vc("\x3c"+f.tag+' v-model\x3d"'+l+"\"\x3e: v-model is not supported on this element type. If you are working with contenteditable, it's recommended to wrap a library dedicated for that purpose inside a custom component.",
f.rawAttrsMap["v-model"]);else return Re(f,l,n),!1;return!0},text:function(f,h){h.value&&qb(f,"textContent","_s("+h.value+")",h)},html:function(f,h){h.value&&qb(f,"innerHTML","_s("+h.value+")",h)}},isPreTag:function(f){return"pre"===f},isUnaryTag:gj,mustUseProp:lg,canBeLeftOpenTag:hj,isReservedTag:Sd,getTagNamespace:Ie,staticKeys:function(f){return f.reduce(function(h,l){return h.concat(l.staticKeys||[])},[]).join(",")}(wg)},If,Gd,kj=y(function(f){return t("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+
(f?","+f:""))}),di=/^([\w$_]+|\([^)]*?\))\s*=>|^function\s*(?:[\w$]+)?\s*\(/,ei=/\([^)]*?\);*$/,Lf=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Nf={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,"delete":[8,46]},gi={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],"delete":["Backspace","Delete","Del"]},db=function(f){return"if("+
f+")return null;"},Mf={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:db("$event.target !\x3d\x3d $event.currentTarget"),ctrl:db("!$event.ctrlKey"),shift:db("!$event.shiftKey"),alt:db("!$event.altKey"),meta:db("!$event.metaKey"),left:db("'button' in $event \x26\x26 $event.button !\x3d\x3d 0"),middle:db("'button' in $event \x26\x26 $event.button !\x3d\x3d 1"),right:db("'button' in $event \x26\x26 $event.button !\x3d\x3d 2")},lj={on:function(f,h){h.modifiers&&U("v-on without argument does not support modifiers.");
f.wrapListeners=function(l){return"_g("+l+","+h.value+")"}},bind:function(f,h){f.wrapData=function(l){return"_b("+l+",'"+f.tag+"',"+h.value+","+(h.modifiers&&h.modifiers.prop?"true":"false")+(h.modifiers&&h.modifiers.sync?",true":"")+")"}},cloak:H},hi=function(f){this.options=f;this.warn=f.warn||cc;this.transforms=Jb(f.modules,"transformCode");this.dataGenFns=Jb(f.modules,"genData");this.directives=A(A({},lj),f.directives);var h=f.isReservedTag||Qa;this.maybeComponent=function(l){return!!l.component||
!h(l.tag)};this.onceId=0;this.staticRenderFns=[];this.pre=!1},qi=new RegExp("\\b"+"do if for let new try var case else with await break catch class const super throw while yield delete export import return switch default extends finally continue debugger function arguments".split(" ").join("\\b|\\b")+"\\b"),pi=RegExp("\\bdelete\\s*\\([^\\)]*\\)|\\btypeof\\s*\\([^\\)]*\\)|\\bvoid\\s*\\([^\\)]*\\)"),Yf=/'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"|`(?:[^`\\]|\\.)*\$\{|\}(?:[^`\\]|\\.)*`|`(?:[^`\\]|\\.)*`/g,
xg=function(f){return function(h){function l(n,r){var v=Object.create(h),x=[],z=[],D=function(N,W,fa){(fa?z:x).push(N)};if(r){if(r.outputSourceRange){var E=n.match(/^\s*/)[0].length;D=function(N,W,fa){N={msg:N};W&&(null!=W.start&&(N.start=W.start+E),null!=W.end&&(N.end=W.end+E));(fa?z:x).push(N)}}r.modules&&(v.modules=(h.modules||[]).concat(r.modules));r.directives&&(v.directives=A(Object.create(h.directives||null),r.directives));for(var I in r)"modules"!==I&&"directives"!==I&&(v[I]=r[I])}v.warn=
D;n=f(n.trim(),v);oi(n.ast,D);n.errors=x;n.tips=z;return n}return{compile:l,compileToFunctions:ri(l)}}}(function(f,h){f=Mh(f.trim(),h);!1!==h.optimize&&f&&(If=kj(h.staticKeys||""),Gd=h.isReservedTag||Qa,Fd(f),Hd(f,!1));h=Of(f,h);return{ast:f,render:h.render,staticRenderFns:h.staticRenderFns}})(jj).compileToFunctions,rc,mj=Aa?$f(!1):!1,nj=Aa?$f(!0):!1,oj=y(function(f){return(f=dd(f))&&f.innerHTML}),pj=va.prototype.$mount;va.prototype.$mount=function(f,h){f=f&&dd(f);var l=this.$options;if(!l.render){var n=
l.template;if(n)if("string"===typeof n)"#"===n.charAt(0)&&((n=oj(n))||U("Template element not found or is empty: "+l.template,this));else if(n.nodeType)n=n.innerHTML;else return U("invalid template option:"+n,this),this;else if(f)if(n=f,n.outerHTML)n=n.outerHTML;else{var r=document.createElement("div");r.appendChild(n.cloneNode(!0));n=r.innerHTML}n&&(ra.performance&&Ha&&Ha("compile"),n=xg(n,{outputSourceRange:application&&application.configuration&&application.configuration.development,shouldDecodeNewlines:mj,
shouldDecodeNewlinesForHref:nj,delimiters:l.delimiters,comments:l.comments},this),r=n.staticRenderFns,l.render=n.render,l.staticRenderFns=r,ra.performance&&Ha&&(Ha("compile end"),Yb("vue "+this._name+" compile","compile","compile end")))}return pj.call(this,f,h)};va.compile=xg;return va});if(!nabu)var nabu={};nabu.utils||(nabu.utils={});nabu.utils.schema||(nabu.utils.schema={});nabu.utils.schema.json||(nabu.utils.schema.json={});
nabu.utils.schema.addAsyncValidation=function(a,b,c){if(null==a.promises){a.promises=[];var d=a.filter;a.filter=function(){return nabu.utils.schema.addAsyncValidation(d.apply(a,arguments))};var e=a.map;a.map=function(){return nabu.utils.schema.addAsyncValidation(e.apply(a,arguments))}}null==a.defer&&(a.defer=function(g,k){return nabu.utils.schema.addAsyncValidation(a,g,k)});null!=b&&(b.then(function(g){g=null!=c&&null!=g?c(g):g;null==g||g instanceof Array||Object.keys(g).forEach(function(k){null!=
g&&!(g instanceof Array)&&g[k]instanceof Array&&(g=g[k].map(function(m){null==m.title&&null!=m.message&&(m.title=m.message);null!=m.severity&&(m.severity=m.severity.toLowerCase());return m}))});g instanceof Array&&0<g.length&&nabu.utils.arrays.merge(a,g)}),b.promises instanceof Array?nabu.utils.arrays.merge(a.promises,b.promises):a.promises.push(b));null==a.then&&(a.then=function(g,k,m){(new nabu.utils.promises(a.promises)).then(function(){g instanceof Function?g(a):g.resolve&&g.resolve(a)},function(p){a.push({code:"internal",
title:"%{validation::An error has occurred during validation}"});g instanceof Function?g(a):g.resolve(a)},m)});return a};
nabu.utils.schema.json.format=function(a,b,c){if(a.$ref)if(c)a=c(a.$ref);else throw"Can not format value because definition has a reference in it and no resolver is provided";if("string"==a.type)return"date"!=a.format&&"date-time"!=a.format||"string"!=typeof b||!b.match(/[-]{0,1}P[YMDTHS0-9]+$/)||(b=nabu.utils.dates.addDuration(b)),"binary"==a.format||"byte"==a.format?b instanceof File||b instanceof Blob?b:"string"==typeof b||b instanceof Date?new Blob([b],{type:"text/plain"}):new Blob([JSON.stringify(b,
null,2)],{type:"application/json"}):"date"==a.format&&b instanceof Date?b.getFullYear()+"-"+(9>b.getMonth()?"0":"")+(b.getMonth()+1)+"-"+(10>b.getDate()?"0":"")+b.getDate():"date-time"==a.format&&b instanceof Date?b.toISOString():"time"==a.format&&b instanceof Date?b.toISOString().substring(11):!1===b?"false":b?"string"===typeof b?b:new String(b):null;if("number"==a.type||"integer"==a.type){if("number"===typeof b)return"integer"==a.type?parseInt(b):b;if(b){c=new Number(b);if(isNaN(c))throw"Not a number: "+
b;"integer"==a.type&&(c=parseInt(c));return c}return null}if("boolean"==a.type)return"boolean"===typeof b?b:"undefined"==typeof b||null==b?null:"string"==typeof b&&"false"===b.toLowerCase()?!1:!!b;if("array"==a.type){if(null==b)return null;b instanceof Array||(b=[b]);for(var d=[],e=0;e<b.length;e++)d.push(nabu.utils.schema.json.format(a.items,b[e],c));return d}if("object"==a.type){if(null==b)return null;d={};if(a.properties)for(e in a.properties){var g=nabu.utils.schema.json.format(a.properties[e],
b[e],c);if(null!=g)d[e]=g;else if(a.required&&0<=a.required.indexOf(e))if("boolean"==a.properties[e].type)d[e]=!1;else throw"Missing required element: "+e;}return d}throw"Unsupported type: "+a.type;};
nabu.utils.schema.json.normalize=function(a,b,c,d,e){if(a.$ref)if(c)a=c(a.$ref);else throw"Can not normalize value because definition has a reference in it and no resolver is provided";if("undefined"==typeof b)return d?nabu.utils.schema.json.instance(a,c):null;if("object"==a.type||null==a.type&&a.properties){if(a.properties&&null!=b)for(var g in a.properties)"undefined"==typeof b[g]?e&&(b[g]=nabu.utils.schema.json.instance(a.properties[g],c)):b[g]=nabu.utils.schema.json.normalize(a.properties[g],
b[g],c,e,e)}else if("array"==a.type)for(b instanceof Array||(b=[b]),d=0;d<b.length;d++)b[d]&&a.items&&(b[d]=nabu.utils.schema.json.normalize(a.items,b[d],c,e,e));else if(""===b)b=null;else if(b&&"string"==a.type&&("date"==a.format||"date-time"==a.format))b=new Date(b);else if(b&&"string"==a.type&&"time"==a.format)b=new Date("1970-01-01T"+b);else if("string"==typeof b&&"boolean"==a.type)b="true"==b;else if(b&&"string"==typeof b&&("binary"==a.format||"byte"==a.format)){a=window.atob(b);b=a.length;c=
new Uint8Array(b);for(e=0;e<b;++e)c[e]=a.charCodeAt(e);b=new Blob([c],{type:"application/octet-stream"})}return b};nabu.utils.schema.json.instance=function(a,b){if(a.$ref)if(b)a=b(a.$ref);else throw"Can not normalize value because definition has a reference in it and no resolver is provided";return"array"==a.type?[]:"object"==a.type?nabu.utils.schema.json.normalize(a,{},b):null};
nabu.utils.schema.json.validate=function(a,b,c,d){if(a.$ref)if(d)a=d(a.$ref);else throw"Can not normalize value because definition has a reference in it and no resolver is provided";"undefined"==typeof b&&(b=null);var e=[];d=function(){c&&e.push({soft:!0,severity:"error",code:"required",title:"%{validation::The value is required}",priority:0,values:{actual:!1,expected:!0},context:[]})};if(!a)return!c||"undefined"!=typeof b&&null!=b&&""!==b||d(),e;var g=function(F,C){null!=C&&y.length<C&&e.push({severity:"error",
code:"minLength",title:"%{validation::The value must be at least {expected} long}",priority:-2,values:{actual:y.length,expected:C},context:[]})},k=function(F,C){null!=C&&y.length>C&&e.push({severity:"error",code:"maxLength",title:"%{validation::The value can be at most {expected} long}",priority:-2,values:{actual:y.length,expected:C},context:[]})},m=function(F,C){null!=C&&(y.length>C||y.length<C)&&e.push({severity:"error",code:"exactLength",title:"%{validation::The value must be {expected} long}",
priority:-2,values:{actual:y.length,expected:C},context:[]})},p=function(F,C,A){null==C||y.match(C)||e.push({severity:"error",code:"pattern",title:A?A:"%{validation::The value '{actual}' does not match the expected pattern '{expected}'}",priority:A?-1:-3,values:{actual:y,expected:C},context:[]})},q=function(F,C,A){null!=F&&(null!=A&&A&&F>=C||null!=C&&F>C)&&e.push({severity:"error",code:"maximum",title:null!=A?"%{validation::The value {actual} should be smaller than {expected}}":"%{validation::The value {actual} should be smaller than or equal to {expected}}",
priority:-2,values:{actual:F,expected:C,exclusive:!!A},context:[]})},t=function(F,C,A){null!=F&&(null!=A&&A&&F<=C||null!=C&&F<C)&&e.push({severity:"error",code:"minimum",title:null!=A?"%{validation::The value {actual} should be bigger than {expected}}":"%{validation::The value {actual} should be bigger than or equal to {expected}}",priority:-2,values:{actual:F,expected:C,exclusive:!!A},context:[]})},u=function(F,C){null!=C&&F.length>C&&e.push({severity:"error",code:"maxItems",title:"%{validation::There are {actual} entries, can be at most {expected}}",
priority:-2,values:{actual:F.length,expected:C},context:[]})},w=function(F,C){null!=C&&F.length<C&&e.push({severity:"error",code:"minItems",title:"%{validation::There are only {actual} entries, expecting at least {expected}}",priority:-2,values:{actual:F.length,expected:C},context:[]})};(function(F,C){C&&0>C.indexOf(F)&&e.push({severity:"error",code:"enum",title:"%{validation::The value {actual} does not match one of the possible values}",priority:-1,values:{actual:F,expected:C},context:[]})})(b,
a["enum"]);if("string"==a.type||"number"==a.type||"integer"==a.type||!a.type)if(null==b||""===b)d();else{var y="string"===typeof b?b:new String(b);a.minLength==a.maxLength?m(y,a.minLength):(g(y,a.minLength),k(y,a.maxLength));p(y,a.pattern,a.patternComment)}if("number"==a.type||"integer"==a.type){y=null;if("number"===typeof b)y=b;else if("undefined"!=typeof b){var B=new Number(b);isNaN(B)?e.push({severity:"error",code:"type",title:"%{validation::The value '{actual}' is not a '{expected}'}",priority:-1,
values:{actual:b,expected:a.type},context:[]}):y=B}null!=y?(q(y,a.maximum,a.exclusiveMaximum),t(y,a.minimum,a.exclusiveMinimum)):d()}else if("boolean"==a.type)null==b&&d();else if("array"==a.type)if(null==b)d();else if(y=b instanceof Array?b:[b],b.length){if(u(y,a.maxItems),w(y,a.minItems),a.items)for(b=0;b<y.length;b++)for(d=nabu.utils.schema.json.validate(a.items,y[b],!1),q=0;q<d.length;q++)d[q].context.push(b),e.push(d[q])}else d();else if("object"==a.type)if(null==b)d();else if(a.properties)for(B in a.properties)for(d=
nabu.utils.schema.json.validate(a.properties[B],b[B],a.required&&0<=a.required.indexOf(B)),q=0;q<d.length;q++)d[q].context.push(B),e.push(d[q]);nabu.utils.schema.addAsyncValidation(e);return e};nabu||={};nabu.services||(nabu.services={});nabu.services.iterators||(nabu.services.iterators={});nabu.services.iterators.Static=function(){this.hasNext=function(){return!1};this.hasPrevious=function(){return!1};this.next=function(a,b){0==b.length&&nabu.utils.arrays.merge(b,a)};this.previous=function(a,b){}};
nabu||={};nabu.services||(nabu.services={});nabu.services.iterators||(nabu.services.iterators={});
nabu.services.iterators.Window=function(a){var b=this;this.totalSize=a.totalSize;this.scrollSize=a.scrollSize?a.scrollSize:this.totalSize;this.loadNext=a.loadNext;this.hasMore=!0;this.loop=a.loop;this.initialOffset=a.initialOffset?a.initialOffset:0;this.next=function(c,d){var e=function(m){b.loadNext(c,m,function(p){p.length<m&&(b.hasMore=!1);m<b.scrollSize&&nabu.utils.arrays.merge(d,c.slice(c.length-m,c.length));nabu.utils.arrays.merge(c,p);nabu.utils.arrays.merge(d,p.slice(0,Math.min(p.length,b.scrollSize-
m)))})};if(0==d.length)c.length<b.initialOffset+b.totalSize&&b.loadNext?e(b.totalSize+b.initialOffset-c.length):nabu.utils.arrays.merge(d,c.slice(b.initialOffset,Math.min(b.totalSize+b.initialOffset,c.length)));else{var g=function(m){m=Math.min(b.scrollSize-m,c.length-m);d.splice(0,d.length-Math.min(d.length,b.totalSize-m));nabu.utils.arrays.merge(d,c.slice(0,m))},k=c.indexOf(d[d.length-1]);if(0>k)throw"Could not find selected item in list";k+b.scrollSize>=c.length-1&&b.loadNext?e(b.scrollSize-(c.length-
1-k)):k<c.length-1?(e=Math.min(b.scrollSize,c.length-k-1),d.splice(0,d.length-Math.min(d.length,b.totalSize-e)),nabu.utils.arrays.merge(d,c.slice(k+1,k+1+e)),e<b.scrollSize&&b.loop&&g(e)):b.loop&&g(0)}};this.previous=function(c,d){if(0<d.length){var e=function(p){p=Math.min(b.scrollSize-p,c.length-p);var q=Math.min(d.length,b.totalSize-p);d.splice(q,d.length-q);nabu.utils.arrays.offer(d,c.slice(c.length-p,c.length))},g=c.indexOf(d[0]);if(0>g)throw"Could not find selected item in list";if(0<g){var k=
Math.min(b.scrollSize,g),m=Math.min(d.length,b.totalSize-k);d.splice(m,d.length-m);nabu.utils.arrays.offer(d,c.slice(g-k,g));k<b.scrollSize&&b.loop&&e(k)}else b.loop&&e(0)}};this.hasNext=function(c,d){return b.loop&&d.length!=c.length?!0:0==d.length?0<c.length:c.indexOf(d[d.length-1])<c.length-1};this.hasPrevious=function(c,d){return b.loop&&d.length!=c.length?!0:0<d.length&&0<c.indexOf(d[0])};this.autosize=function(c,d,e){this.totalSize=e;this.totalSize<d.length?d.splice(this.totalSize):this.totalSize>
d.length&&(e=c.indexOf(d[d.length-1]),nabu.utils.arrays.merge(d,c.slice(e+1,e+1+Math.min(this.totalSize-d.length,c.length-e))))}};Function.name||Object.defineProperty(Function.prototype,"name",{get:function(){var a=(""+this).match(/^\s*function\s+([^\(\s]*)\s*/);return a?a[1]:null},configurable:!0});nabu||={};nabu.formatters||(nabu.formatters={});
nabu.formatters.markdown={syntaxProviders:{xml:function(a,b){b="";for(var c=0;0<=c;)if(c=a.indexOf("\x3c"),0<c&&(b+=a.substring(0,c),a=a.substring(c),c=0),0==c){var d=a.match(/^[^\s>]+/);b+="\x3cspan class\x3d'is-code-variable'\x3e"+nabu.formatters.markdown.formatTextAsHtml(d[0])+"\x3c/span\x3e";a=a.substring(d[0].length);d=a.indexOf("\x3e");if(0<d){var e=a.substring(0,d);a=a.substring(d);d=0;var g=nabu.formatters.markdown.encodeStrings(e);e=g.content;e=e.replace(/\b([\w]+[\s]*)=/g,"\x3cspan class\x3d'is-code-keyword'\x3e$1\x3d\x3c/span\x3e");
b+=nabu.formatters.markdown.decodeStrings(e,g)}0==d&&(b+="\x3cspan class\x3d'is-code-variable'\x3e"+nabu.formatters.markdown.formatTextAsHtml("\x3e")+"\x3c/span\x3e",a=a.substring(1))}return b},html:"xml",css:function(a,b){return nabu.formatters.markdown.encodeCode(a,null,/\/\*.*\*\//s,/\b(:[\w]+)[\s]*\(/g,/(\.[a-zA-Z]+[\w-]*)\b/g,nabu.formatters.markdown.keywords.css,b)},scss:function(a,b){var c=["@mixin","@include"];nabu.utils.arrays.merge(c,nabu.formatters.markdown.keywords.css);return nabu.formatters.markdown.encodeCode(a,
/\/\/.*$/m,/\/\*.*\*\//s,/\b([:\w]+)[\s]*\(/g,/((?:\$|\.)[a-zA-Z]+[\w-]*)\b/g,c,b)},sql:function(a,b){return nabu.formatters.markdown.encodeCode(a,/--.*$/m,null,/\b([\w.]+)\(/g,null,nabu.formatters.markdown.keywords.sql,b)},glue:function(a,b){return nabu.formatters.markdown.encodeCode(a,/#.*$/m,null,/\b([\w.]+)\(/g,null,nabu.formatters.markdown.keywords.default.filter(function(c){return 0>["new"].indexOf(c)}),b)},python:"glue",java:function(a,b){return nabu.formatters.markdown.encodeCode(a,/\/\/.*$/m,
/\/\*.*\*\//s,/\b([\w]+)\(/g,null,nabu.formatters.markdown.keywords.default,b)},javascript:"java",json:"java",text:function(a,b){return nabu.formatters.markdown.formatTextAsHtml(a,!0)}},keywords:{css:["!default","!important","@media"],sql:"select;update;delete;insert;create;drop;from;where;order by;group by;limit;offset;table;index;and;or;current_timestamp".split(";"),default:"abstract null continue for new switch assert default goto package synchronized boolean do if private this break double implements protected throw byte else import public throws case enum instanceof return transient catch extends int short try char final interface static void class finally long strictfp volatile const float native super while true false".split(" ")},
encodeCode:function(a,b,c,d,e,g,k){k=nabu.formatters.markdown.encodeStrings(a);a=k.content;b=nabu.formatters.markdown.encodeComments(a,b,c);a=b.content;a=nabu.formatters.markdown.formatTextAsHtml(a,!0);g&&g.length&&(a=a.replaceAll(new RegExp("(?:\\b)("+g.join("|")+")(?:\\b)","g"),"\x3cspan class\x3d'is-code-keyword'\x3e$1\x3c/span\x3e"));null!=d&&(a=a.replaceAll(d,"\x3cspan class\x3d'is-code-method'\x3e$1\x3c/span\x3e("));null!=e&&(a=a.replaceAll(e,"\x3cspan class\x3d'is-code-variable'\x3e$1\x3c/span\x3e"));
a=nabu.formatters.markdown.decodeComments(a,b);return a=nabu.formatters.markdown.decodeStrings(a,k)},asHtml:function(a,b){var c=[],d={},e=[],g=function(m){for(m=(m?m:e.length)-1;0<=m;m--){var p=2<=e.length;c.push("\x3c/"+e.pop()+"\x3e"+(p?"\x3c/li\x3e":""))}},k=function(m){c.push((0<e.length?"\x3cli\x3e":"")+"\x3c"+m+" class\x3d'is-list is-variant-article'\x3e");e.push(m)};for(a.forEach(function(m){"ul"!=m.type&&"ol"!=m.type&&0<e.length&&g();var p=[];if(0<="h1 h2 h3 h4 h5 h6 p".split(" ").indexOf(m.type))0==
m.type.indexOf("h")&&p.push("\x3ca id\x3d'"+m.linkId+"'\x3e\x3c/a\x3e"),p.push("\x3c"+m.type+" class\x3d'is-"+m.type+" is-variant-article'\x3e"+nabu.formatters.markdown.formatContentAsHtml(m.content,b)+"\x3c/"+m.type+"\x3e");else if("code"==m.type){var q=nabu.formatters.markdown.formatCodeAsHtml(m.content,m.syntax,b);if(q.then){var t=crypto?crypto.randomUUID():"code-"+Math.random();p.push("\x3ccode class\x3d'is-code is-variant-article' target\x3d'"+(m.syntax?m.syntax:"text")+"' data-resolve-id\x3d'"+
t+"'\x3e");d[t]=q}else p.push("\x3ccode class\x3d'is-code is-variant-article' target\x3d'"+(m.syntax?m.syntax:"text")+"'\x3e"),p.push(q);p.push("\x3c/code\x3e")}else if("quote"==m.type)p.push("\x3cblockquote class\x3d'is-quote is-variant-article'\x3e"+nabu.formatters.markdown.formatTextAsHtml(m.content,b)+"\x3c/blockquote\x3e");else if("ul"==m.type||"ol"==m.type){for(;m.depth>e.length;)p.push((0<e.length?"\x3cli\x3e":"")+"\x3cul class\x3d'is-list is-variant-article'\x3e"),e.push("ul");m.depth<e.length-
1&&g(e.length-(m.depth+1));m.depth==e.length?k(m.type):e[e.length-1]!=m.type&&(g(1),k(m.type));p.push("\x3cli\x3e"+nabu.formatters.markdown.formatContentAsHtml(m.content,b)+"\x3c/li\x3e")}else if("table"==m.type)p.push("\x3ctable class\x3d'is-table is-variant-article'\x3e"),q=m.rows.filter(function(y){return y.header}),m=m.rows.filter(function(y){return!y.header}),q.length&&(p.push("\x3cthead\x3e"),q.forEach(function(y){p.push("\x3ctr\x3e");y.columns.forEach(function(B){p.push("\x3cth colspan\x3d'"+
(B.colspan?B.colspan:1)+"'\x3e"+nabu.formatters.markdown.formatContentAsHtml(B.content,b)+"\x3c/th\x3e")});p.push("\x3c/tr\x3e")}),p.push("\x3c/thead\x3e")),m.length&&(p.push("\x3ctbody\x3e"),m.forEach(function(y){p.push("\x3ctr\x3e");y.columns.forEach(function(B){p.push("\x3ctd colspan\x3d'"+(B.colspan?B.colspan:1)+"'\x3e"+nabu.formatters.markdown.formatContentAsHtml(B.content,b)+"\x3c/td\x3e")});p.push("\x3c/tr\x3e")}),p.push("\x3c/tbody\x3e")),p.push("\x3c/table\x3e");else if("block"==m.type){p.push("\x3cdiv class\x3d'is-"+
(m.direction?m.direction:"row")+" is-variant-article'\x3e");var u="column"==m.direction?"row":"column",w=(q=m.configuration.filter(function(y){return"dimensions"==y.key})[0])?q.value.split(","):[];m.blocks.forEach(function(y,B){p.push("\x3cdiv class\x3d'is-"+u+" is-variant-article' style\x3d'flex-basis: 0; flex-grow: "+((B<w.length?w[B]:"1")+";'\x3e"));y=nabu.formatters.markdown.asHtml([y],b);p.push(y.content);nabu.utils.objects.merge(d,y.promises);p.push("\x3c/div\x3e")});p.push("\x3c/div\x3e")}nabu.utils.arrays.merge(c,
p)});e.length;)g();for(a=0;a<c.length-1;a++)c[a].indexOf("\x3c/li\x3e")!=c[a].length-5||0!=c[a+1].indexOf("\x3cli\x3e\x3cul")&&0!=c[a+1].indexOf("\x3cli\x3e\x3col")||(c[a]=c[a].substring(0,c[a].length-5),c[a+1]=c[a+1].substring(4));return{content:nabu.formatters.markdown.replaceVariables(c.join("\n"),b),promises:d}},replacePromises:function(a){Object.keys(a).forEach(function(b){a[b].then(function(c){var d=document.querySelector('[data-resolve-id\x3d"'+b+'"]');d&&c&&(d.innerHTML=c)})})},replaceVariables:function(a,
b){b&&b.variables&&Object.keys(b.variables).forEach(function(c){a=a.replace(new RegExp("\\$\\{"+c+"\\}","g"),b.variables[c])});return a},formatTextAsHtml:function(a,b){a=a.replace(/&/g,"\x26amp;");a=a.replace(/</g,"\x26lt;");a=a.replace(/>/g,"\x26gt;");a=a.replace(/\t/g,"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;");a=a.replace(/\n/g,"\x3cbr/\x3e");b&&(a=a.replace(/[ ]{2}/g,"\x26nbsp;\x26nbsp;"));return a},formatContentAsHtml:function(a,b){for(var c=[];a.match(/``(.*?)``/);){var d=a.match(/``(.*?)``/)[0];
a=a.replace(d,"::encoded-inline-code-"+c.length+"::");d=d.replace(/``(.*?)``/g,"$1");c.push("\x3ccode class\x3d'is-code is-variant-inline'\x3e"+nabu.formatters.markdown.formatTextAsHtml(d)+"\x3c/code\x3e")}for(;a.match(/`(.*?)`/);)d=a.match(/`(.*?)`/)[0],console.log("inline code is",d),a=a.replace(d,"::encoded-inline-code-"+c.length+"::"),d=d.replace(/`(.*?)`/g,"$1"),c.push("\x3ccode class\x3d'is-code is-variant-inline'\x3e"+nabu.formatters.markdown.formatTextAsHtml(d)+"\x3c/code\x3e");a=a.replace(/\\\*/g,
"::escaped-asterisk::");a=a.replace(/\\_/g,"::escaped-underscore::");a=a.replace(/\\\+/g,"::escaped-plus::");a=a.replace(/\\~/g,"::escaped-tilde::");a=a.replace(/\\`/g,"::escaped-backtick::");a=a.replace(/\\@/g,"::escaped-at::");a=a.replace(/\\#/g,"::escaped-hashtag::");a=a.replace(/\*\*\*(.*?)\*\*\*/g,"\x3cem\x3e$1\x3c/em\x3e");a=a.replace(/\*\*(.*?)\*\*/g,"\x3cb\x3e$1\x3c/b\x3e");a=a.replace(/__(.*?)__/g,"\x3cb\x3e$1\x3c/b\x3e");a=a.replace(/\*(.*?)\*/g,"\x3ci\x3e$1\x3c/i\x3e");a=a.replace(/_(.*?)_/g,
"\x3ci\x3e$1\x3c/i\x3e");a=a.replace(/~~(.*?)~~/g,"\x3cdel\x3e$1\x3c/del\x3e");a=a.replace(/\+\+(.*?)\+\+/g,"\x3cins\x3e$1\x3c/ins\x3e");a=a.replace(/``(.*?)``/g,"\x3ccode class\x3d'is-code is-variant-inline'\x3e$1\x3c/code\x3e");a=a.replace(/`(.*?)`/g,"\x3ccode class\x3d'is-code is-variant-inline'\x3e$1\x3c/code\x3e");a=a.replace(/!!\[(.*?)#(.*?)\]\((.*?)\)/g,"\x3cvideo alt\x3d'$1' class\x3d'is-video is-variant-article $2' controls frameborder\x3d'0' allowfullscreen\x3e\x3csource src\x3d'$3'/\x3e\x3c/video\x3e");
a=a.replace(/!!\[(.*?)\?(.*?)\]\((.*?)\)/g,"\x3cvideo alt\x3d'$1' class\x3d'is-video is-variant-article' style\x3d'$2' controls frameborder\x3d'0' allowfullscreen\x3e\x3csource src\x3d'$3'/\x3e\x3c/video\x3e");a=a.replace(/!!\[(.*?)\]\((.*?)\)/g,"\x3cvideo alt\x3d'$1' class\x3d'is-video is-variant-article' controls frameborder\x3d'0' allowfullscreen\x3e\x3csource src\x3d'$2'/\x3e\x3c/video\x3e");a=a.replace(/!\[(.*?)#(.*?)\]\((.*?)\)/g,"\x3cimg alt\x3d'$1' src\x3d'$3' class\x3d'is-image is-variant-article $2'/\x3e");
a=a.replace(/!\[(.*?)\?(.*?)\]\((.*?)\)/g,"\x3cimg alt\x3d'$1' style\x3d'$2' src\x3d'$3' class\x3d'is-image is-variant-article'/\x3e");a=a.replace(/!\[(.*?)\]\((.*?)\)/g,"\x3cimg alt\x3d'$1' src\x3d'$2' class\x3d'is-image is-variant-article'/\x3e");a=a.replace(/\[(.*?)\]\(((?:http|https):\/\/.*?)\)/g,"\x3ca rel\x3d'norel nofollow noopener' href\x3d'$2' class\x3d'is-link is-variant-article is-target-external'\x3e$1\x3c/a\x3e");a=a.replace(/\[(.*?)\]\((#.*?)\)/g,"\x3ca href\x3d'"+window.location.pathname+
"$2' class\x3d'is-link is-variant-article is-target-internal'\x3e$1\x3c/a\x3e");a=a.replace(/\[(.*?)\]\((.*?)\)/g,"\x3ca href\x3d'$2' class\x3d'is-link is-variant-article is-target-internal'\x3e$1\x3c/a\x3e");a=a.replace("\t","\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;");a=a.replace("\n","\x3cbr/\x3e");b&&b.tagUrl&&(a=a.replace(/(^|[\s]+)#([\w/-]+)/g,"$1\x3ca class\x3d'is-link is-variant-tag is-target-internal' href\x3d'"+b.tagUrl+"$2'\x3e$2\x3c/a\x3e"));b&&b.userUrl&&(a=a.replace(/(^|[\s]+)@([\w/-]+)/g,
"$1\x3ca class\x3d'is-link is-variant-user is-target-internal' href\x3d'"+b.userUrl+"$2'\x3e$2\x3c/a\x3e"));a=a.replace(/::escaped-asterisk::/g,"*");a=a.replace(/::escaped-underscore::/g,"_");a=a.replace(/::escaped-plus::/g,"+");a=a.replace(/::escaped-tilde::/g,"~");a=a.replace(/::escaped-backtick::/g,"`");a=a.replace(/::escaped-at::/g,"@");a=a.replace(/::escaped-hashtag::/g,"#");c.forEach(function(e,g){a=a.replace("::encoded-inline-code-"+g+"::",e)});return a},encodeStrings:function(a){for(var b,
c=null,d=[],e=0,g=0;0<=e;){if(null!=c){b=a.indexOf(c,e+1);0>b&&(g=e+1,c=null);if(null!=c){var k=a.indexOf("\n",e+1);0<=k&&k<b&&(c=null,g=k+1)}if(null!=c)if(0<=b)c=a.substring(e,b+1),a=a.replace(c,"::encoded-string-"+d.length+"::"),d.push(c),c=null;else break}null==c&&(e=a.indexOf("'",g),b=a.indexOf('"',g),0<=e&&0<=b&&e<b||0<=e&&0>b?c="'":0<=e&&0<=b&&e>b||0>e&&0<=b?(c='"',e=b):e=-1)}return{strings:d,content:a}},decodeStrings:function(a,b){b.strings.forEach(function(c,d){a=a.replace("::encoded-string-"+
d+"::","\x3cspan class\x3d'is-code-string'\x3e"+nabu.formatters.markdown.formatTextAsHtml(c)+"\x3c/span\x3e")});return a},encodeComments:function(a,b,c){var d=[];if(c)for(;a.match(c);){var e=a.match(c)[0];a=a.replace(e,"::encoded-multi-comment-"+d.length+"::");d.push(e)}c=[];if(b)for(;a.match(b);)e=a.match(b)[0],a=a.replace(e,"::encoded-single-comment-"+c.length+"::"),c.push(e);return{single:c,multi:d,content:a}},decodeComments:function(a,b){b.single.forEach(function(c,d){a=a.replace("::encoded-single-comment-"+
d+"::","\x3cspan class\x3d'is-code-comment is-variant-single'\x3e"+nabu.formatters.markdown.formatTextAsHtml(c)+"\x3c/span\x3e")});b.multi.forEach(function(c,d){a=a.replace("::encoded-multi-comment-"+d+"::","\x3cspan class\x3d'is-code-comment is-variant-multi'\x3e"+nabu.formatters.markdown.formatTextAsHtml(c)+"\x3c/span\x3e")});return a},formatCodeAsHtml:function(a,b,c){for(b&&nabu.formatters.markdown.syntaxProviders[b]||(b="text");"string"==typeof b||b instanceof String;)b=nabu.formatters.markdown.syntaxProviders[b];
return b(a,c)},parse:function(a,b){if(null==a)return[];a.innerHTML&&(a=a.innerHTML);b=a.split(/\n/);for(var c=[],d=null,e=null,g=function(){d&&(c.push(d),d=null)},k=function(H){g();c.push(H);H.type.match(/^h[0-9]+$/)&&(H.linkId=H.content.replace(/[^\w]+/g,"-").toLowerCase())},m=function(H,ca){d&&(d.type!=H.type||ca)?(g(),d=H):d&&null==d.content?d.content=a:d?d.content+="\n"+H.content:d=H},p=function(H){d?d.content=null==d.content?H:d.content+("\n"+H):d={type:"p",content:H}},q=null,t=0;t<b.length;t++){var u=
b[t].trim(),w=!0;q&&(w=q(u,b[t]));if(w)if(0==u.length)g();else if(0==u.indexOf("######"))k({type:"h6",content:u.substring(6).trim()});else if(0==u.indexOf("#####"))k({type:"h5",content:u.substring(5).trim()});else if(0==u.indexOf("####"))k({type:"h4",content:u.substring(4).trim()});else if(0==u.indexOf("###"))k({type:"h3",content:u.substring(3).trim()});else if(0==u.indexOf("##"))k({type:"h2",content:u.substring(2).trim()});else if(0==u.indexOf("#"))k({type:"h1",content:u.substring(1).trim()});else if(0==
u.indexOf("\x3e"))m({type:"quote",content:u.substring(1).trim()});else if(0==u.indexOf("````"))u=u.substring(4).trim(),m({type:"code",syntax:0<u.length?u:null}),q=function(H,ca){"````"==H?(g(),q=null):p(ca)};else if(0==u.indexOf("```"))u=u.substring(3).trim(),m({type:"code",syntax:0<u.length?u:null}),q=function(H,ca){"```"==H?(g(),q=null):p(ca)};else if(u.match(/^[-]+(>|\^).*/)){w=u.replace(/^[-]+(?:>|\^)(.*)/,"$1").trim();u=u.replace(/^([-]+(?:>|\^)).*/,"$1").trim();var y=u.length-u.replace(/^[-]+/,
"").length,B=0<u.indexOf("\x3e")?"row":"column";console.log("starting block",u);d&&"block"!=d.type&&g();u={blockWrapper:e,blocks:c,parseEvaluator:q};e={configuration:[],parent:u,type:"block",direction:B,depth:y,blocks:[]};w&&w.split(";").forEach(function(H){var ca=H.indexOf("\x3d"),P=0<ca?H.substring(0,ca):null;H=0<ca?H.substring(ca+1):H;e.configuration.push({key:null==P?"dimensions":P,value:H})});c.push(e);c=e.blocks}else if(u.match(/^(<|\^)[-]+$/))y=u.length-u.replace(/[-]+$/,"").length,B=0==u.indexOf("\x3c")?
"row":"column",console.log("stopping block",u,e,B,y),e&&e.direction==B&&e.depth==y&&(console.log("actually stopping!"),u=e.parent,e.parent=null,delete e.parent,g(),q=u.parseEvaluator,c=u.blocks,e=u.blockWrapper);else if("---"==u||"___"==u||"***"==u)m({type:"hr"});else if(0==u.indexOf("-")||0==u.indexOf("+")||0==u.indexOf("*"))m({type:"ul",depth:b[t].indexOf(u.substring(0,1)),content:u.substring(1).trim()},!0);else if(u.match(/^[0-9]+\..*/))m({type:"ol",depth:b[t].indexOf(u.substring(0,1)),number:parseInt(u.replace(/^([0-9]+)\..*/,
"$1")),content:u.replace(/^[0-9]+\.(.*)/,"$1").trim()},!0);else if(u.match(/^\[\^[0-9]+\].*/))m({type:"footnote",number:parseInt(u.replace(/^\[\^([0-9]+)\].*/,"$1"))},!0);else if("/*"==u)m({type:"comment"}),q=function(H){"*/"==H?q=null:p(H)};else if(0==u.indexOf("|")){m({type:"table",rows:[],styling:[]});var F=!0;q=function(H){H=H.replace(/\\\|/g,"::encoded-pipe::");if(0!=H.indexOf("|"))return F&&d.rows.forEach(function(Q){Q.header=!1}),g(),q=null,!0;for(var ca=[],P=0;0<=P;)if(H=H.replace(/^[|]+/,
""),P=H.indexOf("|"),0<=P){var M=H.substring(0,P).trim();H=H.substring(P);if(M.match(/^[-]+$/))d.styling.push({align:"left"}),F=!1;else if(M.match(/^:[-]+$/))d.styling.push({align:"left"}),F=!1;else if(M.match(/^[-]+:$/))d.styling.push({align:"right"}),F=!1;else if(M.match(/^:[-]+:$/))d.styling.push({align:"center"}),F=!1;else{var K=H.length;H=H.replace(/^[|]*(\|.*)/,"$1");K-=H.length;M=M.replace(/::encoded-pipe::/g,"|");ca.push({content:M,colspan:K+1})}}0<ca.length&&d.rows.push({columns:ca,header:F})};
q(u)}else p(u)}g();var C=0,A=0,O=0;c.forEach(function(H){0<A?H.depth>A?H.depth-=O:H.depth<A&&(O=A=0):H.depth>C+1&&(A=C+1,O=H.depth-A,H.depth-=O);C=H.depth});return c}};nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.objects={copy:function(a){if(navigator&&navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText("string"==typeof a?a:JSON.stringify(a));else{var b=document.createElement("textarea");b.style.fontSize="12pt";b.style.border="0";b.style.padding="0";b.style.margin="0";b.style.position="absolute";b.style.left="-9999px";b.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px";b.setAttribute("readonly","");b.value="string"==typeof a?a:JSON.stringify(a);
document.body.appendChild(b);b.select();document.execCommand("copy")}},deepClone:function(a){return JSON.parse(JSON.stringify(a))},clone:function(a){if(a instanceof Array)return a.map(function(c){return nabu.utils.objects.clone(c)});if("object"!=typeof a||null==a)return a;var b={};nabu.utils.objects.merge(b,a);return b},retain:function(a,b){for(var c in a)0>b.indexOf(c)&&delete a[c];return a},remove:function(a,b){for(var c in a)0<=b.indexOf(c)&&delete a[c];return a},merge:function(a){if(a instanceof
Array){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);for(c=0;c<a.length;c++)b.unshift(a[c]),nabu.utils.objects.merge.apply(null,b),b.shift()}else for(c=1;c<arguments.length;c++)if(arguments[c]){b="undefined"==typeof arguments[c].$overwrite?!0:arguments[c].$overwrite;for(var d in arguments[c])"$overwrite"!=d&&(arguments[c][d]instanceof Array?b?a[d]=arguments[c][d]:(a[d]||(a[d]=[]),nabu.utils.arrays.merge(a[d],arguments[c][d])):"object"!=typeof arguments[c][d]||null==arguments[c][d]||
arguments[c][d]instanceof Date?"undefined"==typeof arguments[c][d]||a[d]&&!b||(a[d]=arguments[c][d]):a[d]?nabu.utils.objects.merge(a[d],arguments[c][d]):a[d]=arguments[c][d])}},get:function(a,b,c){c||="/";b=b.split(c);for(c=0;c<b.length&&(a=a[b[c]],a);c++);return a?a:null}};nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.stage=function(a,b){b||={};b.observer||(b.observer=function(q){q.__ob__&&q.__ob__.dep&&q.__ob__.dep.notify&&q.__ob__.dep.notify()});if(a instanceof Array){"undefined"==typeof b.added&&(b.added=!0);"undefined"==typeof b.removed&&(b.removed=!0);"undefined"==typeof b.spliced&&(b.spliced=!0);var c=[];c.$original=a;c.$changed=function(){var q=c.pushed&&c.pushed.length||c.unshifted&&c.unshifted.length||c.popped&&c.popped.length||c.shifted&&c.shifted.length||c.spliced&&c.spliced.length;if(!q)for(var t=
0;t<c.length&&!(q=q||!!c[t].$changed&&c[t].$changed());t++);return q};var d=function(){for(var q=0;q<a.length;q++)b.shallow||!(a[q]instanceof Array||"object"==typeof a[q])||a[q]instanceof Date?c.push(a[q]):c.push(nabu.utils.stage(a[q],b));c.pushed=[];c.unshifted=[];c.popped=[];c.shifted=[];c.spliced=[]};d();if(b.added){var e=c.push;c.push=function(){c.pushed.push.apply(c.pushed,arguments);e.apply(c,arguments);c.__ob__&&c.__ob__.observeArray(arguments);b.observer(c)};var g=c.unshift;c.unshift=function(){c.unshifted.push.apply(c.unshifted,
arguments);g.apply(c,arguments);c.__ob__&&c.__ob__.observeArray(arguments);b.observer(c)}}if(b.removed){var k=c.pop;c.pop=function(){var q=k.apply(c);q&&(c.popped.push(q),b.observer(this))};var m=c.shift;c.shift=function(){c.shifted.push(m.apply(c));b.observer(this)}}else b.added&&(k=c.pop,c.pop=function(){var q=k.apply(c),t=c.pushed.indexOf(q);0<=t&&c.pushed.splice(t,1);t=c.unshifted.indexOf(q);0<=t&&c.unshifted.splice(t,1)},m=c.shift,c.shift=function(){var q=m.apply(c),t=c.pushed.indexOf(q);0<=
t&&c.pushed.splice(t,1);t=c.unshifted.indexOf(q);0<=t&&c.unshifted.splice(t,1)});if(b.spliced){var p=c.splice;c.oldSplice=p;c.splice=function(q,t){for(var u=[],w=2;w<arguments.length;w++)u.push(arguments[w]);c.spliced.push({starting:c[q],added:u,removed:p.apply(c,arguments)});u.length&&c.__ob__&&c.__ob__.observeArray(arguments);b.observer(this)}}else p=c.splice,c.splice=function(q,t){for(var u=p.apply(c,arguments),w=0;w<u.length;w++){q=a.indexOf(u[w].$original?u[w].$original:u[w]);0<=q&&a.splice(q,
1);var y=c.pushed.indexOf(u[w]);0<=y&&c.pushed.splice(y,1);y=c.unshifted.indexOf(u[w]);0<=y&&c.unshifted.splice(y,1)}y=[];for(w=2;w<arguments.length;w++)y.push(arguments[w]);y.length&&c.__ob__&&c.__ob__.observeArray(arguments);b.observer(this);return u},c.spliceSuperficial=function(q,t){p.apply(c,arguments)};c.$commit=function(){if(c.pushed)for(var q=0;q<c.pushed.length;q++)a.push(c.pushed[q]);if(c.unshifted)for(q=0;q<c.unshifted.length;q++)a.unshift(c.unshifted[q]);if(c.spliced)for(q=0;q<c.spliced.length;q++){var t=
a.indexOf(c.spliced[q].starting.$original?c.spliced[q].starting.$original:c.spliced[q].starting);if(0<=t){if(b.added&&a.splice.bind(a,t,0).apply(a,c.spliced[q].added),b.removed)for(var u=0;u<c.spliced[q].removed.length;u++)t=a.indexOf(c.spliced[q].removed[u].$original?c.spliced[q].removed[u].$original:c.spliced[q].removed[u]),0<=t?a.splice(t,1):console.log("Can not find spliced element",c.spliced[q].removed[u])}else console.log("Can not find splice start point",c.spliced[q].starting)}if(c.popped)for(q=
0;q<c.popped.length;q++)t=a.indexOf(c.popped[q].$original?c.popped[q].$original:c.popped[q]),0<=t?a.splice(t,1):console.log("Can not find popped element",c.shifted[q]);if(c.shifted)for(q=0;q<c.shifted.length;q++)t=a.indexOf(c.shifted[q].$original?c.shifted[q].$original:c.shifted[q]),0<=t?a.splice(t,1):console.log("Can not find shifted element",c.shifted[q]);for(q=0;q<c.length;q++)c[q].$commit&&c[q].$commit();c.$rollback()};c.$rollback=function(){c.spliceSuperficial?c.spliceSuperficial(0,c.length):
c.splice(0,c.length);d()};return c}if("object"!=typeof a||a instanceof Date)throw"Can only shim arrays of objects or objects";c={};c.$original=a;c.$rollback=function(){for(var q in a)b.ignoreFields&&0<=b.ignoreFields.indexOf(q)||null==a[q]||!(a[q]instanceof Array||"object"==typeof a[q])||a[q]instanceof Date?c[q]=a[q]:c[q]=nabu.utils.stage(a[q],b)};c.$changed=function(){var q=!1,t;for(t in c)if(c[t]&&c[t].$changed?q=c[t].$changed():"$"!=t.substring(0,1)&&(q=a[t]!=c[t]),q)break;return q};c.$rollback();
c.$commit=function(){for(var q in c)"$"!=q.substring(0,1)&&(null!=c[q]&&c[q].$commit&&(c[q]instanceof Array||"object"==typeof c[q])?c[q].$commit():a[q]=c[q]);c.$rollback()};return c};Vue&&Vue.mixin&&Vue.mixin({computed:{$stage:function(){return nabu.utils.stage}}});nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.arrays={merge:function(a){for(var b=1;b<arguments.length;b++)if(arguments[b]instanceof Array)for(var c=0;c<arguments[b].length;c++)a.push(arguments[b][c]);else"undefined"!=typeof arguments[b]&&a.push(arguments[b]);return a},offer:function(a){for(var b=1;b<arguments.length;b++)if(arguments[b]instanceof Array)for(var c=arguments[b].length-1;0<=c;c--)a.unshift(arguments[b][c]);else"undefined"!=typeof arguments[b]&&a.unshift(arguments[b]);return a},remove:function(a){for(var b=1;b<arguments.length;b++)if(arguments[b]instanceof
Array)for(var c=0;c<arguments[b].length;c++)nabu.utils.arrays.remove(a,arguments[b][c]);else c=a.indexOf(arguments[b]),0<=c&&a.splice(c,1)},flatten:function(a,b,c){for(var d=[],e=0;e<a.length;e++)(a[e][b]||c)&&d.push(a[e][b]);return d},find:function(a,b,c){"undefined"==typeof c&&(c=1);for(var d=[],e=0;e<a.length;e++){var g=!0,k;for(k in b)if(b[k]instanceof Array&&0>b[k].indexOf(a[e][k])||!(b[k]instanceof Array)&&a[e][k]!=b[k]){g=!1;break}g&&d.push(a[e]);if(0!=c&&d.length>=c)break}return 1==c?0==d.length?
null:d[0]:d},clear:function(a){a.splice(0,a.length)},unique:function(a){return a.filter(function(b,c,d){return d.indexOf(b)===c})},hash:function(a,b){return a.reduce(function(c,d){var e=b(d);c[e]||(c[e]=[]);c[e].push(d);return c},{})}};nabu||={};nabu.utils||(nabu.utils={});nabu.utils.string={quotePattern:function(a){return a.replace(/([\[\]\^\$\|\(\)\\\+\*\?\{\}=!])/gi,"\\$1")}};nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.elements={first:function(a){if(a.firstChild)for(a=a.firstChild;a;){if(1===a.nodeType)return a;a=a.nextSibling}return null},next:function(a){if(a.nextSibling)for(a=a.nextSibling;a;){if(1===a.nodeType)return a;a=a.nextSibling}return null},previous:function(a){if(a.previousSibling)for(a=a.previousSibling;a;){if(1===a.nodeType)return a;a=a.previousSibling}return null},clear:function(a){for(var b=a.childNodes,c=b.length-1;0<=c;c--){var d=b.item(c);d&&d.getAttribute&&"true"==d.getAttribute("locked")||
a.removeChild(d)}},inViewport:function(a){a=a.getBoundingClientRect();return 0<=a.top&&0<=a.left&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth)},sanitize:function(a,b){var c="a b i u em strong h1 h2 h3 h4 h5 h6 h7 p table ul li tr td thead tbody th ol font br span div pre blockquote code img video source article".split(" ");b&&b.allowFormElements&&c.push("input");return nabu.utils.elements.clean(a,c,null,"style href target rel src alt title class colspan rowspan controls frameborder allowfullscreen".split(" "),
null,b&&b.allowDataAttributes,b&&b.allowLinkIds)},clean:function(a,b,c,d,e,g,k){var m=!1;if(!(a instanceof HTMLElement)){m=!0;var p=document.createElement("div");p.innerHTML=a;a=p}var q=function(t){if(d||e)for(var u=t.attributes.length-1;0<=u;u--){var w=t.attributes.item(u);k&&"id"==w.name.toLowerCase()&&"a"==t.tagName.toLowerCase()||(d&&0>d.indexOf(w.name)&&(!g||0>w.name.indexOf("data-"))?t.removeAttribute(w.name):e&&0<=e.indexOf(w.name)?t.removeAttribute(w.name):0<=w.value.indexOf("javascript:")?
t.removeAttribute(w.name):w.value.trim&&0==w.value.trim().indexOf("data:")&&t.removeAttribute(w.name))}for(u=t.childNodes.length-1;0<=u;u--)if(1==t.childNodes[u].nodeType)if(c&&0<=c.indexOf(t.childNodes[u].nodeName.toLowerCase()))t.removeChild(t.childNodes[u]);else if(q(t.childNodes[u]),!b||0>b.indexOf(t.childNodes[u].nodeName.toLowerCase())){for(var y=w=t.childNodes[u],B=w.childNodes.length-1;0<=B;B--)y=t.insertBefore(w.childNodes[B],y);t.removeChild(w)}};p=document.createElement("div");"object"==
typeof a&&1===a.nodeType?p.appendChild(a):p.innerHTML=a;q(p);return m?a.innerHTML:p},inlineCss:function(a,b,c,d,e){d||=function(m){m=m.tagName.toLowerCase();return 0>"br strong i b u hr center".split(" ").indexOf(m)};if(!e){e=nabu.utils.elements.cssRules(c);var g=[];e.forEach(function(m){for(var p=0,q=0,t=[],u=m.selectorText,w=0;w<m.selectorText.length;w++)"("==u.charAt(w)?p++:")"==u.charAt(w)?p--:","==u.charAt(w)&&0==p&&(t.push(u.substring(q,w)),q=w+1);t.push(u.substring(q,u.length));t.forEach(function(y){y.trim()&&
g.push({selectorText:y,cssText:m.cssText})})});e=g}var k=function(m){var p=0;m=m.split(/[\s]*,[\s]*/);for(var q=0;q<m.length;q++)m[q].length>p&&(p=m[q].length);return p};(function(){var m=[],p=[];e.forEach(function(q){try{for(var t=document.body.querySelectorAll(q.selectorText),u=0;u<t.length;u++)if(1==t.item(u).nodeType&&t.item(u).hasAttribute&&!t.item(u).hasAttribute("original-style")){var w=m.indexOf(t.item(u));0>w&&(w=m.length,m.push(t.item(u)),p.push([]));p[w].push({selectorText:q.selectorText,
cssText:q.cssText})}}catch(y){console.info("Failed to run selector",q.selectorText,y)}});m.forEach(function(q,t){if(q.hasAttribute){p[t].sort(function(y,B){return k(y.selectorText)-k(B.selectorText)});for(var u="",w=0;w<p[t].length;w++)""!=u&&(u+=";"),u+=p[t][w].cssText.replace(/.*\{[\s]*(.*)[\s]*\}.*/,"$1");q.hasAttribute("original-style")||q.setAttribute("original-style",q.getAttribute("style")?q.getAttribute("style"):" ");q.getAttribute("original-style")&&""!=q.getAttribute("original-style").trim()&&
(u=q.getAttribute("original-style")+";"+u);q.setAttribute("style",u)}else console.log("skipping",typeof q,q)})})()},cssRules:function(a){for(var b=[],c=document.styleSheets,d=0;d<c.length;d++)try{for(var e=c.item(d).rules||c.item(d).cssRules,g=0;g<e.length;g++){var k=e.item(g);if(a&&k.media){for(var m=!1,p=0;p<k.media.length;p++)if(k.media.item(p).toString()==a){m=!0;break}if(m){var q=k.rules||k.cssRules;if(!q){var t=document.createElement("style");t.setAttribute("type","text/css");t.innerHTML=k.cssText.replace(/@media.*?\{[\s]*(.*)[\s]*\}[\s]*/,
"$1");document.head.appendChild(t);q=document.styleSheets[document.styleSheets.length-1].cssRules;document.head.removeChild(t)}if(q)for(m=0;m<q.length;m++)q.item(m).selectorText&&b.push(q.item(m))}}else a||k.selectorText&&b.push(k)}}catch(u){}return b},css:function(a,b){var c=[],d=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;if(d)for(var e=b.length-1;0<=e;e--)try{d.call(a,b[e].selectorText)&&c.push({selector:b[e].selectorText,rule:b[e].cssText})}catch(k){b.splice(e,
1)}var g=function(k){var m=0;k=k.split(/[\s]*,[\s]*/);for(var p=0;p<k.length;p++)d.call(a,k[p])&&k[p].length>m&&(m=k[p].length);return m};c.sort(function(k,m){return g(k.selector)-g(m.selector)});return c.map(function(k){return k.rule})}};nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.dates={dayOfWeek:function(a){a=a.getDay()-1;0>a&&(a=6);return a},months:function(){var a=[];a.push("%{date::January}");a.push("%{date::February}");a.push("%{date::March}");a.push("%{date::April}");a.push("%{date::May}");a.push("%{date::June}");a.push("%{date::July}");a.push("%{date::August}");a.push("%{date::September}");a.push("%{date::October}");a.push("%{date::November}");a.push("%{date::December}");return a},days:function(){var a=[];a.push("%{date::Monday}");a.push("%{date::Tuesday}");
a.push("%{date::Wednesday}");a.push("%{date::Thursday}");a.push("%{date::Friday}");a.push("%{date::Saturday}");a.push("%{date::Sunday}");return a},addDuration:function(a,b){var c=a;a=0==c.indexOf("-")?-1:1;0>a&&(c=c.substring(1));b=b?new Date(b.getTime()):new Date;b.setMilliseconds(0);c=c.substring(1);c=c.split("T");var d=c[0].indexOf("Y");0<=d&&(b.setYear(b.getFullYear()+a*parseInt(c[0].substring(0,d))),c[0]=c[0].substring(d+1));d=c[0].indexOf("M");0<=d&&(b.setMonth(b.getMonth()+a*parseInt(c[0].substring(0,
d))),c[0]=c[0].substring(d+1));d=c[0].indexOf("D");0<=d&&(b.setDate(b.getDate()+a*parseInt(c[0].substring(0,d))),c[0]=c[0].substring(d+1));2<=c.length&&(d=c[1].indexOf("H"),0<=d&&(b.setHours(b.getHours()+a*parseInt(c[1].substring(0,d))),c[1]=c[1].substring(d+1)),d=c[1].indexOf("M"),0<=d&&(b.setMinutes(b.getMinutes()+a*parseInt(c[1].substring(0,d))),c[1]=c[1].substring(d+1)),d=c[1].indexOf("S"),0<=d&&(b.setSeconds(b.getSeconds()+a*parseInt(c[1].substring(0,d))),c[1]=c[1].substring(d+1)));return b}};
nabu||={};nabu.utils||(nabu.utils={});nabu.utils.gtin={validate:function(a,b,c){var d=function(e){return 0==(e.substring(0,e.length-1).split(/\B/).reduce(function(g,k,m){return g+(0==(e.toString().length-m)%2?3:1)*k},0)%10+parseInt(e.substring(e.length-1,e.length)))%10};return function(e){e=null!=c?c:"";return(new RegExp(e+"[0-9]{"+(b-e.length)+"}")).test(a)}(a)&&d(a)}};nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.jwt={parse:function(a){a=a.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");a=decodeURIComponent(atob(a).split("").map(function(b){return"%"+("00"+b.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(a)}};nabu||={};nabu.services||(nabu.services={});
nabu.services.SwaggerClient=function(a){var b=this;this.swagger=null;this.operations={};this.secure=!1;this.host=null;this.executor=a.executor;this.normalize=a.normalize;this.parseError=a.parseError;this.rememberHandler=a.remember;this.remembering=!1;this.rememberPromise=null;this.definitionProcessors=[];this.language=null;this.bearer=a.bearer;this.toggledFeatures=[];this.geoPosition=null;this.offlineHandler=a.offlineHandler;this.requestEnrichers=[];application.configuration.requestEnrichers&&nabu.utils.arrays.merge(b.requestEnrichers,
application.configuration.requestEnrichers);if(!this.executor)if(nabu.utils&&nabu.utils.ajax)this.executor=function(c){var d=b.language;d||=application&&application.configuration&&"unavailable"!=application.configuration.applicationLanguage?application.configuration.applicationLanguage:null;d&&(c.language=d);var e=new nabu.utils.promise;c.map&&e.map(c.map);c.progress=e.onprogress;nabu.utils.ajax(c).then(function(g){var k=g,m=g.getResponseHeader("Content-Type");m&&0<=m.indexOf("application/json")?
(g=JSON.parse(g.responseText),c.definition&&(g=nabu.utils.schema.json.normalize(c.definition,g,b.definition.bind(b),!0,b.normalize))):g=m&&0<=m.indexOf("text/html")?g.responseText:204==g.status?null:"blob"==g.responseType?g.response:g.responseText?g.responseText:null;c.$$rawMapper&&(g=c.$$rawMapper(g,k));e.resolve(g)},function(g){502!=g.status&&503!=g.status||!b.offlineHandler||b.offlineHandler(g);var k=401==g.status;if(b.parseError&&(!c||"blob"!=c.responseType)){var m=g.getResponseHeader("Content-Type");
m&&(0<=m.indexOf("application/json")||0<=m.indexOf("application/problem+json"))&&(g=JSON.parse(g.responseText))}var p=function(){c.remember=!0;b.bearer&&(c.bearer=b.bearer);b.executor(c).then(function(t){e.resolve(t)},function(t){e.reject(t)})},q=function(){e.reject(g)};!k||c.remember||!b.rememberHandler||b.remembering||c.$$skipRemember?k&&!c.remember&&b.remembering&&!c.$$skipRemember?b.rememberPromise.then(p,q):e.reject(g):(b.remembering=!0,b.rememberPromise=new nabu.utils.promise,b.rememberHandler().then(function(){b.rememberPromise.resolve();
b.remembering=!1;p()},function(t){b.rememberPromise.resolve();b.remembering=!1;q(t)}))});return e};else throw"No executor";this.remember=function(){if(b.rememberHandler)return b.remembering=!0,b.rememberPromise=new nabu.utils.promise,b.rememberHandler().then(function(){b.rememberPromise.resolve();b.remembering=!1},function(){b.rememberPromise.resolve();b.remembering=!1});var c=new nabu.utils.promise;c.reject();return c};this.loadDefinition=function(c){this.swagger="string"==typeof c?JSON.parse(c):
c;if("2.0"!=this.swagger.swagger)throw"Only swagger 2.0 is currently supported";this.operations={};this.swagger&&this.swagger.paths&&Object.keys(b.swagger.paths).forEach(function(d){Object.keys(b.swagger.paths[d]).forEach(function(e){var g=b.swagger.paths[d][e];b.operations[g.operationId]={id:g.operationId,parameters:g.parameters,path:d,method:e,responses:g.responses,consumes:g.consumes,produces:g.produces,security:g.security,tags:g.tags,summary:g.summary};Object.keys(b.swagger.paths[d][e]).forEach(function(k){0==
k.indexOf("x-")&&(b.operations[g.operationId][k]=b.swagger.paths[d][e][k])})})});this.secure=0<=this.swagger.schemes.indexOf("https");this.host=this.swagger.host&&a.useHost?(this.secure?"https://":"http://")+this.swagger.host:null;for(c=0;c<this.definitionProcessors.length;c++)this.definitionProcessors[c](b)};this.addDefinitionProcessor=function(c){Object.keys(this.operations).length&&c(b);this.definitionProcessors.push(c)};a.definition&&this.loadDefinition(a.definition);this.operation=function(c){return b.operations[c]};
this.parameters=function(c,d){if(!b.operations[c])throw"Unknown operation: "+c;var e=b.operations[c],g=e.path;b.swagger.basePath&&"/"!=b.swagger.basePath&&(g=b.swagger.basePath+("/"==g.substring(0,1)?"":"/")+g);"/"!=g.substring(0,1)&&(g="/"+g);for(var k={},m={},p=null,q={},t=0;t<e.parameters.length;t++){if(e.parameters[t].required&&"header"!=e.parameters[t].in&&(!d||"undefined"==typeof d[e.parameters[t].name]||null==d[e.parameters[t].name]))throw"Missing required parameter for "+c+": "+e.parameters[t].name;
if(d&&d.hasOwnProperty(e.parameters[t].name)){var u=d[e.parameters[t].name];e.parameters[t].schema?u=this.format(e.parameters[t].schema,u):e.parameters[t].type&&(u=this.format(e.parameters[t],u));if(u instanceof Array){var w=e.parameters[t].collectionFormat?e.parameters[t].collectionFormat:"csv";if("multi"!=w){for(var y="",B=0;B<u.length;B++){if(0<y.length)if("csv"==w)y+=",";else if("ssv"==w)y+=" ";else if("tsv"==w)y+="\t";else if("pipes"==w)y+="|";else throw"Unsupported collection format: "+w;y+=
encodeURIComponent(u[B])}u=y}}if("path"==e.parameters[t].in)g=g.replace(new RegExp("{[\\s]*"+e.parameters[t].name+"[^}]*}"),u),q[e.parameters[t].name]=u;else if(null!=u&&""!==u&&"undefined"!=typeof u)if("query"==e.parameters[t].in)null!=u&&(k[e.parameters[t].name]=u);else if("header"==e.parameters[t].in)null!=u&&(m[e.parameters[t].name]=u);else if("body"==e.parameters[t].in)p=u;else throw"Invalid 'in': "+e.parameters[t].in;}}Object.keys(k).forEach(function(F){if(k[F]instanceof Array)for(var C=0;C<
k[F].length;C++)null!=k[F][C]&&(g+=0<=g.indexOf("?")?"\x26":"?",g+=encodeURIComponent(F)+"\x3d"+encodeURIComponent(k[F][C]));else null!=k[F]&&(g+=0<=g.indexOf("?")?"\x26":"?",g+=encodeURIComponent(F)+"\x3d"+encodeURIComponent(k[F]))});(t=e.responses&&e.responses[200]?e.responses[200].schema:null)&&t.$ref&&(t=this.definition(t.$ref));y={method:e.method,host:b.host,url:g,data:p,headers:m,definition:t,path:q,query:k};b.bearer&&(y.bearer=b.bearer);b.geoPosition&&(y.headers["Geo-Position"]=b.geoPosition.latitude+
";"+b.geoPosition.longitude);b.requestEnrichers.forEach(function(F){F(y)});e.consumes&&1==e.consumes.length&&"application/octet-stream"==e.consumes[0]&&(y.contentType="application/octet-stream");b.toggledFeatures.length&&(y.headers.Feature="",b.toggledFeatures.forEach(function(F){""!=y.headers.Feature&&(y.headers.Feature+=";");y.headers.Feature+=F.name+"\x3d"+(1==F.enabled)}));application&&application.configuration&&application.configuration.development&&(y.headers["X-Service-Id"]=c);d&&d.$serviceContext&&
"default"!=d.$serviceContext&&(y.headers["X-Service-Context"]=d.$serviceContext);d&&d.$accept&&(y.headers.Accept=d.$accept);return y};this.execute=function(c,d,e,g){var k=b.operations[c];if(!k)throw"Can not resolve operation: "+c;if(!k.hasOwnProperty("isBinary")){var m=!1;if(k.responses["200"]){var p=k.responses["200"];p&&p.schema&&(p=b.resolve(p.schema))&&(m="string"==p.type&&"binary"==p.format)}k.isBinary=m}if(k.executor)return k.executor(d,e);c=b.parameters(c,d);e&&(c.map=e);null!=g&&(c.async=
g);d&&d.$$rawMapper&&(c.$$rawMapper=d.$$rawMapper);d&&d.$$skipRemember&&(c.$$skipRemember=d.$$skipRemember);k.isBinary?c.responseType="blob":d&&d.$responseType&&(c.responseType=d.$responseType);return b.executor(c)};this.format=function(c,d){c.$ref&&(c=this.definition(c.$ref));return nabu.utils.schema.json.format(c,d,b.definition.bind(b))};this.definition=function(c){0==c.indexOf("#/definitions/")&&(c=c.substring(14));var d=this.swagger.definitions[c];if(!d)throw"Could not find definition: "+c;return d};
this.resolve=function(c,d){if(!d)return this.resolve(c,{});"string"==typeof c&&(c=this.definition(c));var e=this;if(c.schema&&c.schema.$ref)c=nabu.utils.objects.deepClone(c),d[c.schema.$ref]||(d[c.schema.$ref]=this.resolve(this.definition(c.schema.$ref),d)),c.schema=d[c.schema.$ref];else if(c.items&&c.items.$ref)c=nabu.utils.objects.deepClone(c),d[c.items.$ref]||(d[c.items.$ref]=this.resolve(this.definition(c.items.$ref),d)),c.items=d[c.items.$ref];else if(c.items&&c.items.properties)c=nabu.utils.objects.deepClone(c),
Object.keys(c.items.properties).map(function(g){c.items.properties[g]=e.resolve(c.items.properties[g],d)});else{if(c.$ref)return d[c.$ref]||(d[c.$ref]=this.resolve(this.definition(c.$ref),d)),d[c.$ref];c.properties&&(c=nabu.utils.objects.deepClone(c),Object.keys(c.properties).map(function(g){c.properties[g]=e.resolve(c.properties[g],d)}))}return c};return this};
nabu.services.SwaggerBatchClient=function(a){var b=this;this.clients=[];for(var c=0;c<a.swaggers.length;c++)this.clients.push(new nabu.services.SwaggerClient({definition:a.swaggers[c],executor:a.executor}));this.execute=function(d,e){for(var g=0;g<b.clients.length;g++)if(b.clients[g].operations[d])return b.clients[g].execute(d,e);throw"Unknown operation: "+d;};this.parameters=function(d,e){for(var g=0;g<b.clients.length;g++)if(b.clients[g].operations[d])return b.clients[g].parameters(d,e);throw"Unknown operation: "+
d;}};nabu||={};nabu.utils||(nabu.utils={});nabu.handlers||(nabu.handlers={});nabu.handlers.ajax={error:function(a){0!=a.status&&console.log("Could not fullfill ajax request",a)},success:function(a){a.target&&(document.getElementById(a.target).innerHTML=a.responseText)}};
nabu.utils.ajax=function(a){var b=function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(p){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(q){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){return new ActiveXObject("Msxml2.XMLHTTP.3.0")}}}throw"Could not get request";}();a.responseType&&(b.responseType=a.responseType);if(!a.url)throw"Could not find url";if(a.host){var c=a.host;0>c.indexOf("/",c.length-1)&&(c+=
"/");"/"==a.url.substring(0,1)?a.url=c+a.url.substring(1):a.url=c+a.url}a.method=a.method?a.method.toUpperCase():"GET";if(a.parameters){c="";for(var d in a.parameters)c+=(""==c?"":"\x26")+encodeURIComponent(d)+"\x3d"+encodeURIComponent(a.parameters[d]);"GET"==a.method||a.data?a.url+="?"+c:a.data=c}null==a.async&&(a.async=!0);a.user?b.open(a.method.toUpperCase(),a.url,a.async,a.user,a.pass):b.open(a.method.toUpperCase(),a.url,a.async);c=!1;if(a.headers)for(d in a.headers)b.setRequestHeader(d,a.headers[d]),
"ACCEPT"==d.toUpperCase()&&(c=!0);a.target&&(b.target=a.target);var e=new nabu.utils.promise(a);d=null;if(d=a.progress?a.progress:e.onprogress)null==a.method||"GET"==a.method.toUpperCase()?b.onprogress=d:b.upload.onprogress=d;e.cancel(function(p){b.abort()});b.onreadystatechange=function(){switch(b.readyState){case 1:a.opened&&a.opened(b);break;case 2:a.sent&&a.sent(b);break;case 3:a.loading&&a.loading(b);break;case 4:200<=b.status&&300>b.status?(a.success?a.success(b):a.completed?a.completed(b):
nabu.handlers.ajax.success&&nabu.handlers.ajax.success(b),e.succeed(b)):(0==b.status?a.cancelled&&a.cancelled(b):a.error?a.error(b):a.completed?a.completed(b):nabu.handlers.ajax.error&&nabu.handlers.ajax.error(b),e.fail(b))}};c||b.setRequestHeader("Accept","application/json");var g=[];d=null;if("POST"==a.method.toUpperCase()||"PUT"==a.method.toUpperCase()||"DELETE"==a.method.toUpperCase()||"PATCH"==a.method.toUpperCase()){if(!a.data||"object"!=typeof a.data||a.data instanceof File||a.data instanceof
Blob)a.data instanceof Blob&&(a.data.name&&(b.setRequestHeader("Content-Disposition","attachment; filename\x3d"+a.data.name),a.contentType&&"application/octet-stream"!=a.contentType||(a.data.name.match(/.*\.png/i)?a.contentType="image/png":a.data.name.match(/.*\.jpg/i)||a.data.name.match(/.*\.jpeg/i)?a.contentType="image/jpeg":a.data.type&&(a.contentType=a.data.type))),a.contentType||(a.contentType="application/octet-stream"));else{var k=function(p){return null!=p&&"object"==typeof p&&!(p instanceof
File)&&!(p instanceof Blob)&&!(p instanceof Date)&&!(p instanceof Array)},m=function(p){var q=Object.keys(p);q.filter(function(t){return p[t]instanceof Blob||p[t]instanceof File}).map(function(t){var u=new FileReader;u.readAsDataURL(p[t]);var w=new nabu.utils.promise;g.push(w);u.onload=function(){var y=u.result,B=y.indexOf(",");p[t]=y.substring(B+1);w.resolve()}});q.forEach(function(t){p[t]instanceof Array&&p[t].length?p[t].forEach(function(u){k(u)&&m(u)}):k(p[t])&&m(p[t])})};m(a.data);g.length&&
(d=new nabu.utils.promises(g));null!=d?d.then(function(){a.data=JSON.stringify(a.data)}):a.data=JSON.stringify(a.data);a.contentType="application/json"}!a.contentType&&a.data&&(a.contentType="application/x-www-form-urlencoded");a.contentType&&(b.setRequestHeader("Content-Type",a.contentType),a.binary||"image/"==a.contentType.substring(0,6)&&!(a.data instanceof Blob))&&(a.data=nabu.utils.binary.blob(a.data,a.contentType))}else a.data=null;a.language&&b.setRequestHeader("Accept-Language",a.language);
a.bearer&&b.setRequestHeader("Authorization","Bearer "+a.bearer);null!=d?d.then(function(){b.send(a.data?a.data:null)}):b.send(a.data?a.data:null);return e};nabu.utils.binary={blob:function(a,b,c){b=b?b:"application/octet-stream";c=c?c:512;for(var d=[],e=0;e<a.length;e+=c){for(var g=a.slice(e,Math.min(e+c,a.length)),k=Array(g.length),m=0;m<g.length;m++)k[m]=g.charCodeAt(m);d.push(new Uint8Array(k))}return new Blob(d,{type:b})}};nabu||={};nabu.services||(nabu.services={});nabu.utils||(nabu.utils={});
nabu.services.Router=function(a){var b=this;this.defaultAnchor=a.defaultAnchor?a.defaultAnchor:"main";this.useHash=a.useHash?!0:!1;this.routes=[];this.enter=a.enter?a.enter:null;this.unknown=a.unknown?a.unknown:null;this.authorizer=a.authorizer?a.authorizer:null;this.chosen=a.chosen?a.chosen:null;this.useParents=a.useParents?!0:!1;this.previousUrl=null;this.changingHash=!1;this.initials=[];this.parents=[];this.urlRewriter=a.urlRewriter;window.addEventListener("popstate",function(c){var d=(c=c.state)?
c.alias:null,e=c?c.anchor:null;if(d||!b.initials.length){var g=b.initials.pop();d?g&&!b.useParents?b.routeAll(d,c?c.parameters:null,e,!1):b.route(d,c?c.parameters:null,e,!1,!1,!0):b.routeInitial(e,c?c.parameters:null,!0)}},!1);this.get=function(c){for(var d=this.sort(),e=0;e<d.length;e++)if(d[e].alias==c)return d[e];return null};this.list=function(c){return this.sort()};this.route=function(c,d,e,g,k,m,p){var q=!e;e||(e=b.defaultAnchor);for(var t=null,u=b.sort(),w=0;w<u.length;w++)if(u[w].alias==c){t=
u[w];break}null==t&&b.unknown&&(t=b.unknown(c,d,e));if(null==t)throw"Unknown route: "+c;if(b.authorizer){u=b.authorizer(e,t,d);if("boolean"==typeof u&&!u)return!1;if("object"==typeof u&&u)return b.route(u.alias,u.parameters,u.anchor?u.anchor:q?null:e,"undefined"==typeof u.mask?g:u.mask)}b.useParents&&null!=t.parent&&q&&(u=b.get(t.parent))&&u.defaultAnchor&&(e=u.defaultAnchor);u=t.defaultAnchor&&!1;var y=w=null;if(b.useParents&&!p){p=t.parent;u&&(p=t.alias);if(!p&&(k||!g&&t.url)){var B=b.getInitial(e,
d,g);B&&B.route.alias!=c?p=B.route.alias:(e="body",b.parents.splice(0))}if(p){if(c=this.routeParent(p,d),B=c.anchor,w=c.url,y=c.enter,q&&(e=B),u)return b.updateUrl(p,c.url,d,t.query,e),null==y&&(y=new nabu.utils.promise,y.resolve()),y}else q&&0<b.parents.length&&b.parents[b.parents.length-1].defaultAnchor?e=b.parents[b.parents.length-1].defaultAnchor:q&&0==b.parents.length&&(e="body")}b.chosen&&((q=b.chosen(e,t,d))&&q.route&&(t=q.route),q&&q.parameters&&(d=q.parameters),q&&"undefined"!=typeof q.mask&&
(g=q.mask));q=t.enter(e,d,g,y);null!=b.enter&&b.enter(e,t,d,q,g);if(!t.url||g||k||m||t.initial)k||m||t.initial?k&&b.updateState(t.alias,d,t.query,e):b.updateState(t.alias,d,t.query,e);else{var F=[];t.query&&nabu.utils.arrays.merge(F,t.query);g=null==w?-1:w.indexOf("?");0<=g&&(w.substring(g+1).split("\x26").forEach(function(A){A=A.split("\x3d");2==A.length&&(0>F.indexOf(A[0])&&F.push(A[0]),d.hasOwnProperty(A[0])||(d[A[0]]=A[1]))}),w=w.substring(0,g));b.updateUrl(t.alias,null==w?t.url:w.replace(/[/]+$/,
"")+"/"+t.url.replace(/^[/]+/,""),d,F,e)}if(t.defaultAnchor&&t.url&&!t.initial&&!u){e=t;var C=function(A){var O=A.url?A.url:"";A.parent&&(O=C(b.get(A.parent))+"/"+O);return O.replace(/[/]{2,}/g,"/")};t=this.localizeUrl(this.templateUrl(C(e),d,e.query));e=nabu.utils.objects.clone(e);e.renderedUrl=t;b.parents.push(e)}b.initials.push(null);return q};this.routeParent=function(c,d){var e=this.get(c);if(!e)throw"Could not find parent route: "+c;if(e.query){var g=b.getQueryParameters(e.query);nabu.utils.objects.merge(g,
d);d=g}g=!1;for(var k=this.parents.length-1;0<=k;k--)if(this.parents[k].alias==c){k<this.parents.length-1&&this.parents.splice(k+1);g=!0;break}c=null;var m=function(){for(var t=b.parents.length-1;0<=t;t--)if(b.parents[t].renderedUrl)return b.parents[t].renderedUrl;return null};k=m();var p=function(t){var u=t.url?t.url:"";t.parent&&(u=p(b.get(t.parent))+"/"+u);return u.replace(/[/]{2,}/g,"/")};if(e.url&&!e.initial){var q=this.localizeUrl(this.templateUrl(p(e),d,e.query));g&&q!=k&&(this.parents.splice(this.parents.length-
1,1),g=!1,k=m())}if(!g){(g=null!=e.parent?b.routeParent(e.parent,d):null)&&(k=m());m=null==g?"body":g.anchor;"body"==m&&b.parents.splice(0);try{c=e.enter(m,d,!0,g?g.enter:null),e.url&&!e.initial&&(e=nabu.utils.objects.clone(e),q=this.localizeUrl(this.templateUrl(e.url,d,e.query)),k=null!=k?k.replace(/[/]+$/,"")+"/"+q.replace(/^[/]+/,""):q,e.renderedUrl=k),b.parents.push(e)}catch(t){throw"body"==m||document.querySelector("#"+m)||console.log("The anchor '"+m+"' is unavailable for routing parent '"+
e.alias+"', parents can currently not be nested in asynchronous grandparents, check if parent '"+e.parent+"' has an asynchronous action"),t;}}return{anchor:e.defaultAnchor?e.defaultAnchor:b.defaultAnchor,url:k,enter:c}};this.template=function(c,d){c=this.findByAlias(c,d,null,!1);if(b.useParents){for(var e=null,g=c;g;)if(g.url&&(e=g.url+(null==e?"":"/"+e)),g.parent)g=b.get(g.parent);else break;return e?this.templateUrl(e,d,c.query):null}return c&&c.url?this.templateUrl(c.url,d,c.query):null};this.bookmark=
function(c,d,e){window.history&&(d||={},window.history.pushState({alias:c,anchor:e,parameters:d},c,b.template(c,d)),b.previousUrl=b.getUrl())};this.templateUrl=function(c,d,e){for(var g in d)c=c.replace(new RegExp("{[s]*"+g.replace("$","\\$")+"[s]*:[^}]+}"),d[g]).replace(new RegExp("{[s]*"+g.replace("$","\\$")+"[s]*}"),d[g]);c=c.replace(/[\/]{2,}/,"/");if(e&&d){g=!0;for(var k=0;k<e.length;k++){var m=d[e[k]];"undefined"!=typeof m&&null!=m&&(g?(c+="?",g=!1):c+="\x26",c+=encodeURIComponent(e[k])+"\x3d"+
encodeURIComponent(d[e[k]]))}}this.urlRewriter&&this.urlRewriter.outgoing&&(c=this.urlRewriter.outgoing(c));c=c.replace(/\{[^}]+}/,"default");return(b.useHash&&"#"!=c.substring(0,1)?"#"+c:(application&&application.configuration?application.configuration.root:"/")+c.replace(/^[/]+/,"")).replace(/[/]{2,}/,"/")};this.getUrl=function(){var c=b.useHash?window.location.hash:window.location.pathname+(window.location.search?window.location.search:"");b.useHash&&"#"!=c.substring(0,1)&&(c="#"+c);return c?c:
"/"};this.updateUrl=function(c,d,e,g,k){d=b.templateUrl(d,e,g);if(window.history&&d!=b.getUrl()){e||={};try{window.history.pushState({alias:c,anchor:k,parameters:e},c,d)}catch(m){}b.previousUrl=b.getUrl()}};this.updateState=function(c,d,e,g){if("string"==typeof g)try{window.history.pushState({alias:c,anchor:g,parameters:d},c,b.getUrl())}catch(k){}};this.sorted=!1;this.sort=function(){this.sorted||(this.sorted=!0,this.routes.sort(function(c,d){return("undefined"==typeof d.priority?0:d.priority)-("undefined"==
typeof c.priority?0:c.priority)}));return this.routes};this.getPath=function(){var c;(c=b.useHash?window.location.hash&&1<window.location.hash.length?window.location.hash.substring(1):"/":b.localizeUrl(window.location.pathname?window.location.pathname:"/"))||(c="/");return c};this.getQueryParameters=function(c){var d=this.getPath(),e=d.indexOf("?");d=(0<=e?d.substring(e):window.location.search).substring(1).split("\x26");e={};for(var g=0;g<d.length;g++){var k=d[g].indexOf("\x3d");if(0<=k){var m=decodeURIComponent(d[g].substring(0,
k));k=decodeURIComponent(d[g].substring(k+1))}else m=decodeURIComponent(d[g]),k=null;d[g].split("\x3d");0<=c.indexOf(m)&&(null!=e[m]?(e[m]instanceof Array||(e[m]=[e[m]]),e[m].push(k)):e[m]=k)}return e};this.findRoute=function(c,d){c||="/";this.urlRewriter&&this.urlRewriter.incoming&&(c=this.urlRewriter.incoming(c));var e=null,g={},k=c.indexOf("?"),m=0<=k?c.substring(k):window.location.search;0<=k&&(c=c.substring(0,k));c=c.replace(/[/]+$/,"");""==c&&(c="/");k=this.sort();for(var p=0;p<k.length;p++)if(k[p].url&&
(!d&&!k[p].initial||d&&k[p].initial)){var q=k[p].url instanceof Array?k[p].url:[k[p].url],t=!1,u=null;if(this.useParents&&k[p].parent)for(var w=k[p];w&&w.parent;)(w=k.filter(function(A){return A.alias==w.parent})[0])&&w.url&&(u=null==u?w.url:w.url.replace(/[/]+$/,"")+"/"+u.replace(/^[/]+/,""));for(var y=0;y<q.length;y++){var B=q[y];null!=u&&(B=u.replace(/[/]+$/,"")+"/"+B.replace(/^[/]+/,""));var F="^"+B.replace(/\{[\s]*[^}:]+[\s]*:[\s]*([^}]+)[\s]*\}/g,"($1)").replace(/\{[\s]*[^}]+[\s]*\}/g,"([^/]+)")+
"$";F=F.replace(/\./g,"\\.");var C=c.match(F);if(C){e=B.match(F);if(!e)throw"Could not extract variables from: "+B;if(e.length!=C.length)throw"The amount of variables does not equal the amount of values";for(B=1;B<e.length;B++)g[e[B].substring(1,e[B].length-1).replace(/:.*$/,"")]=C[B];e=k[p];if(e.query)for(C=m.substring(1).split("\x26"),B=0;B<C.length;B++)q=C[B].indexOf("\x3d"),u=t=null,0<=q?(t=decodeURIComponent(C[B].substring(0,q)),u=decodeURIComponent(C[B].substring(q+1))):(t=decodeURIComponent(C[B]),
u=null),C[B].split("\x3d"),0<=e.query.indexOf(t)&&(null!=g[t]?(g[t]instanceof Array||(g[t]=[g[t]]),g[t].push(u)):g[t]=u);t=!0;break}}if(t)break}return null==e?null:{route:e,parameters:g}};this.localizeUrl=function(c){var d=application&&application.configuration&&application.configuration.root?application.configuration.root:"/";c.length>=d.length&&c.substring(0,d.length)==d?c="/"+c.substring(d.length):c.length==d.length-1&&c==d.substring(0,d.length-1)&&(c="/");return c};this.getInitial=function(c,
d,e){return b.useHash?b.findRoute(window.location.hash&&1<window.location.hash.length?window.location.hash.substring(1):"/",!0):b.findRoute(b.localizeUrl(window.location.pathname?window.location.pathname:"/"),!0)};this.routeInitial=function(c,d,e){var g=b.findRoute(b.getPath());if(b.useParents)return b.route(g?g.route.alias:"unknown",g?g.parameters:d,c,e,!0);var k=b.getInitial(c,d,e);return b.routePage(k,g,d,c,e)};this.routeAll=function(c,d,e,g){for(var k=null,m=null,p=this.sort(),q=0;q<p.length;q++)p[q].alias==
c?p[q].initial&&!k?k=p[q]:p[q].initial||m||(m=p[q]):p[q].initial&&!k&&c.match(p[q].alias)&&(k=p[q]);b.routePage(null==k?null:{route:k,parameters:d},null==m?null:{route:m,parameters:d},d,e,g,!0)};this.routePage=function(c,d,e,g,k,m){g||(g=b.defaultAnchor);if(null==c)for(var p=0;p<b.routes.length;p++)if(b.routes[p].initial&&!b.routes[p].url){c={route:b.routes[p],parameters:b.routes[p].parameters};break}if(null!=c){if(b.authorizer&&(p=b.authorizer("body",c.route,c.parameters,null,null),"object"==typeof p&&
p)){c=b.findByAlias(p.alias,p.parameters,"body",!0);if(null==c)throw"Could not find initial route: "+p.alias;c={route:c,parameters:p.parameters}}b.initials.push(c);c.route.enter("body",c.parameters,null,null)}!d&&b.unknown&&(c=b.unknown(null,e,g))&&(d={route:c,parameters:e});if(!d)throw"Unknown initial route";if(null!=d){if(b.authorizer&&(p=b.authorizer(g,d.route,d.parameters,null,null),"object"==typeof p&&p)){c=b.findByAlias(p.alias,p.parameters,p.anchor?p.anchor:g,!1);if(null==c)throw"Could not find alternative route: "+
p.alias;d={route:c,parameters:p.parameters};k?b.updateState(c.alias,e):(!c.url||"undefined"!=typeof c.mask&&c.mask||b.updateUrl(c.alias,c.url,p.parameters),b.updateUrl(c.alias,c.url,e))}b.chosen&&((k=b.chosen(g,d.route,e?e:d.parameters,null,null))&&k.route&&(d.route=k.route),k&&k.parameters&&(e?e=k.parameters:d.parameters=k.parameters));k=d.route.enter(g,d.parameters,null,null);null!=b.enter&&(b.enter(g,d.route,e?e:d.parameters,null,null,k),m?b.updateUrl(d.route.alias,d.route.url,e):b.updateState(d.route.alias,
e?e:d.parameters,d.query,g));return k}return null};this.findByAlias=function(c,d,e,g){for(var k=null,m=0;m<b.routes.length;m++)if(b.routes[m].alias==c&&(g||!b.routes[m].initial)){k=b.routes[m];break}null==k&&b.unknown&&(k=b.unknown(c,d,e));return k};this.register=function(c){b.routes.push(c);return c};this.unregister=function(c){"string"==typeof c&&(c=b.routes.filter(function(e){return e.alias==c})[0]);if(c){var d=b.routes.indexOf(c);0<=d&&b.routes.splice(d,1)}};this.previousUrl=this.getUrl()};
nabu.utils.router={anchor:function(a){var b="object"===typeof a?a:document.getElementById(a);b||"body"!=a||(b=document.body);return b},self:function(a){for(;a&&!a.hasAttribute("route");)a=a.parentNode;return a}};nabu||={};nabu.services||(nabu.services={});
nabu.services.ServiceManager=function(){var a=this;this.$definitions=[];this.$instances=[];this.$promises={};this.$optionals={};for(var b=0;b<arguments.length;b++)this.$definitions.push(arguments[b]);this.$promise=function(c,d){a.$promises[c]||(a.$promises[c]=new nabu.utils.promise);d?a.$optionals.hasOwnProperty(c)||(a.$optionals[c]=!0):a.$optionals[c]=!1;return a.$promises[c]};this.$initialize=function(){var c=new nabu.utils.promise,d=function(){c.resolve(a)};this.$register(this.$definitions).then(d,
d);Object.keys(a.$optionals).forEach(function(e){1==a.$optionals[e]&&(console.log("resolving optional dependency to",e),a.$promise(e).resolve())});return c};this.$register=function(c,d,e){d||=a;c instanceof Array||(c=[c]);for(var g=[],k=function(y,B,F){var C=y.$initialize?y.$initialize():null;if(C)if(C.then){var A=!1;C.staged&&C.staged(function(O){O&&B&&(d[B]=O,a.$instances.push(O),A=!0)});C.then(function(O){O&&B?(O.$initialized=new Date,A||(d[B]=O,a.$instances.push(O)),F.resolve(O)):(a.$instances.push(y),
F.resolve(y))},function(O){F.reject(O)})}else B&&(d[B]=C,a.$instances.push(C),F.resolve(C));else d[B]=y,a.$instances.push(y),F.resolve(y)},m=0;m<c.length;m++)if(c[m]instanceof Function){var p=new c[m](a),q=c[m].name?c[m].name.substring(0,1).toLowerCase()+c[m].name.substring(1):null;p.$initialize&&k(p,q)}else for(var t=Object.keys(c[m]),u=0;u<t.length;u++){q=t[u].substring(0,1).toLowerCase()+t[u].substring(1);var w=(e?e+".":"")+q;c[m][t[u]]instanceof Function?(p=new c[m][t[u]](a),w=a.$promise(w),g.push(w),
w.then(function(y){y.$initialized=new Date}),k(p,q,w)):(d[q]={},g.push(this.$register([c[m][t[u]]],d[q],w)))}return new nabu.utils.promises(g)};this.$clear=function(){for(var c=[],d=0;d<this.$instances.length;d++)if(this.$instances[d].$initialized&&this.$instances[d].$clear){var e=this.$instances[d].$clear();this.$instances[d].$initialized=new Date;e&&e.then&&c.push(e)}return new nabu.utils.promises(c)};this.$switchLanguage=function(){for(var c=[],d=0;d<this.$instances.length;d++)if(this.$instances[d].$initialized&&
this.$instances[d].$switchLanguage){var e=this.$instances[d].$switchLanguage();this.$instances[d].$initialized=new Date;e&&e.then&&c.push(e)}return new nabu.utils.promises(c)}};nabu||={};nabu.utils||(nabu.utils={});nabu.services||(nabu.services={});nabu.utils.when=function(a){return new nabu.utils.promises(a)};nabu.utils.wait=function(a,b,c){var d=this;this.timer=setTimeout(c,b);this.cancel=function(){clearTimeout(d.timer)};a.then(this.cancel)};
nabu.utils.promise=function(a){var b=this;this.state=null;this.cancelHandlers=[];this.successHandlers=[];this.errorHandlers=[];this.progressHandlers=[];this.stagedHandlers=[];this.response=this.stagedResult=null;this.parameters=a;this.mapper=[];this.succeed=function(c){if(!b.state){if(b.mapper.length)for(var d=0;d<b.mapper.length;d++)c=b.mapper[d](c);b.response=c;b.state="success";for(d=0;d<b.successHandlers.length;d++)if(b.successHandlers[d]instanceof Function)b.successHandlers[d](c);else b.successHandlers[d].resolve&&
b.successHandlers[d].resolve(c)}};this.stage=function(c){if(!b.stagedResult){b.stagedResult=c;for(var d=0;d<b.stagedHandlers.length;d++)if(b.stagedHandlers[d]instanceof Function)b.stagedHandlers[d](response);else b.stagedHandlers[d].resolve&&b.stagedHandlers[d].resolve(c)}};this.staged=function(c){b.stagedHandlers.push(c);null!=b.stagedResult&&(c instanceof Function?c(b.stagedResult):c.resolve&&c.resolve(b.stagedResult));return b};this.resolve=function(c){b.succeed(c)};this.fail=function(c){if(!b.state){b.response=
c;b.state="error";for(var d=0;d<b.errorHandlers.length;d++)if(b.errorHandlers[d]instanceof Function)b.errorHandlers[d](c);else b.errorHandlers[d].reject&&b.errorHandlers[d].reject(c)}};this.reject=function(c){b.fail(c)};this.success=function(c){b.successHandlers.push(c);"success"==b.state&&(c instanceof Function?c(b.response):c.resolve&&c.resolve(b.response));return b};this.error=function(c){b.errorHandlers.push(c);"error"==b.state&&(c instanceof Function?c(b.response):c.reject&&c.reject(b.response));
return b};this.onprogress=function(c){if(b.progressHandlers)for(var d=0;d<b.progressHandlers.length;d++)b.progressHandlers[d](c,b.parameters)};this.progress=function(c){b.progressHandlers.push(c)};this.then=function(c,d,e,g){c&&b.success(c);d&&b.error(d);e&&b.progress(e);g&&b.cancelHandlers.push(g);return b};this.map=function(c){c instanceof Array?nabu.utils.arrays.merge(b.mapper,c):c instanceof Function&&b.mapper.push(c)};this.cancel=function(c){this.cancelHandlers.push(c)};this.abort=function(c){null==
this.state&&(this.successHandlers.splice(0),this.errorHandlers.splice(0),this.progressHandlers.splice(0),this.stagedHandlers.splice(0),this.cancelHandlers.forEach(function(d){d(b,c)}))}};
nabu.utils.promises=function(a){var b=this;this.promises=a?a:[];this.resolution=null;this.cancelHandlers=[];this.successHandlers=[];this.errorHandlers=[];this.progressHandlers=[];this.response=this.state=null;this.progressIndicators={};this.resolver=function(){if(null==b.state){for(var c=0,d=0,e=[],g=0;g<b.promises.length;g++)"success"==b.promises[g].state?(d++,e.push(b.promises[g].response)):"error"==b.promises[g].state&&(c++,e.push(b.promises[g].response));if(d==b.promises.length)for(b.response=
e,b.state="success",g=0;g<b.successHandlers.length;g++)if(b.successHandlers[g]instanceof Function)b.successHandlers[g](e);else b.successHandlers[g].resolve&&b.successHandlers[g].resolve(e);else if(d+c==b.promises.length)for(b.response=e,b.state="error",g=0;g<b.errorHandlers.length;g++)if(b.errorHandlers[g]instanceof Function)b.errorHandlers[g](e);else b.errorHandlers[g].reject&&b.errorHandlers[g].reject(e)}};this.onprogress=function(c,d){c.target&&(b.progressIndicators[c.target]=c,Object.values(b.progressIndicators).forEach(function(g){}));
if(b.progressHandlers)for(var e=0;e<b.progressHandlers.length;e++)b.progressHandlers[e](c,d)};for(a=0;a<this.promises.length;a++)this.promises[a].success(this.resolver).error(this.resolver).progress(this.onprogress);this.progress=function(c){b.progressHandlers.push(c)};this.success=function(c){b.successHandlers.push(c);"success"==b.state&&(c instanceof Function?c(b.response):c.resolve&&c.resolve(b.response));return b};this.error=function(c){b.errorHandlers.push(c);"error"==b.state&&(c instanceof Function?
c(b.response):c.reject&&c.reject(b.response));return b};this.then=function(c,d,e,g){c&&b.success(c);d&&b.error(d);e&&b.progress(e);g&&b.cancelHandlers.push(g);return b};this.cancel=function(c){this.cancelHandlers.push(c)};this.abort=function(c){null==this.state&&(this.successHandlers.splice(0),this.errorHandlers.splice(0),this.progressHandlers.splice(0),this.cancelHandlers.forEach(function(d){d(b,c)}),this.promises.forEach(function(d){d.abort()}))};this.resolver()};
nabu.services.Q=function(){this.defer=function(a,b){if(a&&"undefined"!=typeof b){var c=new nabu.utils.promise;c.stage(b);a.then(function(d){c.resolve(b)},c);return c}return new nabu.utils.promise};this.all=function(){for(var a=[],b=0;b<arguments.length;b++)if(arguments[b]instanceof Array)for(var c=0;c<arguments[b].length;c++)a.push(arguments[b][c]);else a.push(arguments[b]);return new nabu.utils.promises(a)};this.resolve=function(a){var b=this.defer();b.resolve(a);return b};this.reject=function(a){var b=
this.defer();b.reject(a);return b};this.wait=function(a,b,c){return new nabu.utils.wait(a,b,c)}};nabu||={};nabu.services||(nabu.services={});
nabu.services.Cookies=function(a){this.set=function(b,c,d,e){var g="";d&&(g=new Date,g.setTime(g.getTime()+864E5*d),g="; expires\x3d"+g.toUTCString());document.cookie=b+"\x3d"+c+g+"; path\x3d"+(application&&application.configuration?application.configuration.cookiePath:"/")+(e?";domain\x3d"+e:"")};this.get=function(b,c){b+="\x3d";for(var d=document.cookie.split(";"),e=0;e<d.length;e++){for(var g=d[e];" "==g.charAt(0);)g=g.substring(1,g.length);if(0==g.indexOf(b))return g.substring(b.length,g.length)}return c?
c:null};this.unset=function(b,c){this.set(b,"",-1,c)}};nabu||={};nabu.utils||(nabu.utils={});nabu.utils.misc||(nabu.utils.misc={});
nabu.utils.misc.BatchResolver=function(a,b,c,d,e){e||=50;c||=function(){return{}};var g=[],k=null;return function(m){var p=JSON.stringify(m),q=b(p);if(q)return q;k&&(clearTimeout(k),k=null);q=c(m);b(p,q);g.push(m);k=setTimeout(function(){var t=g.splice(0,g.length);a(t).then(function(u){var w=null;!u||u instanceof Array?w=u:Object.keys(u).map(function(B){u[B]instanceof Array&&(w=u[B])});if(w){d&&(t=w.map(d));for(var y=0;y<w.length;y++)b(t[y],w[y])}})},e);return q}};
Vue.directive("sticky-header",{bind:function(a,b){a.setAttribute("n-sticky-header","true");var c=document.body.scrollTop,d=a.getBoundingClientRect().height;a["$n-sticky-header-listener"]=function(e){0==d&&(d=a.getBoundingClientRect().height);a.style.top=document.body.scrollTop<=d||document.body.scrollTop<c?"0px":"-"+(b.value?b.value:d)+"px";c=document.body.scrollTop};window.addEventListener("scroll",a["$n-sticky-header-listener"])},unbind:function(a){a.removeAttribute("n-sticky-header");a["$n-sticky-header-listener"]&&
(console.log("Removing event listener"),window.removeEventListener("scroll",a["$n-sticky-header-listener"]))}});
Vue.directive("select-on",{bind:function(a,b){var c=a.__vue__?a.__vue__:a;c["$n-select-on-handler"]=function(d){if(d&&d.target)try{setTimeout(function(){d.target.select()},1)}catch(e){console.log("error selecting element content",e,d.target)}else console.warn("A valid DOM event should be provided as the first argument")};a.__vue__?c.$on(b.arg,c["$n-select-on-handler"]):a.addEventListener(b.arg,c["$n-select-on-handler"])},unbind:function(a,b){var c=a.__vue__?a.__vue__:a;c["$n-select-on-handler"]&&
(a.__vue__?c.$off(b.arg,c["$n-select-on-handler"]):a.removeEventListener(b.arg,c["$n-select-on-handler"]))}});
Vue.directive("auto-close",{bind:function(a,b){if(b.value){var c=b.modifiers?Object.keys(b.modifiers):null;a["$n-auto-close-listener"]=function(d){var e=d.target!=a&&!a.contains(d.target)&&document.body.contains(d.target),g=!1;if(!e&&a.contains(d.target)){var k=d.target,m="auto-close";for(c.length&&(m+="-"+c[0]);k!=a;){if(k.hasAttribute(m)&&"false"!=k.getAttribute(m)){g=e=!0;break}k=k.parentNode}}e&&b.value&&b.value(g,d)};window.addEventListener("click",a["$n-auto-close-listener"],!0)}},unbind:function(a){a["$n-auto-close-listener"]&&
window.removeEventListener("click",a["$n-auto-close-listener"],!0)}});nabu||={};nabu.tmp||(nabu.tmp={});nabu.tmp.timeouts={};
Vue.directive("timeout",{bind:function(a,b){var c=null;b.modifiers&&(c=Object.keys(b.modifiers));var d=600,e=null;if(c)for(var g=0;g<c.length;g++)c[g].match("[0-9]+")?d=new Number(c[g]):e=c[g];c=a.__vue__?a.__vue__:a;c["$n-timeout-handle"]=null;c["$n-timeout-handler"]=function(){null!=e?null!=nabu.tmp.timeouts[e]&&clearTimeout(nabu.tmp.timeouts[e]):null!=a["$n-timeout-handle"]&&clearTimeout(a["$n-timeout-handle"]);var k=setTimeout(function(){b.value()},d);null!=e?nabu.tmp.timeouts[e]=k:a["$n-timeout-handle"]=
k};a.__vue__?c.$on(b.arg,c["$n-timeout-handler"]):a.addEventListener(b.arg,c["$n-timeout-handler"])},unbind:function(a,b){var c=a.__vue__?a.__vue__:a;c["$n-timeout-handler"]&&(a.__vue__?c.$off(b.arg,c["$n-timeout-handler"]):a.removeEventListener(b.arg,c["$n-timeout-handler"]))}});
Vue.directive("css",{bind:function(a,b){b.value&&(a=b.value,a.$el&&(a=a.$el));var c=a.__vue__?a.__vue__:a,d=Object.keys(b.modifiers)[0];c["$n-css-handler"]=function(){a.classList.contains(d)?a.classList.remove(d):a.classList.add(d)};a.__vue__?c.$on(b.arg?b.arg:"click",c["$n-css-handler"]):c.addEventListener(b.arg?b.arg:"click",c["$n-css-handler"])},unbind:function(a,b){b.value&&(a=b.value);var c=a.__vue__?a.__vue__:a;c["$n-css-handler"]&&(a.__vue__?c.$off(b.arg,c["$n-css-handler"]):c.removeEventListener(b.arg,
c["$n-css-handler"]))}});
Vue.directive("action",{bind:function(a,b,c){var d=["click","hover","mouseover","mouseout"],e=function(g){a.setAttribute("disabled","disabled");if((g=b.value(g))&&g.then){var k=document.createElement("span");k.setAttribute("class","n-icon n-icon-spinner");k.setAttribute("style","display: inline-block; text-align: center");a.appendChild(k);var m=function(){a.removeAttribute("disabled");a.removeChild(k)};g.then(m,m)}else a.removeAttribute("disabled")};!b.arg||0<=d.indexOf(b.arg)?a.addEventListener(b.arg?
b.arg:"click",e):c.context.$on(b.arg,e)}});nabu||={};nabu.tmp||(nabu.tmp={});nabu.tmp.groups={};
Vue.directive("group",{bind:function(a,b){if(a=a.__vue__)if(b=b.arg?b.arg:b.value,"undefined"==typeof nabu.tmp.groups[b]&&(nabu.tmp.groups[b]=[]),0>nabu.tmp.groups[b].indexOf(a)){nabu.tmp.groups[b].push(a);a.$group=nabu.tmp.groups[b];for(var c=0;c<nabu.tmp.groups[b].length;c++)nabu.tmp.groups[b][c].$emit("$vue.group.added",a)}},update:function(a,b){if(a=a.__vue__){var c=!1;b=b.arg?b.arg:b.value;for(var d in nabu.tmp.groups){var e=nabu.tmp.groups[d].indexOf(a);if(0<=e)if(b==d)c=!0;else for(nabu.tmp.groups[d].splice(e,
1),e=0;e<nabu.tmp.groups[d].length;e++)nabu.tmp.groups[d][e].$emit("$vue.group.removed",a)}if(!c)for("undefined"==typeof nabu.tmp.groups[b]&&(nabu.tmp.groups[b]=[]),nabu.tmp.groups[b].push(a),a.$group=nabu.tmp.groups[b],e=0;e<nabu.tmp.groups[b].length;e++)nabu.tmp.groups[b][e].$emit("$vue.group.added",a)}},unbind:function(a,b){if(a=a.__vue__)for(var c in nabu.tmp.groups)if(b=nabu.tmp.groups[c].indexOf(a),0<=b)for(nabu.tmp.groups[c].splice(b,1),b=0;b<nabu.tmp.groups[c].length;b++)nabu.tmp.groups[c][b].$emit("$vue.group.removed",
a)}});Vue.mixin({beforeDestroy:function(){if(Object.keys(nabu.tmp.groups).length){var a=function(b){for(var c in nabu.tmp.groups){var d=nabu.tmp.groups[c].indexOf(b);if(0<=d)for(nabu.tmp.groups[c].splice(d,1),d=0;d<nabu.tmp.groups[c].length;d++)nabu.tmp.groups[c][d].$emit("$vue.group.removed",b)}for(c=0;c<b.$children.length;c++)a(b.$children[c])};a(this)}}});
Vue.directive("route-render",{inserted:function(a,b,c){Vue.nextTick(function(){var d=b.modifiers?Object.keys(b.modifiers):null,e={alias:b.arg?b.arg:b.value.alias,parameters:b.arg?b.value:b.value.parameters};if(e.alias){var g=c.context.$services.router.route(e.alias,e.parameters,a,!0);b.value&&b.value.created&&b.value.created(g);g&&g.then?g.then(function(k){a["n-route-component"]=k;if(d&&d.length)if(c.context[d[0]]instanceof Function)c.context[d[0]](k);else c.context.$refs[d[0]]=k;b.value&&b.value.mounted&&
b.value.mounted(k);var m;a:{for(m=a;m;)if((m=m.parentNode)&&m.__vue__){m=m.__vue__;break a}m=null}m&&m.$children?(m.$children.push(k),k.$parent=m):c.context.$children&&(c.context.$children.push(k),k.$parent=c.context);m&&m.$root?k.$root=m.$root:c.context.$root&&(k.$root=c.context.$root)}):b.value&&b.value.mounted&&b.value.mounted(g);g={alias:b.arg?b.arg:b.value.alias,parameters:function(k){var m={};Object.keys(k).forEach(function(p){"page"!=p&&"cell"!=p&&(m[p]=k[p])});return m}(b.arg?b.value:b.value.parameters)};
try{a["n-route-render-route-json"]=JSON.stringify(g)}catch(k){console.warn("Could not marshal route render parameters",k)}a["n-route-render-route"]=e}})},unbind:function(a,b,c){var d=function(e){for(var g=0;g<e.childNodes.length;g++)1==e.childNodes[g].nodeType&&d(e.childNodes[g]);e.__vue__&&e.__vue__.$destroy&&e.__vue__.$destroy()};d(a)},update:function(a,b,c){var d=["page","cell","component"],e=function(q){var t={};Object.keys(q).forEach(function(u){0>d.indexOf(u)&&(t[u]=q[u])});return t};if(a["n-route-render-route"]){var g=
b.modifiers?Object.keys(b.modifiers):null,k={alias:b.arg?b.arg:b.value.alias,parameters:b.arg?b.value:b.value.parameters};e={alias:b.arg?b.arg:b.value.alias,parameters:e(b.arg?b.value:b.value.parameters)};var m=null;try{m=JSON.stringify(e)}catch(q){console.warn("Could not marshal route render parameters",q)}if(null!=m&&a["n-route-render-route-json"]!=m){a["n-route-render-route-json"]=m;if((e=a["n-route-render-route"]&&a["n-route-render-route"].alias==k.alias)&&a["n-route-component"]&&a["n-route-component"].setRouteParameters&&
!a["n-route-component"].setRouteParameters(k.parameters))return null;e=e&&a["n-route-render-route"].parameters==k.parameters;if(!e&&a["n-route-render-route"]&&a["n-route-render-route"].parameters&&k.parameters){m=Object.keys(k.parameters);var p=Object.keys(a["n-route-render-route"].parameters);if(m.length==p.length)for(e=!0,p=0;p<m.length;p++)if(0>d.indexOf(m[p])&&a["n-route-render-route"].parameters[m[p]]!=k.parameters[m[p]]&&JSON.stringify(a["n-route-render-route"].parameters[m[p]])!=JSON.stringify(k.parameters[m[p]])){e=
!1;break}}e||(a["n-route-render-route"]=k,b.value.rerender&&!b.value.rerender())||(k=c.context.$services.router.route(k.alias,k.parameters,a,!0),b.value&&b.value.created&&b.value.created(k),k&&k.then?k.then(function(q){if(a["n-route-component"]){var t=a["n-route-component"];if(t.$parent&&t.$parent.$children){var u=t.$parent.$children.indexOf(t);0<=u&&t.$parent.$children.splice(u,1)}}a:{for(t=a;t;)if((t=t.parentNode)&&t.__vue__){t=t.__vue__;break a}t=null}t&&t.$children?(t.$children.push(q),q.$parent=
t):c.context.$children&&(c.context.$children.push(q),q.$parent=c.context);t&&t.$root?q.$root=t.$root:c.context.$root&&(q.$root=c.context.$root);a["n-route-component"]=q;if(g&&g.length)if(c.context[g[0]]instanceof Function)c.context[g[0]](q);else c.context.$refs[g[0]]=q;b.value.mounted&&b.value.mounted(q)}):b.value.mounted&&b.value.mounted(k))}}}});nabu||={};nabu.tmp||(nabu.tmp={});nabu.tmp.visibleElementListeners=[];nabu.tmp.visibleElementTimeout=null;
window.addEventListener("scroll",function(a){nabu.tmp.visibleElementTimeout&&(clearTimeout(nabu.tmp.visibleElementTimeout),nabu.tmp.visibleElementTimeout=null);nabu.tmp.visibleElementTimeout=setTimeout(function(){nabu.tmp.visibleElementListeners.map(function(b){var c=nabu.utils.elements.inViewport(b.element);c!=b.visible&&(b.visible=c,b.target&&(b.target.$visible=c),b.handler&&b.handler(c))})},100)},!0);
Vue.directive("visible",{bind:function(a,b){var c=a.__vue__,d={element:a,target:c,handler:b.value,visible:!1};nabu.tmp.visibleElementListeners.push(d);c&&Vue.set(c,"$visible",!1);Vue.nextTick(function(){d.visible=nabu.utils.elements.inViewport(a);d.visible&&(d.target&&(d.target.$visible=d.visible),d.handler&&d.handler(d.visible))})},unbind:function(a,b){(b=nabu.tmp.visibleElementListeners.filter(function(c){return c.element==a})[0])&&nabu.tmp.visibleElementListeners.splice(nabu.tmp.visibleElementListeners.indexOf(b),
1)}});
Vue.directive("content",function(a,b,c){var d=b.value,e=null;b.modifiers&&(e=Object.keys(b.modifiers));nabu.utils.elements.clear(a);b=function(){if(application&&application.services&&application.services.router)for(var w=a.querySelectorAll("a"),y=function(C){return function(A){var O=application.services.router.router.findRoute(C,!1);O&&application.services.router.route(O.route.alias,O.parameters);A.stopPropagation();A.preventDefault()}},B=0;B<w.length;B++){var F=w.item(B).getAttribute("href");F&&
0==F.indexOf("/")&&w.item(B).addEventListener("click",y(F))}};if(null!=d&&"undefined"!=typeof d){var g={};e&&0<=e.indexOf("parameterized")&&(g=d,d=d.value);if(null!=d&&"undefined"!=typeof d){var k=e&&0<=e.indexOf("compile")||g.compile,m=e&&0<=e.indexOf("sanitize")||g.sanitize,p=0<=e.indexOf("allowDataAttributes")||g.allowDataAttributes,q=0<=e.indexOf("allowFormElements")||g.allowFormElements,t=0<=e.indexOf("allowLinkIds")||g.allowLinkIds;p={allowDataAttributes:p,allowFormElements:q,allowLinkIds:t};
e&&0<=e.indexOf("plain")||g.plain?("string"!=typeof d&&(d=d.innerHTML?d.innerHTML:""+d),d=d.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/\n/g,"\x3cbr/\x3e").replace(/\t/g,"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;")):m&&(k||(d=nabu.utils.elements.sanitize(d,p)));if("string"==typeof d&&0==d.trim().length)a.appendChild(document.createTextNode(d));else{if(k){var u={};Object.keys(c.context.$props).map(function(w){"undefined"!==typeof c.context.$props[w]&&(u[w]=c.context.$props[w])});
Object.keys(c.context.$data).map(function(w){"undefined"!==typeof c.context.$data[w]&&(u[w]=c.context.$data[w])});d=new (Vue.extend({data:function(){return u},template:"\x3cdiv\x3e"+("string"==typeof d?d:d.innerHTML)+"\x3c/div\x3e"}));d.$mount();m&&nabu.utils.elements.sanitize(d.$el,p);e=null;for(g=d.$el.childNodes.length-1;0<=g;g--)e=null==e?a.appendChild(d.$el.childNodes[g]):a.insertBefore(d.$el.childNodes[g],e)}else d instanceof HTMLElement?a.appendChild(d):0<=d.indexOf("\x3c")?a.innerHTML=d:(e=
document.createElement("span"),e.innerHTML=d,a.appendChild(e));b()}}}});
Vue.directive("fixed-header",{bind:function(a,b){b=b.value;if(null==b||0!=b){var c=a.style.position,d=a.style.marginBottom;a.style.transition="position 0.3s linear, top 0.3s linear";var e=window.pageYOffset+a.getBoundingClientRect().top,g=a.getBoundingClientRect().height,k=document.createElement("div");k.setAttribute("class","fixed-header-spacer");var m=!1;a["$n-fixed-header-listener"]=function(p){!m&&a.parentNode&&(m=!0,a.parentNode.insertBefore(k,a));0==g&&(g=a.getBoundingClientRect().height);0==
e&&"fixed"!=a.style.position&&(e=window.pageYOffset+a.getBoundingClientRect().top);0>a.getBoundingClientRect().top&&"fixed"!=a.style.position?(k.style.height=g+"px",a.style.position="fixed",a.style.top="0px",a.style.marginBottom=g+"px",a.setAttribute("fixed","true")):"fixed"==a.style.position&&window.pageYOffset<e&&(k.style.height="0px",a.style.position=c,a.style.marginBottom=d,a.removeAttribute("fixed"))};window.addEventListener("scroll",a["$n-fixed-header-listener"])}},unbind:function(a){a["$n-fixed-header-listener"]&&
(console.log("Removing event listener"),window.removeEventListener("scroll",a["$n-fixed-header-listener"]))}});Vue.directive("focus",{inserted:function(a,b,c){("undefined"==typeof b.value||b.value)&&Vue.nextTick(function(){var d=a.getElementsByTagName("input");d.length||(d=a.getElementsByTagName("textarea"));d.length?d[0].focus():a.focus()})}});
Vue.directive("route",function(a,b,c){var d=b.arg?b.arg:b.value.alias,e=b.arg?b.value:b.value.parameters,g=c.context.$services.router.template(d,e),k=null;b.modifiers&&(k=Object.keys(b.modifiers));var m=0<=k.indexOf("all");m&&k.splice(k.indexOf("all"),1);k&&0<=k.indexOf("absolute")&&(g=(application&&application.configuration&&application.configuration.url?application.configuration.url:window.location.protocol+"//"+window.location.host)+g,k.splice(k.indexOf("absolute"),1));var p=!1;k&&0<=k.indexOf("mask")&&
(p=!0,k.splice(k.indexOf("mask"),1));var q=!1;"a"==a.tagName.toLowerCase()&&a.setAttribute("href",g);a.onclick=function(t){q||(t=null,k&&0<=k.indexOf("self")?t=nabu.utils.router.self(a):k&&k.length&&(t=k[0]),q=!0,m?c.context.$services.router.routeAll(d,e,t,p):c.context.$services.router.route(d,e,t,p),q=!1);return!1}});
Vue.directive("bubble",{bind:function(a,b,c){var d=b.arg?b.arg:"input";c.componentInstance.$on(d,function(){for(var e=[],g=0;g<arguments.length;g++)e.push(arguments[g]);if(!b.value||b.value.apply(c.context,e))e.unshift(d),c.context.$emit.apply(c.context,e)})}});
Vue.directive("swipe",{bind:function(a,b){a.$$touchStart=function(g){a.$$touches=g.touches[0]};for(var c=Object.keys(b.modifiers),d=50,e=0;e<c.length;e++)if(parseInt(c[e])==c[e]){d=parseInt(c[e]);c.splice(e,1);break}a.$$touchMove=function(g){if(a.$$touches){var k=g.touches[0].clientX-a.$$touches.clientX,m=g.touches[0].clientY-a.$$touches.clientY,p=!1;if(Math.abs(k)>Math.abs(m))if(k>d){if(!c.length||0<=c.indexOf("right"))p=!0}else k<0-d&&(!c.length||0<=c.indexOf("left"))&&(p=!0);else if(m>d){if(!c.length||
0<=c.indexOf("down"))p=!0}else m<0-d&&(!c.length||0<=c.indexOf("up"))&&(p=!0);p&&b.value(g)}};a.$$touchStop=function(g){a.$$touches=null};a.addEventListener("touchstart",a.$$touchStart);a.addEventListener("touchmove",a.$$touchMove);a.addEventListener("touchstop",a.$$touchStop)},unbind:function(a,b){a.removeEventListener("touchstart",a.$$touchStart);a.removeEventListener("touchmove",a.$$touchMove);a.removeEventListener("touchstop",a.$$touchStop)}});nabu||={};nabu.vue||(nabu.vue={});
nabu.vue.objects={merge:function(a){if(a instanceof Array){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);for(c=0;c<a.length;c++)b.unshift(a[c]),nabu.vue.objects.merge.apply(null,b),b.shift()}else for(c=1;c<arguments.length;c++)if(arguments[c]){b="undefined"==typeof arguments[c].$overwrite?!0:arguments[c].$overwrite;for(var d in arguments[c])"$overwrite"!=d&&(arguments[c][d]instanceof Array?b?a[d]=arguments[c][d]:(a[d]||(a[d]=[]),nabu.vue.arrays.merge(a[d],arguments[c][d])):"object"!=
typeof arguments[c][d]||null==arguments[c][d]||arguments[c][d]instanceof Date?"undefined"==typeof arguments[c][d]||a[d]&&!b||Vue.set(a,d,arguments[c][d]):a[d]?nabu.vue.objects.merge(a[d],arguments[c][d]):Vue.set(a,d,arguments[c][d]))}}};nabu||={};nabu.utils||(nabu.utils={});nabu.utils.vue||(nabu.utils.vue={});nabu.utils.vue.Loader=Vue.component("n-loader",{template:"\x3cspan class\x3d'n-icon n-icon-spinner n-loader fa spinner fas fa-spinner' style\x3d'display: block; text-align: center; margin: auto;'\x3e\x3c/span\x3e"});
nabu.utils.vue.prompt=function(a,b){var c=document.createElement("div");c.setAttribute("class","n-prompt is-modal"+(b&&b.class?" "+b.class:""));document.body.appendChild(c);if(b&&b.raw)var d=c;else d=document.createElement("div"),d.setAttribute("class","n-prompt-container is-modal-content"),c.appendChild(d);var e=function(p){27==p.keyCode&&(document.body.removeChild(c),document.removeEventListener("keydown",e),g.reject())};document.addEventListener("keydown",e);c.addEventListener("click",function(p){p.target==
c&&(document.body.removeChild(c),document.removeEventListener("click",e),g.reject())});var g=new nabu.utils.promise;b&&b.slow&&this.$render&&this.$render({target:d,content:new nabu.utils.vue.Loader});var k=function(){c.parentNode==document.body&&(document.body.removeChild(c),document.removeEventListener("keydown",e))},m=function(p){p.$resolve=function(q){k();g.state||g.resolve(q)};p.$reject=function(q){k();g.state||g.reject(q)};g.then(k,k)};"string"==typeof a&&0>a.indexOf("#")&&this.$services&&this.$services.router?
this.$services.router.route(a,b,d).then(m):this.$render?this.$render({target:d,content:a,activate:m}):nabu.utils.vue.render({target:d,content:a,activate:m});return g};
nabu.utils.vue.confirm=function(a){return nabu.utils.vue.prompt.bind(this)(function(){return new (Vue.extend({template:"#n-confirm",data:function(){return{title:null,ok:null,cancel:null,type:null,message:null,rejectable:!0}},methods:{getIcon:function(){if("question"==this.type)return"question-circle-o";if("warning"==this.type)return"exclamation-triangle";if("error"==this.type)return"exclamation-circle"},resolve:function(){this.$resolve()},translate:function(b){return a&&a.translator?a.translator(b):
b&&b.replace?b.replace(/%[{](?:[a-zA-Z]+[:]+|)([^}]+)}/,"$1"):b}}}))({data:a})},{class:"is-variant-"+(this.variant?this.variant:"confirm")})};
nabu.utils.vue.wait=function(a){return nabu.utils.vue.prompt.bind(this)(function(){return new (Vue.extend({template:"#n-confirm",data:function(){return{title:null,ok:null,cancel:null,type:null,message:null,rejectable:!1,failed:!1,result:null}},activate:function(b){var c=this;a.promise.then(function(d){null!=a.success&&nabu.utils.objects.merge(c,a.success);c.result=d;b();null==a.success&&c.resolve()},function(d){null!=a.failure&&nabu.utils.objects.merge(c,a.failure);c.failed=!0;c.result=d;b();null==
a.failure&&c.resolve()})},methods:{resolve:function(){this.failed?this.$reject(this.result):this.$resolve(this.result)}}}))({data:a})},{slow:!0,class:"n-prompt-wait"})};Vue.mixin({computed:{$prompt:function(){return nabu.utils.vue.prompt},$confirm:function(){return nabu.utils.vue.confirm},$wait:function(){return nabu.utils.vue.wait}}});nabu||={};nabu.tmp||(nabu.tmp={});nabu.tmp.panes=Vue.extend({data:function(){return{panes:[]}}});nabu.tmp.panes=new nabu.tmp.panes;
Vue.directive("pane",{bind:function(a,b){a.classList.add("v-pane-"+nabu.tmp.panes.panes.length);b.value&&(a.paneValue=b.value);a.hasAttribute("id")||a.setAttribute("id","v-pane-"+nabu.tmp.panes.panes.length);nabu.tmp.panes.panes.push(a)},unbind:function(a,b){b=nabu.tmp.panes.panes.indexOf(a);if(0<=b){for(var c=b+1;c<nabu.tmp.panes.panes.length;c++)a.hasAttribute("id")&&a.getAttribute("id").match("v-pane-[0-9]+")&&a.setAttribute("id","v-pane-"+c),a.classList.remove("v-pane-"+c),a.classList.add("v-pane-"+
(c-1));nabu.tmp.panes.panes.splice(b,1)}a.paneValue=null}});Vue.component("n-pane-crumbs",{template:"\x3cdiv class\x3d'n-pane-crumbs'\x3e\x3cdiv @mouseover\x3d'highlight(pane)' @mouseout\x3d'unhighlight()' @click\x3d'select(pane)' v-for\x3d'pane in $window.nabu.tmp.panes.panes'\x3e\x3cspan v-if\x3d'pane.name'\x3e{{pane.name}}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e",methods:{highlight:function(a){this.unhighlight();a.$el.classList.add("v-pane-hover")},unhighlight:function(){for(var a=0;a<nabu.tmp.panes.panes.length;a++)nabu.tmp.panes.panes[a].$el.classList.remove("v-pane-hover")}}});
Vue.component("n-panes",{template:"\x3cdiv class\x3d'n-panes'\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/div\x3e"});
Vue.component("n-pane",{props:{name:{type:String,required:!1}},template:"\x3cdiv class\x3d'n-pane'\x3e\x3cn-pane-crumbs/\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/div\x3e",data:function(){return{index:0}},mounted:function(){this.register()},updated:function(){this.register()},methods:{register:function(){0>nabu.tmp.panes.panes.indexOf(this)&&(this.$el.classList.add("v-pane-"+nabu.tmp.panes.panes.length),this.$el.hasAttribute("id")||this.$el.setAttribute("id","v-pane-"+nabu.tmp.panes.panes.length),nabu.tmp.panes.panes.push(this),
this.setReverse())},setReverse:function(){for(var a=0;a<nabu.tmp.panes.panes.length;a++){var b=nabu.tmp.panes.panes[a].$el;b.hasAttribute("v-pane-reverse-index")&&b.classList.remove("v-pane-reverse-"+b.getAttribute("v-pane-reverse-index"));b.setAttribute("v-pane-reverse-index",nabu.tmp.panes.panes.length-1-a);b.classList.add("v-pane-reverse-"+b.getAttribute("v-pane-reverse-index"))}}},beforeDestroy:function(){var a=nabu.tmp.panes.panes.indexOf(this);if(0<=a){for(var b=a+1;b<nabu.tmp.panes.panes.length;b++){var c=
nabu.tmp.panes.panes[b].$el;c.hasAttribute("id")&&c.getAttribute("id").match("v-pane-[0-9]+")&&c.setAttribute("id","v-pane-"+b);c.classList.remove("v-pane-"+b);c.classList.add("v-pane-"+(b-1))}this.setReverse();nabu.tmp.panes.panes.splice(a,1)}}});nabu||={};nabu.services||(nabu.services={});
nabu.services.VueService=function(a,b){a.render=function(k){return k()};var c=function(k){var m=function(p){var q=function(){if(p.$options.activated)for(var F=p.$options.activated instanceof Array?p.$options.activated:[p.$options.activated],C=0;C<F.length;C++)F[C].call(p)};if(p.$options&&p.$options.activate){if(p.$options.activate instanceof Array){for(var t=[],u=function(F){var C=k.q.defer();t.push(C);F.call(p,function(A){C.resolve(A)})},w=0;w<p.$options.activate.length;w++)u(p.$options.activate[w]);
var y=k.q.defer();k.q.all(t).then(function(F){q();if(F)for(var C=0;C<F.length;C++);y.resolve(p)},y);return y}var B=k.q.defer();p.$options.activate.call(p,function(F){q();B.resolve(p)});return B}B=k.q.defer();q();B.resolve(p);return B};this.$initialize=function(){var p=new a({data:{$services:k}});p.$options.clear&&(p.$clear=function(){for(var B=p.$options.clear instanceof Array?p.$options.clear:[p.$options.clear],F=[],C=function(O){var H=new nabu.utils.promise;O.call(p,function(){H.resolve()});return H},
A=0;A<B.length;A++)F.push(C(B[A]));return new nabu.utils.promises(F)});p.$options.switchLanguage&&(p.$switchLanguage=function(){for(var B=p.$options.switchLanguage instanceof Array?p.$options.switchLanguage:[p.$options.switchLanguage],F=[],C=function(O){var H=new nabu.utils.promise;O.call(p,function(){H.resolve()});return H},A=0;A<B.length;A++)F.push(C(B[A]));return new nabu.utils.promises(F)});b&&b.lazy&&(p.$lazy=function(){if(p.$lazyInitialized){var B=k.q.defer();B.resolve(p);return B}p.$lazyInitialized=
new Date;return m(p)});if(b&&b.lazy)return p;var q=[];p.$options.services&&nabu.utils.arrays.merge(q,p.$options.services);p.$options.optionalServices&&p.$options.optionalServices.forEach(function(B){q.push({name:B,optional:!0})});if(q.length){for(var t=[],u=0;u<q.length;u++){var w=q[u],y=k.$promise(w.name?w.name:w,w.optional);if(!y)throw"Could not find service dependency: "+q[u];t.push(y)}y=new nabu.utils.promise;y.stage(p);(new nabu.utils.promises(t)).then(function(){m(p).then(y,y)});return y}return m(p)}};
if(b&&b.name){for(var d=b.name.split("."),e=window,g=0;g<d.length-1;g++)e[d[g]]||(e[d[g]]={}),e=e[d[g]];e[d[d.length-1]]=c}return c};
Vue.mixin({initialize:function(a){var b=[];this.$options.services&&nabu.utils.arrays.merge(b,this.$options.services);this.$options.optionalServices&&this.$options.optionalServices.forEach(function(m){b.push({name:m,optional:!0})});if(b.length){if(!this.$services)throw"No service provider found";for(var c=[],d=0;d<b.length;d++){for(var e=b[d].name?b[d].name:b[d].split("."),g=this.$services,k=0;k<e.length;k++){if(!g)throw"Could not find service: "+this.$options.services[d];g=g[e[k]]}!g.$lazyInitialized&&
g.$lazy&&(e=g.$lazy(),e.then&&c.push(e))}this.$services.q.all(c).then(function(){a()})}else a()}});var vi=function(a){for("string"==typeof a&&(a=document.querySelector(a));a&&!a.__vue__;)a=a.parentNode;return a?a.__vue__:null};Vue.config.optionMergeStrategies.activate=function(a,b){var c=[];b instanceof Array?nabu.utils.arrays.merge(c,b):b&&c.push(b);a instanceof Array?nabu.utils.arrays.merge(c,a):a&&c.push(a);return c};Vue.config.optionMergeStrategies.activated=Vue.config.optionMergeStrategies.activate;
Vue.config.optionMergeStrategies.clear=Vue.config.optionMergeStrategies.activate;Vue.config.optionMergeStrategies.services=Vue.config.optionMergeStrategies.activate;Vue.config.optionMergeStrategies.asyncWatch=Vue.config.optionMergeStrategies.watch;Vue.config.optionMergeStrategies.asyncComputed=Vue.config.optionMergeStrategies.computed;
Vue.mixin({activated:function(){if(this.$options.asyncComputed)for(var a=this.$options.asyncComputed instanceof Array?this.$options.asyncComputed:[this.$options.asyncComputed],b=0;b<a.length;b++)Vue.util.initComputed(this,a[b]);this.$options.asyncWatch&&Vue.util.initWatch(this,this.$options.asyncWatch)},methods:{$appendTo:function(a){a.appendChild(this.$el)},$dispatch:function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);var d=function(e){if(e&&e.$options&&e.$options.events){for(var g=
Object.keys(e.$options.events),k=0;k<g.length;k++)if(a==g[k]){if(!0!==e.$options.events[g[k]].apply(e,b))return!0;break}e.$parent&&d(e.$parent)}return!1};d(this)},$remove:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},$redirect:function(a){window.location=a}},mounted:function(){this.$mounted=!0;if(this.$options.ready){var a=this;this.$nextTick(function(){if(a.$options.ready instanceof Array)for(var b=0;b<a.$options.ready.length;b++)a.$options.ready[b].call(a);
else a.$options.ready.call(a)})}},ready:function(){this.$readied=!0;this.$parent&&this.$parent.$emit("$vue.child.added",this);this.$emit("hook:ready")},computed:{$window:function(){return window},$document:function(){return document},$self:function(){return this}}});Vue.views={};Vue.services={};Vue.view=function(a,b){b&&(null==b.template&&(b.template="#"+a),Vue.views[a]={original:b,component:Vue.component(a,b)});return Vue.views[a].component};
Vue.service=function(a,b,c){b&&(Vue.services[a]=nabu.services.VueService(Vue.extend(b,c)));return Vue.services[a]};
window.addEventListener("load",function(){application.bootstrap(function(a){Object.keys(Vue.views).map(function(b){var c=Vue.views[b].original,d={priority:c.priority,alias:c.alias?c.alias:b,category:c.category,description:c.description,name:c.name!=b?c.name:null,icon:c.icon,accept:c.accept,initialize:c.init,enter:function(e){return new (Vue.view(b))({propsData:e})},query:[],parameters:{}};c.url&&(d.url=c.url);c.props&&Object.keys(c.props).map(function(e){if(!d.url||0>d.url.indexOf("{"+e+"}"))d.parameters[e]=
{type:"string"}});a.router.register(d)});return a.$register(Vue.services)})});Vue.component("n-view",{template:"\x3cdiv v-route-render\x3d'{alias: alias, parameters: $attrs, mounted: register }'\x3e\x3c/div\x3e",props:{alias:{type:String,required:!0}},methods:{register:function(a){if(this.$listeners){var b=this;Object.keys(this.$listeners).forEach(function(c){a.$on(c,b.$listeners[c])})}}}});nabu||={};nabu.components||(nabu.components={});nabu.services||(nabu.services={});nabu.state||(nabu.state={});
nabu.utils||(nabu.utils={});
nabu.services.VueRouter=function(a){var b=this;this.components={};this.router=new nabu.services.Router(a);this.useProps=a.useProps;this.route=function(c,d,e,g){return b.router.route(c,d,e,g)};this.routeInitial=function(c){return this.router.routeInitial(c)};this.updateUrl=this.router.updateUrl;this.routeAll=this.router.routeAll;this.bookmark=this.router.bookmark;this.register=function(c){c=b.create(c);b.router.register(c);return c};this.unregister=this.router.unregister;this.template=function(c,d){return b.router.template(c,
d)};this.get=function(c){return b.router.get(c)};this.list=function(){return b.router.list()};this.create=function(c){if(c.enter){var d=c.enter;c.enter=function(g,k,m,p){var q=new nabu.utils.promise,t=function(){var C=null;d?C=d(k,m):c.component&&("string"==typeof c.component?(C=eval(c.component),C=new C(b.useProps?{propsData:k}:{data:k})):C=new c.component(b.useProps?{propsData:k}:{data:k}));var A="object"===typeof g?g:document.getElementById(g);A||"body"!=g||(A=document.body);return nabu.utils.vue.render({target:A,
content:C,ready:function(O){c.postProcess&&c.postProcess(k,O);c.ready&&c.ready(k,O);q.resolve(O)},prepare:function(O){O.setAttribute("route",c.alias);O.leave=c.leave}})},u=[];p&&p.then&&u.push(p);p="object"===typeof g?g:document.getElementById(g);p||"body"!=g||(p=document.body);if(p){var w=function(C){for(var A=0;A<C.childNodes.length;A++)1==C.childNodes[A].nodeType&&w(C.childNodes[A]);C.leave&&(C=C.leave(C))&&C.then&&u.push(C)};w(p)}if(c.services&&a.services)for(p=0;p<c.services.length;p++){for(var y=
c.services[p].split("."),B=a.services,F=0;F<y.length;F++){if(!B)throw"Could not find service: "+c.services[p];B=B[y[F]]}if(!B)throw"Could not find service '"+c.services[p]+"' for route: "+c.alias;B.$lazy&&!B.lazyInitialized&&(B.lazyInitialized=new Date,y=B.$lazy(),y.then&&u.push(y))}(new nabu.utils.promises(u)).then(function(){t()},q);return q}}var e=c.leave;c.leave=function(g){g&&delete g.leave;e&&e(g)};return c}};nabu||={};nabu.utils||(nabu.utils={});nabu.utils.vue||(nabu.utils.vue={});
nabu.utils.vue.render=function(a){var b="object"===typeof a.target?a.target:document.getElementById(a.target);b||"body"!=a.target||(b=document.body);if(!b)throw"Target not found: "+a.target+" in: "+document.body.innerHTML;var c=b.$el?b.$el:b;if(!a.append){var d=function(q,t){for(var u=0;u<q.childNodes.length;u++)t||"true"==q.getAttribute("unclearable")||1==q.getAttribute("unclearable")||1==q.childNodes[u].nodeType&&d(q.childNodes[u]);t=null;q.__vue__&&q.__vue__.$parent&&q.__vue__.$el&&q.__vue__.$parent.$el===
q.__vue__.$el&&q.__vue__.$parent.$destroy&&(t=q.__vue__.$parent);q.__vue__&&q.__vue__.$destroy&&q.__vue__.$destroy();t&&t.$destroy()};d(c)}var e=a.content;if(e){e instanceof Function&&(e=e(c));"string"==typeof e&&"#"==e.substring(0,1)&&(e=new (Vue.extend({template:e}))({data:a}));var g=function(q){if(e.$options&&e.$options.activated)for(var t=e.$options.activated instanceof Array?e.$options.activated:[e.$options.activated],u=0;u<t.length;u++)t[u].call(e);if(e.$mount&&!e.$parent){for(u=c;u&&!u.__vue__;)u=
u.parentNode;u&&u.__vue__&&(e.$parent=u.__vue__,e.$root=e.$parent.$root?e.$parent.$root:e.$parent)}a.append||(b.clear?b.clear():c&&nabu.utils.elements.clear(c));e.$mount&&(e.$el?e.$remove():e.$mount());q&&(e=q);a.prepare&&a.prepare(c,e);e.$appendTo?e.$appendTo(c):"string"===typeof e?c.innerHTML+=e:c.appendChild(e);if(e.$options&&e.$options.template&&"#"==e.$options.template.substring(0,1))for(q=e.$options.template.substring(1),c.setAttribute("template",q),q=document.getElementById(q),u=0;u<q.attributes.length;u++)"id"!=
q.attributes[u].name&&"x/templates"!=q.attributes[u].value&&c.setAttribute(q.attributes[u].name,q.attributes[u].value);a.ready&&a.ready(e)};if(e.$mount)if(a.activate&&a.activate(e),e&&e.$options&&(e.$options.activate||e.$options.initialize)){a.loader&&a.loader(c);var k=[],m=function(q,t){var u=new nabu.utils.promise;t.push(u);q.call(e,function(w){u.resolve(w)})};if(e.$options.initialize instanceof Array)for(var p=0;p<e.$options.initialize.length;p++)m(e.$options.initialize[p],k);else e.$options.initialize&&
m(e.$options.initialize,k);(new nabu.utils.promises(k)).then(function(){k=[];if(e.$options.activate instanceof Array)for(var q=0;q<e.$options.activate.length;q++)m(e.$options.activate[q],k);else e.$options.activate&&m(e.$options.activate,k);(new nabu.utils.promises(k)).then(function(t){g()})})}else g();else e.success?e.success(function(q){g(q.responseText)}):g()}return e};Vue.mixin({computed:{$render:function(){return nabu.utils.vue.render}}});nabu||={};nabu.utils||(nabu.utils={});
nabu.utils.vue||(nabu.utils.vue={});
nabu.utils.vue.transform=function(a,b,c){if(!a.__ob__)throw"The object is not observable, use 'Vue.observe(object, true)' first";var d={state:{}};Vue.observe(d,!0);nabu.utils.objects.merge(d.state,b(a));a.__ob__.dep.addSub({update:function(){console.log("updating original object",a);d instanceof Object?nabu.utils.objects.merge(d.state,b(a)):d=b(a)}});d.__ob__.dep.addSub({update:function(){console.log("updating target object",d);a instanceof Object?nabu.utils.objects.merge(a,c(d.state)):a=c(d.state)}});
return d.state};Vue.mixin({methods:{$transform:nabu.utils.vue.transform}});
Vue.mixin({data:function(){return{$fetched:{}}},created:function(){if(this.$options.fetch)for(var a=this,b=function(g,k,m,p,q,t,u){var w=function(H){if(H)if(H=H.toString(),"string"==typeof H){if(H=H.replace(/^[^(]*\(([^)]*)\)[\s\S]*/g,"$1").trim(),0!=H.length)return H.split(",").length}else throw"No stringification support for functions";return 0},y=u?u instanceof Array?u.length:1:0,B=k instanceof Function&&w(k)>y||p instanceof Function&&w(p)>y,F=a.$data.$fetched[g]=null,C=null,A=null,O=function(){A=
null==A?!0:!1;var H=F,ca=C,P=g,M=[];if(B){if(t)throw"You can not combine a function and a resolve requirement";for(var K=0;K<arguments.length;K++)M.push(arguments[K]);P+=JSON.stringify(M);ca=a.$data.$fetched["_original_promise_"+P];H=a.$data.$fetched["_promise_"+P]}H||=a.$services.q.defer();if(!ca){if(k&&"string"==typeof k)ca=a[k];else if(B||k instanceof Function||p instanceof Function){var Q=p,Z=[];if("string"==typeof u){var aa=a[u];aa.then&&Z.push(aa);M.push(aa)}else if(u instanceof Array)for(K=
0;K<u.length;K++)aa=a[u[K]],aa.then&&Z.push(aa),M.push(aa);Z.length?(ca=a.$services.q.defer(),a.$services.q.all(Z).then(function(S){for(var la=0;la<M.length;la++)M[la].then&&M[la].then(function(pa){M[la]=pa});k instanceof Function?(S=k.apply(a,M),console.log("fetch",P,S),S&&S.then?S.then(ca,ca):ca.resolve("undefined"==typeof S?null:S)):(Q=p.apply(a,M),a.$services.swagger.execute(m,Q).then(ca,ca))})):k instanceof Function?ca=k.apply(a,M):(Q=p.apply(a,M),ca=a.$services.swagger.execute(m,Q))}else ca=
k?k:a.$services.swagger.execute(m,p);ca.then(function(S){if("undefined"==typeof S)S=null;else if(q)if(q instanceof Function)S=q.call(a,S);else if(q instanceof Array)for(var la=0;la<q.length;la++)S=q[la].call(a,S);a.$data.$fetched[P]instanceof Array&&S instanceof Array?(a.$data.$fetched[P].splice(0,a.$data.$fetched[P].length),nabu.utils.arrays.merge(a.$data.$fetched[P],S)):a.$data.$fetched[P]=S;H.resolve(a.$data.$fetched[P])},H);B?(a.$data.$fetched["_original_promise_"+P]=ca,a.$data.$fetched["_promise_"+
P]=H):(F=H,C=ca)}H.refresh||(H.refresh=function(){if(!A){C=this.state=null;for(var S=[],la=0;la<arguments.length;la++)S.push(arguments[la]);O.apply(a,arguments)}return H});H.resolved||(H.resolved=function(){return a.$data.$fetched[P]});return t?a.$data.$fetched[P]:H};Object.defineProperty(a,g,{enumerable:!0,get:B?function(){return O}:O})},c=0;c<this.$options.fetch.length;c++)for(var d in this.$options.fetch[c]){var e=this.$options.fetch[c][d];b(d,"string"==typeof e?e:e.fetch,"string"==typeof e?e:
e.operation,"string"==typeof e?null:e.parameters,"string"==typeof e?null:e.map,"string"==typeof e?null:e.resolve,"string"==typeof e?null:e.inject)}}});Vue.config.optionMergeStrategies.fetch=Vue.config.optionMergeStrategies.activate;
Vue.component("n-input-date",{props:{value:{required:!0},minimum:{required:!1},maximum:{required:!1},parser:{type:Function,required:!1},formatter:{type:Function,required:!1},allow:{type:Function,required:!1},yearsDropdown:{type:Boolean,required:!1,default:!1},yearsFrom:{type:Number,required:!1,default:-5},yearsTo:{type:Number,required:!1,default:5},includeHours:{type:Boolean,required:!1},includeMinutes:{type:Boolean,required:!1},includeSeconds:{type:Boolean,required:!1},"default":{required:!1},translator:{type:Function,
required:!1}},template:"#n-input-date",data:function(){return{date:null,day:null,month:null,year:null,hours:null,minutes:null,seconds:null,updating:!1,internalChange:!1}},created:function(){this.setValue(this.value)},watch:{date:function(a){a&&(this.day=a.getDay(),this.month=a.getMonth(),this.year=a.getFullYear(),this.hours=a.getHours(),this.minutes=a.getMinutes(),this.seconds=a.getSeconds())},value:function(a){this.internalChange?this.internalChange=!1:this.setValue(a)},years:function(a){a&&(0>a.indexOf(this.year)&&
(this.year=a[0]),this.selectYear(this.year))}},methods:{setValue:function(a){this.date=a?a instanceof Date?this.value:this.parse(a):new Date},incrementMonth:function(a){return new Date(this.date.getFullYear(),this.date.getMonth()+a,this.date.getDate(),this.includeHours?this.hours?parseInt(this.hours):0:0,this.includeMinutes?this.minutes?parseInt(this.minutes):0:0,this.includeSeconds?this.seconds?parseInt(this.seconds):0:0)},canIncrementMonth:function(a){if(this.yearsDropdown&&0<this.years.length){var b=
Math.min.apply(Math,this.years),c=Math.max.apply(Math,this.years);a=this.incrementMonth(a).getFullYear();return a>=b&&a<=c?!0:!1}return 0>a?this.minimum?this.incrementMonth(a)>=this.minimum:!0:this.maximum?this.incrementMonth(a)<=this.maximum:!0},parse:function(a){return a?this.parser?this.parser(a):new Date(parseInt(a.substring(0,4)),parseInt(a.substring(5,7))-1,parseInt(a.substring(8,10)),this.includeHours&&13<=a.length?parseInt(a.substring(11,13)):0,this.includeMinutes&&16<=a.length?parseInt(a.substring(14,
16)):0,this.includeSeconds&&19<=a.length?parseInt(a.substring(17,19)):0,0):null},format:function(a){if(!a)return null;if(this.formatter)return this.formatter(a);var b=a.getFullYear()+"-",c=a.getMonth()+1;b+=(10>c?"0":"")+c+"-";a=a.getDate();b+=(10>a?"0":"")+a;this.includeHours&&(b=b+" "+((10>this.hours?"0":"")+(this.hours?parseInt(this.hours):0)));this.includeMinutes&&(b=b+":"+((10>this.minutes?"0":"")+(this.minutes?parseInt(this.minutes):0)));this.includeSeconds&&(b=b+":"+((10>this.seconds?"0":"")+
(this.seconds?parseInt(this.seconds):0)));return b},isToday:function(a){var b=new Date;return a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()},isSelected:function(a){if(!this.value)return!1;var b=this.parse(this.value);return b.getFullYear()==a.getFullYear()&&b.getMonth()==a.getMonth()&&b.getDate()==a.getDate()},isAvailable:function(a){return null==this.allow||this.allow(a)},select:function(a){a&&=new Date(a.getFullYear(),a.getMonth(),a.getDate(),this.includeHours?
this.hours?parseInt(this.hours):0:0,this.includeMinutes?this.minutes:0,this.includeSeconds?this.seconds:0,0);this.isAvailable(a)&&(this.date=a,this.internalChange=!0,this.$emit("input",this.format(a)))},translate:function(a){return this.translator?this.translator(a):a&&a.replace?a.replace(/%[{](?:[a-zA-Z]+[:]+|)([^}]+)}/,"$1"):a},selectYear:function(a){if(a){for(var b=new Date(a,this.date.getMonth(),this.date.getDate(),this.includeHours?this.hours?parseInt(this.hours):0:0,this.includeMinutes?this.minutes:
0,this.includeSeconds?this.seconds:0,0),c=this.isAvailable(b),d=1;!c;){var e=new Date(a,this.date.getMonth(),this.date.getDate()-d++,this.includeHours?this.hours?parseInt(this.hours):0:0,this.includeMinutes?this.minutes:0,this.includeSeconds?this.seconds:0,0);if(e.getFullYear()!=a)break;(c=this.isAvailable(e))&&(b=e)}for(d=1;!c;){e=new Date(a,this.date.getMonth(),this.date.getDate()+d++,this.includeHours?this.hours?parseInt(this.hours):0:0,this.includeMinutes?this.minutes:0,this.includeSeconds?this.seconds:
0,0);if(e.getFullYear()!=a)break;(c=this.isAvailable(e))&&(b=e)}this.date=b;c&&null!=this.default?(this.date=b,this.internalChange=!0):c&&!this.default&&(this.date=b)}}},computed:{days:function(){var a=[];a.push(this.translate("%{date::Mo}"));a.push(this.translate("%{date::Tu}"));a.push(this.translate("%{date::We}"));a.push(this.translate("%{date::Th}"));a.push(this.translate("%{date::Fr}"));a.push(this.translate("%{date::Sa}"));a.push(this.translate("%{date::Su}"));return a},months:function(){var a=
[];a.push(this.translate("%{date::January}"));a.push(this.translate("%{date::February}"));a.push(this.translate("%{date::March}"));a.push(this.translate("%{date::April}"));a.push(this.translate("%{date::May}"));a.push(this.translate("%{date::June}"));a.push(this.translate("%{date::July}"));a.push(this.translate("%{date::August}"));a.push(this.translate("%{date::September}"));a.push(this.translate("%{date::October}"));a.push(this.translate("%{date::November}"));a.push(this.translate("%{date::December}"));
return a},weeks:function(){var a=[],b=[[]],c=0,d=new Date(this.date.getFullYear(),this.date.getMonth(),1),e=0===d.getDay()?6:d.getDay()-1,g=(new Date(this.date.getFullYear(),this.date.getMonth()+1,0)).getDate();for(d=0;d<e;d++)a.push({label:null,value:null});for(d=0;d<g;d++)a.push({label:d+1,value:new Date(this.date.getFullYear(),this.date.getMonth(),d+1)});if(0<a.length%7)for(e=7-a.length%7,d=0;d<e;d++)a.push({label:null,value:null});for(d=0;d<a.length;d++)b[c].push(a[d]),0===b[c].length%7&&(c+=
1,b.push([]));return b},years:function(){var a=Number((new Date).getFullYear()),b=a+Number(this.yearsFrom);a+=Number(this.yearsTo);var c=Number(a-b),d=[];if(0<c){for(var e=0;e<c-1;e++)d[e]=b+e+1;d.unshift(b);d.push(a)}return d}}});
Vue.component("n-input-file",{props:{value:{type:Array,required:!0},types:{type:Array,required:!1},amount:{required:!1},maxFileSize:{type:Number,required:!1},disabled:{type:Boolean,required:!1,default:!1},browseLabel:{type:String,required:!1},dropLabel:{type:String,required:!1},browseIcon:{type:String,required:!1},visualiseSelectedFiles:{type:Boolean,required:!1,default:!1},deleteIcon:{type:String,required:!1,default:"times"},restrictionMessage:{type:String,required:!1},schema:{type:Object,required:!1},
required:{type:Boolean,required:!1,default:null},visualizeFileNames:{type:Boolean,required:!1,default:!1},buttonClass:{required:!1},capture:{type:String,required:!1,default:null},fileNameDeleteClass:{required:!1},fileNameContainerClass:{required:!1},fileNameRowClass:{required:!1},fileNameClass:{required:!1}},template:"#n-input-file",data:function(){return{counter:0,dragging:!1,messages:[]}},methods:{dragOver:function(a){this.dragging=!0;a.preventDefault()},hasDropSupport:function(){var a=document.createElement("div");
return("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&"FormData"in window&&"FileReader"in window},selectFiles:function(a){var b=this.addFiles(a.target.files||a.dataTransfer.files);a.preventDefault();a.stopPropagation();this.$refs.input.value="";return b},addFiles:function(a){for(var b=[],c=this.makeRoomFor(a.length),d=0;d<a.length;d++)(!this.amount||this.value.length<this.amount)&&this.isAllowedType(a.item(d).type)&&this.isAllowedSize(a.item(d).size)?(c=!0,this.value.push(a.item(d))):b.push(a.item(d));
this.validate();c&&this.$emit("change",this.value);return b},makeRoomFor:function(a){return null!=this.amount&&0<this.amount&&(a=this.value.length+a-this.amount,0<a)?(this.value.splice(0,a),!0):!1},pasteFiles:function(a){a=a.clipboardData?a.clipboardData.items:null;var b=[];if(a){for(var c=this.makeRoomFor(a.length),d=0;d<a.length;d++)if((!this.amount||this.value.length<this.amount)&&this.isAllowedType(a[d].type)&&this.isAllowedSize(a[d].size)){var e=a[d].getAsFile();c=!0;this.value.push(new File([e],
"pasted_file_"+this.counter++,{type:a[d].type}))}else b.push(a[d]);c&&this.$emit("change",this.value)}return b},isAllowedType:function(a){return!this.types||!this.types.length||a&&(0<=this.types.indexOf(a)||0<=this.types.indexOf(a.replace(/\/.*$/,"")+"/*"))},isAllowedSize:function(a){return this.maxFileSize?null==a?!1:a<=this.maxFileSize?!0:!1:!0},isAllAllowedSize:function(){var a=this;return this.value.reduce(function(b,c){return b&&a.isAllowedSize(c.size)},!0)},isAllAllowedType:function(){var a=
this;return this.value.reduce(function(b,c){return b&&a.isAllowedType(c.type)},!0)},browse:function(){this.$refs.input.click()},removeFile:function(a){this.value.splice(this.value.indexOf(a),1);this.$emit("change",this.value)},validate:function(a){this.messages.splice(0);a=[];var b=nabu.utils.vue.form.mandatory(this);this.isAllAllowedType()||a.push({severity:"error",code:"invalidFileType",title:"This file type is not allowed",priority:-1,values:{actual:this.value.map(function(d){return d.type}),expected:this.types},
context:[this]});if(!this.isAllAllowedSize()){var c="This file is too big, the maximum file size is {maxFileSize}";c=1048576>this.maxFileSize?c.replace("{maxFileSize}",this.maxFileSize/1024+"kb"):c.replace("{maxFileSize}",this.maxFileSize/1048576+"mb");a.push({severity:"error",code:"invalidFileSize",title:c,priority:-1,values:{actual:this.value.map(function(d){return d.size}),expected:this.maxFileSize},context:[this]})}b&&1>this.value.length&&a.push({soft:!0,severity:"error",code:"required",title:"The value is required",
priority:0,values:{actual:!1,expected:!0},context:[this]});nabu.utils.arrays.merge(self.messages,nabu.utils.vue.form.localMessages(self,a));return a}}});
Vue.component("n-input-combo",{props:{value:{required:!0},labels:{type:Array,required:!1},initialLabel:{required:!1},filter:{type:Function,required:!1},formatter:{type:Function,required:!1},extracter:{type:Function,required:!1},prettyFormatter:{type:Function,required:!1},resolver:{type:Function,required:!1},items:{required:!1},nillable:{type:Boolean,default:!0},allowTyping:{type:Boolean,default:!0},timeout:{type:Number,required:!1},placeholder:{type:String,required:!1},autoclose:{type:Boolean,required:!1,
default:!0},disabled:{type:Boolean,required:!1,default:!1},name:{type:String,required:!1},autocomplete:{type:String,default:0<=window.navigator.userAgent.indexOf("Chrome")?"nothing":"off"},autoselectSingle:{type:Boolean,required:!1},caseInsensitive:{type:Boolean,required:!1,default:!1},allowTypeMatch:{type:Boolean,required:!1,default:!1},emptyValue:{type:String,required:!1},calculatingValue:{type:String,required:!1},resetValue:{type:String,required:!1},reloadOnFocus:{type:Boolean,required:!1,default:!0}},
template:"#n-input-combo",data:function(){return{label:null,showLabels:!1,showValues:!1,values:[],content:null,timer:null,updatingContent:!1,actualValue:null,keyValue:null,filtering:!1,stillFocused:!1}},mounted:function(){this.labels&&(this.label=this.initialLabel&&0<=this.labels.indexOf(this.initialLabel)?this.initialLabel:this.labels[0]);if(this.filter&&!this.disabled)try{this.filterItems(this.content,this.label,null,!0)}catch(b){console.error("Could not perform initial filter",b)}else if(this.items)if(this.items.then){var a=
this;this.items.then(function(b){nabu.utils.arrays.merge(a.values,b);a.synchronizeValue(!0)})}else nabu.utils.arrays.merge(this.values,this.items),this.synchronizeValue(!0);this.extracter&&!this.resolver||this.synchronizeValue(!0)},computed:{formatted:function(){return this.formatter&&null!=this.actualValue?this.formatter(this.actualValue):this.actualValue}},methods:{cleanupFormatted:function(a){return a&&a.replace?a.replace(/<[^>]+>/g,"").trim():a},focusOn:function(a){var b=this;this.stillFocused=
!0;setTimeout(function(){if(b.stillFocused){if(b.reloadOnFocus&&b.filter){var c=b.content;b.content&&b.actualValue&&b.cleanupFormatted(b.formatter?b.formatter(b.actualValue):b.actualValue)==c&&(c=null);b.filterItems(c,b.label)}b.showValues=!0}},100)},focusOut:function(a){null==this.value&&null!=this.keyValue&&null!=this.content&&0<this.content.trim().length&&(a=this.keyValue,this.keyValue=null,this.updateValue(a))},synchronizeValue:function(a){var b=this;if(null!=this.value)if(this.extracter){if(!this.actualValue||
this.extracter(this.actualValue)!=this.value)for(var c=0;c<this.values.length;c++)if(this.extracter(this.values[c])==this.value){this.actualValue=this.values[c];break}null==this.resolver||this.actualValue&&this.extracter(this.actualValue)==this.value||(c=this.resolver(this.value),null!=c&&c.then?c.then(function(d){d instanceof Array&&(d=d[0]);b.actualValue=d;a&&(b.content=null!=b.actualValue?b.formatter?b.formatter(b.actualValue):b.actualValue:null);b.$emit("label",null!=b.actualValue?b.formatter?
b.formatter(b.actualValue):b.actualValue:null)}):null!=c&&(b.actualValue=c,b.$emit("label",null!=b.actualValue?b.formatter?b.formatter(b.actualValue):b.actualValue:null)))}else this.actualValue=this.value;else!this.nillable&&0<this.values.length?this.updatingContent&&this.actualValue||this.updateValue(this.values[0]):this.actualValue=null;b.$emit("label",null!=b.actualValue?b.formatter?b.formatter(b.actualValue):b.actualValue:null);this.keyValue&&0>this.values.indexOf(this.keyValue)&&(this.keyValue=
null);null==this.keyValue&&this.setKeyValue()},validateKey:function(a){this.allowTyping||(a.preventDefault(),a.stopPropagation())},validateEnter:function(a){null!=this.keyValue&&(a.preventDefault(),a.stopPropagation(),a=this.keyValue,this.keyValue=null,this.updateValue(a),this.showValues=!1)},validateTab:function(a){null!=this.keyValue&&0==a.shiftKey&&this.showValues&&(a=this.keyValue,this.keyValue=null,this.updateValue(a));this.showValues=!1},doEscape:function(){this.showValues=!1;this.keyValue=
null},moveUp:function(a){this.showValues=!0;if(null==this.keyValue){var b=this.value?this.values.indexOf(this.value):-1;this.keyValue=0<b?this.values[b-1]:this.values.length?this.values[0]:null}else b=this.values.indexOf(this.keyValue),0>b?this.keyValue=this.values.length?this.values[0]:null:0<b&&(this.keyValue=this.values[b-1]),this.scrollTo("pondering");a.preventDefault();a.stopPropagation()},moveDown:function(a){this.showValues=!0;if(null==this.keyValue){var b=this.value?this.values.indexOf(this.value):
-1;this.keyValue=0<=b?b<this.values.length-1?this.values[b+1]:this.value:this.values.length?this.values[0]:null}else b=this.values.indexOf(this.keyValue),0>b?this.keyValue=this.values.length?this.values[0]:null:b<this.values.length-1&&(this.keyValue=this.values[b+1]),this.scrollTo("pondering");a.preventDefault();a.stopPropagation()},scrollTo:function(a){if(a=this.$el.querySelector("."+a))a.parentNode.scrollTop=a.offsetTop-a.parentNode.offsetHeight/2},clear:function(){this.content=null;this.filter&&
this.filterItems(this.content,this.label)},refilter:function(){this.filterItems(this.content,this.label)},setKeyValue:function(){this.showValues&&null==this.keyValue&&(this.value&&0<=this.values.indexOf(this.value)?this.keyValue=this.value:this.values.length&&(this.keyValue=this.values[0]))},filterItems:function(a,b,c,d){this.stillFocused&&a&&(this.showValues=!0);var e=this.filter(a,b);this.filtering=!!e.then;this.values.splice(0,this.values.length);if(e instanceof Array)nabu.utils.arrays.merge(this.values,
e),this.synchronizeValue(d),c&&null!=this.checkForMatch(a)&&this.filterItems(null,b,!1),null==this.value&&this.autoselectSingle&&1==e.length&&this.updateValue(e[0]);else if(e.then){var g=this;e.then(function(k){g.values.splice(0,g.values.length);if(!(k instanceof Array))for(var m in k)if(k[m]instanceof Array){k=k[m];break}k&&k.length&&nabu.utils.arrays.merge(g.values,k);g.synchronizeValue(d);c&&null!=g.checkForMatch(a)&&g.filterItems(null,b,!1);null==this.value&&this.autoselectSingle&&null!=k&&1==
k.length&&this.updateValue(k[0]);g.filtering=!1},function(){g.filtering=!1})}},checkForMatch:function(a){for(var b=null,c=0;c<this.values.length;c++){var d=this.cleanupFormatted(null!=this.values[c]&&this.formatter?this.formatter(this.values[c]):this.values[c]);if(d==a||this.caseInsensitive&&d.toLowerCase&&a&&a.toLowerCase&&d.toLowerCase()==a.toLowerCase()){b=this.values[c];break}}null!=b||!a&&this.nillable?(this.updatingContent=!0,this.actualValue=a,this.$emit("input",this.extracter&&b?this.extracter(b):
b,this.formatter&&b?this.formatter(b):b,this.label),this.$emit("label",this.formatter&&b?this.formatter(b):b,this.label)):this.nillable&&this.value&&(this.updatingContent=!0,this.$emit("input",null),this.$emit("label",null));return b},updateContent:function(a){this.content=a;var b=this.allowTypeMatch||!a&&this.nillable?this.checkForMatch(a):null;b&&(this.showValues=!1,this.keyValue=null);if(this.filter)if(this.timer&&(clearTimeout(this.timer),this.timer=null),this.timeout){var c=this;this.timer=setTimeout(function(){c.filterItems(b||
!a?null:a,c.label,!b&&this.allowTypeMatch)},this.timeout)}else this.filterItems(b||!a?null:a,this.label,!b&&this.allowTypeMatch)},hideSlowly:function(){var a=this;setTimeout(function(){a.showValues=!1},500)},updateValue:function(a){this.keyValue=null;this.updatingContent=!0;this.actualValue=a;this.$emit("input",this.extracter&&a?this.extracter(a):a,this.formatter&&a?this.formatter(a):a,a,this.label);this.$emit("label",this.formatter&&a?this.formatter(a):a,this.label);if(this.filter)if(this.timer&&
(clearTimeout(this.timer),this.timer=null),this.timeout){var b=this;this.timer=setTimeout(function(){b.filterItems(null,b.label,!1)},this.timeout)}else this.filterItems(null,this.label,!1)},selectLabel:function(a){this.content=null;this.filter&&this.filterItems(this.content,a);this.label=a}},watch:{items:function(a){if(a&&a.then){var b=this;a.then(function(c){b.values.splice(0,b.values.length);nabu.utils.arrays.merge(b.values,c);b.synchronizeValue(!0)})}else this.values.splice(0,this.values.length),
a&&(nabu.utils.arrays.merge(this.values,a),this.synchronizeValue(!0))},value:function(a,b){this.updatingContent?(this.synchronizeValue(!1),this.updatingContent=!1):this.synchronizeValue(!0);this.keyValue=null;this.setKeyValue()},disabled:function(a,b){0==a&&1==b&&this.filter&&this.filterItems(this.content,this.label)},labels:function(a){this.label&&0>a.indexOf(this.label)&&(this.label=a.length?a[0]:null,this.filterItems(this.content,this.label))},showValues:function(a){if(a){var b=this;this.keyValue=
null;this.setKeyValue();Vue.nextTick(function(){b.scrollTo("active")})}else this.keyValue=null},formatted:function(a){a?this.content=this.cleanupFormatted(a):this.value||(this.content="")}}});
Vue.component("n-input-combo2",{template:"#n-input-combo2",props:{value:{required:!0},initialRawValues:{type:Array},name:{required:!1},placeholder:{type:String},placeholderSelected:{type:String},items:{type:Array,required:!1},filter:{type:Function,required:!1},nillable:{type:Boolean,default:!0},formatter:{type:Function,required:!1},extracter:{type:Function,required:!1},prettyFormatter:{type:Function,required:!1},grouper:{type:Function,required:!1},resolver:{type:Function,required:!1},emptyValue:{type:String,
required:!1},calculatingValue:{type:String,required:!1},resetValue:{type:String,required:!1},selectAllValue:{type:String,required:!1},searchInDropdown:{type:Boolean,required:!1},useCheckbox:{type:Boolean,default:!1},allowTyping:{type:Boolean,default:!1},disabled:{type:Boolean,required:!1,default:!1},timeout:{type:Number,default:600},showTags:{type:Boolean,default:!1},maxAmountOfTags:{default:3},showAmount:{type:Boolean,default:!1},deleteTagIcon:{type:String,default:"times"},autoclose:{type:Boolean,
required:!1,default:!0},loadOnFocus:{type:Boolean,default:!1}},data:function(){return{dirty:!1,showValues:!1,search:null,searchTimer:null,filteredValues:[],potentialValues:[],rawValues:[],calculating:!0,updating:!1,focused:!1,keyValue:null,hasSearched:!1,lastSearch:null,initialized:!1}},created:function(){null!=this.value&&(null!=this.initialRawValues&&this.initialRawValues.length&&nabu.utils.arrays.merge(this.rawValues,this.initialRawValues),this.synchronize(this.value))},computed:{visibleRawValues:function(){return null!=
this.maxAmountOfTags&&0<this.maxAmountOfTags?this.rawValues.slice(Math.max(0,this.rawValues.length-this.maxAmountOfTags),this.rawValues.length):this.rawValues},hiddenAmount:function(){return null!=this.maxAmountOfTags&&0<this.maxAmountOfTags?Math.max(0,this.rawValues.length-this.maxAmountOfTags):0},multiple:function(){return this.value instanceof Array},groups:function(){var a={};if(this.grouper){var b=this;this.potentialValues.forEach(function(c){var d=b.grouper(c);null!=d&&(a[d]||(a[d]=[]),a[d].push(c))})}return a},
ungrouped:function(){var a=[];this.grouper?this.potentialValues.forEach(function(b){null==self.grouper(b)&&a.push(b)}):nabu.utils.arrays.merge(a,this.potentialValues);return a},currentPlaceholder:function(){return this.multiple&&null!=this.value&&0!=this.value.length&&this.placeholderSelected?this.placeholderSelected.replace("{amount}",this.value.length):this.placeholder}},methods:{markDirty:function(){this.dirty=!0},click:function(){this.disabled||this.allowTyping||(this.load(),this.showValues=!0)},
focus:function(){this.disabled||(this.loadOnFocus&&(this.dirty=!0),this.load(),this.showValues=!0)},deselect:function(a){null==a?this.rawValues.splice(0):(a=this.rawValues.indexOf(a),this.rawValues.splice(a,1))},getExtracted:function(a){this.extracter&&null!=a&&(a=this.extracter(a));return a},getPrettyFormatted:function(a){return this.prettyFormatter&&null!=a?this.prettyFormatter(a):this.getFormatted(a)},getFormatted:function(a){this.formatter&&null!=a&&(a=this.formatter(a));return a},getPlainFormatted:function(a){(a=
this.getFormatted(a))&&a.replace&&(a=a.replace(/<[^>]+>/g,""));return a},isEqual:function(a,b){return this.extracter?this.extracter(a)==this.extracter(b):JSON.stringify(a)==JSON.stringify(b)},showIfFocus:function(){this.$refs.searchInput==document.activeElement&&(this.showValues=!0)},initializeKeyValue:function(){null==this.keyValue&&(this.keyValue=this.potentialValues[0])},commitKeyValue:function(a){null!=this.keyValue&&this.toggle(this.keyValue);a.stopPropagation();a.preventDefault()},moveUp:function(a){this.moveKeyValue(-1);
a.stopPropagation();a.preventDefault()},moveDown:function(a){this.moveKeyValue(1);a.stopPropagation();a.preventDefault()},moveKeyValue:function(a){this.showValues=!0;this.initializeKeyValue();if(null!=this.keyValue){var b=this.potentialValues.indexOf(this.keyValue);b+=a;if(b<this.potentialValues.length&&0<=b){this.keyValue=this.potentialValues[b];var c=this;Vue.nextTick(function(){c.$refs.valueList.querySelectorAll("li").item(b).scrollIntoView({behavior:"smooth",block:"center"})})}}},load:function(){var a=
this.search;null!=a&&""==a.trim()&&(a=null);!this.multiple&&this.rawValues.length&&this.getPlainFormatted(this.rawValues[0])==a&&(a=null);if(!this.dirty)if(this.hasSearched){if(a==this.lastSearch)return}else this.hasSearched=!0;this.lastSearch=a;this.dirty=!1;var b=this;b.calculating=!0;var c=function(e){if(e)for(var g=0;g<e.length;g++){var k=b.rawValues.filter(function(m){return b.isEqual(m,e[g])})[0];k&&(e[g]=k)}return e};if(this.items)b.potentialValues.splice(0),nabu.utils.arrays.merge(this.potentialValues,
c(this.items)),b.calculating=!1,b.showIfFocus();else if(this.filter){var d=this.filter(a);d&&d.then?d.then(function(e){b.potentialValues.splice(0);null==e||e instanceof Array||Object.keys(e).forEach(function(g){e instanceof Array||e[g]instanceof Array&&(e=e[g])});e instanceof Array&&nabu.utils.arrays.merge(b.potentialValues,c(e));b.calculating=!1;b.showIfFocus()}):d instanceof Array?(b.potentialValues.splice(0),nabu.utils.arrays.merge(b.potentialValues,c(d)),b.calculating=!1,b.showIfFocus()):(console.error("The provided result is not a list of available options",
d),b.calculating=!1)}else console.error("The provided items can not be resolved to a list of available options",d),b.calculating=!1},synchronize:function(a){null==a?a=[]:a instanceof Array||(a=[a]);var b=this;if(0<a.length)if(this.extracter){if(this.rawValues.length!=a.length){var c=[],d=this.extracter?this.potentialValues.map(function(m){return b.extracter(m)}):this.potentialValues,e=[];nabu.utils.arrays.merge(e,a.map(function(m){var p=d.indexOf(m);0>p&&c.push(m);return 0<=p?b.potentialValues[p]:
null}));var g=this.resolver;null==g&&null!=this.items&&0<this.items.length&&(g=function(m){m instanceof Array||(m=[m]);return b.items.filter(function(p){return 0<=m.indexOf(b.extracter?b.extracter(p):p)})});if(c.length&&null!=g){g=g(this.multiple?c:c[0]);var k=function(m){m instanceof Array||(m=[m]);var p=b.extracter?m.map(function(t){return b.extracter(t)}):m,q=[];c.forEach(function(t){var u=a.indexOf(t),w=p.indexOf(t);0<=w?e.splice(u,1,m[w]):(q.unshift(t),console.warn("Can not resolve existing value",
t))});q.forEach(function(t){t=a.indexOf(t);e.splice(t,1);a.splice(t,1)});e.unshift(b.rawValues.length);e.unshift(0);b.rawValues.splice.apply(b.rawValues,e)};null!=g&&g.then?g.then(k):null!=g&&k(g)}}}else nabu.utils.arrays.merge(this.rawValues,a);else!this.nillable&&0<this.potentialValues.length?this.rawValues.push(this.potentialValues[0]):this.rawValues.splice(0)},toggleAll:function(){if(this.rawValues.length==this.potentialValues.length)this.rawValues.splice(0);else{var a=[];a.push(0);a.push(0);
var b=this;nabu.utils.arrays.merge(a,this.potentialValues.filter(function(c){return 0>b.rawValues.indexOf(c)}));this.rawValues.splice.apply(this.rawValues,a)}},toggle:function(a){var b=this.rawValues.indexOf(a);0>b?(this.multiple||this.rawValues.splice(0),this.rawValues.push(a),this.multiple||(this.showValues=!1)):(2<=this.rawValues.length||this.nillable)&&this.rawValues.splice(b,1)}},watch:{calculating:function(a){a||this.initialized||(null!=this.value&&this.synchronize(this.value),this.initialized=
!0)},potentialValues:function(){this.keyValue=null},rawValues:function(){var a=this;this.updating=!0;if(this.multiple){var b=[],c=this.rawValues.map(function(d){b.push(a.getFormatted(d));return a.getExtracted(d)});c.unshift(this.value.length);c.unshift(0);this.value.splice.apply(this.value,c);this.$emit("label",b)}else this.searchUpdatedSelf=!0,this.search=this.getPlainFormatted(this.rawValues[0]),this.$emit("input",this.getExtracted(this.rawValues[0]),this.getFormatted(this.rawValues[0]),this.rawValues[0])},
value:{deep:!0,handler:function(){this.updating?this.updating=!1:this.synchronize(this.value)}},search:function(a){this.searchUpdatedSelf?this.searchUpdatedSelf=!1:(this.multiple||!this.nillable||null!=a&&""!=a.trim()||this.$emit("input",null),this.searchTimer&&(clearTimeout(this.searchTimer),this.searchTimer=null),this.searchTimer=setTimeout(this.load,600))}}});
Vue.component("n-form-date",{props:{value:{required:!0},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},placeholder:{type:String,required:!1},schema:{type:Object,required:!1},pattern:{type:String,required:!1},patternComment:{type:String,required:!1},minLength:{type:Number,required:!1},maxLength:{type:Number,required:!1},type:{type:String,required:!1,default:"text"},hide:{type:Boolean,required:!1,
default:null},disabled:{type:Boolean,required:!1},validator:{type:Function,required:!1},unique:{type:Boolean,required:!1},parser:{type:Function,required:!1},formatter:{type:Function,required:!1},minimum:{required:!1},maximum:{required:!1},allow:{type:Function,required:!1},stringify:{type:Boolean,required:!1,default:!1},timeout:{type:Number,required:!1,default:600},popup:{type:Number,required:!1},yearsDropdown:{type:Boolean,required:!1,default:!0},yearsFrom:{type:Number,required:!1},yearsTo:{type:Number,
required:!1},includeHours:{type:Boolean,required:!1,default:!1},includeMinutes:{type:Boolean,required:!1,default:!1},includeSeconds:{type:Boolean,required:!1,default:!1},timestamp:{type:Boolean,required:!1,default:!1},secondsTimestamp:{type:Boolean,required:!1,default:!1},"default":{required:!1},disableTextInput:{type:Boolean,required:!1},info:{type:String,required:!1},before:{type:String,required:!1},after:{type:String,required:!1},localTime:{type:Boolean,default:!1},translator:{type:Function,required:!1}},
template:"#n-form-date",data:function(){return{messages:[],valid:null,show:!1,date:null,customizedSchema:null,lastParsed:null}},computed:{dynamicPattern:function(){if(!this.formatter){var a="^[0-9]{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])";this.includeHours&&(a+=" [0-9]{2}",this.includeMinutes&&(a+=":[0-9]{2}",this.includeSeconds&&(a+=":[0-9]{2}")));return a+"$"}},defaultValue:function(){return this.default}},created:function(){!this.value&&this.default&&this.$emit("input",this.default);this.schema&&
("integer"==this.schema.type?(this.customizedSchema=nabu.utils.objects.deepClone(this.schema),this.customizedSchema.type="string",this.customizedSchema.format="date-time"):this.customizedSchema=this.schema);if(this.value instanceof Date||"number"==typeof this.value)this.date=this.formatValue(this.value);else if(null==this.value||isNaN(this.value))if("string"==typeof this.value){var a=this.valueToDate(this.value);this.date=this.formatValue(a);this.stringified||(this.$emit("input",a,this.value),this.$emit("label",
this.value))}else this.date=this.value;else this.date=this.formatValue(parseInt(this.value))},methods:{formatValue:function(a){a=a instanceof Date?a:new Date(this.secondsTimestamp?1E3*a:a);this.formatter?a=this.formatter(a):(a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()-a.getTimezoneOffset(),a.getSeconds(),0),a=this.includeHours&&this.includeMinutes&&this.includeSeconds?a.toISOString().substring(0,19).replace("T"," "):this.includeHours&&this.includeMinutes?a.toISOString().substring(0,
16).replace("T"," "):this.includeHours?a.toISOString().substring(0,13).replace("T"," "):a.toISOString().substring(0,10));return a},updateValue:function(a){this.stringify?this.$emit("input",a):(this.$emit("input",this.valueToDate(a),a),this.$emit("label",a))},isAvailable:function(a){return null==this.allow||this.allow(a)},dateValidate:function(a){var b=[];if(this.validator){var c=this.validator(a);c&&nabu.utils.arrays.merge(b,c)}""==a&&(a=null);c=null==a?null:this.valueToDate(a);null!=a&&(null==c||
!c.getTime)||null!=c&&c.getTime&&isNaN(c.getTime())?b.push({severity:"error",code:"type",title:"%{validation::This is not a valid date: {actual}}",values:{actual:a,expected:"date"},context:[]}):null==c||!c.getTime||isNaN(c.getTime())||this.isAvailable(c)||b.push({severity:"error",code:"allowed",title:"%{validation::This date is not allowed: {actual}}",priority:1,variables:{actual:a},context:[]});return b},validate:function(){var a=this.$refs.text.validate();this.valid=!a.length;return a},focus:function(){this.showPopup();
this.show=this.edit&&!this.disabled?!this.show:!1},showPopup:function(){if(this.popup){var a=this;setTimeout(function(){a.show=a.edit&&!a.disabled},this.popup)}},valueToDate:function(a){if(this.parser)return this.parser(a);this.localTime||(this.includeHours?this.includeMinutes?this.includeSeconds||(a+=":00Z"):a+=":00:00Z":a+="T00:00:00Z");a&&a.match&&a.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}[\s]+[0-9]{2}:[0-9]{2}:[0-9]{2}.*$/)&&(a=a.replace(/([0-9]{4}-[0-9]{2}-[0-9]{2})[\s]+([0-9]{2}:[0-9]{2}:[0-9]{2}.*)$/,
"$1T$2"));return new Date(a)}},watch:{date:function(a){if(a)if(this.secondsTimestamp)this.value&&this.formatValue(this.value)==a||(a=this.valueToDate(a),this.$emit("input",a.getTime()/1E3,this.formatValue(a)),this.$emit("label",this.formatValue(a)));else if(this.timestamp)this.value&&this.formatValue(this.value)==a||(a=this.valueToDate(a),this.$emit("input",a.getTime(),this.formatValue(a)),this.$emit("label",this.formatValue(a)));else if(this.stringify)this.value!=a&&(a=this.formatValue(this.valueToDate(a)),
this.$emit("input",a,this.formatValue(a)),this.$emit("label",this.formatValue(a)));else if((a=this.valueToDate(a))&&a.getTime){var b=this.value;"string"==typeof b&&(b=new Date(this.value));this.value&&a.getTime()==b.getTime()||(this.lastParsed=a,this.$emit("input",a,this.formatValue(a)),this.$emit("label",this.formatValue(a)),this.show=!1)}else this.lastParsed=null,this.$emit("input",null),this.$emit("label",null);else this.value&&(this.$emit("input",null),this.$emit("label",null))},value:function(a){if("string"==
typeof a&&a.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}.*/)&&this.lastParsed){var b=new Date(a);b.getTime()==this.lastParsed.getTime()&&(a=b)}a instanceof Date||"number"==typeof a?(b=this.formatValue(a),null!=this.lastParsed&&this.lastParsed.getTime()==a.getTime()&&b!=this.date?console.warn("Prevented a date loop potentially caused by a timezone difference",this.lastParsed,b,this.date):(this.date=b,this.$emit("input",a,this.formatValue(a))),this.lastParsed=null):this.date=a},"default":function(a){(a&&
!this.value||this.value&&!this.isAvailable(this.value))&&this.$emit("input",a)}}});
Vue.component("n-form-date-picker",{template:"#n-form-date-picker",props:{value:{required:!0},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},hide:{type:Boolean,required:!1},placeholder:{type:String,required:!1},placeholderYear:{type:String,required:!1},placeholderMonth:{type:String,required:!1},placeholderDay:{type:String,required:!1},schema:{type:Object,required:!1},pattern:{type:String,required:!1},
patternComment:{type:String,required:!1},minLength:{type:Number,required:!1},maxLength:{type:Number,required:!1},disabled:{type:Boolean,required:!1},validator:{type:Function,required:!1},format:{type:String,required:!1},minimum:{required:!1},maximum:{required:!1},allow:{type:Function,required:!1},notBefore:{required:!1},notAfter:{required:!1},minimumOffset:{type:Number,required:!1},maximumOffset:{type:Number,required:!1},stringify:{type:Boolean,required:!1,default:!1},timeout:{type:Number,required:!1,
default:600},default:{required:!1},fields:{type:Array,required:!1,default:function(){return["year","month","day"]}},autoFormat:{type:Boolean,required:!1,default:!1},allowPartial:{type:Boolean,required:!1,default:!1},description:{type:String,required:!1},filterValues:{type:Boolean,required:!1,default:!1},descriptionIcon:{type:String,required:!1},descriptionType:{type:String,default:"after"},info:{type:String,required:!1},after:{type:String,required:!1},before:{type:String,required:!1},suffix:{type:String,
required:!1},suffixIcon:{type:String,required:!1}},data:function(){return{result:{year:null,month:null,day:null},messages:[],valid:null}},created:function(){!this.value&&this.default&&this.$emit("input",this.default);this.value&&(this.result.year=0<=this.fields.indexOf("year")?this.value.getFullYear():null,this.result.month=0<=this.fields.indexOf("month")?this.value.getMonth()+1:null,this.result.day=0<=this.fields.indexOf("day")?this.value.getDate():null)},computed:{self:function(){return this},definition:function(){return nabu.utils.vue.form.definition(this)},
mandatory:function(){return nabu.utils.vue.form.mandatory(this)},formattedDate:function(){var a=this.format;a||="dd MMMM yyyy";return null==this.value?null:this.$services.formatter.date(this.value,a)}},methods:{validate:function(a){this.messages.splice(0,this.messages.length);for(var b=nabu.utils.schema.json.validate(this.definition,this.value,this.mandatory),c=0;c<b.length;c++)Object.defineProperty(b[c],"component",{value:this,enumerable:!1});if(null!=this.validator){var d=this.validator(this.value);
if(null!=d&&d.length)for(c=0;c<d.length;c++)Object.defineProperty(d[c],"component",{value:this,enumerable:!1}),"undefined"==typeof d[c].context&&(d[c].context=[]),b.push(d[c]);else null!=d&&d.then&&b.defer(d)}c=b.filter(function(e){return!e.soft});a&&0==c.length&&(0<b.length||!valueToValidate)&&null==this.valid?(this.valid=null,this.messages.splice(0)):(this.valid=0==b.length,nabu.utils.arrays.merge(this.messages,nabu.utils.vue.form.localMessages(this,b)));return b},getPlaceholder:function(a){return"year"==
a?this.placeholderYear:"month"==a?this.placeholderMonth:"day"==a?this.placeholderDay:null},editable:function(a){return"year"==a||"month"==a&&(null!=this.result.year||0>this.fields.indexOf("year"))||"day"==a&&(null!=this.result.year||0>this.fields.indexOf("year"))&&(null!=this.result.month||0>this.fields.indexOf("month"))},listField:function(a,b){var c=null!=this.notBefore?this.notBefore instanceof Date?this.notBefore:new Date(this.notBefore):null!=this.maximumOffset&&0>=this.maximumOffset?new Date((new Date).getTime()+
864E5*this.maximumOffset):null!=this.minimumOffset&&0<this.minimumOffset?new Date((new Date).getTime()+864E5*this.minimumOffset):new Date("1900-01-01T00:00:00Z");var d=null!=this.notAfter?this.notAfter instanceof Date?this.notAfter:new Date(this.notAfter):null!=this.maximumOffset&&0<this.maximumOffset?new Date((new Date).getTime()+864E5*this.maximumOffset):null!=this.minimumOffset&&0>=this.minimumOffset?new Date((new Date).getTime()+864E5*this.minimumOffset):new Date("2075-01-01T00:00:00Z");var e=
[];if("year"==a){for(var g=c.getFullYear();g<=d.getFullYear();g++)(null==b||!this.filterValues||0<=this.formatField(a,g).toLowerCase().indexOf(b.toLowerCase()))&&e.push(g);e.reverse()}else if("month"==a)for(g=1;12>=g;g++){if(null!=this.result.year)if((new Date(this.result.year,g,-1)).getTime()<c.getTime())continue;else if((new Date(this.result.year,g-1,1)).getTime()>d.getTime())continue;(null==b||!this.filterValues||0<=this.formatField(a,g).toLowerCase().indexOf(b.toLowerCase()))&&e.push(g)}else if("day"==
a)for(g=1;31>=g;g++){if(null!=this.result.year&&null!=this.result.month){var k=new Date(this.result.year,this.result.month-1,g);if(k.getMonth()!=this.result.month-1)continue;else if(k.getTime()<c.getTime())continue;else if(k.getTime()>d.getTime())continue}(null==b||!this.filterValues||0<=this.formatField(a,g).toLowerCase().indexOf(b.toLowerCase()))&&e.push(g)}return e},formatField:function(a,b){return null==b?b:"year"!=a&&"month"==a?nabu.utils.dates.months()[b-1]:""+b},updateField:function(a,b){""==
b&&(b=null);var c=this;this.result[a]=b;"year"==a?(null!=this.result.month&&(b=this.listField("month"),0>b.indexOf(this.result.month)&&(this.result.month=null,this.result.day=null)),this.$refs.month[0].refilter(),null!=this.result.year&&0<=this.fields.indexOf("month")&&setTimeout(function(){c.$refs.month[0].$el.querySelector("input").focus()},1)):"month"==a&&null!=this.result.month&&0<=this.fields.indexOf("day")&&setTimeout(function(){c.$refs.day[0].$el.querySelector("input").focus()},1);if("year"==
a||"month"==a)null!=this.result.day&&(b=this.listField("day"),0>b.indexOf(this.result.day)&&(this.result.day=null)),0<=this.fields.indexOf("day")&&this.$refs.day[0].refilter();this.emitValue()},emitValue:function(){var a=null;var b=!0;for(var c=0;c<this.fields.length;c++)if(null==this.result[this.fields[c]]){b=!1;break}if(b||this.allowPartial)a=null==this.result.year?(new Date).getFullYear():this.result.year,a+="-"+(null==this.result.month?"01":(10>this.result.month?"0":"")+this.result.month),a+=
"-"+(null==this.result.day?"01":(10>this.result.day?"0":"")+this.result.day),a+="T00:00:00Z";if(null!=a||null!=this.value)this.autoFormat?(b=null,this.result.year&&(b="yyyy"),this.result.month&&(b="yyyy-MM"),this.result.day&&(b="yyyy-MM-dd"),null!=b&&this.$emit("input",null==a?null:this.$services.formatter.date(new Date(a),b))):this.$emit("input",null==a?null:new Date(a))}}});
Vue.component("n-form-file",{props:{value:{required:!0},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},placeholder:{type:String,required:!1},schema:{type:Object,required:!1},info:{type:String,required:!1},infoIcon:{type:String,required:!1},prefix:{type:String,required:!1},prefixIcon:{type:String,required:!1},suffix:{type:String,required:!1},suffixIcon:{type:String,required:!1},before:{type:String,
required:!1},after:{type:String,required:!1},allow:{type:Function,required:!1},formatter:{type:Function,required:!1},masker:{type:Function,required:!1},parser:{type:Function,required:!1},codes:{required:!1},types:{type:Array,required:!1},amount:{required:!1},maxFileSize:{type:Number,required:!1},disabled:{type:Boolean,required:!1,default:!1},browseLabel:{type:String,required:!1},dropLabel:{type:String,required:!1},browseIcon:{type:String,required:!1},deleteIcon:{type:String,required:!1,default:"fa fa-times"},
restrictionMessage:{type:String,required:!1},buttonClass:{required:!1},visualizeFileNames:{type:Boolean,required:!1},fileNameDeleteClass:{required:!1},fileNameContainerClass:{required:!1},fileNameClass:{required:!1}},template:"#n-form-file",data:function(){return{messages:[],valid:null,timer:null,localValue:null,offsetX:0,blurred:!1,valueToCommit:null}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("n-form-combo",{props:{value:{required:!0},label:{type:String,required:!1},labels:{type:Array,required:!1},initialLabel:{required:!1},filter:{type:Function,required:!1},formatter:{type:Function,required:!1},extracter:{type:Function,required:!1},prettyFormatter:{type:Function,required:!1},resolver:{type:Function,required:!1},required:{type:Boolean,required:!1,default:null},schema:{type:Object,required:!1},edit:{type:Boolean,required:!1,default:!0},items:{required:!1},nillable:{type:Boolean,
default:!0},timeout:{type:Number,required:!1},placeholder:{type:String,required:!1},placeholderSelected:{type:String,required:!1},autoclose:{type:Boolean,required:!1,default:!0},disabled:{type:Boolean,required:!1},name:{type:String,required:!1},autocomplete:{type:String,required:!1},autoselectSingle:{type:Boolean,required:!1},caseInsensitive:{type:Boolean,required:!1,default:!1},descriptionIcon:{type:String,required:!1},description:{type:String,required:!1},descriptionType:{type:String,default:"after"},
info:{type:String,required:!1},infoIcon:{type:String,required:!1},after:{type:String,required:!1},before:{type:String,required:!1},validator:{type:Function,required:!1},allowTyping:{type:Boolean,default:!0},emptyValue:{type:String,required:!1},calculatingValue:{type:String,required:!1},resetValue:{type:String,required:!1},prefix:{type:String,required:!1},prefixIcon:{type:String,required:!1},suffix:{type:String,required:!1},suffixIcon:{type:String,required:!1},allowTypeMatch:{type:Boolean,required:!1},
comboType:{type:String,default:"n-input-combo"},selectAllValue:{type:String,required:!1},searchInDropdown:{type:Boolean,required:!1},useCheckbox:{type:Boolean,default:!1},showTags:{type:Boolean,default:!1},maxAmountOfTags:{default:3},showAmount:{type:Boolean,default:!1},deleteTagIcon:{type:String,default:"times"},loadOnFocus:{type:Boolean,default:!1}},template:"#n-form-combo",data:function(){return{valid:null,messages:[],valueLabel:null}},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},
mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},methods:{refilter:function(){this.$refs.combo.refilter()},validate:function(a){this.messages.splice(0);var b=nabu.utils.schema.json.validate(this.definition,this.value,this.mandatory),c=b.filter(function(e){return"required"==e.code})[0];c&&this.$refs&&this.$refs.combo&&this.$refs.combo.content&&(c.title="%{validation::The value you entered is invalid}",c.actual=this.$refs.combo.content);for(c=0;c<b.length;c++)Object.defineProperty(b[c],
"component",{value:this,enumerable:!1});b=nabu.utils.vue.form.validateCustom(b,this.value,this.validator,this);var d=this;b.then(function(e){e=b.filter(function(g){return!g.soft});a&&0==e.length&&(0<b.length||null==d.value)&&(null==d.valid||null==d.value)?d.valid=null:(d.valid=0==b.length,d.messages.splice(0),nabu.utils.arrays.merge(d.messages,nabu.utils.vue.form.localMessages(d,b)))});return b},updateValue:function(a,b,c,d){this.$emit("input",a,b,c,d)},clear:function(){this.$refs.combo.clear()}},
watch:{value:function(){this.messages.splice(0);this.valid=null}}});
Vue.component("n-form-section",{props:{name:{type:String,required:!1},schema:{type:Object,required:!1},label:{type:String,required:!1},value:{required:!1},validator:{type:Function,required:!1},mode:{type:String,required:!1}},data:function(){return{labels:[]}},template:"#n-form-section",computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},methods:{validate:function(a){a=nabu.utils.vue.form.validateChildren(this,
a);if(this.validator){var b=this.validator(this.value);if(b&&b.length)for(var c=0;c<b.length;c++)Object.defineProperty(b[c],"component",{value:this,enumerable:!1}),"undefined"==typeof b[c].context&&(b[c].context=[]),a.push(b[c])}return a}},events:{"$vue.child.added":function(a){a.label?this.labels.push({name:a.label,component:a}):!this.labels.length&&a.labels?nabu.utils.arrays.merge(this.labels,a.labels):this.labels.push(null)}}});
Vue.component("n-form-richtext",{props:{value:{required:!0},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},schema:{type:Object,required:!1},pattern:{type:String,required:!1},minLength:{type:Number,required:!1},maxLength:{type:Number,required:!1},timeout:{type:Number,required:!1},cleanStyle:{type:Boolean,required:!1},info:{type:String,required:!1},suffix:{type:String,required:!1},before:{type:String,
required:!1},after:{type:String,required:!1},supportLinkType:{type:Boolean,required:!1},supportBlocks:{type:Boolean,default:!0},placeholder:{type:String,default:"Rich text"},showMenu:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},template:"#n-form-richtext",data:function(){return{messages:[],valid:null,showBlock:!1,showJustify:!1,showDecoration:!1,color:"#000000",localValue:null,internalSet:!1}},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},
created:function(){this.localValue=this.value},methods:{update:function(a){var b=a.target.innerHTML;if(b!=this.value)if(this.$emit("change",b),null!=this.timer&&(clearTimeout(this.timer),this.timer=null),this.timeout){var c=this;c=this;this.timer=setTimeout(function(){c.internalSet=!0;c.$emit("input",b)},this.timeout)}else this.internalSet=!0,this.$emit("input",b)},justify:function(a){document.execCommand(a,!1,null)},insertTable:function(){document.execCommand("insertHTML",null,"\x3ctable cellspacing\x3d'0' cellpadding\x3d'0'\x3e\x3ctr\x3e\x3ctd\x3e"+
window.getSelection()+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")},list:function(){document.execCommand("insertHTML",null,"\x3cul\x3e\x3cli\x3e"+window.getSelection()+"\x3c/li\x3e\x3c/ul\x3e")},wrap:function(a){document.execCommand("insertHTML",null,"\x3c"+a+"\x3e"+window.getSelection()+"\x3c/"+a+"\x3e")},bold:function(){document.execCommand("bold",!1,null)},italic:function(){document.execCommand("italic",!1,null)},underline:function(){document.execCommand("underline",!1,null)},link:function(){var a=
prompt("Link");if(a){var b=null;this.supportLinkType&&(b=prompt("Link Type (optional)"));var c=prompt("Link classes");b?document.execCommand("insertHTML",!1,"\x3ca class\x3d'"+c+"' target\x3d'_blank' type\x3d'"+b+"' href\x3d'"+a+"' rel\x3d'noreferer noopener nofollow'\x3e"+window.getSelection()+"\x3c/a\x3e"):document.execCommand("insertHTML",!1,"\x3ca class\x3d'"+c+"' target\x3d'_blank' href\x3d'"+a+"' rel\x3d'noreferer noopener nofollow'\x3e"+window.getSelection()+"\x3c/a\x3e")}},paste:function(a){for(var b=
this,c=0;c<a.clipboardData.items.length;c++)if(a.clipboardData.items[c].type.toLowerCase().match(/text\/.*/)){a.clipboardData.items[c].getAsString(function(d){d=nabu.utils.elements.clean(d,"p strong h1 h2 h3 h4 h5 h6 h7 strong em b i u ul ol li br span div".split(" "),["head","script","style","meta","font"],null,b.cleanStyle?["style"]:null);document.execCommand("insertHTML",null,d)});break}a.preventDefault()},tab:function(a){document.execCommand("insertHTML",!1,"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;");
a.preventDefault()},indent:function(){document.execCommand("indent",!1,null)},outdent:function(){document.execCommand("outdent",!1,null)},clean:function(){document.execCommand("removeFormat",!1,null)},validate:function(){for(var a=nabu.utils.schema.json.validate(this.definition,this.value?this.value.replace(/<[^>]+>/,""):this.value,this.mandatory),b=0;b<a.length;b++)Object.defineProperty(a[b],"component",{value:this,enumerable:!1});this.valid=0==a.length;return a},applyColor:function(){document.execCommand("insertHTML",
null,"\x3cspan style\x3d'color:"+this.color+"'\x3e"+window.getSelection()+"\x3c/span\x3e")}},watch:{value:function(a){this.internalSet?this.internalSet=!1:this.localValue=a}}});Vue.directive("html-once",{bind:function(a,b){a.innerHTML=b.value}});Vue.directive("html-basic",{bind:function(a,b){a.innerHTML=null==b.value?"":b.value},update:function(a,b){a.innerHTML=null==b.value?"":b.value}});
Vue.component("n-form-checkbox",{props:{component:{type:String,default:"is-form-checkbox"},value:{required:!0},item:{required:!1},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},schema:{type:Object,required:!1},hide:{type:Boolean,required:!1,default:null},disabled:{type:Boolean,required:!1},invert:{type:Boolean,required:!1,default:!1},validator:{type:Function,required:!1},mustCheck:{type:Boolean,
required:!1,default:!1},info:{type:String,required:!1},infoIcon:{type:String,required:!1},before:{type:String,required:!1},after:{type:String,required:!1},labelBefore:{type:Boolean,required:!1},tabindex:{type:String}},template:"#n-form-checkbox",data:function(){return{messages:[],valid:null,calculatedValue:!1}},created:function(){var a=this.getBooleanValue(this.value);this.calculatedValue=this.invertIfNecessary(a)},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},
methods:{getBooleanValue:function(a){if(null==a)var b=!1;else if("false"===a)b=!1;else if("true"===a)b=!0;else if(a instanceof Array)if(this.item instanceof Array){b=!0;for(var c=0;c<this.item.length;c++)if(0>a.indexOf(this.item[c])){b=!1;break}}else b=0<=a.indexOf(this.item);else b=a;return b},invertIfNecessary:function(a){return this.invert?!a:a},validate:function(){for(var a=nabu.utils.schema.json.validate(this.definition,this.mustCheck&&!this.calculatedValue?null:null==this.calculatedValue?!1:
this.calculatedValue,this.mandatory||this.mustCheck),b=0;b<a.length;b++)Object.defineProperty(a[b],"component",{value:this,enumerable:!1});if(this.validator){var c=this.validator(this.value);if(c&&c.length)for(b=0;b<c.length;b++)Object.defineProperty(c[b],"component",{value:this,enumerable:!1}),"undefined"==typeof c[b].context&&(c[b].context=[]),a.push(c[b])}this.valid=0==a.length;return a},toggleValue:function(){if(!this.disabled&&this.edit)if(this.value instanceof Array){var a=this,b=function(d){var e=
a.value.indexOf(d);0<=e?(a.value.splice(e,1),a.$emit("remove",d)):(a.value.push(d),a.$emit("add",d))};if(this.item instanceof Array){var c=this.getBooleanValue(this.value);this.item.forEach(function(d){var e=a.value.indexOf(d);c&&0<=e?(a.value.splice(e,1),a.$emit("remove",d)):!c&&0>e&&(a.value.push(d),a.$emit("add",d))})}else b(this.item)}else this.$emit("input",this.invertIfNecessary(!this.calculatedValue))},updateChecked:function(a){this.$refs&&this.$refs.input&&(a?this.$refs.input.setAttribute("checked",
"true"):this.$refs.input.removeAttribute("checked"))}},watch:{value:function(a){a=this.getBooleanValue(this.value);this.calculatedValue=this.invertIfNecessary(a);this.updateChecked(this.calculatedValue)}}});Vue.directive("checked",function(a,b){b.value instanceof Array&&b.length||!(b.value instanceof Array)&&b.value?a.setAttribute("checked","true"):a.removeAttribute("checked")});
Vue.component("n-form-checkbox-list",{template:"#n-form-checkbox-list",props:{value:{required:!0},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},label:{type:String,required:!1},name:{type:String,required:!1},schema:{type:Object,required:!1},hide:{type:Boolean,required:!1,default:null},disabled:{type:Boolean,required:!1},items:{type:Array,required:!0,default:function(){return[]}},filter:{type:Function},validator:{type:Function,required:!1},formatter:{type:Function,
required:!1},extracter:{type:Function,required:!1},info:{type:String,required:!1},after:{type:String,required:!1},before:{type:String,required:!1}},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},data:function(){return{messages:[],valid:null,actualValue:null,chosen:!1,labels:[]}},created:function(){if(this.filter){var a=this,b=this.filter();b&&b.then?b.then(function(c){a.items.splice(0);null==c||c instanceof
Array||Object.keys(c).forEach(function(d){c instanceof Array||c[d]instanceof Array&&(c=c[d])});c instanceof Array&&nabu.utils.arrays.merge(a.items,c)}):b instanceof Array&&nabu.utils.arrays.merge(a.items,b)}},mounted:function(){if(null!=this.value&&!(this.value instanceof Array))this.$emit("input",[this.value]);else if(!(this.value&&this.value instanceof Array))this.$emit("input",[]);else if(this.value.length){var a=this;this.value.forEach(function(b){var c;a.extracter?a.items.forEach(function(d,
e){a.extracter(d)==b&&(c=e)}):c=a.items.indexOf(b);a.labels.push(0<=c?a.formatter?a.formatter(a.value[c]):a.value[c]:a.value[c])})}},methods:{isChecked:function(a){a=this.extracter?this.extracter(a):a;return this.value&&0<=this.value.indexOf(a)},toggle:function(a){a=this.extracter?this.extracter(a):a;var b=this.value.indexOf(a);0<=b?(this.value.splice(b,1),this.labels.splice(b,1)):(this.value.push(a),this.labels.push(this.formatter?this.formatter(a):a))},validate:function(a){this.messages.splice(0,
this.messages.length);var b=nabu.utils.schema.json.validate(this.definition,this.value,this.mandatory),c=b.filter(function(d){return"required"==d.code})[0];c?c.title="%{validation::You must choose at least one option}":this.mandatory&&0==this.value.length&&b.push({code:"required",severity:"error",soft:!0,priority:0,title:"%{validation::You must choose at least one option}"});for(c=0;c<b.length;c++)Object.defineProperty(b[c],"component",{value:this,enumerable:!1});c=b.filter(function(d){return!d.soft});
a&&0==c.length&&(0<b.length||null==this.value)&&(null==this.valid||null==this.value)?(this.valid=null,this.messages.splice(0)):(this.valid=0==b.length,nabu.utils.arrays.merge(this.messages,nabu.utils.vue.form.localMessages(this,b)));return b}}});
Vue.component("n-form-text",{props:{value:{required:!0},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},placeholder:{type:String,required:!1},schema:{type:Object,required:!1},pattern:{type:String,required:!1},patternComment:{type:String,required:!1},minLength:{type:Number,required:!1},maxLength:{type:Number,required:!1},type:{type:String,required:!1,default:"text"},hide:{type:Boolean,required:!1,
default:null},disabled:{type:Boolean,required:!1},validator:{type:Function,required:!1},unique:{type:Boolean,required:!1},caseSensitive:{type:Boolean,required:!1,default:!0},timeout:{required:!1},maximum:{type:Number,required:!1},minimum:{type:Number,required:!1},step:{type:Number,required:!1},exclusiveMaximum:{type:Number,required:!1},exclusiveMinimum:{type:Number,required:!1},trim:{type:Boolean,required:!1,default:!1},mode:{type:String,required:!1},autoSelect:{type:Boolean,required:!1,default:!1},
autoScale:{type:Boolean,required:!1,default:!1},info:{type:String,required:!1},infoIcon:{type:String,required:!1},prefix:{type:String,required:!1},prefixIcon:{type:String,required:!1},suffix:{type:String,required:!1},suffixIcon:{type:String,required:!1},before:{type:String,required:!1},after:{type:String,required:!1},allow:{type:Function,required:!1},formatter:{type:Function,required:!1},masker:{type:Function,required:!1},parser:{type:Function,required:!1},codes:{required:!1},showTooltip:{type:Boolean,
required:!1,default:!0},autocomplete:{type:String,default:0<=window.navigator.userAgent.indexOf("Chrome")?"nothing":"off"},showCustomSpinner:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},commit:{type:Boolean,default:!1},validateOnBlur:{type:Boolean,default:!1}},template:"#n-form-text",data:function(){return{messages:[],valid:null,timer:null,localValue:null,offsetX:0,blurred:!1,valueToCommit:null}},created:function(){this.localValue=this.formatter&&null!=this.value?this.formatter(this.value):
this.value;this.masker&&(this.localValue=null!=this.value?this.masker(this.value):this.value)},ready:function(){"range"==this.type&&this.calculateOffset(this.value);this.autofocus&&this.$refs.input&&(this.$refs.input.focus(),this.$refs.input.select())},computed:{rows:function(){return this.autoScale?this.value?this.value.length-this.value.replace(/\n/g,"").length+1:1:null},definition:function(){var a=nabu.utils.vue.form.definition(this);"number"==this.type&&(a.type="number");return a},rangeWidth:function(){return this.minimum&&
this.maximum&&this.exclusiveMinimum&&this.exclusiveMaximum?(this.maximum-this.minimum)/(this.exclusiveMaximum-this.exclusiveMinimum)*100+"%":"100%"},rangeLeftOffset:function(){return this.minimum&&this.maximum&&this.exclusiveMinimum&&this.exclusiveMaximum?(this.minimum-this.exclusiveMinimum)/(this.exclusiveMaximum-this.exclusiveMinimum)*100+"%":"0%"},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},methods:{attemptSubmit:function(){for(var a=this.$el;a;)if(a.tagName&&"form"==a.tagName.toLowerCase()){(a=
a.querySelector("button[type\x3d'submit']"))&&a.click();break}else a=a.parentNode},mergeContent:function(a){return this.$refs.input.value?this.$refs.input.value.substring(0,this.$refs.input.selectionStart)+a+this.$refs.input.value.substring(this.$refs.input.selectionEnd):a},pasteHandler:function(a){var b=b=a.clipboardData||window.clipboardData;b=b.getData("Text");if(this.allow)if(b=this.allow(null,this.mergeContent(b)),"string"==typeof b){var c=this.$refs.input.selectionStart;this.$refs.input.value=
b;this.$refs.input.selectionEnd=Math.min(c+1,b.length);a.preventDefault();a.stopPropagation();this.updateValue(b)}else if(b instanceof Array&&0<b.length||!b)a.preventDefault(),a.stopPropagation()},checkKey:function(a){"Enter"==a.key&&(this.timer&&(clearTimeout(this.timer),this.timer=null),this.$emit("input",this.valueToCommit),this.$emit("commit"));if(this.allow&&a.key&&!a.ctrlKey&&!a.metaKey){var b=this.allow(a.key,this.mergeContent(a.key));if(b instanceof Array){if(0<b.length)return a.preventDefault(),
!1}else if("string"==typeof b){var c=this.$refs.input.selectionStart;this.$refs.input.value=b;this.$refs.input.selectionEnd=Math.min(c+1,b.length);a.preventDefault();this.updateValue(b)}else if(!b)return a.preventDefault(),!1}return!0},focus:function(a){this.blurred=!1;this.$emit("focus",a);this.autoSelect&&this.$refs.input.select();this.masker&&(this.localValue=this.formatter&&null!=this.value?this.formatter(this.value):this.value)},blur:function(a){this.blurred=!0;this.localValue=this.masker&&null!=
a?this.masker(a):a;this.$emit("blur");this.validateOnBlur&&this.validate(!0)},validate:function(a){if(this.masker)var b=this.value;else b=this.edit?this.$refs.input.value:this.value,this.trim&&b&&b.trim&&(b=b.trim()),""==b&&(b=null);this.parser&&null!=b&&(b=this.parser(b));this.messages.splice(0);for(var c=nabu.utils.schema.json.validate(this.definition,b,this.mandatory),d=0;d<c.length;d++)Object.defineProperty(c[d],"component",{value:this,enumerable:!1});if(null!=b&&this.unique&&this.$group){var e=
0;for(d=0;d<this.$group.length;d++)this.$group[d].$el&&this.$document.body.contains(this.$group[d].$el)&&(this.$group[d].value==b?e++:!this.caseSensitive&&this.$group[d].value&&b&&this.$group[d].value.toLowerCase()==b.toLowerCase()&&e++);1<e&&(d={code:"unique",context:[],severity:"error",values:{expected:1,actual:e,value:b}},Object.defineProperty(d,"component",{value:this,enumerable:!1}),c.push(d))}c=nabu.utils.vue.form.validateCustom(c,b,this.validator,this);var g=this;c.then(function(k){nabu.utils.vue.form.rewriteCodes(c,
g.codes);k=c.filter(function(p){return"error"!=p.severity});k.length&&k.forEach(function(p){c.splice(c.indexOf(p),1)});g.messages.splice(0);var m=c.filter(function(p){return!p.soft});a&&0==m.length&&(0<c.length||!b)&&null==g.valid?g.valid=null:(g.valid=0==c.length,nabu.utils.arrays.merge(g.messages,nabu.utils.vue.form.localMessages(g,c)));g.timer&&(clearTimeout(g.timer),g.timer=null);if(null!=g.value||b)g.valueToCommit=g.valueToValidate,g.$emit("input",b);k.length&&nabu.utils.arrays.merge(g.messages,
k)});return c},calculateOffset:function(a){a?this.$refs.input&&(parseFloat(a),a=this.$refs.input,a=(a.value-a.min)/(a.max-a.min),this.$refs.tooltip.style.display="block",this.$refs.tooltip.style.left=Math.floor(a*this.$refs.input.offsetWidth-40*a)+"px"):this.$refs.tooltip.style.display="none"},triggerChange:function(a){"range"==this.type&&navigator.userAgent&&0<=navigator.userAgent.toLowerCase().indexOf("rv:11.0")&&this.updateValue(a.target.value)},updateValue:function(a){this.trim&&"undefined"!=
typeof a&&null!=a&&(a=a.trim());""==a&&(a=null);if(a!=this.value){this.timer&&(clearTimeout(this.timer),this.timer=null);"range"==this.type&&(null!=this.exclusiveMinimum&&null!=this.minimum&&a<this.minimum&&(a=this.minimum,this.localValue=this.formatter&&null!=this.value?this.formatter(this.value):this.value),null!=this.exclusiveMaximum&&null!=this.maximum&&a>this.maximum&&(a=this.maximum,this.localValue=this.formatter&&null!=this.value?this.formatter(this.value):this.value),this.calculateOffset(a));
var b=this.parser&&null!=a?this.parser(a):a;""==b&&(b=null);this.localValue=this.formatter&&null!=b?this.formatter(b):b;this.$emit("change",b);this.valueToCommit=b;if(!this.commit)if(this.timeout){var c=this;this.timer=setTimeout(function(){c.$emit("input",b)},this.timeout)}else this.$emit("input",b)}},increment:function(){"number"==this.type&&(this.$refs.input.stepUp(),this.valueToCommit=this.$refs.input.value,this.$emit("input",this.$refs.input.value))},decrement:function(){"number"==this.type&&
(this.$refs.input.stepDown(),this.valueToCommit=this.$refs.input.value,this.$emit("input",this.$refs.input.value))}},watch:{value:function(a){this.valid=null;this.messages.splice(0);this.localValue=this.blurred?this.masker&&null!=this.value?this.masker(this.value):this.value:this.formatter&&null!=this.value?this.formatter(this.value):this.value;if("range"==this.type){var b=this;setTimeout(function(){b.calculateOffset(b.value)},1)}}}});
HTMLTextAreaElement.prototype.insertAtCaret=function(a){a=a||"";if(document.selection)this.focus(),document.selection.createRange().text=a;else if(this.selectionStart||0===this.selectionStart){var b=this.selectionStart,c=this.selectionEnd;this.value=this.value.substring(0,b)+a+this.value.substring(c,this.value.length);this.selectionStart=b+a.length;this.selectionEnd=b+a.length}else this.value+=a};
HTMLInputElement.prototype.insertAtCaret=function(a){a=a||"";if(document.selection)this.focus(),document.selection.createRange().text=a;else if(this.selectionStart||0===this.selectionStart){var b=this.selectionStart,c=this.selectionEnd;this.value=this.value.substring(0,b)+a+this.value.substring(c,this.value.length);this.selectionStart=b+a.length;this.selectionEnd=b+a.length}else this.value+=a};
Vue.component("n-form-switch",{props:{value:{required:!0},item:{required:!1},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},disabled:{type:Boolean,required:!1,default:!1},invert:{type:Boolean,required:!1,default:!1},info:{type:String,required:!1},infoIcon:{type:String,required:!1},before:{type:String,required:!1},after:{type:String,required:!1}},template:"#n-form-switch",methods:{updateValue:function(a){this.disabled||this.$emit("input",a)},validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("n-form-radio",{props:{value:{required:!0},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},label:{type:String,required:!1},name:{type:String,required:!1,default:function(){return("radio-"+Math.random()).replace("0.","")}},schema:{type:Object,required:!1},hide:{type:Boolean,required:!1,default:null},disabled:{type:Boolean,required:!1},disabler:{type:Function,required:!1},items:{type:Array,required:!0,default:function(){return[]}},filter:{type:Function},
validator:{type:Function,required:!1},formatter:{type:Function,required:!1},extracter:{type:Function,required:!1},infoIcon:{type:String,required:!1},info:{type:String,required:!1},after:{type:String,required:!1},before:{type:String,required:!1},mustChoose:{type:Boolean,required:!1}},template:"#n-form-radio",data:function(){return{messages:[],valid:null,actualValue:null,chosen:!1}},created:function(){if(this.filter){var a=this,b=this.filter();b&&b.then?b.then(function(c){a.items.splice(0);null==c||
c instanceof Array||Object.keys(c).forEach(function(d){c instanceof Array||c[d]instanceof Array&&(c=c[d])});c instanceof Array&&(nabu.utils.arrays.merge(a.items,c),a.synchronizeValue())}):b instanceof Array&&(nabu.utils.arrays.merge(a.items,b),a.synchronizeValue())}else this.synchronizeValue()},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){console.log("computed mandatory:",nabu.utils.vue.form.mandatory(this));return nabu.utils.vue.form.mandatory(this)}},
methods:{isDisabled:function(a){return this.disabler?this.disabler(a):this.disabled},synchronizeValue:function(){if(this.extracter&&this.value){var a=this;this.actualValue=this.items.filter(function(b){return a.extracter(b)==a.value})[0]}else this.actualValue=this.value},validate:function(a){this.messages.splice(0,this.messages.length);var b=nabu.utils.schema.json.validate(this.definition,this.value,this.mandatory),c=b.filter(function(d){return"required"==d.code})[0];c?c.title="%{validation::You must choose an option}":
!this.chosen&&this.mustChoose&&(c={soft:!1,severity:"error",code:"required",title:"%{validation::You must choose an option}",priority:0,values:{actual:!1,expected:!0},context:[]},Object.defineProperty(c,"component",{value:this,enumerable:!1}),b.push(c));(c=b.filter(function(d){return"required"==d.code})[0])&&this.$refs&&this.$refs.combo&&this.$refs.combo.content&&(c.title="%{validation::Please choose a value}",c.actual=this.$refs.combo.content);for(c=0;c<b.length;c++)Object.defineProperty(b[c],"component",
{value:this,enumerable:!1});c=b.filter(function(d){return!d.soft});a&&0==c.length&&(0<b.length||null==this.value)&&(null==this.valid||null==this.value)?(this.valid=null,this.messages.splice(0)):(this.valid=0==b.length,nabu.utils.arrays.merge(this.messages,nabu.utils.vue.form.localMessages(this,b)));return b},select:function(a){!this.disabled&&this.edit&&(this.chosen=!0,this.$emit("input",this.extracter?this.extracter(a):a,this.formatter?this.formatter(a):a),this.valid=null,this.messages.splice(0))}}});
Vue.component("n-form-location",{props:{value:{required:!1},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},placeholder:{type:String,required:!1},schema:{type:Object,required:!1},disabled:{type:Boolean,required:!1},validator:{type:Function,required:!1},timeout:{type:Number,required:!1},countryRestriction:{type:String,required:!1},allowEstablishments:{type:Boolean,required:!1},allowCities:{type:Boolean,
required:!1},allowRegions:{type:Boolean,required:!1},allowVague:{type:Boolean,required:!1},allowStreet:{type:Boolean,required:!1},bounds:{type:String,required:!1},bias:{type:String,required:!1},latitude:{type:String,required:!1},longitude:{type:String,required:!1},country:{type:String,required:!1},countryCode:{type:String,required:!1},city:{type:String,required:!1},province:{type:String,required:!1},region:{type:String,required:!1},street:{type:String,required:!1},streetIncludeNumber:{type:Boolean,
required:!1},streetNumber:{type:String,required:!1},postCode:{type:String,required:!1},formatted:{type:String,required:!1}},template:"#n-form-location",data:function(){return{timer:null,place:null,sessionToken:null,resolvedType:null}},computed:{definition:function(){var a=nabu.utils.vue.form.definition(this);"number"==this.type&&(a.type="number");return a},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},created:function(){this.sessionToken=this.$services.geo.newSessionToken();var a=
this,b=null;if(this.formatted&&this.value[this.formatted])b=this.$services.geo.geocode({address:this.value[this.formatted]});else if((this.country&&this.value[this.country]||this.countryCode&&this.value[this.countryCode])&&this.city&&this.value[this.city]){b="";this.country&&this.value[this.country]?b+=this.value[this.country]:this.countryCode&&this.value[this.countryCode]&&(b+=this.value[this.countryCode]);this.city&&this.value[this.city]&&(b=this.value[this.city]+", "+b);if(this.street&&this.value[this.street]){var c=
this.value[this.street];this.streetNumber&&this.value[this.streetNumber]&&(c+=" "+this.value[this.streetNumber]);b=c+", "+b}b=this.$services.geo.geocode({address:b})}else this.latitude&&this.longitude&&this.value[this.longitude]&&this.value[this.latitude]&&(b=this.$services.geo.geocode({location:new google.maps.LatLng({lat:parseFloat(this.value[this.latitude]),lng:parseFloat(this.value[this.longitude])})}));null!=b&&b.then(function(d){d instanceof Array&&(d=d[0]);d.description=d.formatted_address;
a.place=d})},methods:{getPart:function(a,b,c){b instanceof Array||(b=[b]);var d=null;b.forEach(function(e){null==d&&(d=a.address_components.filter(function(g){return 0<=g.types.indexOf(e)})[0])});return d?c?d.short_name:d.long_name:d},validate:function(a){this.$refs.combo.messages.splice(0);var b=nabu.utils.schema.json.validate(this.definition,this.resolvedType,this.mandatory);this.resolvedType&&(this.allowVague||"street_address"==this.resolvedType||b.push({code:"vague",title:"%{validation::The address is not specific enough}",
component:this,context:[],severity:"error",values:{expected:"street_address",actual:this.resolvedType}}));var c=b.filter(function(d){return!d.soft});a&&0==c.length&&0<b.length&&null==this.$refs.combo.valid?(this.$refs.combo.valid=null,this.messages.splice(0)):(this.$refs.combo.valid=0==b.length,nabu.utils.arrays.merge(this.$refs.combo.messages,nabu.utils.vue.form.localMessages(this,b)));return b},update:function(a){this.$refs.combo&&(this.$refs.combo.messages.splice(0),this.$refs.combo.valid=null);
var b=this;if(a&&a.place_id){var c=function(d){d instanceof Array&&(d=d[0]);b.place=d;b.resolvedType=d.types[0];b.country&&(b.value[b.country]=b.getPart(d,["country"]));b.countryCode&&(b.value[b.countryCode]=b.getPart(d,["country"],!0));b.province&&(b.value[b.province]=b.getPart(d,["administrative_area_level_2"]));b.region&&(b.value[b.region]=b.getPart(d,["administrative_area_level_1"]));b.city&&(b.value[b.city]=b.getPart(d,["sublocality","locality"]));b.postCode&&(b.value[b.postCode]=b.getPart(d,
["postal_code"]));if(b.street&&(b.value[b.street]=b.getPart(d,["route"]),b.streetIncludeNumber)){var e=b.getPart(d,"street_number");null!=e&&null!=b.value[b.street]&&(b.value[b.street]+=" "+e)}b.streetNumber&&(b.value[b.streetNumber]=b.getPart(d,["street_number"]));b.formatted&&(b.value[b.formatted]=d.formatted_address);b.latitude&&d.geometry&&(b.value[b.latitude]=d.geometry.location.lat instanceof Function?d.geometry.location.lat():d.geometry.location.lat);b.longitude&&d.geometry&&(b.value[b.longitude]=
d.geometry.location.lng instanceof Function?d.geometry.location.lng():d.geometry.location.lng);b.$emit("label",b.formatPlace(d))};this.$services.geo.geocode({placeId:a.place_id}).then(c,function(){a.description&&b.$services.geo.geocode({address:a.description}).then(c)})}},searchPlace:function(a){if(a){this.$services.q.defer();var b={sessionToken:this.sessionToken};this.countryRestriction&&(b.componentRestrictions={country:this.countryRestriction.toUpperCase().split(",")});var c=[];this.allowVague?
(this.allowRegions&&c.push("regions"),this.allowCities&&c.push("cities")):c.push("address");this.allowEstablishments&&c.push("establishment");b.types=c;if(this.bias){c=this.bias.split(";");var d=c[0].split(",");b.location=new google.maps.LatLng({lat:d[0],lng:d[1]});2<=c.length&&(b.radius=c[1])}this.bounds&&(c=this.bias.split(";"),d=c[0].split(","),c=c[1].split(","),b.bounds=new google.maps.LatLngBounds(new google.maps.LatLng({lat:d[0],lng:d[1]}),new google.maps.LatLng({lat:c[0],lng:c[1]})));return this.$services.geo.autocomplete(a,
b)}return this.$services.q.resolve([])},formatPlace:function(a){return a.formatted_address?a.formatted_address:a.description}}});
Vue.component("n-form-address",{props:{value:{required:!1},label:{type:String,required:!1},edit:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1,default:null},name:{type:String,required:!1},placeholder:{type:String,required:!1},schemaResolver:{type:Function,required:!1},disabled:{type:Boolean,required:!1},validator:{type:Function,required:!1},timeout:{type:Number,required:!1},countryRestriction:{type:String,required:!1},allowEstablishments:{type:Boolean,required:!1},allowCities:{type:Boolean,
required:!1},allowRegions:{type:Boolean,required:!1},allowVague:{type:Boolean,required:!1},allowStreet:{type:Boolean,required:!1},bounds:{type:String,required:!1},bias:{type:String,required:!1},latitude:{type:String,required:!1},longitude:{type:String,required:!1},country:{type:String,required:!1},countryCode:{type:String,required:!1},countryLabel:{type:String,required:!1},city:{type:String,required:!1},cityLabel:{type:String,required:!1},province:{type:String,required:!1},region:{type:String,required:!1},
street:{type:String,required:!1},streetLabel:{type:String,required:!1},streetNumber:{type:String,required:!1},additional:{type:String,required:!1},streetNumberLabel:{type:String,required:!1},additionalLabel:{type:String,required:!1},postCode:{type:String,required:!1},postCodeLabel:{type:String,required:!1},formatted:{type:String,required:!1}},template:"#n-form-address",data:function(){return{timer:null,place:null,sessionToken:null,resolvedType:null,ready:!1,postCodeFull:null}},computed:{definition:function(){var a=
nabu.utils.vue.form.definition(this);"number"==this.type&&(a.type="number");return a},mandatory:function(){return nabu.utils.vue.form.mandatory(this)},countryField:function(){return this.country?this.country:this.countryCode?"$country":null},formattedAddress:function(){var a="";this.countryField&&this.value[this.countryField]?a+=this.value[this.countryField]:this.countryCode&&this.value[this.countryCode]&&(a+=this.value[this.countryCode]);this.city&&this.value[this.city]&&this.postCode&&this.value[this.postCode]?
a=""!=a?this.value[this.postCode]+" "+this.value[this.city]+", "+a:this.value[this.postCode]+" "+this.value[this.city]:this.city&&this.value[this.city]?a=""!=a?this.value[this.city]+", "+a:this.value[this.city]:!this.city&&this.postCode&&this.value[this.postCode]&&(a=this.postCodeFull?this.postCodeFull+(a?", "+a:""):this.value[this.postCode]+", "+a);if(this.street&&this.value[this.street]){var b=this.value[this.street];this.streetNumber&&this.value[this.streetNumber]&&(b+=" "+this.value[this.streetNumber],
this.additional&&this.value[this.additional]&&(b+=" "+this.value[this.additional]));a=b+", "+a}this.formatted&&Vue.set(this.value,this.formatted,a);return a},anyRequired:function(){if(this.schemaResolver){if(this.country){var a=this.schemaResolver(this.country);if(a&&a.required)return!0}if(this.countryCode&&(a=this.schemaResolver(this.countryCode))&&a.required||this.city&&(a=this.schemaResolver(this.city))&&a.required||this.postCode&&(a=this.schemaResolver(this.postCode))&&a.required||this.province&&
(a=this.schemaResolver(this.province))&&a.required||this.region&&(a=this.schemaResolver(this.region))&&a.required||this.street&&(a=this.schemaResolver(this.street))&&a.required||this.streetNumber&&(a=this.schemaResolver(this.streetNumber))&&a.required)return!0}return!1}},created:function(){this.sessionToken=this.$services.geo.newSessionToken();if(!this.country&&this.countryCode&&this.value[this.countryCode]){var a=this;this.$services.geo.geocode({address:this.formattedAddress}).then(function(b){b instanceof
Array&&(b=b[0]);Vue.set(a.value,a.countryField,a.getPart(b,["country"]))})}},ready:function(){this.ready=!0},methods:{getPart:function(a,b,c){b instanceof Array||(b=[b]);var d=null;b.forEach(function(e){null==d&&(d=a.address_components.filter(function(g){return 0<=g.types.indexOf(e)})[0])});return d?c?d.short_name:d.long_name:d},validate:function(a){a=nabu.utils.vue.form.validateChildren(this,a);if(this.validator){var b=this.validator(this.value);if(b&&b.length)for(var c=0;c<b.length;c++)Object.defineProperty(b[c],
"component",{value:this,enumerable:!1}),"undefined"==typeof b[c].context&&(b[c].context=[]),a.push(b[c])}return a},checkFullAddress:function(){var a=this;if(this.latitude||this.longitude||this.countryCode&&!this.value[this.countryCode])null!=a.country&&!a.value[a.country]||null!=a.city&&!a.value[a.city]||null!=a.postCode&&!a.value[a.postCode]||null!=a.street&&!a.value[a.street]||null!=a.streetNumber&&!a.value[a.streetNumber]||this.$services.geo.geocode({address:this.formattedAddress}).then(function(b){b instanceof
Array&&(b=b[0]);a.latitude&&b.geometry&&(a.value[a.latitude]=b.geometry.location.lat instanceof Function?b.geometry.location.lat():b.geometry.location.lat);a.longitude&&b.geometry&&(a.value[a.longitude]=b.geometry.location.lng instanceof Function?b.geometry.location.lng():b.geometry.location.lng);a.countryCode&&(a.value[a.countryCode]=a.getPart(b,["country"],!0))})},updateCountry:function(a,b){this.updateCity(null,!0);Vue.set(this.value,this.countryField,this.formatAutocomplete("country",a));this.countryCode&&
(Vue.set(this.value,this.countryCode,null),this.countryRestriction&&(b=this.countryRestriction.split(/[\s]*,[\s]*/),1==b.length&&0!=b[0].trim().length&&Vue.set(this.value,this.countryCode,b[0].trim())));this.$emit("changed");var c=this;Vue.nextTick(function(){a&&(c.city?c.$refs.city.$el.querySelector("input").focus():c.postCode?c.$refs.postCode.$el.querySelector("input").focus():c.street&&c.$refs.street.$el.querySelector("input").focus())});this.checkFullAddress()},updateCity:function(a,b){this.updatePostCode(null,
!0);Vue.set(this.value,this.city,this.formatAutocomplete("city",a));b||this.$emit("changed");var c=this;Vue.nextTick(function(){a&&(c.postCode?c.$refs.postCode.$el.querySelector("input").focus():c.street&&c.$refs.street.$el.querySelector("input").focus())});this.checkFullAddress()},updatePostCode:function(a,b){this.updateStreet(null,!0);Vue.set(this.value,this.postCode,this.formatAutocomplete("postCode",a));b||this.$emit("changed");var c=this;Vue.nextTick(function(){a&&c.street&&c.$refs.street.$el.querySelector("input").focus()});
this.checkFullAddress()},updateStreet:function(a,b){this.updateStreetNumber(null,!0);Vue.set(this.value,this.street,this.formatAutocomplete("street",a));b||this.$emit("changed");var c=this;Vue.nextTick(function(){a&&c.streetNumber&&c.$refs.streetNumber.$el.querySelector("input").focus()});this.checkFullAddress()},updateStreetNumber:function(a,b){Vue.set(this.value,this.streetNumber,this.formatAutocomplete("streetNumber",a));b||this.$emit("changed");this.checkFullAddress()},updateAdditional:function(a,
b){Vue.set(this.value,this.additional,this.formatAutocomplete("additional",a));b||this.$emit("changed");this.checkFullAddress()},searchField:function(a,b){if(!this.ready)return b?[b]:[];var c=this.$services.q.defer(),d="",e=[];"country"==a?e.push("(regions)"):"city"==a?e.push("(cities)"):"postCode"==a?e.push("(regions)"):"street"==a?e.push("address"):"streetNumber"==a&&e.push("address");this.countryField?d="country"==a?b:this.value[this.countryField]:this.countryRestriction&&(d=this.countryRestriction);
if("country"!=a){if(this.city&&("city"==a||this.value[this.city])){var g="city"==a?b:this.value[this.city];"city"!=a&&this.postCode&&("postCode"==a||this.value[this.postCode])&&(g=g+" "+("postCode"==a?b:this.value[this.postCode]));d+=", "+g}else this.city||!this.postCode||"postCode"!=a&&!this.value[this.postCode]||(d+=", "+("postCode"==a?b:this.value[this.postCode]));"city"!=a&&"postCode"!=a&&this.street&&("street"==a||this.value[this.street])&&(g="street"==a?b:this.value[this.street],"street"!=a&&
this.streetNumber&&("streetNumber"==a||this.value[this.streetNumber])&&(g+=" "+("streetNumber"==a?b:this.value[this.streetNumber])),d+=", "+g)}var k=this;this.searchPlace(d,e).then(function(m){c.resolve(m.filter(function(p){return"country"==a?0<=p.types.indexOf(a):"city"==a?0<=p.types.indexOf("locality")||0<=p.types.indexOf("city")||0<=p.types.indexOf("sublocality"):"postCode"==a?k.formatAutocomplete("postCode",p).match(/.*[0-9]+.*/)?0<=p.types.indexOf("postal_code")||0<=p.types.indexOf("locality")||
0<=p.types.indexOf("sublocality"):!1:"streetNumber"==a?0<=p.types.indexOf("address"):!0}))},c);return c},searchPlace:function(a,b){if(a){this.$services.q.defer();var c={sessionToken:this.sessionToken};this.countryRestriction&&(c.componentRestrictions={country:this.countryRestriction.toUpperCase().split(",")});c.types=b;if(this.bias){b=this.bias.split(";");var d=b[0].split(",");c.location=new google.maps.LatLng({lat:d[0],lng:d[1]});2<=b.length&&(c.radius=b[1])}this.bounds&&(b=this.bias.split(";"),
d=b[0].split(","),b=b[1].split(","),c.bounds=new google.maps.LatLngBounds(new google.maps.LatLng({lat:d[0],lng:d[1]}),new google.maps.LatLng({lat:b[0],lng:b[1]})));return this.$services.geo.autocomplete(a,c)}return this.$services.q.resolve([])},formatPlace:function(a){return a.formatted_address?a.formatted_address:a.description},formatAutocomplete:function(a,b,c){c||=0;if(!b)return null;if("string"==typeof b)return b;var d=!1;"postCodeFull"==a&&(d=!0,a="postCode");var e=this;c=b.terms.filter(function(g){g=
g.value;if("country"==a)return!0;if("city"==a)return null==e.country||g!=e.value[e.countryField];if("postCode"==a)return(null==e.country||g!=e.value[e.countryField])&&(null==e.city||g!=e.value[e.city]);if("street"==a)return(null==e.country||g!=e.value[e.countryField])&&(null==e.city||g!=e.value[e.city])&&(null==e.postCode||g!=e.value[e.postCode]);if("streetNumber"==a)return(null==e.country||g!=e.value[e.countryField])&&(null==e.city||g!=e.value[e.city])&&(null==e.postCode||g!=e.value[e.postCode])&&
(null==e.street||g!=e.value[e.street])})[c].value;d&&"postCode"==a&&!this.city&&(b=this.formatAutocomplete("city",b,1))&&(this.postCodeFull=c+=", "+b);return c}}});
Vue.component("n-form",{props:{schema:{type:Object,required:!1},mode:{type:String,required:!1},codes:{type:Object,required:!1},contentClass:{required:!1}},template:"#n-form",computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},methods:{validate:function(a){var b=nabu.utils.vue.form.validateChildren(this,a),c=this,d=function(e){c.codes&&e.forEach(function(g){g.code&&c.codes[g.code]&&Vue.set(g,"title",c.codes[g.code])})};
d(b);b.then&&b.then(function(){d(b)});return b}}});
Vue.component("n-form-table",{props:{schema:{type:Object,required:!1},mode:{type:String,required:!1}},template:"#n-form-table",data:function(){return{labels:[],hasContent:!1}},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)}},methods:{validate:function(a){return nabu.utils.vue.form.validateChildren(this,a)}},events:{"$vue.child.added":function(a){a.labels&&(this.labels.splice(0,this.labels.length),nabu.utils.arrays.merge(this.labels,
a.labels));this.hasContent=!!this.labels.length}}});nabu||={};nabu.utils||(nabu.utils={});nabu.utils.vue||(nabu.utils.vue={});
nabu.utils.vue.form={definition:function(a){var b=a.schema?nabu.utils.objects.clone(a.schema):null;!b&&a.name&&a.$parent&&a.$parent.definition&&a.$parent.definition.properties&&(b=a.$parent.definition.properties[a.name]);b||={};for(var c="minLength maxLength pattern patternComment maxItems minItems maximum minimum exclusiveMaximum exclusiveMinimum enum".split(" "),d=0;d<c.length;d++)null!=a[c[d]]&&(b[c[d]]=a[c[d]]);return b},rewriteCodes:function(a,b){if(b instanceof Array){var c={};b.forEach(function(d){d.code&&
(c[d.code]=d)});b=c}a&&a.length&&b&&a.forEach(function(d){if(d.code){var e=null;if(d.context instanceof Array)for(var g="",k=d.context.length-1;0<=k;k--)(""+d.context[k]).match(/^[0-9]+$/)||(""!=g&&(g+="."),g+=d.context[k],b[g+"."+d.code]&&(e=b[g+"."+d.code]));null==e&&(e=b[d.code]);e&&("string"==typeof e?(d.title=e,d.title=nabu.utils.vue.form.replaceVariables(d.title,d)):Object.keys(e).forEach(function(m){d[m]=e[m];d[m]=nabu.utils.vue.form.replaceVariables(d[m],d)}))}})},replaceVariables:function(a,
b){b&&Object.keys(b).forEach(function(c){a=a.replace(new RegExp("\\{[\\s]*"+c+"[\\s]*\\}","g"),b[c])});return a},mandatory:function(a){var b=a.required;null==b&&a.name&&a.$parent&&a.$parent.definition&&(b=a.$parent.definition.required&&0<=a.$parent.definition.required.indexOf(a.name));null==b&&a.definition&&a.definition.required&&(b=!0);null==b&&(b=!1);return b},labels:function(a){var b=[];if(a.$children){for(var c=0;c<a.$children.length;c++)a.$children[c].label&&b.push(a.$children[c].label);if(!b.length)for(c=
0;c<a.$children.length&&(a.$children[c].labels&&nabu.utils.arrays.merge(b,a.$children[c].labels),!b.length);c++);}return b.length?b:null},mode:function(a){for(var b=a.$el;b&&b.getAttribute;){if(b.getAttribute("mode"))return b.getAttribute("mode");b=b.parentNode}for(;a;){if(a.mode)return a.mode;a=a.$parent}return null},localMessages:function(a,b){var c=[];if(!b||!b.length)return c;var d=nabu.utils.vue.form.mode(a);b.sort(function(g,k){return("undefined"!=typeof g.priority?g.priority:0)-("undefined"!=
typeof k.priority?k.priority:0)});var e=!1;"component"==d?(c.push(b[0]),e=!0):null!=a.mode&&(a=parseInt(a.mode),a=0==a?b.length:Math.min(a,b.length),nabu.utils.arrays.merge(c,b.slice(0,a)),e=!0);1==e&&b.forEach(function(g){g.handled=!0});return c},validateChildren:function(a,b){for(var c=nabu.utils.schema.addAsyncValidation([]),d=0;d<a.$children.length;d++){if(a.$children[d].validate){var e=a.$children[d].validate(b);if(a.$children[d].name)for(var g=0;g<e.length;g++)e[g].context instanceof Array&&
e[g].context.push(a.$children[d].name)}else e=nabu.utils.vue.form.validateChildren(a.$children[d],b);nabu.utils.arrays.merge(c,e);if(e&&e.then){g=c;var k=g.defer,m=new nabu.utils.promise;e.then(m,m);k.call(g,m)}}return c},validateCustom:function(a,b,c,d){if(null!=c)if(b=c(b),null!=b&&b.then)a.defer(b);else if(null!=b&&b.length)for(c=0;c<b.length;c++)Object.defineProperty(b[c],"component",{value:d,enumerable:!1}),"undefined"==typeof b[c].context&&(b[c].context=[]),a.push(b[c]);return a}};nabu||={};
nabu.components||(nabu.components={});nabu.components.secret=Vue.component("n-secret",{props:{content:{type:String,required:!0}},template:"#n-secret",data:function(){return{show:!1}},computed:{secretContent:function(){return this.content.replace(/./g,"*")}}});nabu||={};nabu.components||(nabu.components={});
nabu.components.wizard=Vue.component("n-wizard",{props:{steps:{type:Array,required:!0},initial:{type:Object,required:!1},number:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},browse:{type:Boolean,required:!1},loader:{type:Function,required:!1}},template:"#n-wizard",data:function(){return{current:null}},ready:function(){this.current=this.initial?this.initial:this.steps[0]},methods:{hasNext:function(){var a=this.steps.indexOf(this.current);return a<this.steps.length-1?!this.steps[a+1].disabled:
!1},hasPrevious:function(){var a=this.steps.indexOf(this.current);return 0<a?!this.steps[a-1].disabled:!1},next:function(){var a=this.steps.indexOf(this.current)+1;if(a>=this.steps.length)if(this.loop)a=0;else return this.current;return this.current=this.steps[a]},previous:function(){var a=this.steps.indexOf(this.current);if(0>a)a=0;else if(a--,0>a)if(this.loop)a=this.steps.length-1;else return this.current;return this.current=this.steps[a]}},watch:{current:function(a){a&&a.content&&this.$refs.container&&
this.$render({target:this.$refs.container,content:a.content,loader:this.loader})}}});nabu||={};nabu.components||(nabu.components={});
nabu.components.collapsible=Vue.component("n-collapsible",{props:{title:{type:String,required:!0},load:{type:Function,required:!1},before:{type:String,required:!1},after:{type:String,required:!1},startOpen:{type:Boolean,required:!1},onlyOneOpen:{type:Boolean,required:!1},contentClass:{type:String,required:!1}},template:"#n-collapsible",data:function(){return{show:!1,loading:!1,toggleable:!0}},created:function(){this.startOpen&&(this.show=!0)},methods:{toggle:function(){var a=this,b=function(){a.onlyOneOpen&&
a.$parent.$children.forEach(function(c){c.toggle&&c.$el.classList.contains("is-collapsible")&&c.show&&c.toggle()})};this.toggleable&&(this.show?(this.show=!1,this.$emit("hide",this)):this.load?(this.loading=!0,a=this,this.load().then(function(){b();a.show=!0;a.loading=!1;a.$emit("show",a)},function(){a.show=!1;a.loading=!1;a.$emit("hide",a)})):(b(),this.show=!0,this.$emit("show",this)))}}});
Vue.component("n-menu-dropdown",{props:{actions:{types:Array,required:!0}},template:"#n-menu-dropdown",data:function(){return{showing:[]}},methods:{handle:function(a){a.handler&&a.handler(a)},hide:function(a){a=this.showing.indexOf(a);0<=a&&this.showing.splice(a,1)},show:function(a){0>this.showing.indexOf(a)&&this.showing.push(a)}}});
Vue.component("e-root",{props:{inlineAll:{type:Boolean,required:!1,default:!1}},template:'\x3c!--mailroot--\x3e\x3ctable class\x3d"body"\x3e\x3ctr\x3e\x3ctd class\x3d"float-center" align\x3d"center" valign\x3d"top"\x3e\x3ccenter\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/center\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c!--/mailroot--\x3e',ready:function(){setTimeout(this.inlineCss,1)},methods:{inlineCss:function(){nabu.utils.elements.inlineCss(this.$el,!0,this.inlineAll?null:"email")}}});
Vue.component("e-wrapper",{template:'\x3ctable class\x3d"wrapper" align\x3d"center"\x3e\x3ctr\x3e\x3ctd class\x3d"wrapper-inner"\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'});Vue.component("e-container",{template:'\x3ctable class\x3d"container"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e'});Vue.component("e-row",{template:'\x3ctable class\x3d"row"\x3e\x3ctbody\x3e\x3ctr\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e'});
Vue.component("e-columns",{props:{small:{type:String,required:!1},large:{type:String,required:!1}},computed:{clazz:function(){var a="";this.small&&(a+=" small-"+this.small);this.large&&(a+=" large-"+this.large);return a}},template:'\x3cth class\x3d"columns" :class\x3d"clazz"\x3e\x3ctable\x3e\x3ctr\x3e\x3cth\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/th\x3e\x3cth class\x3d"expander"\x3e\x3c/th\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/th\x3e'});Vue.component("e-button",{props:{href:{type:String,required:!0}},template:'\x3ctable class\x3d"button"\x3e\x3ctr\x3e\x3ctd\x3e\x3ctable\x3e\x3ctr\x3e\x3ctd\x3e\x3ca :href\x3d"href"\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/a\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'});
Vue.component("e-menu",{template:'\x3ctable class\x3d"menu"\x3e\x3ctr\x3e\x3ctd\x3e\x3ctable\x3e\x3ctr\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'});Vue.component("e-item",{props:{href:{type:String,required:!0}},template:'\x3cth class\x3d"menu-item"\x3e\x3ca :href\x3d"href"\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/a\x3e\x3c/th\x3e'});Vue.component("e-spacer",{template:'\x3ctable class\x3d"spacer"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd height\x3d"35px" style\x3d"font-size:35px;line-height:35px;"\x3e\x26#xA0;\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e'});
Vue.component("e-callout",{template:'\x3ctable class\x3d"callout"\x3e\x3ctr\x3e\x3cth class\x3d"callout-inner"\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/th\x3e\x3cth class\x3d"expander"\x3e\x3c/th\x3e\x3c/tr\x3e\x3c/table\x3e'});Vue.component("n-button",{template:"#n-button",props:{icon:{type:String,required:!1},text:{type:String,required:!1},type:{type:String,required:!1}}});
Vue.component("n-windowing",{props:{value:{type:Number,required:!1,default:0},hasNext:{type:Boolean,required:!1,default:!1},load:{type:Function,required:!1},initialize:{type:Boolean,required:!1,default:!0}},template:"#n-windowing",data:function(){return{loading:!1,page:0}},mounted:function(){this.page=this.value;this.load&&this.initialize&&this.load(this.page)},methods:{update:function(a){if(this.load){var b=this;b.loading=!0;this.load(a).then(function(){b.$emit("input",a);b.page=a;b.loading=!1},
function(){b.loading=!1})}else this.page=a},set:function(a){this.page=a}},watch:{value:function(a){this.page=a}}});
Vue.component("n-sidebar",{template:"#n-sidebar",props:{popout:{type:Boolean,required:!1,default:!1},autocloseable:{type:Boolean,required:!1,default:!0},inline:{type:Boolean,required:!1,default:!1},position:{type:String,required:!1,default:"right"}},ready:function(){this.closeOther();var a="left"==this.position?"left":"right";this.popout&&(this.$el.setAttribute("id","n-sidebar-"+a+"-instance"),this.parentNode=this.$el.parentNode,this.$root.$el!=this.parentNode&&this.$root.$el.appendChild(this.$el));
this.inline&&document.body.setAttribute("has-sidebar-"+a,"true");this.$el.$$close=this.close},beforeDestroy:function(){this.inline&&("left"==this.position?document.body.removeAttribute("has-sidebar-left"):document.body.removeAttribute("has-sidebar-right"))},methods:{closeOther:function(){var a=this;document.querySelectorAll(".n-sidebar."+("left"==this.position?"left":"right")).forEach(function(b){b!=a.$el&&b.$$close()})},close:function(a){this.inline&&("left"==this.position?document.body.removeAttribute("has-sidebar-left"):
document.body.removeAttribute("has-sidebar-right"));this.popout&&this.parentNode&&this.$el.parentNode!=this.parentNode&&this.parentNode.appendChild(this.$el);this.$emit("close",{explicit:a})},autoClose:function(){this.autocloseable&&this.close()}}});
Vue.component("n-messages",{props:{messages:{type:Array,required:!0}},template:"#n-messages",methods:{format:function(a,b,c){if(c)for(var d=0;d<c.length;d++)a=a.replace("{context["+d+"]}",c[d]);if(b)for(var e in b)c=b[e],this.$services&&this.$services.formatter&&this.$services.formatter.number&&("string"==typeof c&&c.match&&c.match(/^[0-9.]+/)&&(c=Number(c)),c instanceof Number||"number"==typeof c)&&(c=this.$services.formatter.number(c)),a=a.replace("{"+e+"}",c);return a},highlight:function(a){a.component&&
a.component.$el&&a.component.$el.setAttribute("highlight","true")},unhighlight:function(a){a.component&&a.component.$el&&a.component.$el.removeAttribute("highlight")}}});
Vue.component("n-paging",{props:{value:{type:Number,required:!1,default:0},amount:{type:Number,required:!1,default:7},total:{type:Number,required:!1,default:1},load:{type:Function,required:!1},arrows:{type:Boolean,required:!1,default:!1},initialize:{type:Boolean,required:!1,default:!0},buttonClasses:{type:Array,required:!1},formClasses:{type:Array,required:!1,default:function(){return["is-color-background","is-spacing-large","is-shadow-xsmall","is-variant-vertical"]}},showEmpty:{type:Boolean,required:!1}},
template:"#n-paging",data:function(){return{loading:!1,page:0}},mounted:function(){this.page=this.value;this.load&&this.initialize&&this.load(this.page)},computed:{buttons:function(){var a=[],b=(this.amount-2-1)/2;this.page>=b&&(a.push(1),2<b&&this.page>b&&a.push(2),this.page>=b+1&&a.push(null));for(var c=Math.max(this.page-b+1,0);c<Math.min(this.page+b,this.total);c++)a.push(c+1);this.page+b<this.total&&(this.page<this.total-b-1&&a.push(null),2<b&&this.page<this.total-b-1&&a.push(this.total-1),a.push(this.total));
0==a.length&&this.showEmpty&&a.push(1);return a}},methods:{update:function(a){this.$emit("input",a);if(this.load){var b=this;b.loading=!0;this.load(a).then(function(){b.page=a;b.loading=!1},function(){b.loading=!1})}else this.page=a},set:function(a){this.page=a},promptPage:function(){var a=this;this.$prompt(function(){return new (Vue.extend({template:"#n-paging-prompt"}))({data:{page:null,formClasses:a.formClasses}})}).then(function(b){b=parseInt(b)-1;b=Math.max(0,b);b=Math.min(a.total,b);a.update(b)})}},
watch:{value:function(a){this.page=a}}});Vue.component("n-info",{props:{autoClose:{type:Boolean,required:!1,default:!0},icon:{type:String,required:!1,default:"info-circle"}},template:"#n-info",data:function(){return{showing:!1}}});
Vue.component("n-tags",{props:{tags:{type:Array,required:!0},formatter:{type:Function,required:!1},removable:{type:Boolean,required:!1}},template:"#n-tags",methods:{remove:function(a){this.$emit("remove",this.tags.splice(this.tags.indexOf(a),1))},format:function(a){return this.formatter?this.formatter(a):a}}});
Vue.service("geo",{data:function(){return{geocoder:null,autocompleter:null,placer:null}},methods:{initialize:function(){console.log("initializing geo")},geocode:function(a){this.geocoder||(this.geocoder=new google.maps.Geocoder);var b=this.$services.q.defer();this.geocoder.geocode(a,function(c,d){"OK"===d?b.resolve(c):b.reject(d)});return b},autocomplete:function(a,b){this.autocompleter||(this.autocompleter=new google.maps.places.AutocompleteService);b||={};b.input=a;b.sessionToken||(b.sessionToken=
this.newSessionToken());var c=this.$services.q.defer();this.autocompleter.getPlacePredictions(b,function(d,e){e===google.maps.places.PlacesServiceStatus.OK?c.resolve(d):c.reject(e)});return c},newSessionToken:function(){return new google.maps.places.AutocompleteSessionToken}}});window.addEventListener("load",function(){Vue.component("icon",{template:"\x3cspan class\x3d'is-icon fa' :class\x3d\"'fa-' + name\"/\x3e",props:{name:{type:String,required:!0}}})});
Vue.component("n-form-image-uploader-configure",{template:"#n-form-image-uploader-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},childComponents:{type:Object,required:!1}}});
Vue.component("n-form-image-uploader",{template:"#n-form-image-uploader",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},parentValue:{required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},edit:{type:Boolean,required:!1},name:{type:String,required:!1},readOnly:{type:Boolean,required:!1,default:!1},contentField:{type:String,default:"content"},nameField:{type:String,default:"contentName"},
typeField:{type:String,default:"contentType"},childComponents:{type:Object,required:!1}},data:function(){return{files:[],fileTypes:[],working:[],messages:[],selectedImage:null,singular:!1,valid:null}},computed:{remaining:function(){var a=this.field.maximum?parseInt(this.field.maximum):null;return null==a?null:a-(this.files.length+this.storedAmount)},storedAmount:function(){return this.field.binary?null!=this.value?1:0:this.singular?null!=this.value[this.contentField]?1:0:this.value.length}},created:function(){this.field.hasOwnProperty("showLargeSelectedReadOnly")||
Vue.set(this.field,"showLargeSelectedReadOnly",!0);if(this.field.binary)this.singular=!0;else if(this.value instanceof Array)this.singular=!1;else if(null!=this.value)this.singular=!0;else{var a=this.$services.page.getAllArrays(this.page);0<=a.indexOf(this.field.name)||0<=a.indexOf("page."+this.field.name)?this.singular=!1:this.singular=!0}this.value?this.processImages(this.value):this.$emit("input",this.singular?this.field.binary?null:{}:[]);this.field.allowNonImages||nabu.utils.arrays.merge(this.fileTypes,
["image/jpeg","image/png","image/svg+xml"])},methods:{getChildComponents:function(){return[{title:"Image Entry Wrapper",name:"image-entry-wrapper",component:"column"},{title:"Image Hero Wrapper",name:"image-hero-wrapper",component:"column"},{title:"Image Entry",name:"image-entry",component:"image"},{title:"Image Hero",name:"image-hero",component:"image"},{title:"Image Container",name:"image-container",component:"row"},{title:"Image Title",name:"image-title",component:"h6"},{title:"File Input",name:"file-input",
component:"column"},{title:"File Input Button",name:"file-input-button",component:"button"},{title:"Remove Button",name:"file-delete-button",component:"button"}]},validate:function(a){a=this.field.minimum?parseInt(this.field.minimum):null;var b=[];null!=a&&this.files.length+this.storedAmount<a&&b.push({severity:"error",code:"not-enough-files",title:"%{You need to add at least {minimum} image(s)}",values:{minimum:a}});this.valid=0==b.length;nabu.utils.arrays.merge(this.messages,nabu.utils.vue.form.localMessages(this,
b));return b},changed:function(){var a=this;this.messages.splice(0);this.valid=null;var b=this.field.maximum?parseInt(this.field.maximum):null;(this.field.binary||this.singular)&&1==this.files.length?(this.$emit("input",this.field.binary?null:{}),a.working.push(this.files[0]),a.resizeAndAdd(this.files[0])):null!=b&&this.files.length+this.storedAmount+this.working.length>b?this.messages.push({severity:"info",code:"too-many-files",title:"%{You can only add {maximum} images}",values:{maximum:b}}):this.files.forEach(function(c){0>
a.working.indexOf(c)&&(a.working.push(c),a.resizeAndAdd(c))});this.files.splice(0)},remove:function(a){this.singular?(this.value[this.nameField]=null,this.value[this.typeField]=null,this.value[this.contentField]=null,this.selectedImage=this.value.$url=null):(this.selectedImage==this.value[a]&&(this.selectedImage=null),this.value.splice(a,1));this.messages.splice(0);this.valid=null;this.$emit("changed")},getPlaceholder:function(a){return this.field.emptyImage?this.field.emptyImage:a.$url},resizeAndAdd:function(a){var b=
this,c=new FileReader;c.onload=function(d){var e=function(k){var m={};m.$url=k;m[b.contentField]=b.urlToBlob(k);m[b.nameField]=a.name;m[b.typeField]=a.type?a.type:b.field.allowNonImages?"application/octet-stream":"image/jpeg";b.field.binary?(m[b.contentField].name=a.name,m[b.contentField].type=a.type,m[b.contentField].$url=k,b.$emit("input",m[b.contentField])):b.singular?Object.keys(m).forEach(function(p){Vue.set(b.value,p,m[p])}):b.value.push(m);null==b.selectedImage&&(b.selectedImage=m);k=b.working.indexOf(a);
0<=k&&b.working.splice(k,1);b.$emit("changed")};if(0==a.type.indexOf("image/")){var g=new Image;g.onload=function(k){k=document.createElement("canvas");var m=b.field.maxResolution?parseInt(b.field.maxResolution):1024,p=g.width,q=g.height;null!=m&&0<m&&(p>=q&&p>m?(q*=m/p,p=m):q>p&&q>m&&(p*=m/q,q=m));k.width=p;k.height=q;k.getContext("2d").drawImage(g,0,0,p,q);k=k.toDataURL(a.type?a.type:"image/jpeg");e(k)};g.src=d.target.result}else e(d.target.result)};c.readAsDataURL(a)},urlToBlob:function(a){if(0>
a.indexOf(";base64,")){a=a.split(",");var b=a[0].split(":")[1];return new Blob([a[1]],{type:b})}a=a.split(";base64,");b=a[0].split(":")[1];return this.base64ToBlob(a[1],b)},base64ToBlob:function(a,b){a=window.atob(a);for(var c=a.length,d=new Uint8Array(c),e=0;e<c;++e)d[e]=a.charCodeAt(e);return new Blob([d],{type:b})},processImages:function(a){var b=this;a instanceof Array||(a=[a]);a.forEach(function(c){if(null==c.$url&&b.field.binary&&c instanceof Blob){var d=new FileReader;d.onload=function(e){Vue.set(c,
"$url",e.target.result)};d.readAsDataURL(c);null==b.selectedImage&&(b.selectedImage=c)}else null==c.$url&&null!=c[b.contentField]&&"string"==typeof c[b.contentField]?(c.$url="data:"+c[b.typeField]+";base64,"+c[b.contentField],c[b.contentField]=b.base64ToBlob(c[b.contentField],c[b.typeField]),null==b.selectedImage&&(b.selectedImage=c)):null==c.$url&&null!=c[b.contentField]&&c[b.contentField]instanceof Blob?(d=new FileReader,d.onload=function(e){Vue.set(c,"$url",e.target.result)},d.readAsDataURL(c[b.contentField]),
null==b.selectedImage&&(b.selectedImage=c)):null!=c.$url&&null==b.selectedImage&&(b.selectedImage=c)})}}});
window.addEventListener("load",function(){application.bootstrap(function(a){nabu.page.provide("page-form-list-input",{component:"n-form-image-uploader",configure:"n-form-image-uploader-configure",name:"image-uploader",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"n-form-image-uploader",configure:"n-form-image-uploader-configure",name:"image-uploader",namespace:"nabu.page"});a.router.register({alias:"page-form-image-uploader",enter:function(b){var c={};nabu.utils.objects.merge(c,
b);c.formComponent="n-form-image-uploader";c.configurationComponent="n-form-image-uploader-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"imageUploader",category:"Form",name:"Image uploader",description:"Uploads images and can resize them",icon:"page/core/images/image.svg"})})});
Vue.service("triggerable",{methods:{getActiveRoutes:function(a){var b=[];a.triggers&&a.triggers.forEach(function(c){c.actions&&c.actions.forEach(function(d){"route"==d.type&&(d.route&&0!=d.route.indexOf("\x3d")&&b.push(d.route),d.activeRoutes&&nabu.utils.arrays.merge(b,d.activeRoutes))})});return b},getInternalState:function(a,b,c,d,e){var g={};b.trigger&&d&&d[b.trigger]&&(g[b.trigger]=d[b.trigger]);e&&e.getTriggers&&(d=e.getTriggers())&&nabu.utils.objects.merge(g,d);a=this.$services.page.getPageInstance(a);
c=c?b.actions.indexOf(c):b.actions.length;for(d=0;d<c;d++)e=b.actions[d],"action"==e.type&&e.resultName&&e.actionTarget&&e.action?g[e.resultName]=this.$services.page.getActionOutput(a,e.actionTarget,e.action):"operation"==e.type&&e.operation&&e.resultName&&(g[e.resultName]=this.$services.page.getSwaggerOperationOutputDefinition(e.operation));return g},getTriggerErrorTypes:function(a,b,c){var d=[];if(b&&b.triggers){a=this.$services.page.getPageInstance(a);var e=this.$services.page.getAvailableActions(a);
b.triggers.forEach(function(g){c&&g.trigger!=c||g.actions&&g.actions.forEach(function(k){if("action"==k.type){var m=e.filter(function(p){return p.name==k.action})[0];m&&m.errors&&m.errors.length?nabu.utils.arrays.merge(d,m.errors):0>d.indexOf(k.action)&&d.push(k.action)}else 0>d.indexOf(k.type)&&d.push(k.type)})})}return d},getEvents:function(a,b,c){var d={},e=this;this.$services.page.getPageInstance(a);b.triggers&&b.triggers.forEach(function(g){var k=e.getInternalState(a,g,null,null,c);g.actions.forEach(function(m){if(nabu.page.event.getName(m,
"event")&&"$close"!=nabu.page.event.getName(m,"event"))if(m.eventContent)d[nabu.page.event.getName(m,"event")]=k[m.eventContent];else{var p=nabu.page.event.getType(m,"event",a);d[nabu.page.event.getName(m,"event")]=p}});g.errorEvent&&(d[g.errorEvent]=e.$services.swagger.resolve("#/definitions/StructuredErrorResponse"))});return d},canTrigger:function(a,b){return a.triggers&&null==this.$services.page.editing?0<a.triggers.filter(function(c){return c.trigger==b}).length:!1},untrigger:function(a,b,c){var d=
this;(a.triggers?a.triggers.filter(function(e){return!b||e.trigger==b}):[]).forEach(function(e,g){c["$$triggerTimer"+g]&&(e.timeout?clearTimeout(c["$$triggerTimer"+g]):e.interval&&clearInterval(c["$$triggerTimer"+g]),c["$$triggerTimer"+g]=null);c["$$triggerPromise"+g]&&(c["$$triggerPromise"+g].reject(),c["$$triggerPromise"+g]=null);e.actions&&e.actions.forEach(function(k){if("visibility"==k.type&&k.closeableTarget){if(k.allowUntrigger){var m=d.$services.page.getPageInstance(c.page,c);"visible"==k.closeableAction?
Vue.set(m.closed,k.closeableTarget,"$any"):"hidden"==k.closeableAction?Vue.set(m.closed,k.closeableTarget,null):Vue.set(m.closed,k.closeableTarget,null==m.closed[k.closeableTarget]?"$any":null)}}else if("event"==k.type&&nabu.page.event.getName(k,"event")){if(k.allowUntrigger)return m=d.$services.page.getPageInstance(c.page,c),m.emit(nabu.page.event.getName(k,"event"),null)}else"variable"==k.type&&k.allowUntrigger&&(m=d.$services.page.getPageInstance(c.page,c),Object.keys(k.bindings).map(function(p){if(null!=
k.bindings[p]&&1==m.get(p+"$active")){if(m.get(p)===m.get(p+"$expected")){var q=m.get(p+"$previous");m.set(p,q)}m.set(p+"$expected",null);m.set(p+"$previous",null);m.set(p+"$active",!1)}}))})})},calculateUrl:function(a,b,c,d,e){var g=this,k=function(q,t){var u=g.$services.page.getValue(c,q);null==u&&(u=b.$value(q,t));return u},m=function(q,t){var u=g.$services.router.router.get(q);if(u&&u.isPage){var w=g.$services.page.pages.filter(function(y){return y.content.name==q})[0];w&&(w=w.content.serviceContext,
(u=u.url)&&w&&0==w.indexOf("page.")&&(w=w.substring(5),u&&0<=u.indexOf("{"+w+"}")&&!t[w]&&(u=g.$services.page.getPageInstance(b.page,b),t[w]=u.getServiceContext(),t[w]||(t[w]="default"))))}};if("route"==a.type&&(a.route||a.routeFormula)){k=a.routeAsFormula?g.$services.page.eval(a.routeFormula,c,b):a.route;var p=a.routeFormulateParameters?g.$services.page.eval(a.routeFormulateParameters,c,b):this.getBindings(a,b,c);m(k,p);return d?(g.$services.page.chosenRoute=k,g.$services.router.route(k,p,e,a.mask)):
g.$services.router.template(k,p)}if("route"==a.type&&a.url)return g.$services.page.interpret(a.url,b,null,k)},getBindings:function(a,b,c){var d=this,e={};if(a.bindings){var g=function(m,p){var q=d.$services.page.getValue(c,m);null==q&&(q=b.$value(m,p));return q},k=d.$services.page.getPageInstance(b.page,b);Object.keys(a.bindings).map(function(m){if(null!=a.bindings[m]){var p=null,q=a.bindings[m].indexOf("."),t=!1;0<q&&(q=a.bindings[m].substring(0,q),c&&c.hasOwnProperty(q)&&(p=d.$services.page.getValue(c,
a.bindings[m]),t=!0));t||(p=d.$services.page.getBindingValue(k,a.bindings[m],b,g));t=0==a.bindings[m].indexOf("fixed.");(null!=p||t)&&d.$services.page.setValue(e,m,p)}})}return e},trigger:function(a,b,c,d,e){var g=this,k=function(m,p){var q=null==c?null:g.$services.page.getValue(c,m);null==q&&(q=d.$value(m,p));return q};e=(a.triggers?a.triggers.filter(function(m){return m.trigger==b&&(!m.condition||g.$services.page.isCondition(m.condition,c,d,k))&&(!m.triggerError||c&&c.errorType==m.triggerError)}):
[]).map(function(m,p){var q={};q[b]=c;var t=function(F,C){var A=g.$services.page.getValue(q,F);null==A&&(A=k(F,C));null==A&&(A=d.$value(F,C));return A},u=m.actions,w=!1,y=g.$services.q.defer(),B=function(F,C){var A=u[F],O=function(){return g.getBindings(A,d,q)},H=function(){if(!A.condition||g.$services.page.isCondition(A.condition,c,d,t)){if("event"==A.type&&nabu.page.event.getName(A,"event")){var P=g.$services.page.getPageInstance(d.page,d);return P.emit(nabu.page.event.getName(A,"event"),A.eventContent?
q[A.eventContent]:nabu.page.event.getInstance(A,"event",d.page,d))}if("route"==A.type){var M=ta&&ta.anchor?ta.anchor:A.anchor;if((ta=g.calculateUrl(A,d,q,!M,M))&&ta.then)return ta;"$blank"==M?window.open(ta):"$window"!=M&&M||(window.location=ta)}else{if("notification"==A.type)return M={},M.duration=A.notificationDuration?parseInt(A.notificationDuration):null,M.title=A.notificationTitle?g.$services.page.translate(g.$services.page.interpret(A.notificationTitle,d)):null,M.message=A.notificationMessage?
g.$services.page.translate(g.$services.page.interpret(A.notificationMessage,d)):null,M.severity=A.notificationColor,M.closeable=!!A.notificationCloseable,M.icon=A.notificationIcon,g.$services.notifier.push(M),g.$services.q.resolve();if("action"==A.type&&A.action){if(A.actionTarget){P=g.$services.page.getPageInstance(d.page,d);var K=g.$services.page.getActionTarget(P,A.actionTarget);if(K&&K.runAction){var Q=M=null,Z=null,aa=K.target?K.target:K.cell?K.cell:K.row;aa&&aa.triggers&&(M=aa.triggers.filter(function(ea){return ea.trigger==
A.action+":before"}),Q=aa.triggers.filter(function(ea){return ea.trigger==A.action+":after"}),Z=aa.triggers.filter(function(ea){return ea.trigger==A.action+":error"}));ta=null;M&&M.length&&(ta=g.$services.triggerable.trigger(aa,A.action+":before",null,K));var S=function(){var ea=K.runAction(A.action,O()),sa=g.$services.q.defer();ea&&ea.then?ea.then(function(wa){A.resultName&&(q[A.resultName]=wa);Q&&Q.length?g.$services.triggerable.trigger(aa,A.action+":after",wa,K).then(function(){sa.resolve(wa)},
sa):sa.resolve(wa)},function(wa){Z&&Z.length?g.$services.triggerable.trigger(aa,A.action+":error",wa,K).then(function(){sa.reject(wa)},sa):sa.reject(wa)}):sa.resolve();return sa};if(ta){var la=g.$services.q.defer();ta.then(function(){S().then(la,la)},la);return la}return S()}}}else if("operation"==A.type&&A.operation){M=g.$services.swagger.operations[A.operation];var pa=O();try{var ya=g.$services.q.defer();pa.$serviceContext||(P=g.$services.page.getPageInstance(d.page,d),pa.$serviceContext=P.getServiceContext());
(K=d.cell?d.cell:d.row)&&M.method&&"get"!=M.method.toLowerCase()&&g.$services.analysis.push({event:"operation",category:"trigger",component:K.analysisId?K.analysisId:(K.alias?K.alias+"-":"")+K.id,context:A.operation,page:g.$services.page.getRootPage(g.$services.page.getPageInstance(d.page,d)).page.content.name});g.$services.swagger.execute(A.operation,pa).then(function(ea){A.resultName&&(q[A.resultName]=ea);ya.resolve(ea)},function(ea){ya.reject({errorType:"operation",error:ea})});return ya}catch(ea){return console.error("Could not run operation: "+
A.operation,ea),g.$services.q.reject({action:"operation",exception:ea})}}else{if("variable"==A.type)return A.bindings&&(P=g.$services.page.getPageInstance(d.page,d),Object.keys(A.bindings).map(function(ea){if(null!=A.bindings[ea]){var sa=null,wa=A.bindings[ea].indexOf("."),ub=!1;0<wa&&(wa=A.bindings[ea].substring(0,wa),q&&q.hasOwnProperty(wa)&&(sa=g.$services.page.getValue(q,A.bindings[ea]),ub=!0));ub||(sa=g.$services.page.getBindingValue(P,A.bindings[ea],d,t));null==sa&&A.defaultValue&&(sa=g.$services.page.eval(A.defaultValue,
{},g));A.allowUntrigger&&1!=P.get(ea+"$active")&&(P.set(ea+"$active",!0),P.set(ea+"$previous",P.get(ea)),P.set(ea+"$expected",sa));P.set(ea,sa)}})),g.$services.q.resolve();if("download"==A.type&&A.operation){pa=O();g.$services.analysis.push({event:"download",category:"trigger",component:(d.alias?d.alias+"-":"")+d.analysisId?d.analysisId:d.id,context:d.page.content.name,path:d.page.content.path,data:pa});if(A.allowArbitraryDownload)return pa.$serviceContext||(P=g.$services.page.getPageInstance(d.page,
d),pa.$serviceContext=P.getServiceContext()),M=[{name:"excel",contentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{name:"json",contentType:"application/json"},{name:"xml",contentType:"application/xml"},{name:"csv",contentType:"text/csv"}],ta=null,A.downloadAs&&(ta=M.filter(function(ea){return ea.name==A.downloadAs})[0])&&(ta=ta.contentType),pa.$responseType="blob",g.$services.page.downloadService(A.operation,pa,A.fileName,ta);var Ta=function(ea){var sa=g.$services.swagger.operations[A.operation],
wa=g.$services.page.getPageInstance(d.page,d).getServiceContext();wa&&(ea+=(0<=ea.indexOf("?")?"\x26":"?")+"$serviceContext\x3d"+wa);"get"==sa.method&&sa.produces&&sa.produces.length&&"application/octet-stream"==sa.produces[0]?"$window"!=A.anchor?g.$services.page.download(ea,function(){}):window.location=g.$services.swagger.parameters(A.operation,pa).url:"true"==sa["x-downloadable"]&&(sa=null,"excel"==A.downloadAs?sa="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"csv"==A.downloadAs?
sa="text/csv":"json"==A.downloadAs?sa="application/json":"xml"==A.downloadAs&&(sa="application/xml"),wa=0>ea.indexOf("?")?"?":"\x26",null!=sa&&(ea+=wa+"header:Accept\x3d"+sa,wa="\x26"),ea+=wa+"header:Accept-Content-Disposition\x3dattachment",A.fileName&&(ea+=";fileName\x3d"+g.$services.page.interpret(A.fileName,d)),"$window"!=A.anchor?g.$services.page.download(ea,function(){}):window.location=ea)};if(g.$services.user.downloadUrl)return g.$services.user.downloadUrl(A.operation,pa).then(function(ea){ea&&
Ta(ea)});Ta(g.$services.swagger.parameters(A.operation,pa).url);return g.$services.q.resolve()}if("javascript"==A.type&&A.javascript)return M=A.javascript,0!=M.trim().indexOf("function")&&(M="function(){ "+M+"}"),(M=g.$services.page.eval(M,q,d,t))&&M.then?M:g.$services.q.resolve(M);if("function"==A.type&&A.function){M=g.$services.page.getRunnableFunction(A.function);if(!M)throw"Could not find function: "+A.function;ya=g.$services.q.defer();try{M=g.$services.page.runFunction(M,O(),g,ya)}catch(ea){console.error("Could not run function: "+
A.function,ea),ya.reject(ea)}return ya}if("confirmation"==A.type&&A.confirmation)return ya=g.$services.q.defer(),g.$confirm({translator:g.$services.page.translate,message:g.$services.page.translate(g.$services.page.interpret(A.confirmation,d))}).then(ya,function(ea){w=!0;ya.reject(ea)}),ya;if("visibility"==A.type&&A.closeableTarget)return P=g.$services.page.getPageInstance(d.page,d),!P.closed.hasOwnProperty(A.closeableTarget)&&P.fragmentParent&&(P=P.fragmentParent),"visible"==A.closeableAction?Vue.set(P.closed,
A.closeableTarget,null):"hidden"==A.closeableAction?Vue.set(P.closed,A.closeableTarget,"$any"):Vue.set(P.closed,A.closeableTarget,null==P.closed[A.closeableTarget]?"$any":null),g.$services.q.resolve();if("scroll"==A.type&&A.scrollTo){if(M=document.querySelector(A.scrollTo)){var ta={};ta.behavior=A.scrollBehavior?A.scrollBehavior:"smooth";ta.block=A.scrollBlock?A.scrollBlock:"center";ta.inline=A.scrollInline?A.scrollInline:"nearest";M.scrollIntoView(ta);return g.$services.q.resolve(M)}return g.$services.q.reject()}}}}};
if(!g.edit){var ca=function(P){F==u.length-1?m.interval?d["$$triggerTimer"+p]=setTimeout(function(){B(0)},m.interval):P?P.then(y,y):y.resolve():P?P.then(function(){B(F+1,P)},y):B(F+1,P)};H=H();!C||A.immediate?(H&&H.then&&(C=C&&A.immediate?g.$services.q.all([C,H]):H),ca(C)):ca(H&&H.then?H:C)}};if(0<u.length){if(m.timeout||m.interval)d["$$triggerPromise"+p]=y;m.confirmation?g.$confirm({message:g.$services.page.translate(g.$services.page.interpret(m.confirmation,d))}).then(function(){B(0)},y):m.timeout?
d["$$triggerTimer"+p]=setTimeout(function(){B(0)},m.timeout):B(0)}else y.resolve();return y.then(function(){m.closeEvent&&d.$emit("close")},function(F){m.errorEvent&&g.$services.page.getPageInstance(g.page).emit(m.errorEvent,F?F:{});if(!w){var C=m.trigger+":error";m.errorTrigger&&(C=m.errorTrigger);g.trigger(a,C,F,d)}})});return this.$services.q.all(e)}}});
Vue.component("page-triggerable-configure",{template:"#page-triggerable-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},triggers:{type:Object,required:!0},name:{type:String,default:"triggers"},allowClosing:{type:Boolean,default:!1}},created:function(){this.target[this.name]||Vue.set(this.target,this.name,[])},computed:{actionTypes:function(){var a=[];a.push({title:"REST call",name:"operation"});a.push({title:"Download data",name:"download"});a.push({title:"Run action",
name:"action"});a.push({title:"Run function",name:"function"});a.push({title:"Show / hide",name:"visibility"});a.push({title:"Send event",name:"event"});a.push({title:"Send notification",name:"notification"});a.push({title:"Redirect",name:"route"});a.push({title:"Scroll",name:"scroll"});a.push({title:"Ask confirmation",name:"confirmation"});a.push({title:"Set variable",name:"variable"});a.push({title:"Execute javascript",name:"javascript"});return a}},methods:{getTriggerErrorTypes:function(a,b){(a=
a?a.trigger:null)&&(a=a.replace(/:error$/,""));a=this.$services.triggerable.getTriggerErrorTypes(this.page,this.target,a);a.length&&b&&(a=a.filter(function(c){return 0<=c.toLowerCase().indexOf(b.toLowerCase())}));return a},finalizedTrigger:function(a){return a.actions&&0<a.actions.filter(function(b){return"route"==b.type}).length},getAvailableColors:function(a){var b=[];this.$services.page.getArisComponentHierarchy("alert").forEach(function(c){c.dimensions&&c.dimensions.forEach(function(d){"color"==
d.name&&d.options.forEach(function(e){0>b.indexOf(e)&&b.push(e)})})});null!=a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b},getAnchors:function(a){var b=["$blank","$window"];document.body.querySelectorAll("[anchor]").forEach(function(c){b.push(c.getAttribute("anchor"))});b.sort();a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},actionUp:function(a,b){var c=a.actions.indexOf(b);0<c&&(a.actions.splice(c,1),
a.actions.splice(c-1,0,b))},actionDown:function(a,b){var c=a.actions.indexOf(b);c<a.actions.length-1&&(a.actions.splice(c,1),a.actions.splice(c+1,0,b))},getAvailableParameters:function(a,b){var c={};nabu.utils.objects.merge(c,this.$services.page.getAllAvailableParameters(this.page));nabu.utils.objects.merge(c,this.$services.triggerable.getInternalState(this.page,a,b,this.triggers));return c},addAction:function(a){a.actions.push({event:null,url:null,action:null,actionTarget:null,actionEvent:null,route:null,
mask:null,anchor:null,activeRoutes:[],bindings:{}})},addTrigger:function(){var a={actions:[]},b=this.getTriggerNames();1==b.length&&(a.trigger=b[0]);this.target[this.name].push(a)},getTriggerNames:function(a){var b=Object.keys(this.triggers);a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));this.target.triggers&&this.target.triggers.forEach(function(c){var d=null;c.errorTrigger?d=c.errorTrigger:c.trigger&&(d=c.trigger+":error");null!=d&&0>b.indexOf(d)&&b.push(d)});b.sort();
return b}}});
Vue.component("n-form-ace",{template:"\x3cdiv class\x3d'is-form-ace'\x3e\t\x3cdiv class\x3d'is-label-wrapper is-row is-spacing-gap-small' v-if\x3d'label'\x3e\x3clabel class\x3d'is-label'\x3e\x3cspan class\x3d'is-label-content' v-html\x3d'label'\x3e\x3c/span\x3e\x3cn-info v-if\x3d'$slots[\"default\"]'\x3e\x3cslot\x3e\x3c/slot\x3e\x3c/n-info\x3e\x3c/label\x3e\x3cbutton @click\x3d'magnify' class\x3d'is-button is-size-xsmall is-variant-ghost'\x3e\x3cicon name\x3d'search'/\x3e\x3c/button\x3e\x3c/div\x3e\t\x3cdiv class\x3d'is-content-before' v-if\x3d'before' v-html\x3d'before'\x3e\x3c/div\x3e\t\x3cdiv class\x3d'is-content-wrapper'\x3e\t\t\x3cn-ace :mode\x3d'mode' :timeout\x3d'timeout' :value\x3d'value' v-bubble:input ref\x3d'ace' :placeholder\x3d'placeholder'/\x3e\t\x3c/div\x3e\t\x3cn-messages :messages\x3d'messages' v-if\x3d'messages \x26\x26 messages.length'/\x3e\t\x3cdiv class\x3d'is-content-after' v-if\x3d'after' v-html\x3d'after'\x3e\x3c/div\x3e\x3c/div\x3e",props:{value:{required:!0},
label:{type:String,required:!1},mode:{type:String,required:!1,default:"javascript"},timeout:{type:Number,required:!1,default:300},before:{type:String,required:!1},after:{type:String,required:!1},placeholder:{type:String,required:!1},template:{type:Boolean,required:!1}},data:function(){return{messages:[]}},methods:{validate:function(a){return[]},magnify:function(){var a=this;this.$prompt(function(){var b=new (Vue.component("big-ace"))({propsData:{value:a.value,mode:a.mode}});b.$on("input",function(c){a.$emit("input",
c);a.$refs.ace.editor.setValue(c)});return b})}}});
Vue.component("n-ace",{template:"\x3cdiv class\x3d'n-ace'\x3e\x3c/div\x3e",props:{value:{required:!0},mode:{type:String,required:!1,default:"scss"},timeout:{type:Number,required:!1,default:300},placeholder:{type:String,required:!1}},data:function(){return{editor:null,timer:null}},ready:function(){ace.require("ace/ext/language_tools");this.editor=ace.edit(this.$el);this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,useSoftTabs:!1,showInvisibles:!1,scrollPastEnd:!1,
enableEmmet:!1,scrollSpeed:.5,tabSize:4,placeholder:this.placeholder});var a=this;this.editor.getSession().on("change",function(){a.timer&&(clearTimeout(a.timer),a.timer=null);a.$emit("change",a.editor.getSession().getValue());a.timeout?a.timer=setTimeout(function(){a.$emit("input",a.editor.getSession().getValue())},a.timeout):a.$emit("input",value)});this.value&&this.editor.setValue(this.value,-1);this.setMode(this.mode)},methods:{setMode:function(a){this.editor.getSession().setMode("ace/mode/"+
a)},insert:function(a){this.editor.insert(a)}},watch:{mode:function(a){this.editor.getSession().setMode("ace/mode/"+mode)}}});Vue.component("big-ace",{template:"#big-ace",props:{value:{required:!1},mode:{type:String,required:!1,default:"javascript"}},created:function(){console.log("created with",this.value,this.mode)},methods:{close:function(){this.$resolve()}}});
Vue.component("data-pipeline-mixin",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.watchArray();this.loadData&&this.loadData()},methods:{watchArray:function(){if(this.cell.state.array){var a=this;this.$services.data.watchArray({instance:this,handler:function(){a.loadData()}})}}}});
Vue.component("data-configure",{template:"#data-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1}},created:function(){this.target.bindings||Vue.set(this.target,"bindings",{});this.target.defaultOrderBy||Vue.set(this.target,"defaultOrderBy",[]);this.target.type||(this.target.operation?Vue.set(this.target,"type","operation"):this.target.array&&Vue.set(this.target,"type","array"))},computed:{operationParameters:function(){var a=[];if(this.target.operation&&
this.$services.swagger.operations[this.target.operation]){var b=this.$services.swagger.operations[this.target.operation].parameters;b&&nabu.utils.arrays.merge(a,b.map(function(c){return c.name}));a.push("$serviceContext")}return a}},methods:{getRepeatTypes:function(a){var b=[];b.push({name:"operation",title:"The return value of a REST call"});b.push({name:"array",title:"The values available in an array"});nabu.utils.arrays.merge(b,nabu.page.providers("page-repeat"));a&&(b=b.filter(function(c){return c.name&&
0<=c.name.toLowerCase().indexOf(a.toLowerCase())||c.title&&0<=c.title.toLowerCase().indexOf(a.toLowerCase())}));return b},getRepeatConfigurator:function(){var a=this;if(this.target.type&&"operation"!=this.target.type&&"array"!=this.target.type){var b=nabu.page.providers("page-repeat").filter(function(c){return c.name==a.target.type})[0];return b?b.configurator:null}},getOrderByFields:function(){var a=[];if(this.target&&this.target.operation){var b=this.$services.swagger.operation(this.target.operation);
if(b&&b.parameters&&b.parameters.filter(function(d){return"orderBy"==d.name})[0]&&b.responses["200"]&&b.responses["200"].schema){b=this.$services.swagger.resolve(b.responses["200"].schema);var c=this.$services.page.getArrays(b);0<c.length&&(b=this.$services.page.getChildDefinition(b,c[0]))&&b.items&&b.items.properties&&nabu.utils.arrays.merge(a,Object.keys(b.items.properties))}}return a}}});
Vue.component("data-pipeline-configure",{template:"#data-pipeline-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1},removable:{type:Boolean,default:!0},pipeline:{type:Object,required:!0}},data:function(){return{}}});
Vue.component("data-pipelines-configure",{template:"#data-pipelines-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1},allowed:{type:Number},initializer:{type:Function}},created:function(){this.target.pipelines||Vue.set(this.target,"pipelines",[]);1==this.allowed&&0==this.target.pipelines.length&&this.addPipeline()},data:function(){return{}},methods:{addPipeline:function(){var a={};this.initializer&&this.initializer(a);this.target.pipelines.push(a)}}});
Vue.component("page-event-value",{template:"#page-event-value",props:{container:{type:Object,required:!0},page:{type:Object,required:!0},title:{type:String,required:!1,default:"Event"},name:{type:String,required:!1,default:"genericEvent"},inline:{type:Boolean,required:!1},nameModifiable:{type:Boolean,default:!0},keys:{type:Array,required:!1},allowFields:{type:Boolean,default:!0}},created:function(){"string"==typeof this.container[this.name]?Vue.set(this.container,this.name,{eventFields:[{name:"value",
isFixed:!1,fixedValue:null,stateValue:null}],name:this.container[this.name]}):this.container[this.name]?this.container[this.name].eventFields||Vue.set(this.container[this.name],"eventFields",[]):Vue.set(this.container,this.name,{eventFields:[],name:null})},methods:{addEventField:function(a){a.eventFields||Vue.set(a,"eventFields",[]);a.eventFields.push({name:null,fixedValue:null,isFixed:!1,stateValue:null})}}});nabu||={};nabu.page||(nabu.page={});nabu.page.event||(nabu.page.event={});
nabu.page.event={getType:function(a,b,c){var d={};if(a[b]&&a[b].eventFields){var e=c?application.services.page.getAllAvailableParameters(c):{};a[b].eventFields.forEach(function(g){d[g.name]=!g.isFixed&&e?application.services.page.getChildDefinition({properties:e},g.stateValue):{type:"string"}})}return{properties:d}},getName:function(a,b){return a[b]?"string"==typeof a[b]?a[b]:a[b].name:null},getInstance:function(a,b,c,d){var e=application.services.page.getPageInstance(c,d),g={};"string"==typeof a[b]?
"clickEvent"==b?a.hasFixedClickValue&&a.clickEventValue?g.value=a.clickEventValue:a.clickEventValue&&(g.value=application.services.page.getBindingValue(e,a.clickEventValue)):a.hasFixedState&&a.eventFixedState?g.value=application.services.page.interpret(a.eventFixedState,d):a.eventState&&(g.value=e.get(a.eventState)):a[b]&&a[b].eventFields&&a[b].eventFields.forEach(function(k){g[k.name]=k.isFixed?application.services.page.interpret(k.fixedValue,d):application.services.page.getBindingValue(e,k.stateValue)});
return g}};
Vue.component("n-form-page",{template:"#n-form-page",props:{value:{required:!0},timeout:{type:Number,required:!1,default:600}},data:function(){return{page:null,timer:null}},created:function(){var a=this.$services.page.counter++;this.page={name:"dynamic-page-"+a,counter:a,content:this.$services.page.normalize("string"==typeof this.value?JSON.parse(this.value):{})}},methods:{update:function(){var a=JSON.stringify(this.page.content);a!=this.value&&this.$emit("input",a)},validate:function(){return[]}},watch:{page:{handler:function(a){this.timer&&
(clearTimeout(this.timer),this.timer=null);this.timer=setTimeout(this.update,this.timeout)},deep:!0}}});
Vue.component("n-page-mapper",{template:"#n-page-mapper2",props:{from:{type:Object,required:!0},to:{required:!0},value:{type:Object,required:!0},plain:{type:Boolean,default:!1},allowComputed:{type:Boolean,default:!0},watchForChanges:{type:Boolean,default:!1},dropUnused:{type:Boolean,default:!1},allowRecursiveMapping:{type:Boolean,default:!1}},computed:{sources:function(){var a=Object.keys(this.from);a.push("fixed");this.plain||(0<this.$services.page.functions.length&&a.push("$function"),nabu.utils.arrays.merge(a,
nabu.page.providers("page-enumerate").map(function(b){return b.name}).filter(function(b){return 0>a.indexOf(b)})));a.sort();return a},unmappedFields:function(){var a=this;return this.fieldsToMap.filter(function(b){return 0>a.mappedFields.indexOf(b)})}},data:function(){return{fieldsToMap:[],adding:!1,fieldToAdd:null,fieldToMapRecursively:null,fieldMode:null,mappedFields:[],labelChoice:!1}},created:function(){this.calculateFieldsToMap()},methods:{calculateFieldsToMap:function(){this.fieldsToMap.splice(0);
this.mappedFields.splice(0);this.to instanceof Array?nabu.utils.arrays.merge(this.fieldsToMap,this.to):this.to&&nabu.utils.arrays.merge(this.fieldsToMap,this.$services.page.getSimpleKeysFor(this.to,!0,!0));var a=this;this.fieldsToMap.forEach(function(b){null!=a.value[b]&&a.mappedFields.push(b)});this.dropUnused&&Object.keys(this.value).forEach(function(b){0>a.fieldsToMap.indexOf(b)&&delete a.value[b]})},removeField:function(a){this.setValue(a,null,null);a=this.mappedFields.indexOf(a);0<=a&&this.mappedFields.splice(a,
1)},resetField:function(){this.adding=!1;this.fieldMode=this.fieldToAdd=null},addField:function(){this.fieldToAdd&&(this.mappedFields.push(this.fieldToAdd),"fixed"==this.fieldMode&&(this.value[this.fieldToAdd]="fixed."));this.resetField()},mapRecursively:function(){},allFieldsFrom:function(a){var b=this.$services.page.getSimpleKeysFor({properties:this.from},!0,!0);a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},fieldsFrom:function(a,b,c){if("$function"==
b)return c=this.$services.page.listFunctionDefinitions().map(function(e){return e.id}),a&&(c=c.filter(function(e){return e.toLowerCase().indexOf(0<=a.toLowerCase())})),c;if("fixed"==b)return a?[a]:[];var d=nabu.page.providers("page-enumerate").filter(function(e){return e.name==b})[0];if(d)return c=d.enumerate(),d.label&&(c=c.map(function(e){return e[d.label]})),c;c=this.from[b];"array"==c.type&&c.items&&(c=c.items);c=this.$services.page.getSimpleKeysFor(c,!0,!0);a&&(c=c.filter(function(e){return 0<=
e.toLowerCase().indexOf(a.toLowerCase())}));c.push("$all");return c},getUnmappedField:function(a){return this.unmappedFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},getFunctionInput:function(a){var b=this.$services.page.functions.filter(function(e){return e.id==a})[0],c={},d=this;b&&b.inputs.map(function(e){c[e.name]=d.$services.page.getResolvedPageParameterType(e.type)});return{properties:c}},getFunctionOutput:function(a,b){b=this.$services.page.functions.filter(function(e){return e.id==
a})[0];var c={},d=this;b&&b.outputs.map(function(e){c[e.name]=d.$services.page.getResolvedPageParameterType(e.type)});return this.$services.page.getSimpleKeysFor({properties:c},!0,!0)},setValue:function(a,b,c){if(null==c&&!this.labelChoice&&null!=b){var d=b.indexOf(".");0<=d&&(c=b.substring(0,d),b=b.substring(d+1))}if("$function"==c&&b)d=this.$services.page.getFunctionDefinition(b),Vue.set(this.value,a,{label:c,value:b,bindings:{},lambda:d&&d.async?!0:!1,lambdable:!1,output:null}),this.value[a].lambdable=
d&&!d.async;else if("mapRecursive"==this.fieldMode&&"fixed"!=c){var e=this;this.getUnmappedField().forEach(function(g){if("$all"==g||0==g.indexOf(a+".")){var k=g.replace(/^.*\.([^.]+)$/,"$1");e.fieldsFrom(null,c).forEach(function(m){if("$all"==b||0==m.indexOf(b+".")){var p=m.replace(/^.*\.([^.]+)$/,"$1");k==p&&(Vue.set(e.value,g,c+"."+m),e.mappedFields.push(g))}})}});this.resetField()}else null!=c||this.labelChoice?Vue.set(this.value,a,c&&(b||"fixed"==c)?c+"."+(b?b:""):null):Vue.set(this.value,a,
b)},getBindingsFor:function(a){return this.value[a]&&this.value[a].bindings?this.value[a].bindings:null},getObjectFor:function(a){return this.value[a]},isFixedValue:function(a){a=this.value[a];return null!=a&&0==a.indexOf("fixed.")},getValueFor:function(a){return this.value[a]&&this.value[a].value?this.value[a].value:this.labelChoice?this.value[a]?this.value[a].substring(this.value[a].indexOf(".")+1):null:this.value[a]&&0==this.value[a].indexOf("fixed.")?this.value[a].substring(6):this.value[a]},
isComputedValue:function(a){return this.allowComputed?(a=this.getValueFor(a))&&0==a.indexOf("\x3d"):!1},switchComputed:function(a){var b=this.getValueFor(a);b=b&&0==b.indexOf("\x3d")?b.substring(1):"\x3d"+b;console.log("switching computed",a,this.getValueFor(a),b);this.setValue(a,b,"fixed")},getLabelFor:function(a){return this.value[a]&&this.value[a].label?this.value[a].label:this.value[a]?this.value[a].split(".")[0]:0<=this.sources.indexOf("fixed")?"fixed":null},isLambdable:function(a){return this.value[a]&&
this.value[a].lambdable}},watch:{to:function(){this.watchForChanges&&this.calculateFieldsToMap()},value:{deep:!0,handler:function(){this.$emit("changed")}}}});
nabu.services.VueService(Vue.extend({methods:{round:function(a,b){b=Math.pow(10,b);return Math.round(a*b)/b},format:function(a,b,c,d,e,g){if(b.format){if("checkbox"==b.format)return"\x3cn-form-checkbox :value\x3d'value' /\x3e";if(null==a||"undefined"==typeof a)return null;if(b.format&&"text"!=b.format)return"html"==b.format?b.html?b.html:a:"link"==b.format?"\x3ca target\x3d'_blank' class\x3d'is-button is-variant-link is-spacing-none' ref\x3d'noopener noreferrer nofollow' href\x3d'"+a+"'\x3e"+a.replace(/http[s]*:\/\/([^/]+).*/,
"$1")+"\x3c/a\x3e":"date"==b.format?(a&&b.isTimestamp?a=new Date(a):a&&b.isSecondsTimestamp&&(a=new Date(1E3*a)),this.date(a,b.dateFormat)):"dateTime"==b.format?this.date(a,"dateTime"):"number"==b.format?this.number(a,b.amountOfDecimals,b.retainTrailing):"masterdata"==b.format?(c=null,g&&g.page&&(g=this.$services.page.getPageInstance(g.page,g),c=null==g?null:g.getServiceContext()),this.masterdata(a,c)):"javascript"==b.format?this.javascript(a,b.javascript,b.state,b.$value):nabu.page.providers("page-format").filter(function(k){return k.name==
b.format})[0].format(a,b,c,d,e,g)}return a},javascript:function(a,b,c,d){if(b instanceof Function)return b(a);b=(new Function("with(this) { return "+b+" }")).call({value:a,$value:d,state:c,$services:this.$services});b instanceof Function&&(b=b.bind(this),b=b(a));return b},date:function(a,b){if(a instanceof Array){var c=this;return a.map(function(e){return c.date(e,b)})}if(a)"string"==typeof a&&(a=new Date(a));else return null;if(b&&"date"!=b)if("dateTime"==b)b="yyyy-MM-ddTHH:mm:ss.SSS";else{if("locale-date"==
b&&a.toLocaleDateString)return a.toLocaleDateString();if("locale-time"==b&&a.toLocaleTimeString)return a.toLocaleTimeString();if(0==b.indexOf("locale-time-")){b=b.substring(12);a={};var d=b.length-b.replace(/h/g,"").length;1==d?a.hour="numeric":2<=d&&(a.hour=d+"-digit");d=b.length-b.replace(/m/g,"").length;1==d?a.minute="numeric":2<=d&&(a.minute=d+"-digit");d=b.length-b.replace(/s/g,"").length;1==d?a.second="numeric":2<=d&&(a.second=d+"-digit");return(new Date).toLocaleTimeString([],a)}if("locale"==
b&&a.toLocaleString)return a.toLocaleString()}else b="yyyy-MM-dd";b=b.replace(/yyyy/g,a.getFullYear());b=b.replace(/yy/g,(""+a.getFullYear()).substring(2,4));b=b.replace(/dd/g,(10>a.getDate()?"0":"")+a.getDate());b=b.replace(/d/g,a.getDate());b=b.replace(/HH/g,(10>a.getHours()?"0":"")+a.getHours());b=b.replace(/H/g,a.getHours());b=b.replace(/mm/g,(10>a.getMinutes()?"0":"")+a.getMinutes());b=b.replace(/m/g,a.getMinutes());b=b.replace(/ss/g,(10>a.getSeconds()?"0":"")+a.getSeconds());b=b.replace(/s/g,
a.getSeconds());b=b.replace(/[S]+/g,a.getMilliseconds());b=b.replace(/[X]+/g,Math.floor(a.getTimezoneOffset()/60)+":"+a.getTimezoneOffset()%60);nabu.utils.dates.days&&(b=b.replace(/E/g,"#"));b=b.replace(/M/g,"\x3d");b=b.replace(/====/g,this.$services.page.translate(nabu.utils.dates.months()[a.getMonth()]));b=b.replace(/===/g,this.$services.page.translate(nabu.utils.dates.months()[a.getMonth()]).substring(0,3));b=b.replace(/==/g,(9>a.getMonth()?"0":"")+(a.getMonth()+1));b=b.replace(/=/g,a.getMonth()+
1);nabu.utils.dates.days&&(b=b.replace(/####/g,this.$services.page.translate(nabu.utils.dates.days()[nabu.utils.dates.dayOfWeek(a)])),b=b.replace(/###/g,this.$services.page.translate(nabu.utils.dates.days()[nabu.utils.dates.dayOfWeek(a)]).substring(0,3)));b=b.replace(/##/g,(9>nabu.utils.dates.dayOfWeek(a)?"0":"")+(nabu.utils.dates.dayOfWeek(a)+1));return b=b.replace(/#/g,nabu.utils.dates.dayOfWeek(a)+1)},masterdata:function(a,b){if(!a)return"";var c=this.$services.masterdata.entry(a);return c?c.title?
c.title:c.name:(c=this.$services.masterdata.category(a))?c.title?c.title:c.name:this.$services.masterdata.resolve(a,null,b)},number:function(a,b,c){b=null==b?2:parseInt(b);"number"!=typeof a&&(a=parseFloat(a));var d={};d.minimumFractionDigits=c?b:0;d.maximumFractionDigits=b;return Number(a).toLocaleString(this.$services.page.getLocale(),d)},conventionize:function(a){return a.substring(0,1).toUpperCase()+a.substring(1).replace(/([A-Z]+)/g," $1")}}}),{name:"nabu.page.services.Formatter"});
nabu.services.VueService(Vue.extend({data:function(){return{resolved:{},resolvers:{}}},created:function(){var a=this;this.resolver=nabu.utils.misc.BatchResolver(function(b){return a.$services.swagger.execute("nabu.cms.core.manage.node.rest.node.resolve",{ids:b})},function(b,c){c&&a.merge(b,c);return a.resolved[b]},function(b){Vue.set(a.resolved,b,{});return a.resolved[b]},function(b){return b.id})},methods:{getResolver:function(a,b,c,d){var e=d?JSON.stringify(d):"";if(!this.resolvers[a+"."+b+e]){var g=
this;Vue.set(this.resolved,a+"."+b+e,{});var k=this.resolved[a+"."+b+e];this.resolvers[a+"."+b+e]=nabu.utils.misc.BatchResolver(function(m){var p={};d&&nabu.utils.objects.merge(p,d);p[b]=m;return g.$services.swagger.execute(a,p)},function(m,p){p&&g.merge(k,m,p);return k[m]},function(m){Vue.set(k,m,{});return k[m]},function(m){return m[c]})}return this.resolvers[a+"."+b+e]},resolve:function(a,b,c,d,e){var g=e?JSON.stringify(e):"";return this.resolved[a+"."+b+g]&&this.resolved[a+"."+b+g][d]?this.resolved[a+
"."+b+g][d]:this.getResolver(a,b,c,e)(d)},merge:function(a,b,c){a[b]||Vue.set(a,b,{});Object.keys(c).map(function(d){Vue.set(a[b],d,c[d])})}}}),{name:"nabu.page.services.PageResolver"});
nabu.services.VueService(Vue.extend({data:function(){return{timer:null,width:0,height:0}},created:function(){var a=this;this.update();window.addEventListener("resize",function(b){this.timer&&window.clearTimeout(this.timer);this.timer=setTimeout(function(){a.update()},100)})},methods:{update:function(){this.width=Math.max(document.documentElement.clientWidth,window.innerWidth||0);this.height=Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}}),{name:"nabu.page.services.Resizer"});
Vue.service("aris",{methods:{getAmountOfAppliedOptions:function(a,b){var c=this,d=this.getAvailableModifiers(a,b);d=Object.keys(d).filter(function(g){return c.isActiveModifier(a,b,g)}).length;var e=0;this.getAvailableDimensions(b).forEach(function(g){e+=g.options.filter(function(k){return c.isActiveOption(a,b,g,k.name)}).length});return e+d},isActiveModifier:function(a,b,c){return 0<=a.components[b.name].modifiers.indexOf(c)},getAvailableDimensions:function(a){var b=[];this.$services.page.getArisComponentHierarchy(a.component).forEach(function(c){c.dimensions&&
c.dimensions.forEach(function(d){var e=b.filter(function(g){return g.name==d.name})[0];e||(e={name:d.name},b.push(e));e.options||(e.options=[]);e.components||(e.components=[]);e.components.push(c.name);0<e.options.length?d.options.forEach(function(g){var k=e.options.filter(function(m){return m.name==g.name})[0];null==k?e.options.push(JSON.parse(JSON.stringify(g))):0>k.body.indexOf(g.body)&&(k.body+="\n"+g.body)}):nabu.utils.arrays.merge(e.options,d.options)})});b.sort(function(c,d){return c.name.localeCompare(d.name)});
return b},getAvailableModifiers:function(a,b){var c=a.components[b.name].variant,d={};this.getAvailableVariants(b).filter(function(e){return"default"==e.name||e.name==c}).forEach(function(e){e.modifiers&&e.modifiers.forEach(function(g){null==d[g]&&(d[g]=[]);d[g].push({variant:e.name,component:e.component})})});return d},isActiveOption:function(a,b,c,d){return 0<=a.components[b.name].options.indexOf(c.name+"_"+d)},getAvailableVariants:function(a){var b=[];this.$services.page.getArisComponentHierarchy(a.component).forEach(function(c){null!=
c.variants&&c.variants.forEach(function(d){d=JSON.parse(JSON.stringify(d));d.component=c.name;b.push(d)})});return b},listActiveOptions:function(a,b,c){if(!a||!a.components[b.name])return[];a=a.components[b.name].options.filter(function(d){return 0==d.indexOf(c.name+"_")}).map(function(d){return d.substring((c.name+"_").length)});return null==a?[]:a},listActiveModifiers:function(a,b){a=a&&a.components[b.name]?a.components[b.name].modifiers:null;return null==a?[]:a},listActive:function(a,b){var c=
[],d=this;nabu.utils.arrays.merge(c,this.listActiveModifiers(a,b).map(function(e){return{name:e,dimension:"modifier"}}));this.getAvailableDimensions(b).forEach(function(e){nabu.utils.arrays.merge(c,d.listActiveOptions(a,b,e).map(function(g){return{name:g,dimension:e.name}}))});return c.map(function(e){return{name:e.name,dimension:e.dimension,condition:a.components[b.name].conditions[e.dimension+"_"+e.name]}})}}});nabu||={};nabu.page||(nabu.page={});
nabu.page.provide=function(a,b){nabu.page.state||(nabu.page.state={providers:[]});nabu.page.state.providers[a]||(nabu.page.state.providers[a]=[]);nabu.page.state.providers[a].push(b)};nabu.page.providers=function(a){return nabu.page.state&&nabu.page.state.providers[a]?nabu.page.state.providers[a]:[]};nabu.page.instances={};
nabu.services.VueService(Vue.extend({services:["swagger","user","cookies"],data:function(){return{activeSubTab:"component",availableSubTabs:[],showBreadcrumbs:!0,showRawTranslations:!1,activeViews:[],chosenRoute:null,mouseX:0,mouseY:0,counter:1,title:null,theme:null,restrictToTheme:!0,home:null,homeUser:null,pages:[],loading:!0,properties:[],environment:null,environmentProperties:[],devices:[],styles:[],templates:[],pageTemplates:[],functions:[],contents:[],imports:[],applicationState:[],translations:[],
lastCompiled:null,customStyle:null,cssStep:null,editable:!1,testable:!1,wantEdit:!1,copiedRow:null,copiedCell:null,useEval:!1,cssLastModified:null,cssError:null,functionError:null,disableReload:!0,validations:[],googleSiteVerification:null,editing:null,dragItems:[],variables:{},geoRefusalTimeout:null,location:null,showConsole:!1,reports:[],enabledFeatures:[],availableFeatures:[],toggledFeatures:[],users:[],dragTypes:[],inspectContent:null,consoleTab:null,branding:{},currentBranding:{},defaultLocale:null,
copiedType:null,copiedContent:null,rendering:0,stable:!1,stableTimer:null,hasAcceptedCookies:!0,cookieHooks:[],cookieProviders:{},useAris:!0,aris:null,copiedStyling:null,notificationStyle:"success-outline",conditionalResults:{}}},activate:function(a){this.interceptCookies();this.synchronizeCookies(!0);this.calculateAcceptedCookies();var b=this;this.pageCounter=0;window.addEventListener("paste",function(c){if(b.canEdit()&&(c=c.clipboardData.getData("text/plain")))try{var d=JSON.parse(c);d&&"page-row"==
d.type?(b.copiedRow=d.content,b.copiedCell=null):d&&"page-cell"==d.type?(b.copiedCell=d.content,b.copiedRow=null):d.type&&d.content&&(b.copiedType=d.type,b.copiedContent=d.content)}catch(e){}});window.addEventListener("keydown",function(c){!b.canEdit()||"Backquote"!=c.code&&121!=c.which||(b.showConsole=!b.showConsole)});this.isServerRendering=navigator.userAgent.match(/Nabu-Renderer/);this.$services.swagger.offlineHandler=function(){setTimeout(function(){b.$services.router.route("offline",null,null,
!0)},1)};nabu.page.providers("page-cookies").filter(function(c){return c.name&&!c.accept}).forEach(function(c){var d=c.group?c.group:c.name;b.cookieProviders[d]||Vue.set(b.cookieProviders,d,[]);0>b.cookieProviders[d].indexOf(c.name)&&b.cookieProviders[d].push(c.name)});this.activate(a,!0)},clear:function(a){Object.keys(nabu.page.instances).forEach(function(b){nabu.page.instances[b].emit("$clear",{})});this.activate(a?a:function(){},!1)},computed:{enumerators:function(){var a={};nabu.page.providers("page-enumerate").map(function(b){a[b.name]=
b});return a},isSsr:function(){return navigator.userAgent.match(/Nabu-Renderer/)}},created:function(){var a=this;document.addEventListener("keydown",function(b){b.ctrlKey&&b.altKey&&88==b.keyCode?(a.canEdit()?a.wantEdit=!a.wantEdit:a.$services.router.route("login",null,null,!0),b.preventDefault()):a.canEdit()&&(b.key&&"f1"==b.key.toLowerCase()?(0>a.activeViews.indexOf("conditions")&&a.activeViews.push("conditions"),b.stopPropagation(),b.preventDefault()):b.key&&"f2"==b.key.toLowerCase()&&(0>a.activeViews.indexOf("styling")&&
a.activeViews.push("styling"),b.stopPropagation(),b.preventDefault()))});document.addEventListener("keyup",function(b){a.canEdit()&&(b.key&&"f1"==b.key.toLowerCase()?(b=a.activeViews.indexOf("conditions"),0<=b&&a.activeViews.splice(b,1)):b.key&&"f2"==b.key.toLowerCase()&&(b=a.activeViews.indexOf("styling"),0<=b&&a.activeViews.splice(b,1)))})},methods:{cleanup:function(a){var b=this;a instanceof Array?a.forEach(this.cleanup):this.isObject(a)&&Object.keys(a).forEach(function(c){0==c.indexOf("$")?delete a[c]:
b.cleanup(a[c])});return a},nullify:function(a){var b=this;if(a instanceof Array)a.forEach(this.nullify);else if(Object.keys(a).forEach(function(c){null!=a[c]&&b.$services.page.isObject(a[c])&&(a[c]=b.nullify(a[c]));a[c]instanceof Array&&0==a[c].length&&delete a[c];null==a[c]&&delete a[c]}),0==Object.keys(a).length)return null;return a},getPrettyNameForTypography:function(a){if(a.state&&a.state.content)return a=a.state.content.trim(),"{"==a.substring(0,1)&&(a=a.substring(1)),"}"==a.substring(a.length-
1)&&(a=a.substring(0,a.length-1)),a=this.prettify(a)},isThemeCompliant:function(a){return null!=this.theme&&this.restrictToTheme?a.theme==this.theme:!0},isActiveView:function(a){return 0<=this.activeViews.indexOf(a)},renderComponent:function(a,b,c,d,e,g,k){var m={};if(e){var p=this,q=this.$services.page.getPageInstance(a,c);Object.keys(e).forEach(function(t){var u=e[t];null!=u&&(u=k?k(u):p.$services.page.getBindingValue(q,u,p),null!=u&&p.$services.page.setValue(m,t,u))})}a=document.createElement("div");
this.$services.router.route(d,m,a,!0).then(g)},isPartOfTemplate:function(a){return a.templateReferenceId&&!a.templateVersion},getTemplateRoot:function(a,b,c){a=this.getTargetPath(a.content,b.id);c||a.reverse();return a.filter(function(d){return d.templateReferenceId&&d.templateVersion})[0]},getBindings:function(a,b,c){var d=this,e={},g=d.$services.page.getPageInstance(b.page,b);Object.keys(a).map(function(k){if(null!=a[k]){var m=null,p=a[k].indexOf("."),q=!1;0<p&&(p=a[k].substring(0,p),c&&c.hasOwnProperty(p)&&
(m=d.$services.page.getValue(c,a[k]),q=!0));q||(m=d.$services.page.getBindingValue(g,a[k],b));null!=m&&d.$services.page.setValue(e,k,m)}});return e},updateToLatestTemplate:function(a,b){var c=this;if(a.templateReferenceId){c=this;var d=this.templates.filter(function(m){return m.id==a.templateReferenceId})[0],e=JSON.parse(d.content).content,g=function(m,p){if(m.id==p)return m;if(m.cells)return m.cells.reduce(function(q,t){return null==q?g(t,p):q},null);if(m.rows)return m.rows.reduce(function(q,t){return null==
q?g(t,p):q},null)},k=function(m){var p=g(e,m.templateFragmentId);p&&p.aris&&(Vue.set(m,"aris",p.aris),c.$services.page.setRerender(m.aris));m.cells&&m.cells.forEach(k);m.rows&&m.rows.forEach(k)};k(a);a.templateVersion=d.templateVersion}b&&(a.cells&&a.cells.forEach(function(m){c.updateToLatestTemplate(m,!0)}),a.rows&&a.rows.forEach(function(m){c.updateToLatestTemplate(m,!0)}))},watchField:function(a,b,c){0==b.indexOf("page.")&&(b=b.substring(5));var d=this,e=null,g=a.get(b);c(g);for(var k=b;null==
g&&0<=k.indexOf(".");){var m=k.lastIndexOf(".");0<m&&(k=k.substring(0,m),g=a.get(k))}e=null==g?a.$watch("variables",function(p){p=a.get("page."+b);null!=p&&c(p);e();d.watchField(a,b,c)},{deep:!0}):k!=b?a.$watch("variables."+k,function(p){p=a.get("page."+b);null!=p&&c(p);e();d.watchField(a,b,c)},{deep:!0}):a.$watch("variables."+b,function(p){c(p);e();d.watchField(a,b,c)},{deep:!0});return function(){null!=e&&e()}},getSwaggerOperationInputDefinition:function(a){var b={properties:{}},c=this;a&&((a=this.$services.swagger.operations[a])&&
a.parameters&&(c=this,a.parameters.forEach(function(d){b.properties[d.name]=d.schema?c.$services.swagger.resolve(d.schema):d})),b.properties.$serviceContext={type:"string"});return b},getSwaggerOperationOutputDefinition:function(a){var b={};null!=a&&(a=this.$services.swagger.operations[a])&&a.responses["200"]&&(a=a.responses["200"])&&a.schema&&(a=this.$services.swagger.resolve(a.schema))&&(b=a);return b},listCloseableItems:function(a,b,c){var d=[],e=function(m){m.closeable?d.push(m):m.on&&c&&d.push(m);
m.cells&&m.cells.forEach(e);m.rows&&m.rows.forEach(e)};e(a.content);if(b){var g=this.getPageInstance(a),k=this;d=d.filter(function(m){return 0<=k.formatPageItem(g,m).toLowerCase().indexOf(b.toLowerCase())})}return d},isCloseable:function(a){return a.on||a.closeable||"page"!=a.target&&null!=a.target},getAvailableActions:function(a,b){var c=this,d={};a.getActions().forEach(function(g){d[g.name]=g});this.getSingularComponents(a).forEach(function(g){c.getActions(g,null,a).forEach(function(k){d[k.name]=
k})});this.getAvailableRenderers(a.page).forEach(function(g){var k=c.getRenderer(g.renderer);c.getActions(k,g,a).forEach(function(m){d[m.name]=m})});var e=Object.values(d);e.sort(function(g,k){return g.name.localeCompare(k.name)});b&&(e=e.filter(function(g){return 0<=g.name.toLowerCase().indexOf(b.toLowerCase())||g.title&&0<=g.title.toLowerCase().indexOf(b.toLowerCase())}));return e},getSingularComponents:function(a){var b=[];Object.keys(a.components).forEach(function(c){if(c instanceof Number||c.match(/^[0-9]+$/))!a.components[c]||
a.components[c]instanceof Array||b.push(a.components[c])});return b},getActionTargets:function(a,b,c){var d=[];a.getActions().forEach(function(g){g.name==b&&d.push({name:a.page.name,id:"$page",runAction:a.runAction})});var e=this;this.getSingularComponents(a).forEach(function(g){0<e.getActions(g,null,a).filter(function(k){return k.name==b}).length&&d.push(g.$$cell?g.$$cell:g.target)});c&&(d=d.filter(function(g){return g.name&&0<=g.name.toLowerCase().indexOf(c.toLowerCase())}));return d},getSpecificationTargets:function(a,
b){var c=[],d=this;this.getSingularComponents(a).forEach(function(e){e.getSpecifications&&0<=e.getSpecifications().indexOf(b)&&c.push(e.$$cell)});this.getAvailableRenderers(a.page).forEach(function(e){var g=d.getRenderer(e.renderer);g.getSpecifications&&0<=g.getSpecifications(e).indexOf(b)&&c.push(e)});return c},getActionTarget:function(a,b){if("$page"==b){for(;a.fragmentParent;)a=a.fragmentParent;return a}var c=a.components[b];!c&&a.fragmentParent&&(c=this.getActionTarget(a.fragmentParent,b));return c},
getActionOutput:function(a,b,c){return(b=this.getActionTarget(a,b))&&(a=this.getActions(b,null,a).filter(function(d){return d.name==c})[0])&&a.output&&0<Object.keys(a.output).length?a.output:null},getActionInput:function(a,b,c){return(b=this.getActionTarget(a,b))&&(a=this.getActions(b,null,a).filter(function(d){return d.name==c})[0])&&a.input&&0<Object.keys(a.input).length?a.input:null},getState:function(a){var b={};if(a.getSpecifications){var c=a.getSpecifications();nabu.page.providers("page-specification").filter(function(d){return 0<=
c.indexOf(d.name)}).forEach(function(d){d.state&&nabu.utils.objects.merge(b,d.state)})}a.getState&&nabu.utils.objects.merge(b,a.getState())},getActions:function(a,b,c){var d=[];a.getActions&&nabu.utils.arrays.merge(d,a.getActions(b,c,this.$services));if(a.getSpecifications){var e=a.getSpecifications(b);b=nabu.page.providers("page-specification").filter(function(g){return 0<=e.indexOf(g.name)});b.forEach(function(g){g.actions&&nabu.utils.arrays.merge(d,g.actions)})}(a.target||a.cell||a.row)&&(a=a.target?
a.target:a.cell?a.cell:a.row)&&a.renderer&&((b=this.getRenderer(a.renderer))&&b.getActions&&nabu.utils.arrays.merge(d,b.getActions(a,c,this.$services)),b&&b.getSpecifications&&(e=b.getSpecifications(a),b=nabu.page.providers("page-specification").filter(function(g){return 0<=e.indexOf(g.name)}),b.forEach(function(g){g.actions&&nabu.utils.arrays.merge(d,g.actions)})));return d},getRenderers:function(a){return nabu.page.providers("page-renderer").filter(function(b){return null==b.type||b.type==a||b.type instanceof
Array&&0<=b.type.indexOf(a)})},getRenderer:function(a){return nabu.page.providers("page-renderer").filter(function(b){return b.name==a})[0]},getRendererConfiguration:function(a){var b=nabu.page.providers("page-renderer").filter(function(c){return c.name==a})[0];return b?b.configuration:null},getRendererState:function(a,b,c,d){var e=nabu.page.providers("page-renderer").filter(function(m){return m.name==a})[0],g=e&&e.getState?e.getState(b,c,d,this.$services):null;g?g.properties||(g.properties={}):g=
{properties:{}};if(e.getSpecifications){var k=e.getSpecifications(b);nabu.page.providers("page-specification").filter(function(m){return 0<=k.indexOf(m.name)}).forEach(function(m){m.state&&nabu.utils.objects.merge(g.properties,m.state)})}return g},applyRendererParameters:function(a,b,c,d){console.log("applying parameters",b,c,d);if(b&&b.rendererBindings){var e=this;Object.keys(b.rendererBindings).forEach(function(g){if(null!=b.rendererBindings[g]){var k=!1;if(!d){var m=a.get(b.rendererBindings[g]);
m&&e.isObject(m)&&(e.mergeObject(m,e.$services.page.getValue(c,g)),k=!0)}k||a.set(b.rendererBindings[g],e.$services.page.getValue(c,g))}})}},calculateAcceptedCookies:function(){this.hasAcceptedCookies=!!this.$services.cookies.get("cookie-settings")},getAllowedCookies:function(){var a="JSESSION language Device-moduleWeb Realm-moduleWeb cookie-settings geolocation-refused".split(" "),b=this;this.getCookieSettings().forEach(function(c){a.push(c);b.cookieProviders[c]instanceof Array&&nabu.utils.arrays.merge(a,
b.cookieProviders[c])});nabu.page.providers("page-cookies").filter(function(c){return c.name&&c.accept}).forEach(function(c){a.push(c.name)});return a},getCookieSettings:function(){var a=[],b=this.$services.cookies.get("cookie-settings");if(b)try{nabu.utils.arrays.merge(a,JSON.parse(b))}catch(c){}return a},isPage:function(a){return a&&a.$options&&a.$options.template&&("#nabu-page"==a.$options.template||"#nabu-page-optimized"==a.$options.template)},pasteItem:function(a){var b=null;this.isCopied(a)&&
(b=this.copiedContent,this.copiedType=this.copiedContent=null);return b},isCopied:function(a){return this.copiedType==a},copyItem:function(a,b,c){null==c&&(c=!0);nabu.utils.objects.copy({type:a,content:b});this.copiedType=a;this.copiedContent=c?JSON.parse(JSON.stringify(b)):b},suggestDevices:function(a){var b=this.devices.map(function(c){return c.name});a&&a.match(/[0-9]+/)&&b.unshift(a);return b},device:function(a,b){null==b&&(b=a.replace(/.*?([\w]+).*?/,"$1").trim(),a=a.replace(/([^\w]+)?.*/,"$1").trim());
return this.isDevice([{operator:a,name:b}])},isDevice:function(a){for(var b=this.$services.resizer.width,c=0;c<a.length;c++)if(a[c].operator&&a[c].name){var d=a[c].operator,e=0;if(a[c].name.match(/[0-9]+/))e=parseInt(a[c].name);else{var g=this.devices.filter(function(k){return k.name==a[c].name})[0];g&&g.width?e=parseInt(g.width):g&&!g.width&&"wide"==g.name?e=2560:g&&!g.width&&"desktop"==g.name?e=1280:g&&!g.width&&"tablet"==g.name?e=960:g&&!g.width&&"phone"==g.name&&(e=512)}if(0==e){if("\x3e"!=d&&
"\x3e\x3d"!=d)return!1}else if("\x3c"==d&&b>=e||"\x3c\x3d"==d&&b>e||"\x3e"==d&&b<=e||"\x3e\x3d"==d&&b<e||"\x3d\x3d"==d&&b!=e)return!1}return!0},getLocale:function(){return this.defaultLocale?this.defaultLocale:navigator.language?navigator.language:navigator.userLanguage?navigator.userLanguage:navigator.browserLanguage?navigator.browserLanguage:"en-US"},mergeObject:function(a,b){var c=[];Object.keys(b).forEach(function(d){a[d]instanceof Array&&b[d]instanceof Array?(a[d].splice(0),nabu.utils.arrays.merge(a[d],
b[d])):Vue.set(a,d,b[d]);c.push(d)});Object.keys(a).forEach(function(d){0>c.indexOf(d)&&(a[d]=null,delete a[d])})},showContent:function(a){this.inspectContent=a;this.consoleTab="inspect";this.showConsole=!0},downloadService:function(a,b,c,d){var e=this,g=this.$services.q.defer();b.$$rawMapper=function(k,m){"blob"==m.responseType?k=m.response:"arraybuffer"==m.responseType?k=new Blob(m.response):null!=m.responseText&&(k=new Blob([m.responseText],{type:m.getResponseHeader("Content-Type")}));return k};
d&&(b.$accept=d);this.$services.swagger.execute(a,b).then(function(k){e.downloadBlob(k,c).then(g,g)},g);return g},downloadBlob:function(a,b){var c=this.$services.q.defer(),d=new FileReader;d.readAsDataURL(a);d.onload=function(){var e=d.result,g=document.createElement("a");document.body.appendChild(g);g.setAttribute("download",b?b:a.name?a.name:"");g.setAttribute("href",e);g.click();document.body.removeChild(g);c.resolve()};return c},download:function(a,b,c){var d=d=document.createElement("iframe");
d.setAttribute("class","hiddenDownloader");d.style.visibility="hidden";d.style.width="0px";d.style.height="0px";d.style.display="none";d.onload=function(e){e=d.contentDocument||d.contentWindow.document;!e||e.body&&""!=e.body.innerHTML?(console.log("file download failed",a),b&&b(a)):(console.log("File downloaded correctly",a),c&&c(a))};d.onerror=function(e){console.log("failed!",e)};document.body.appendChild(d);null!=this.$services.language&&null!=this.$services.language.current&&(a=0>=a.indexOf("?")?
a+("?language\x3d"+this.$services.language.current):a+("\x26language\x3d"+this.$services.language.current));d.src=a},report:function(a,b,c,d,e){this.canEdit()&&(this.reports.unshift({category:a,source:b,type:c,name:d,timestamp:new Date,properties:e}),this.limitReports())},limitReports:function(){20<=this.reports.length&&!this.showConsole&&this.reports.splice(20)},getIconHtml:function(a,b){var c=nabu.page.providers("page-icon");c.sort(function(d,e){return d.priority-e.priority});return c[0].html(a,
b)},getNameColor:function(a){for(var b=0,c=0;c<a.length;c++)b=a.charCodeAt(c)+((b<<5)-b);return"hsl("+b%360+", 80%, 40%)"},closeRight:function(){var a=document.querySelector("#n-sidebar-right-instance");a&&a.__vue__&&a.__vue__.close?a.__vue__.close():a&&a.$$close&&a.$$close()},clearAllDrag:function(){this.clearDrag();console.log("-----------\x3e clearing drag");this.dragTypes.splice(0)},clearDrag:function(){this.dragItems.splice(0).forEach(function(a){a.classList.remove("is-hover-bottom","is-hover-top",
"is-hovering","is-hover-left","is-hover-right")})},setDragData:function(a,b,c){a&&a.dataTransfer&&a.dataTransfer.setData&&event.dataTransfer.setData(b,c);this.dragTypes.push({type:b,value:c})},hasDragData:function(a,b){return"operation"==b&&a&&a.dataTransfer&&a.dataTransfer.data&&a.dataTransfer.data.service?!0:a&&a.dataTransfer&&a.dataTransfer.types&&0<=a.dataTransfer.types.indexOf(b)||0<this.dragTypes.filter(function(c){return c.type==b}).length},getDragData:function(a,b){var c=a&&a.dataTransfer&&
a.dataTransfer.getData?a.dataTransfer.getData(b):null;!c&&"operation"==b&&a&&a.dataTransfer&&a.dataTransfer.data&&a.dataTransfer.data.service&&(c=a.dataTransfer.data.service);!c&&(c=this.dragTypes.filter(function(d){return d.type==b})[0])&&(c=c.value);return c},pushDragItem:function(a){this.clearDrag();this.dragItems.push(a)},parseValue:function(a){return null==a||"null"==a?null:"true"===a?!0:"false"===a?!1:a.match instanceof Function&&a.match(/^[0-9]+$/)?parseInt(a):a.match instanceof Function&&
a.match(/^[0-9.]+$/)?parseFloat(a):a},isClickable:function(a){return a.classList&&a.classList.contains("clickable")?!0:a.classList&&a.classList.contains("unclickable")?!1:a.parentNode?this.isClickable(a.parentNode):!0},getAvailableTypes:function(a){var b=["string","boolean","number","integer"];nabu.utils.arrays.merge(b,Object.keys(this.$services.swagger.swagger.definitions));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},getContent:function(a,b){return this.$services.language&&
this.$services.language.cookieValue?this.contents.filter(function(c){return a&&c.page!=a?!1:!a&&c.page?!1:c.key==b})[0]:null},formatFieldsLight:function(a,b){for(a=0;a<b.length;a++);},formatPageItem:function(a,b){a=null!=b.id?a.getComponentForCell(b.id):null;return b.name?b.name:b.id&&null!=a&&null!=a.getPrettyName&&null!=a.getPrettyName(b)?a.getPrettyName(b):b.alias?this.prettifyRouteAlias(b.alias):b.renderer&&this.getRenderer(b.renderer)?this.getRenderer(b.renderer).title:""+b.id},getRootPage:function(a){for(;a&&
a.fragmentParent;)a=a.fragmentParent;return a},getPageType:function(a,b){this.calculatedPageTypes||(this.calculatedPageTypes={});this.calculatedPageTypes[a.content.name]||(this.calculatedPageTypes[a.content.name]={});if(this.calculatedPageTypes[a.content.name]["target-"+b.id]&&!this.editing)return this.calculatedPageTypes[a.content.name]["target-"+b.id];var c=this,d=null,e=this.getRootPage(this.getPageInstance(a));e=this.$services.page.getTargetPath(e.page.content,b.id);e.reverse();e.forEach(function(k){if(k.renderer&&
!d){var m=c.getRenderer(k.renderer);m&&m.getPageType&&(d=m.getPageType(k))}});null==d&&(d=a.content.pageType);var g=null==d?null:nabu.page.providers("page-type").filter(function(k){return k.name==d})[0];e={pageType:d,path:e,provider:g};if(this.editing)return e;this.calculatedPageTypes[a.content.name]["target-"+b.id]=e;return this.calculatedPageTypes[a.content.name]["target-"+b.id]},getCellComponents:function(a,b){var c=[],d=this.getPageType(a,b);d&&d.provider&&d.provider.cellComponent instanceof Function&&
(d=d.provider.cellComponent(b,d.path,a))&&c.push({title:"Cell",name:d,component:d});0==c.length&&c.push({title:"Cell",name:"page-column",component:"page-column",defaultVariant:"page-column"+(b.alias?"-"+b.alias:"")});b.renderer&&(d=this.getRenderer(b.renderer))&&d.getChildComponents&&nabu.utils.arrays.merge(c,d.getChildComponents(b));d=this.getPageInstance(a).getComponentForCell(b.id);null!=d&&(d.getChildComponents?nabu.utils.arrays.merge(c,d.getChildComponents()):d&&d.configurator&&(a=Vue.component(d.configurator()),
a=new a({propsData:{page:this.page,cell:b}}),a.$destroy(),a.getChildComponents&&nabu.utils.arrays.merge(c,a.getChildComponents())));return c},getRowComponents:function(a,b){var c=[],d=this.getPageType(a,b);d&&d.provider&&d.provider.rowComponent instanceof Function&&(a=d.provider.rowComponent(b,d.path,a))&&c.push({title:"Row",name:a,component:a});0==c.length&&c.push({title:"Row",name:"page-row",component:"page-row"});b.renderer&&(a=this.getRenderer(b.renderer))&&a.getChildComponents&&nabu.utils.arrays.merge(c,
a.getChildComponents(b));return c},slowNormalizeAris:function(a,b,c){var d=this;Vue.nextTick(function(){Vue.nextTick(function(){d.normalizeAris(a,b,c)})})},setRerender:function(a){a&&!a.hasOwnProperty("rerender")?Object.defineProperty(a,"rerender",{value:!0,enumerable:!1,writable:!0}):a&&(a.rerender=!0)},normalizeAris:function(a,b,c,d){this.useAris&&(null==b.aris&&Vue.set(b,"aris",{components:{}}),null!=d||null!=c&&"row"!=c&&"cell"!=c||(d="row"==c?this.getRowComponents(a,b):this.getCellComponents(a,
b)),d.forEach(function(e){null==b.aris.components[e.name]&&Vue.set(b.aris.components,e.name,{variant:null,modifiers:[],options:[],conditions:{}});null==b.aris.components[e.name].conditions&&Vue.set(b.aris.components[e.name],"conditions",{});e.defaultVariant&&Vue.set(b.aris.components[e.name],"defaultVariant",e.defaultVariant)}),this.setRerender(b.aris));return!0},calculateArisComponents:function(a,b,c){var d={},e=this;if(a&&a.components){var g=a.components;Object.keys(g).forEach(function(k){var m=
g[k];d[k]={classes:[]};null!=m.variant?"default"!=m.variant&&d[k].classes.push("is-variant-"+m.variant):null!=m.defaultVariant?d[k].classes.push("is-variant-"+m.defaultVariant):b?d[k].classes.push("is-variant-"+k+"-"+b):d[k].classes.push("is-variant-"+k);null!=m.options&&0<m.options.length&&m.options.forEach(function(p){var q=!0;m.conditions&&null!=m.conditions[p]&&(q=e.isCondition(m.conditions[p],{},c));q&&d[k].classes.push("is-"+p.replace("_","-"))});null!=m.modifiers&&0<m.modifiers.length&&m.modifiers.forEach(function(p){var q=
!0;m.conditions&&null!=m.conditions[p]&&(q=e.isCondition(m.conditions[p],{},c));q&&d[k].classes.push("is-"+p)})})}return d},getArisComponentHierarchy:function(a){var b=this.getArisComponents(),c=[];for(a=b[a];a;)c.push(a),a=a.extends?b[a.extends]:null;return c},getArisComponents:function(){return this.aris},activate:function(a,b){var c=this,d=function(){var e=c.$services.q.defer();0<=navigator.userAgent.indexOf("Trident")?e.resolve():c.inject("/resources/cdn/ace/1.3.3/ace.js",function(){c.inject("/resources/cdn/ace/1.3.3/mode-scss.js");
c.inject("/resources/cdn/ace/1.3.3/mode-javascript.js");c.inject("/resources/cdn/ace/1.3.3/mode-html.js");c.inject("/resources/cdn/ace/1.3.3/ext-language_tools.js");c.inject("/resources/cdn/ace/1.3.3/ext-whitespace.js");e.resolve()},function(){c.editable=!1;e.resolve()});return e};c.$services.swagger.execute("nabu.web.page.core.v2.rest.configuration.get").then(function(e){c.editable=e.editable;c.testable=e.testable;c.pages.splice(0,c.pages.length);c.properties.splice(0,c.properties.length);c.environmentProperties.splice(0);
c.devices.splice(0,c.devices.length);c.contents.splice(0);c.translations.splice(0);c.enabledFeatures.splice(0);c.availableFeatures.splice(0);c.toggledFeatures.splice(0);c.users.splice(0);c.defaultLocale=e.defaultLocale;c.environment=e.environment;e.branding?Vue.set(c,"branding",e.branding):Vue.set(c,"branding",{});e.pages&&(nabu.utils.arrays.merge(c.pages,e.pages),c.loadPages(c.pages),c.loadFormatters(c.pages));e.properties&&nabu.utils.arrays.merge(c.properties,e.properties);e.environmentProperties&&
nabu.utils.arrays.merge(c.environmentProperties,e.environmentProperties);e.devices&&nabu.utils.arrays.merge(c.devices,e.devices);c.ensureDevices();e.title&&(c.title=e.title);e.theme&&(c.theme=e.theme);e.home&&(c.home=e.home);e.homeUser&&(c.homeUser=e.homeUser);e.users&&nabu.utils.arrays.merge(c.users,e.users);e.contents&&nabu.utils.arrays.merge(c.contents,e.contents);e.translations&&nabu.utils.arrays.merge(c.translations,e.translations.map(function(k){k&&k.translation&&k.name&&(k.name=k.name.replace(/\\n/g,
"\n").replace(/\\"/g,'"'),k.translation=k.translation.replace(/\\n/g,"\n").replace(/\\"/g,'"'));return k}));e.imports&&nabu.utils.arrays.merge(c.imports,e.imports);e.state&&nabu.utils.arrays.merge(c.applicationState,e.state);e.googleSiteVerification&&(c.googleSiteVerification=e.googleSiteVerification);null!=e.geoRefusalTimeout&&(c.geoRefusalTimeout=e.geoRefusalTimeout);(c.home||c.homeUser)&&c.registerHome(c.home,c.homeUser);e.enabledFeatures&&nabu.utils.arrays.merge(c.enabledFeatures,e.enabledFeatures);
null!=c.geoRefusalTimeout&&navigator.geolocation&&(c.$services.cookies.get("geolocation-refused")||navigator.geolocation.getCurrentPosition(function(k){Vue.set(c,"location",k.coords);navigator.geolocation.watchPosition(function(m){Vue.set(c,"location",m.coords)})},function(k){k.code==k.PERMISSION_DENIED&&c.geoRefusalTimeout&&c.$services.cookies.set("geolocation-refused","true",c.geoRefusalTimeout)}));c.googleSiteVerification&&(e=document.createElement("meta"),e.setAttribute("name","google-site-verification"),
e.setAttribute("content",c.googleSiteVerification),document.head.appendChild(e));navigator.userAgent.match(/Nabu-Renderer/)||c.imports.forEach(function(k){"javascript"==k.type&&c.inject(c.interpret(k.link),function(){},function(){},k.async)});var g=[];c.canEdit()?(c.injectEditIcon(),e=[],c.useAris&&e.push(nabu.utils.ajax({url:"/api/otr/page/aris-definitions"}).then(function(k){c.aris={};JSON.parse(k.responseText).forEach(function(m){c.aris[m.name]=m})})),e.push(d()),e.push(c.$services.swagger.execute("nabu.web.page.core.v2.rest.templates.list").then(function(k){k&&
k.templates&&k.templates.forEach(function(m){try{var p=JSON.parse(m.content);"page"==p.type?c.pageTemplates.push(m):"pages"==p.type?c.pageTemplates.push(m):c.templates.push(m)}catch(q){console.error("Can not parse JSON",q,m.content)}})})),c.scanPagesForTemplates()):c.removeEditIcon();c.canTest()&&c.$services.swagger.execute("nabu.web.page.core.v2.rest.feature.get").then(function(k){k&&(k.enabled&&(nabu.utils.arrays.merge(c.availableFeatures,k.enabled.map(function(m){m.enabled=!0;return m})),k.enabled.forEach(function(m){0>
c.enabledFeatures.indexOf(m.name)&&c.enabledFeatures.push(m.name)})),k.disabled&&nabu.utils.arrays.merge(c.availableFeatures,k.disabled.map(function(m){m.enabled=!1;return m})))});c.applicationState&&c.applicationState.forEach(function(k){k.name&&g.push(c.$services.swagger.execute(k.operation).then(function(m){Vue.set(c.variables,k.name,m)}))});c.$services.q.all(g).then(function(){Vue.nextTick(function(){c.loading=!1});c.canEdit()&&setTimeout(c.reloadCss,1E4);a()},function(k){var m="error";k.forEach(function(p){!p||
503!=p.status&&502!=p.status||(m="offline")});Vue.nextTick(function(p){c.loading=!1;setTimeout(function(){c.$services.router.route(m,null,null,"offline"==m)},1)});c.canEdit()&&setTimeout(c.reloadCss,1E4);a()})})},removeEditIcon:function(){var a=document.getElementById("page-edit-icon");a&&a.parentNode.removeChild(a)},injectEditIcon:function(){var a=document.createElement("div");a.setAttribute("id","page-edit-icon");a.setAttribute("class","is-column has-tooltip");a.setAttribute("style","position: fixed; bottom: 1rem; left: 1rem; z-index: 10000;");
var b=document.createElement("button");a.appendChild(b);b.setAttribute("style","padding: 0.7rem; border-radius: 50px; background-color: #fff; border: solid 1px #666; cursor: pointer");b.innerHTML="\x3cimg src\x3d'"+application.configuration.root+"resources/images/helper/edit.svg' style\x3d'width: 1rem' /\x3e";document.body.appendChild(a);var c=this,d=document.createElement("span");d.setAttribute("class","is-tooltip is-wrap-none");d.innerHTML="Show rendered pages \x3cspan class\x3d'shortkey is-badge'\x3e"+
(0<=navigator.platform.toLowerCase().indexOf("mac")?"CMD":"CTRL")+"+ALT+X\x3c/span\x3e";a.appendChild(d);var e=document.createElement("div");e.setAttribute("style","position: absolute; bottom: 100%; left: 0;");a.appendChild(e);var g=function(){a.removeChild(d);nabu.utils.elements.clear(e);var k=document.createElement("button");k.setAttribute("style","background-color: #333; color: #fff; white-space:nowrap; border: none; padding: 0.7rem; border: solid 1px #333; margin-bottom: 0.3rem; border-radius: 10px; cursor: pointer; display: flex;");
k.innerHTML="View all pages";e.appendChild(k);k.onclick=function(){c.$services.router.route("pages")};var m=[];Object.keys(nabu.page.instances).forEach(function(p){p=nabu.page.instances[p].page;!p.content.readOnly&&0>m.indexOf(p)&&m.push(p)});m.sort(function(p,q){return p.content.name.localeCompare(q.content.name)});m.forEach(function(p){var q=document.createElement("button");q.setAttribute("style","background-color: #fff; border: none; white-space: nowrap; padding: 0.7rem; border: solid 1px #666; margin-bottom: 0.3rem; border-radius: 10px; cursor: pointer; display: flex; column-gap: 0.7rem; align-items: center");
var t=document.createElement("span");t.innerHTML=p.content.label?p.content.label:p.content.name;q.appendChild(t);t=document.createElement("img");t.setAttribute("src",application.configuration.root+"resources/images/helper/search.svg");t.setAttribute("style","width: 0.7rem");t.setAttribute("title","Inspect state");q.appendChild(t);t.onclick=function(u){var w=[];Object.keys(nabu.page.instances).forEach(function(y){p==nabu.page.instances[y].page&&0>w.indexOf(nabu.page.instances[y])&&(w.push(nabu.page.instances[y]),
console.log("Page: "+p.content.name,nabu.page.instances[y].variables,nabu.page.instances[y]))});u.stopPropagation()};e.appendChild(q);q.onclick=function(u){var w=!1;Object.keys(nabu.page.instances).forEach(function(y){w||p!=nabu.page.instances[y].page||(w=!0,nabu.page.instances[y].goIntoEdit())})}})};b.onclick=function(k){e.firstChild?(a.appendChild(d),nabu.utils.elements.clear(e)):(g(),k.stopPropagation())};document.addEventListener("click",function(){e.firstChild&&(a.appendChild(d),nabu.utils.elements.clear(e))});
document.addEventListener("keydown",function(k){(k.ctrlKey||k.metaKey)&&k.altKey&&88==k.keyCode&&(c.canEdit()?e.firstChild?(a.appendChild(d),nabu.utils.elements.clear(e)):g():c.$services.router.route("login",null,null,!0))})},scanPagesForTemplates:function(){var a=this;this.pages.forEach(function(b){if(b.content.hasTemplates){var c=function(d){d.rows&&d.rows.forEach(function(e){if(e.isTemplate){if(e.templateStable){var g=a.templates.filter(function(k){return k.id==e.templateId})[0];g&&a.templates.splice(a.templates.indexOf(g),
1);a.templates.push({id:e.templateId,version:e.release,type:"row",templateVersion:e.templateVersion,category:e.templateCategory?e.templateCategory:b.content.name,name:e.templateTitle,description:e.templateDescription,icon:e.templateIcon?e.templateIcon:"align-justify",content:JSON.stringify({type:"page-row",content:e.templateStable})})}}else e.cells&&c(e)});d.cells&&d.cells.forEach(function(e){if(e.isTemplate){if(e.templateStable){var g=a.templates.filter(function(k){return k.id==e.templateId})[0];
g&&a.templates.splice(a.templates.indexOf(g),1);a.templates.push({id:e.templateId,version:e.release,type:"cell",templateVersion:e.templateVersion,category:e.templateCategory?e.templateCategory:b.content.name,name:e.templateTitle,description:e.templateDescription,icon:e.templateIcon?e.templateIcon:"align-justify",content:JSON.stringify({type:"page-cell",content:e.templateStable})})}}else e.rows&&c(e)})};c(b.content)}})},ensureDevices:function(){var a=this,b=function(c,d){var e=a.devices.filter(function(g){return g.name==
c})[0];null==e?a.devices.push({name:c,width:d}):null==e.width&&(e.width=d)};b("phone",null);b("tablet",null);b("desktop",null);b("wide",null)},getApplicationStateNames:function(a){var b=this.applicationState.filter(function(c){return!!c.name}).map(function(c){return c.name});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},reloadState:function(a){var b=this.applicationState.filter(function(d){return d.name==a})[0];if(b&&b.operation){var c=this;return this.$services.swagger.execute(b.operation).then(function(d){Vue.set(c.variables,
b.name,d)})}return this.$services.q.reject()},renumber:function(a,b,c){var d=!1;c||(c={},d=!0);var e=this;if(b.id){var g=b.id;b.id=a.content.counter++;c[g]=b.id}b.rows&&b.rows.map(function(m){e.renumber(a,m,c)});b.cells&&b.cells.map(function(m){e.renumber(a,m,c)});if(d){var k=function(m){if(m.renderer){var p=nabu.page.providers("page-renumberer").filter(function(q){return q.renderer==m.renderer})[0];p&&p.renumber(m,c)}m.alias&&(p=nabu.page.providers("page-renumberer").filter(function(q){return q.component==
m.alias})[0])&&p.renumber(m,c);m.cells&&m.cells.forEach(k);m.rows&&m.rows.forEach(k)};k(b,c);return b}return c},getGlobalEvents:function(){var a={};this.pages.map(function(b){b.content.globalEvents&&b.content.globalEvents.map(function(c){var d=c.globalName?c.globalName:c.localName;null!=d&&null==a[d]&&(c=c.properties,a[d]=null==c?{properties:{}}:c)})});return a},emit:function(a,b,c){var d=[];null!=c&&d.push(c);Object.keys(nabu.page.instances).map(function(e){e=nabu.page.instances[e];if(0>d.indexOf(e)){if(e.page.content.globalEventSubscriptions){var g=
e.page.content.globalEventSubscriptions.filter(function(k){return k.globalName==a})[0];g&&e.emit(null!=g.localName?g.localName:a,b)}d.push(e)}})},getCurrentInstance:function(a){for(var b=null;!b&&a;)a.page?b=a.page:a=a.$parent;return b?this.getPageInstance(b,a):null},getPageInstanceByName:function(a,b){var c=this.pages.filter(function(d){return d.content.name==a})[0];return c?this.getPageInstance(c,b):null},getParentInstance:function(a){for(var b=a;b&&b.$parent;)if(b=b.$parent,b.page&&b.page!=a.page)return this.getPageInstance(b.page,
b);return null},getParentPageInstance:function(a,b){a=this.getPageInstance(a,b);for(b=null;!b&&a&&a.$parent;)a=a.$parent,a.page&&(b=this.getPageInstance(a.page,a));return b},getDraggables:function(){var a={};Object.keys(nabu.page.instances).forEach(function(b){var c=nabu.page.instances[b].getDraggables();Object.keys(c).forEach(function(d){a[d]=c[d]})});return a},getDraggableKeys:function(a){return Object.keys(this.getDraggables(a)).filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},
getPageInstance:function(a,b){var c=null;if(b&&null!=b.pageInstanceId)c=nabu.page.instances[a.name+"."+b.pageInstanceId];else if(b&&b.$parent){for(var d=b.$parent;null!=d&&null==d.pageInstanceId;)d=d.$parent;d&&null!=d.pageInstanceId&&(c=nabu.page.instances[a.name+"."+d.pageInstanceId])}!c&&b&&b.$root&&null!=b.$root.pageInstanceId&&(c=nabu.page.instances[a.name+"."+b.$root.pageInstanceId]);return c?c:nabu.page.instances["string"==typeof a?a:a.name]},setPageInstance:function(a,b){nabu.page.instances[a.name]=
b;null!=b.pageInstanceId&&(nabu.page.instances[a.name+"."+b.pageInstanceId]=b)},destroyPageInstance:function(a,b){null!=b.pageInstanceId&&delete nabu.page.instances[a.name+"."+b.pageInstanceId];nabu.page.instances[a.name]==b&&delete nabu.page.instances[a.name]},destroy:function(a){a.page&&a.cell&&this.$services.page.getPageInstance(a.page,a).destroyComponent(a,a.cell)},reloadSwagger:function(){if(!this.disableReload)return this.$services.swagger.$clear()},reloadCss:function(){this.reloadSwagger();
var a=this;a.disableReload?setTimeout(a.reloadCss,5E3):nabu.utils.ajax({url:"/api/otr/page/css-modified"}).then(function(b){if(null!=b.responseText&&!a.disableReload)if(b=new Date(b.responseText),!a.cssLastModified)a.cssLastModified=b;else if(b.getTime()>a.cssLastModified.getTime()){for(var c=document.head.getElementsByTagName("link"),d=0;d<c.length;d++){var e=c[d].getAttribute("original");e||(e=c[d].href,c[d].setAttribute("original",e));c[d].setAttribute("href",e+"\x26loadTime\x3d"+b.getTime())}a.cssLastModified=
b}setTimeout(a.reloadCss,5E3)})},getFunctionDefinition:function(a){return this.listFunctionDefinitions().filter(function(b){return b.id==a})[0]},getRunnableFunction:function(a){for(var b=a.split("."),c=window,d=0;d<b.length-1;d++){if(!c[b[d]]){c=null;break}c=c[b[d]]}b=null==c?null:c[b[b.length-1]];!b&&(c=nabu.page.providers("page-function").filter(function(e){return e.id==a})[0])&&(b=c.implementation);return b},runFunction:function(a,b,c,d){var e=null;if("string"==typeof a){e=this.getFunctionDefinition(a);
var g=a;a=this.getRunnableFunction(g);if(!a)throw"Could not find function: "+g;}g=function(p){d&&d.resolve(p)};var k=function(p){p.responseText&&(p=JSON.parse(p.responseText));d&&d.reject(p)};try{var m=a(b,this.$services,c&&c.$value?c.$value:function(){},g,k);e&&!e.async&&g(m);return null==m?d:m}catch(p){throw k(p),p;}},getBindingValue:function(a,b,c,d){var e=this;if(b&&b.label){if("fixed"==b.label)return b.value;if("$function"==b.label){var g=this.getRunnableFunction(b.value);if(!g)throw"Could not find function: "+
b.value;if(b.lambda)return function(){var u=e.getFunctionDefinition(b.value),w={};b.bindings&&Object.keys(b.bindings).forEach(function(C){if(b.bindings[C]){var A=e.getBindingValue(a,b.bindings[C],c);e.setValue(w,C,A)}});if(u.inputs){var y=arguments,B=0;u.inputs.forEach(function(C,A){b.bindings[C.name]||(w[C.name]=y[B++])})}if(u.async){var F=u=e.$services.q.defer();b.output&&(F=e.$services.q.defer(),u.then(function(C){F.resolve(C?C[b.output]:C)},u));e.runFunction(g,w,c,u);return F}u=e.runFunction(g,
w,c);b.output&&(u=u[b.output]);return u};var k={};e=this;b.bindings&&Object.keys(b.bindings).forEach(function(u){if(b.bindings[u]){var w=e.getBindingValue(a,b.bindings[u],c);e.setValue(k,u,w)}});var m=this.runFunction(g,k,c);return b.output?this.getValue(m,b.output):m}}if(null==b)return null;var p=this.enumerators;m=0==b.indexOf("fixed")?this.translate(b.substring(6)):d?d(b):a?a.get(b):null;0==b.indexOf("fixed.\x3d")&&(m=this.interpret(m,a,null,d));var q=b.split(".")[0];if(!m&&p[q]){var t=b.substring(q.length+
1);d=p[q].enumerate().filter(function(u){return p[q].label?u[p[q].label]==t:u==t})[0];null!=d&&"undefined"!=typeof d&&(m=p[q].value?d[p[q].value]:d)}if(null==m&&null!=c)for(;c;){if(c.getCellValue&&(d=c.getCellValue(b),null!=d)){m=d;break}c=c.$parent}null==m&&a&&a.fragmentParent&&(m=this.getBindingValue(a.fragmentParent,b,c));return m},translateErrorCode:function(a,b){if(this.$services.translator&&this.$services.translator.translate)return this.$services.translator.translate("%{"+a+"}",b?b:this.$services.translator.translate("%{An error has occurred while trying to complete your action}"));
var c=a?this.translations.filter(function(e){if(e.translation==e.name)return!1;if(a.toLowerCase()==e.name.toLowerCase())return!0;try{return a.match(new RegExp(e.name.replace(/\*/g,".*")))}catch(g){}return!1}):[],d=null;1<c.length?c.forEach(function(e){if(null==d||d.name.length<e.name.length)d=e}):1==c.length&&(d=c[0]);return d&&d.translation?d.translation:b?b:"An error has occurred while trying to complete your action"},translate:function(a,b){if(this.showRawTranslations)return a;if(this.$services.translator&&
this.$services.translator.translate)return this.$services.translator.translate(a);if(a&&a.indexOf)for(;0<=a.indexOf("%{");){b=a.indexOf("%{");for(var c=1,d=-1,e=b+2;e<a.length;e++)if("{"==a.charAt(e))c++;else if("}"==a.charAt(e)&&(c--,0==c)){d=e;break}if(0>d)break;var g=a.substring(b+2,d).split("::");c=this.translations.filter(function(k){return(1==g.length&&null==k.context||2==g.length&&k.context==g[0])&&k.name==(1==g.length?g[0]:g[1])})[0];a=a.substring(0,b)+(c&&c.translation?c.translation:1==g.length?
g[0]:g[1])+a.substring(d+1)}return a},interpret:function(a,b,c,d){if("string"==typeof a&&0<a.length&&"\x3d"==a.substring(0,1)){a=a.substring(1);var e=null;if(c)e=this.eval(a,c,b,d);else if(b){for(var g=b;!g.localState&&g.$parent;)g=g.$parent;g&&g.localState&&(e=this.eval(a,g.localState,b,d));null==e&&g&&g.state&&(e=this.eval(a,g.state,b,d));null==e&&b.page&&(e=this.getPageInstance(b.page,b),e=this.eval(a,e.variables,b,d))}else e=this.eval(a,{},b,d);a=e}if("string"==typeof a)for(var k=!0;k;){k=!1;
var m=a.indexOf("{{");if(0<=m){var p=a.indexOf("}}",m);if(p>=m){k=a.substring(m+2,p);e=null;if(c)e=this.eval(k,c,b,d);else if(b){for(g=b;!g.localState&&g.$parent;)g=g.$parent;g&&g.localState&&(e=this.eval(k,g.localState,b,d));null==e&&g&&g.state&&(e=this.eval(k,g.state,b,d));null==e&&b.page&&(e=this.getPageInstance(b.page,b),e=this.getBindingValue(e,k))}else if(0==k.trim().indexOf("application.")){var q=k.trim().substring(12);e=(q=this.properties.filter(function(t){return t.key==q})[0])?q.value:null}a=
a.substring(0,m)+(null==e?"":e)+a.substring(p+2);k=!0}}}return a},getValue:function(a,b){if(b){if(a&&a.hasOwnProperty(b))return a[b];b=b.split(".");var c=a;b.forEach(function(d){c&&"$all"!=d&&(c=c[d])});return c}return null},setValue:function(a,b,c){b=b.split(".");for(var d=0;d<b.length-1;d++)if("$all"!=b[d]){if(!a[b[d]]){if(null==c)return;Vue.set(a,b[d],{})}a=a[b[d]]}Vue.set(a,b[b.length-1],c)},getInputBindings:function(a){var b=this,c={};"string"==typeof a&&(a=this.$services.swagger.operations[a]);
a&&a.parameters&&(b=this,a.parameters.map(function(d){if("body"==d.in){var e=b.$services.swagger.resolve(d);e.schema.properties&&Object.keys(e.schema.properties).map(function(g){"object"!=e.schema.properties[g].type&&(c["body."+g]=null);"object"!=e.schema.properties[g].type&&"array"!=e.schema.properties[g].type||Object.keys("array"==e.schema.properties[g].type?e.schema.properties[g].items.properties:e.schema.properties[g].properties).map(function(k){c["body."+g+"."+k]=null})})}else c[d.name]=null}));
return c},filterOperations:function(a,b){return this.getOperations(b).filter(function(c){return!a||0<=c.id.toLowerCase().indexOf(a.toLowerCase())})},getOperations:function(a){var b=[],c=this.$services.swagger.operations;Object.keys(c).map(function(d){(null==a||a instanceof Function&&a(c[d])||a.toLowerCase&&0<=d.toLowerCase().indexOf(a.toLowerCase()))&&b.push(c[d])});b.sort(function(d,e){return d.id.localeCompare(e.id)});return b},getTriggerOperations:function(a){return this.getOperations(function(b){return b&&
(!b.produces||!b.produces.length||0>b.produces.indexOf("application/octet-stream"))&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},getModifyOperations:function(a){return this.getOperations(function(b){return b&&"get"!=b.method&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},getBinaryOperations:function(a){return this.getOperations(function(b){return b&&"get"==b.method&&b.produces&&b.produces.length&&"application/octet-stream"==b.produces[0]&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},
getDownloadOperations:function(a){return this.getOperations(function(b){var c=b&&"true"==b["x-downloadable"];return(b&&"get"==b.method&&b.produces&&b.produces.length&&"application/octet-stream"==b.produces[0]||c)&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},getUploadOperations:function(a){return this.getOperations(function(b){return b&&"get"!=b.method&&b.consumes&&b.consumes.length&&"application/octet-stream"==b.consumes[0]&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},getStateOperations:function(a){var b=
this;return Object.keys(this.$services.swagger.operations).filter(function(c){if(a&&0>c.toLowerCase().indexOf(a.toLowerCase()))return!1;c=b.$services.swagger.operations[c];return"get"==c.method.toLowerCase()&&(!name||0<=c.id.toLowerCase().indexOf(name.toLowerCase()))&&c.responses["200"]})},getArrayOperations:function(a){var b=this;return this.getOperations(function(c){var d="get"==c.method.toLowerCase()&&(!name||0<=c.id.toLowerCase().indexOf(name.toLowerCase()))&&c.responses["200"];d&&null!=c.responses["200"]&&
null!=c.responses["200"].schema&&(d=c.responses["200"].schema,d.$ref?(d=b.$services.swagger.resolve(d.$ref),d=0<b.$services.page.getArrays(d).length):d=!1);d&&a&&(d=0<=c.id.toLowerCase().indexOf(a.toLowerCase()));return d})},getPageVariables:function(a,b){a=this.getSimpleKeysFor({properties:this.getAllAvailableParameters(a,null,!0)});b&&(a=a.filter(function(c){return 0<=c.toLowerCase().indexOf(b.toLowerCase())}));return a},getSimpleClasses:function(a){var b="primary secondary info success warning danger inline".split(" ");
a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));0>b.indexOf(a)&&b.push(a);return b},getDynamicVariables:function(a,b,c){if(!a)return[];var d=this;return a.filter(function(e){return!e.condition||d.isCondition(e.condition,b,c)}).map(function(e){return{name:e.name,value:d.$services.page.interpret(e.rule,c,b)}})},getDynamicClasses:function(a,b,c){if(!a)return[];var d=this;return a.filter(function(e){return d.isCondition(e.condition,b,c)}).map(function(e){return d.$services.page.interpret(e.class,
c,b)})},getRestrictedParameters:function(){return"page cell edit component parameters localState".split(" ")},getPageParameterValues:function(a,b){var c=b.variables?nabu.utils.objects.clone(b.variables):{};if(b.parameters){var d=this.getRestrictedParameters();Object.keys(b.parameters).filter(function(e){return 0>d.indexOf(e)}).forEach(function(e){null==b.parameters[e]||c.hasOwnProperty(e)||(c[e]=b.parameters[e])})}return c},isCondition:function(a,b,c,d,e){if(!a)return!0;try{var g=this.eval(a,b,c,
d);if(g&&g.then){var k=c.conditionId;k||(c.conditionId=crypto.randomUUID());var m=k+"::"+a;this.conditionalResults.hasOwnProperty(m)||Vue.set(this.conditionalResults,m,null==e?!1:e);var p=this;g.then(function(q){q=null==q||!!q;q!==p.conditionalResults[m]&&Vue.set(p.conditionalResults,m,q)});return this.conditionalResults[m]}return!!g}catch(q){return console.error("Could not evaluate condition",a,q),!1}},getSchemaFromObject:function(a,b){var c=this;null==b&&(b={});if("string"===typeof a||a instanceof
String)b.type="string";else if(a instanceof Date)b.type="string",b.format="date-time";else if("number"===typeof a||a instanceof Number)b.type="int64";else if("boolean"===typeof a||a instanceof Boolean)b.type="boolean";else if(a instanceof Array){var d={};a.forEach(function(e){c.getSchemaFromObject(e,d)});b.type="array";b.items=d}else b.type="object",b.properties={},null!=a&&Object.keys(a).forEach(function(e){b.properties[e]=c.getSchemaFromObject(a[e])});return b},getPageState:function(a){var b={};
a.localState&&Object.keys(a.localState).map(function(d){b[d]=a.localState[d]});Object.keys(a.variables).map(function(d){"undefined"==typeof b[d]&&(b[d]=a.variables[d])});var c=a.parameters?nabu.utils.objects.clone(a.parameters):{};Object.keys(c).forEach(function(d){var e={};null!=c[d]&&(e[d]=c[d]);b.page=e});return b},hasFeature:function(a,b){leading||(b="@");a=a.replace(b+"{","");a=a.replace("}","");return 0<=this.enabledFeatures.indexOf(a)},evalInContext:function(a,b){b.match(/^[\s]*function\b.*/)||
b.match(/^[\s]*return[\s]+.*/)||(b="return "+b);try{var c=(new Function("with(this) { "+b+" }")).call(a)}catch(d){}return c},eval:function(a,b,c,d,e){if(!a)return null;var g=a?"@":"@@";0<=a.indexOf(g)&&(this.enabledFeatures.forEach(function(p){a=a.replace(g+"{"+p+"}","true")}),a=a.replace(/@\{[^}]+\}/gm,"false"));if(this.useEval){try{var k=eval(a)}catch(p){return console.warn("Could not evaluate",a,p),!1}k instanceof Function&&(k=k(b))}else try{var m=Function('"use strict";return (function(state, $services, $value, $is, application, value) { return '+
a+" })")();m=m.bind(this);k=m(b,this.$services,d?d:c?c.$value:function(){throw"No value function";},c?c.$is:function(){"No is function"},application,b&&b.value?b.value:b);k instanceof Function&&(k=k.bind(this),e||(k=k(b)))}catch(p){return console.error("Could not evaluate",a,p),null}return k},classes:function(a,b){for(var c=[],d=document.styleSheets,e=0;e<d.length;e++)try{for(var g=d.item(e).rules||d.item(e).cssRules,k=0;k<g.length;k++){var m=g.item(k);if(m.selectorText&&m.selectorText.match(new RegExp(".*\\."+
a+"\\.([\\w-]+)\\b.*","g"))){var p=m.selectorText.replace(new RegExp(".*\\."+a+"\\.([\\w-]+)\\b.*","g"),"$1");0>c.indexOf(p)&&c.push(p)}}}catch(q){}b&&(c=c.filter(function(q){return 0<=q.toLowerCase().indexOf(b.toLowerCase())}),0>c.indexOf(b)&&c.push(b));return c},getSimpleKeysFor:function(a,b,c,d,e){var g=this,k=!1;d||(d=[],k=!0);a&&a.properties&&Object.keys(a.properties).map(function(m){if(a.properties[m]&&("array"!=a.properties[m].type||c||a.properties[m].items&&!a.properties[m].items.properties)){var p=
(e?e+".":"")+m,q="array"==a.properties[m].type,t=!!a.properties[m].properties;!t&&a.properties[m].items&&(t=!!a.properties[m].items.properties);!b&&t||d.push(p);t&&(q?g.getSimpleKeysFor(a.properties[m].items.properties?a.properties[m].items:{properties:a.properties[m].items},b,c,d,p):g.getSimpleKeysFor(a.properties[m],b,c,d,p))}});k&&d.sort();return d},saveConfiguration:function(){return this.$services.swagger.execute("nabu.web.page.core.v2.rest.configuration.update",{body:{title:this.title,theme:this.theme,
home:this.home,homeUser:this.homeUser,users:this.users,properties:this.properties,environmentProperties:this.environmentProperties,devices:this.devices,imports:this.imports,state:this.applicationState,googleSiteVerification:this.googleSiteVerification,geoRefusalTimeout:this.geoRefusalTimeout,defaultLocale:this.defaultLocale,branding:this.branding}})},listFunctionDefinitions:function(){var a=[];nabu.utils.arrays.merge(a,this.functions);nabu.utils.arrays.merge(a,nabu.page.providers("page-function"));
return a},listFunctions:function(a){return this.listFunctionDefinitions().map(function(b){return b.id}).filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},getFunctionInput:function(a,b){(b=this.$services.page.functions.filter(function(e){return e.id==a})[0])||(b=nabu.page.providers("page-function").filter(function(e){return e.id==a})[0]);var c={},d=this;b&&b.inputs&&b.inputs.map(function(e){c[e.name]=d.$services.page.getResolvedPageParameterType(e.type,null,e.isArray);!c[e.name].required&&
e.required&&(c[e.name].required=e.required)});return{properties:c}},hasFunctionOutput:function(a){a=this.getFunctionOutputFull(a);return 0<Object.keys(a.properties).length},getFunctionOutputFull:function(a,b){(b=this.$services.page.functions.filter(function(e){return e.id==a})[0])||(b=nabu.page.providers("page-function").filter(function(e){return e.id==a})[0]);var c={},d=this;b&&b.outputs&&b.outputs.map(function(e){c[e.name]=d.$services.page.getResolvedPageParameterType(e.type,null,e.isArray)});return{properties:c}},
getFunctionOutput:function(a,b){return this.$services.page.getSimpleKeysFor(this.getFunctionOutputFull(a,b),!0,!0)},inject:function(a,b,c,d){if(document.head.querySelector('script[src\x3d"'+a+'"]'))b&&b();else{var e=document.createElement("script");e.setAttribute("src",a);e.setAttribute("type","text/javascript");d&&e.setAttribute("async","true");b&&(e.readyState?e.onreadystatechange=function(){if("loaded"==e.readyState||"complete"==e.readyState)e.onreadystatechange=null,b()}:e.attachEvent?(e.attachEvent("onload",
function(){b()}),c&&e.attachEvent("onerror",function(){c()})):e.addEventListener?(e.addEventListener("load",function(){b()}),c&&e.addEventListener("error",function(){c()})):e.onload=function(){b()});document.head.appendChild(e)}},canEdit:function(){return!this.isServerRendering&&this.editable},canTest:function(){return this.canEdit()||!this.isServerRendering&&this.testable},pathParameters:function(a){return a?(a=a.match(/\{[\s]*[^}:]+[\s]*(:[\s]*([^}]+)[\s]*|)\}/g))?a.map(function(b){return b.substring(1,
b.length-1).replace(/:.*$/,"")}):[]:[]},alias:function(a){return a.name},rename:function(a,b){var c=this.dashify(b);if(c!=a.name){c=this.uniquifyPageName(c);var d=a.name;a.name=c;a.content.label=b;var e=this;return this.update(a).then(function(){e.removeByName(d)})}if(c==a.name&&b!=a.content.label)return a.content.label=b,this.update(a)},remove:function(a){var b=this;this.removeByName(a.name).then(function(){b.pages.splice(b.pages.indexOf(a),1)})},removeByName:function(a){return this.$services.swagger.execute("nabu.web.page.core.v2.rest.page.delete",
{name:a})},uniquifyPageName:function(a){for(var b=this.pages.map(function(d){return d.name}),c=a;0<=b.indexOf(c);)c=a+1;return c},create:function(a,b){var c=this.uniquifyPageName(this.dashify(a)),d=this.normalize({label:a});b&&(d.category=b);d.path="/"+this.dashify(a);return this.update({name:c,content:d})},update:function(a){var b=this;a.content||(a.content=b.normalize({}));a.content.name=a.name;a.marshalled=JSON.stringify(a.content);return this.$services.swagger.execute("nabu.web.page.core.v2.rest.page.update",
{body:a}).then(function(){var c=b.pages.indexOf(a);0<=c?b.pages.splice(c,1,a):b.pages.push(a)})},findMain:function(a){if(a.rows&&a.rows.length)for(var b=0;b<a.rows.length;b++){if("main"==a.rows[b].customId)return a.rows[b];if(a.rows[b].cells&&a.rows[b].cells.length)for(var c=0;c<a.rows[b].cells.length;c++){var d=a.rows[b].cells[c];if("main"==d.customId||d.rows&&(d=this.findMain(d)))return d}}return null},filterRoutes:function(a){if(null!=a&&"\x3d"==a.substring(0,1))return[a];var b=this.$services.router.list().filter(function(c){return c.alias&&
(!a||0<=c.alias.toLowerCase().indexOf(a.toLowerCase()))});b.sort(function(c,d){return c.alias.localeCompare(d.alias)});return b.map(function(c){return c.alias})},loadFormatters:function(a){a instanceof Array||(a=[a]);var b=this;a.forEach(function(c){c.content.formatters&&c.content.formatters.length&&c.content.formatters.forEach(function(d){d.name&&d.script&&nabu.page.provide("page-format",{format:function(e,g,k,m,p,q){g=q?q.$value:null;g||(g=(k=b.getPageInstance(k))?k.$value:function(t){return null});
k=(new Function("with(this) { return "+d.script+" }")).call({value:e,$value:g,state:{value:e},$services:b.$services});k instanceof Function&&(k=k.bind(this),k=k(e));return k},skipCompile:!0,html:!0,name:d.name,namespace:"nabu.page.custom"})})})},loadPages:function(a){var b=this;a.map(function(c){c.content||Vue.set(c,"content",b.normalize(c.marshalled?JSON.parse(c.marshalled):{}));var d={};c.content.parameters&&c.content.parameters.filter(function(k){return!k.private}).forEach(function(k){d[k.name]=
b.getResolvedPageParameterType(k.type,null,k.isArray);d[k.name].properties&&(d[k.name].properties={})});var e=c.content.path;e&&0!=e.indexOf("/")&&(e="/"+e);e&&=b.translate(e);var g={alias:b.alias(c),url:c.content.initial?"/.*":e,query:c.content.query?c.content.query:[],name:c.content.label?c.content.label:c.content.name,category:c.content.category,parameters:d,enter:function(k,m){var p=c.content.serviceContext;p&&0==p.indexOf("page.")&&(p=p.substring(5),e&&0<=e.indexOf("{"+p+"}")&&(k[p]||(k[p]="default")));
c.content.initial?b.findMain(c.content)||c.content.rows.push({id:0,customId:"main",cells:[],class:null}):c.content.path&&setTimeout(function(){b.$services.analysis.push({event:"browse",category:"page",component:c.content.name,path:c.content.path,data:k})},1);return new nabu.page.views.Page({propsData:{page:c,parameters:k,stopRerender:k?k.stopRerender:!1,pageInstanceId:b.pageCounter++,masked:m}})},isPage:!0,initial:c.content.initial,roles:null!=c.content.roles&&0<c.content.roles.length?c.content.roles:
null,slow:!c.content.initial&&c.content.slow,parent:c.content.pageParent,defaultAnchor:c.content.defaultAnchor,properties:c.content.properties?c.content.properties:[]};b.$services.router.unregister(b.alias(c));b.$services.router.register(g)})},normalize:function(a){a.rows||(a.rows=[]);a.path||(a.path=null);a.counter||(a.counter=1);a.variables||(a.variables=[]);a.query||(a.query=[]);a.actions||(a.actions=[]);a.class||(a.class=null);a.initial||(a.initial=!1);a.menuX||(a.menuX=0);a.menuY||(a.menuY=0);
a.states||(a.states=[]);a.category||(a.category=null);a.slow||(a.slow=!1);return a},getParentRoutes:function(a,b){var c=this.$services.router.list().filter(function(d){return!!d.alias&&!!d.defaultAnchor}).map(function(d){return d.alias});a&&(c=c.filter(function(d){return 0<=d.toLowerCase().indexOf(a.toLowerCase())}));b&&(c=c.filter(function(d){return 0>b.indexOf(d)}));c.sort();return c},prettifyRouteAlias:function(a){var b=this.$services.router.list(),c=b.filter(function(d){return d.alias==a})[0];
return c&&c.name?2<=b.filter(function(d){return d.name==c.name}).length?c.name+(c.category?" ("+c.category+")":""):c.name:a},getNamedRoutes:function(a){var b=this.$services.router.list().filter(function(c){return!!c.alias&&!!c.name&&(!a||0<=c.name.toLowerCase().indexOf(a.toLowerCase()))});b.sort(function(c,d){return c.name.localeCompare(d.name)});return b},getPageRoutes:function(a){if(a&&0==a.indexOf("\x3d"))return[{alias:a,name:"Calculated route"}];var b=this.$services.router.list().filter(function(c){return c.isPage});
b.sort(function(c,d){return c.name.localeCompare(d.name)});a&&(b=b.filter(function(c){return 0<=c.name.toLowerCase().indexOf(a.toLowerCase())||c.label&&0<=c.label.toLowerCase().indexOf(a.toLowerCase())}));return b},getEmbeddableRoutes:function(a){return this.getRoutes(a,!0)},getRoutes:function(a,b){var c=this.$services.router.list().filter(function(d){return!!d.alias});b&&(c=c.filter(function(d){return!d.isPage||!d.parent}));c=c.map(function(d){return d.alias});a&&(c=c.filter(function(d){return 0<=
d.toLowerCase().indexOf(a.toLowerCase())}));c.sort();return c},getRouteParameters:function(a){var b={properties:{}};if(!a)return b;if(a.parent){var c=this.$services.router.get(a.parent);c&&(c=this.getRouteParameters(c))&&c.properties&&nabu.utils.objects.merge(b.properties,c.properties)}a.url&&this.pathParameters(a.url).map(function(d){b.properties[d]={type:"string"}});a.query&&a.query.map(function(d){b.properties[d]="string"==typeof d?{type:"string"}:d});a.parameters&&nabu.utils.objects.merge(b.properties,
a.parameters);return b},getArrays:function(a,b,c){c||=[];if(a&&a.properties)for(var d=Object.keys(a.properties),e=0;e<d.length;e++){var g=a.properties[d[e]];if(null!=g){var k=(b?b+".":"")+d[e];"array"==g.type?c.push(k):g.properties&&this.getArrays(g,k,c)}}else a&&"array"==a.type&&c.push(b);return c},getAllAvailableParameters:function(a,b){var c={},d=this;b||=d;var e=d.$services.page.getPageInstance(a,b),g=this.getProvidedParameters();Object.keys(g.properties).map(function(q){c[q]=g.properties[q]});
var k=this.getApplicationParameters();Object.keys(k.properties).length&&(c.application=k);a.content.pageParent?(b=this.pages.filter(function(q){return q.content.name==a.content.pageParent})[0],null!=b&&(c.parent={properties:this.getAllAvailableParameters(b)})):(b=d.$services.page.getParentPageInstance(a,b))&&b.page&&(c.parent={properties:this.getAllAvailableParameters(b.page)});this.normalizeParentScope(c);c.page=this.getPageParameters(a,!0);a.content.states.map(function(q){var t=null;(t=q.inherited?
d.applicationState.filter(function(u){return u.name==q.applicationName}).map(function(u){return u.operation})[0]:q.operation)&&d.$services.swagger.operation(t)&&d.$services.swagger.operation(t).responses&&d.$services.swagger.operation(t).responses["200"]&&(c[q.name]=d.$services.swagger.resolve(d.$services.swagger.operation(t).responses["200"]).schema)});a.content.computed&&a.content.computed.map(function(q){if(q.name&&q.bindings&&q.bindings[q.name]&&"$function"==q.bindings[q.name].label){var t=d.getFunctionOutputFull(q.bindings[q.name].value);
q.bindings&&q.bindings[q.name].output&&(t=t.properties[q.bindings[q.name].output]);c[q.name]=t}});var m=e.getEvents();Object.keys(m).map(function(q){c[q]=m[q]});nabu.page.providers("page-enumerate").forEach(function(q){if(q.enumerate&&q.label){var t={},u=q.enumerate();u&&(u.forEach(function(w){t[w[q.label]]={type:"string"}}),c[q.name]={properties:t})}});var p=function(q){q.forEach(function(t){t.cells&&t.cells.forEach(function(u){u.alias&&u.contentRuntimeAlias&&(c[u.contentRuntimeAlias]=d.getRouteParameters(d.$services.router.get(u.alias)));
u.rows&&u.rows.length&&p(u.rows)})})};a.content.rows&&p(a.content.rows);this.enrichWithRuntimeAliasDefinitions(c,e);return c},enrichWithRuntimeAliasDefinitions:function(a,b){Object.keys(b.components).forEach(function(d){if(0==d.indexOf("alias_")){var e=d.substring(6);d=b.components[d];d.getState&&(d=d.getState())&&(a[e]=d)}});var c=this;this.getAvailableRenderers(b.page).forEach(function(d){if(d.runtimeAlias){var e=c.getRendererState(d.renderer,d,b.page,a);e&&(a[d.runtimeAlias]=e)}})},getAvailableRenderers:function(a){var b=
[],c=function(d){d.forEach(function(e){e.renderer&&b.push(e);e.cells&&e.cells.forEach(function(g){g.renderer&&b.push(g);g.rows&&c(g.rows)})})};a&&a.content&&a.content.rows&&c(a.content.rows);return b},getAllAvailableKeys:function(a,b,c){var d=[],e=this,g=this.getAllAvailableParameters(a);Object.keys(g).map(function(k){b&&"page"!=k&&d.push(k);nabu.utils.arrays.merge(d,e.getSimpleKeysFor(g[k],b,b).filter(function(m){return null!=m}).map(function(m){return k+"."+m}))});c&&(d=d.filter(function(k){return k&&
0<=k.toLowerCase().indexOf(c.toLowerCase())}));return d},getAvailableKeys:function(a,b,c){var d=[],e=this,g=this.getAvailableParameters(a,b,c);Object.keys(g).map(function(k){nabu.utils.arrays.merge(d,e.getSimpleKeysFor(g[k]).map(function(m){return k+"."+m}))});return d},getAvailableParameters:function(a,b,c){var d={},e=this,g=e.$services.page.getPageInstance(a,e),k=g.getEvents();c&&Object.keys(k).map(function(t){d[t]=k[t]});var m=this.getProvidedParameters();Object.keys(m.properties).map(function(t){d[t]=
m.properties[t]});var p=this.getApplicationParameters();Object.keys(p.properties).length&&(d.application=p);a.content.pageParent?(p=this.pages.filter(function(t){return t.content.name==a.content.pageParent})[0],null!=p&&(d.parent={properties:this.getAvailableParameters(p,null,c)})):(p=e.$services.page.getParentPageInstance(a,e))&&p.page&&(p==g.$props.fragmentParent?nabu.utils.objects.merge(d,this.getAvailableParameters(p.page,null,c)):d.parent={properties:this.getAvailableParameters(p.page,null,c)});
this.normalizeParentScope(d);d.page=this.getPageParameters(a);a.content.states.map(function(t){var u=null;(u=t.inherited?e.applicationState.filter(function(w){return w.name==t.applicationName}).map(function(w){return w.operation})[0]:t.operation)&&(u=e.$services.swagger.operation(u))&&u.responses&&u.responses["200"]&&(d[t.name]=e.$services.swagger.resolve(u.responses["200"]).schema)});a.content.computed&&a.content.computed.map(function(t){if(t.name&&t.bindings&&t.bindings[t.name]&&"$function"==t.bindings[t.name].label){var u=
e.getFunctionOutputFull(t.bindings[t.name].value);t.bindings&&t.bindings[t.name].output&&(u=u.properties[t.bindings[t.name].output]);d[t.name]=u}});var q=function(t){t.forEach(function(u){u.cells&&u.cells.forEach(function(w){w.alias&&w.contentRuntimeAlias&&(d[w.contentRuntimeAlias]=e.getRouteParameters(e.$services.router.get(w.alias)));w.rows&&w.rows.length&&q(w.rows)})})};a.content.rows&&q(a.content.rows);this.enrichWithRuntimeAliasDefinitions(d,g);b&&(b=this.getTargetPath(a.content,b.id))&&b.length&&
b.map(function(t){t.on&&(d[t.on]=k[t.on]);t.instances&&Object.keys(t.instances).map(function(u){var w=t.instances[u];if(w){var y=w.substring(0,w.indexOf("."));w=w.substring(w.indexOf(".")+1);d[y]&&(d[u]=e.getChildDefinition(d[y],w).items)}});t.cellState&&Object.keys(t.cellState).map(function(u){d[u]=t.cellState[u]})});return d},getTarget:function(a,b,c){if(a.rows)for(var d=0;d<a.rows.length;d++){if(a.rows[d].id==b)return c?a:a.rows[d];if(a.rows[d].cells)for(var e=0;e<a.rows[d].cells.length;e++){if(a.rows[d].cells[e].id==
b)return c?a.rows[d]:a.rows[d].cells[e];var g=this.getTarget(a.rows[d].cells[e],b,c);if(g)return g}}return null},suggestField:function(a,b){var c=[];a=this.getAvailableParameters(a,null,!0);nabu.utils.arrays.merge(c,this.getSimpleKeysFor({properties:a},!0,!0));c.sort();b&&(c=c.filter(function(d){return 0<=d.toLowerCase().indexOf(b.toLowerCase())}));return c},suggestArray:function(a,b){return this.getAllArrays(a).filter(function(c){return!b||0<=c.toLowerCase().indexOf(b.toLowerCase())})},getAllArrays:function(a,
b){var c=this,d=[],e=this.getAvailableParameters(a,null,!0);Object.keys(e).map(function(g){nabu.utils.arrays.merge(d,c.getArrays(e[g]).map(function(k){return null==k?g:g+"."+k}))});return d},getChildDefinition:function(a,b,c,d){c||(c=b.split("."),d=0);return(a=null==a?null:"array"==a.type?a.items.properties:a.properties)?(a=a[c[d]],d==c.length-1?a:this.getChildDefinition(a,b,c,d+1)):null},cloneByReference:function(a){var b=this;if(a instanceof Array){var c=[];a.forEach(function(d){c.push(b.cloneByReference(d))})}else b.isObject(a)?
(c={},Object.keys(a).forEach(function(d){c[d]=b.cloneByReference(a[d])})):c=a;return c},smartClone:function(a){if(null==a)return null;var b=this,c=JSON.parse(JSON.stringify(a)),d=function(e,g){if(e instanceof Blob||e instanceof File)return e;if(e instanceof Date)return new Date(e.getTime());e instanceof Array?e.forEach(function(k,m){g[m]=d(k,g[m])}):b.isObject(e)&&Object.keys(e).forEach(function(k){g[k]=d(e[k],g[k])});return g};return d(a,c)},explode:function(a,b,c){var d=this;Object.keys(b).forEach(function(e){if(null!=
e){var g=b[e];if(null!=g){var k=c?c+"."+e:e;!d.isObject(g)||g instanceof Array?null!=c&&Vue.set(a,k,b[e]):g._isVue||d.explode(a,g,k)}}})},isObject:function(a){return null!=a&&Object(a)===a&&!(a instanceof Date)&&!(a instanceof File)&&!(a instanceof Blob)},isPublicPageParameter:function(a,b){return a&&a.content&&a.content.path&&0<=this.pathParameters(a.content.path).indexOf(b)||a&&a.content&&a.content.query&&0<=a.content.query.indexOf(b)?!0:!1},filterPageStartupParameters:function(a,b){a=this.getPageStartupParameters(a);
a=this.getSimpleKeysFor({properties:a},!0);return b?a.filter(function(c){return 0<=c.toLowerCase().indexOf(b.toLowerCase())}):a},getPageStartupParameters:function(a){var b={page:this.getPageParameters(a,!0)};if(a.content.pageParent){var c=this.pages.filter(function(d){return d.content.name==a.content.pageParent})[0];null!=c&&(b.parent=this.getPageParameters(c))}else(c=this.$services.page.getParentPageInstance(a))&&c.page&&(b.parent=this.getPageParameters(c.page));return b},normalizeParentScope:function(a){if(a&&
a.parent&&a.parent.properties&&a.parent.properties.parent){var b=a.parent.properties.parent;delete a.parent.properties.parent;var c={};nabu.utils.objects.merge(c,b);nabu.utils.objects.merge(c,a.parent);a.parent=c}},getPageParameters:function(a,b,c){var d={properties:{}};a.content.path&&this.pathParameters(a.content.path).map(function(k){d.properties[k]={type:"string"}});a.content.query&&a.content.query.map(function(k){d.properties[k]={type:"string"}});var e=this;a.content.states&&a.content.states.forEach(function(k){var m=
null;m=k.inherited?e.applicationState.filter(function(p){return p.name==k.applicationName}).map(function(p){return p.operation})[0]:k.operation;k.name&&m&&(m=e.$services.swagger.operation(m))&&m.responses&&m.responses["200"]&&(m=m.responses["200"].schema)&&m.$ref&&(m=e.getResolvedPageParameterType(m.$ref,null,k.isArray))&&(d.properties[k.name]=m)});var g=this.getPageInstance(a);a.content.parameters&&(e=this,a.content.parameters.filter(function(k){return!c||!k.private}).forEach(function(k){var m=k.template?
e.eval(k.template):g?g.get(k.name):null;d.properties[k.name]=k.useDefinition&&k.definition?JSON.parse(k.definition):e.getResolvedPageParameterType(k.type,m,k.isArray)}));g&&!b&&this.enrichWithRuntimeAliasDefinitions(d.properties,g);return d},getTranslatableParameters:function(a,b){null==b&&(b=[]);var c=this;a.$translations&&a.$translations.forEach(function(d){a[d]&&b.push({key:d,value:a[d]})});Object.keys(a).forEach(function(d){"$translations"!=d&&(!a.$translations||0>a.$translations.indexOf(d))&&
("object"==typeof a[d]?c.getTranslatableParameters(a[d],b):a[d]instanceof Array&&a[d].forEach(function(e){"object"==typeof e&&c.getTranslatableParameters(e,b)}))});return b},notify:function(a,b){this.validations.push({severity:a,message:b,title:b})},guessNameFromOperation:function(a){a=a.split(".");for(var b="create read update delete list get rest crud services".split(" "),c=a.length-1;0<=c;c--)if(0>b.indexOf(a[c]))return a[c];return null},getResolvedPageParameterType:function(a,b,c){if(null==a&&
null!=b)var d=this.getSchemaFromObject(b);else if(null==a||0<=["string","boolean","number","integer"].indexOf(a))d={type:null==a?"string":a};else try{d=this.$services.swagger.resolve(this.$services.swagger.definition(a))}catch(e){return console.error("Could not resolve type: "+a),{type:"string"}}d&&c&&(d={type:"array",items:d});return d},getApplicationProperties:function(){var a={};this.properties.map(function(b){a[b.key]=b.value});this.environmentProperties.map(function(b){a[b.key]=b.value});return a},
getApplicationParameters:function(){var a={properties:{}};this.properties.map(function(b){a.properties[b.key]=b});this.environmentProperties.map(function(b){a.properties[b.key]=b});return a},getProvidedParameters:function(){var a={properties:{}};nabu.page.providers("page-bindings").map(function(b){var c=b();c&&c.definition&&Object.keys(c.definition).map(function(d){a.properties[d]=c.definition[d]})});return a},getTargetPath:function(a,b,c){"string"==typeof b&&0<b.indexOf("-")&&(b=b.substring(0,b.indexOf("-")));
var d=!1;c||(d=c=!0);var e=null;if(a.rows)for(var g=0;g<a.rows.length;g++){e=[];var k=a.rows[g];if(k.id==b)e.push(k);else for(var m=0;m<k.cells.length;m++){var p=k.cells[m];if(p.id==b)e.push(p),e.push(k);else if(p.rows){var q=this.getTargetPath(p,b,c);q&&q.length&&(nabu.utils.arrays.merge(e,q),e.push(p),e.push(k))}if(e.length)break}if(e.length)break}e&&d&&e.reverse();return e},getSwaggerParametersAsKeys:function(a){var b=this,c=[];a&&("string"==typeof a&&(a=this.$services.swagger.operations[a]),a.parameters.map(function(d){"body"==
d.in?(d=b.$services.swagger.resolve(d),d.schema.properties&&nabu.utils.arrays.merge(c,b.getSimpleKeysFor(d.schema,!0,!0).map(function(e){return"body."+e}))):c.push(d.name)}));return c},registerHome:function(a,b){var c=this.$services.router.router.list().filter(function(g){return"home"==g.alias&&!g.isPage})[0];c&&this.$services.router.unregister(c);var d=this,e=this.$services.router.router.list().filter(function(g){return"home"==g.alias&&g.isPage})[0];this.$services.router.register({alias:"home",enter:function(g){setTimeout(function(){var k=
d.users.filter(function(m){var p=!1;m.roles&&m.roles.forEach(function(q){"$guest"!=q||d.$services.user.loggedIn?"$user"==q&&d.$services.user.loggedIn?p=!0:d.$services.user.hasRole&&d.$services.user.hasRole(q)&&(p=!0):p=!0});return p})[0];k&&k.home?"home"==k.home&&e?e.enter(g):d.$services.router.route(k.home,g):b&&d.$services.user.loggedIn?"home"==b&&e?e.enter(g):d.$services.router.route(b,g):a?"home"==a&&e?e.enter(g):d.$services.router.route(a,g):d.$services.router.route("login",g,null,!0)},1)},url:"/",
priority:1})},dropOperationInto:function(a,b,c){var d=this;this.$services.swagger.operations[a]?console.log("Dropping",a):c||this.reloadSwagger().then(function(){d.dropOperationInto(a,b,!0)})},updateUrl:function(a){var b=document.head.querySelector("meta[property\x3d'og:url']"),c=!0;b&&(b.getAttribute("content")!=a?b.parentNode.removeChild(b):c=!1);c&&a&&(b=document.createElement("meta"),b.setAttribute("property","og:url"),b.setAttribute("content",a),document.head.appendChild(b))},updateBranding:function(a,
b){var c=this;if(a&&b){var d={};Object.keys(a).forEach(function(k){d[k]=c.interpret(a[k],b,b.variables,b.$value)});a=d}var e="favicon title siteName description image imageAlt facebookAppId twitterUserName".split(" ");e.forEach(function(k){c.currentBranding[k]=a[k]?a[k]:c.branding[k];!c.currentBranding[k]&&"title"==k&&c.title&&(c.currentBranding[k]=c.title)});var g=["title","description","image","siteName"];e.forEach(function(k){if("favicon"==k){var m=document.head.querySelector("link[rel\x3d'icon']"),
p=!0;m&&(m.getAttribute("href")!=c.currentBranding[k]?m.parentNode.removeChild(m):p=!1);p&&c.currentBranding[k]&&(m=document.createElement("link"),m.setAttribute("rel","icon"),m.setAttribute("type","image/png"),m.setAttribute("href",c.currentBranding[k]),document.head.appendChild(m))}else 0<=g.indexOf(k)?(m=document.head.querySelector("meta[property\x3d'og:"+k+"']"),p=!0,m&&(m.getAttribute("content")!=c.currentBranding[k]?m.parentNode.removeChild(m):p=!1),p&&c.currentBranding[k]&&(m=document.createElement("meta"),
m.setAttribute("property","og:"+k),m.setAttribute("content",c.currentBranding[k]),document.head.appendChild(m)),"title"==k&&null!=c.currentBranding[k]&&(document.title=c.templateTitle())):"imageAlt"==k&&(m=document.head.querySelector("meta[name\x3d'twitter:image:alt']"),p=!0,m&&(m.getAttribute("content")!=c.currentBranding[k]?m.parentNode.removeChild(m):p=!1),p&&c.currentBranding[k]&&(m=document.createElement("meta"),m.setAttribute("name","twitter:image:alt"),m.setAttribute("content",c.currentBranding[k]),
document.head.appendChild(m)))})},templateTitle:function(a){var b=this.getEnvironment(),c=this.title;a&&a.content.title?c=a.content.title:this.currentBranding&&this.currentBranding.title?c=this.currentBranding.title:this.branding&&this.branding.title&&(c=this.branding.title);if(c){var d=c.match(/.*\{title\|([^}]+)\}.*/)?c.replace(/.*\{title\|([^}]+)\}.*/,"$1"):"Unnamed";c=c.replace("{environment}",b);a?(c=c.replace(/\{title[^}]*}/,a.content.label),c=c.replace("{category}",a.content.category)):c=c.replace(/\{title[^}]*}/,
d);return this.$services.page.translate(this.$services.page.interpret(c,this))}},getEnvironment:function(){var a=this.environment;a=a.split("-");return a=a[a.length-1].toUpperCase()},dashify:function(a){return null==a?null:this.underscorify(a).replace(/_/g,"-")},underscorify:function(a){return null==a?null:a.replace(/[^\w]+/g,"_").replace(/([A-Z]+)/g,"_$1").replace(/^_/,"").replace(/_$/,"").replace(/[_]+/g,"_").toLowerCase()},prettify:function(a){if(null==a)return null;a=this.underscorify(a);var b=
null;a.split(/_/).forEach(function(c){b=b?b+" ":"";0<c.length&&(b+=c.substring(0,1).toUpperCase()+c.substring(1))});return b},camelify:function(a){if(null==a)return null;a=this.underscorify(a);a=a.split("_");for(var b=null,c=0;c<a.length;c++)b=null==b?a[c]:b+(a[c].substring(0,1).toUpperCase()+a[c].substring(1));return b},normalizeCell:function(a){null==a.rows&&(a.rows=[]);null==a.bindings&&(a.bindings={});null==a.devices&&(a.devices=[]);null==a.id&&(a.id=-1);a.rows.forEach(this.normalizeRow);return a},
normalizeRow:function(a){null==a.cells&&(a.cells=[]);null==a.id&&(a.id=-1);a.cells.forEach(this.normalizeCell);return a},unsetCookie:function(a){var b=a.indexOf("\x3d");b=0<=b?a.substring(0,b):a;var c=null;0<=a.indexOf("path")&&(c=a.replace(/[\n]+/," ").replace(/.*;[\s]*path[\s]*=[\s]*([^;]+).*/,"$1"),c==a&&(c=null));null==c&&(c="/");var d=null;0<=a.indexOf("domain")&&(d=a.replace(/[\n]+/," ").replace(/.*;[\s]*domain[\s]*=[\s]*([^;]+).*/,"$1"),d==a&&(d=null));a=new Date;a.setTime(a.getTime()+-31536E6);
a="; expires\x3d"+a.toUTCString();var e=b+"\x3dcleared"+a+"; path\x3d"+c+(d?";domain\x3d"+d:"");null!=document.originalCookie?document.originalCookie=e:document.cookie=e;null==d&&(d="${environment('host')}");e=b+"\x3dcleared"+a+"; path\x3d"+c+(d?";domain\x3d"+d:"");null!=document.originalCookie?document.originalCookie=e:document.cookie=e},isAllowedCookie:function(a){var b=this.getAllowedCookies();if(0<=b.indexOf(a))return!0;for(var c=0;c<b.length;c++)if(a.match(new RegExp(b[c])))return!0;return!1},
acceptCookies:function(a){a?a instanceof Array||(a=[a]):a=[];this.$services.cookies.set("cookie-settings",JSON.stringify(a),36500);this.calculateAcceptedCookies();this.synchronizeCookies();this.cookieHooks.forEach(function(b){b(a)})},addCookieHook:function(a){this.cookieHooks.push(a);a(this.getAllowedCookies())},interceptCookies:function(){var a=this;this.isSsr||(Object.defineProperty(Document.prototype,"originalCookie",Object.getOwnPropertyDescriptor(Document.prototype,"cookie")),Object.defineProperty(Document.prototype,
"cookie",{enumerable:!0,configurable:!0,get:function(){return this.originalCookie},set:function(b){var c=b.indexOf("\x3d");0<=c&&(c=b.substring(0,c),a.isAllowedCookie(c)?this.originalCookie=b:(console.log("Blocking cookie",c),a.unsetCookie(b)))}}))},synchronizeCookies:function(a){for(var b=this,c=document.cookie.split(/[\s]*;[\s]*/),d=0;d<c.length;d++){var e=c[d].indexOf("\x3d");0<=e&&(e=c[d].substring(0,e),b.isAllowedCookie(e)||(console.log("Removing cookie",e),b.unsetCookie(c[d])))}a&&setTimeout(function(){b.synchronizeCookies(a)},
3E4)}},watch:{environment:function(a,b){b&&document.body&&document.body.classList.remove("environment-"+b);if(a){var c=function(){document.body?document.body.classList.add("environment-"+a):setTimeout(c,100)};c()}},editing:function(a){a||(this.calculatedPageTypes={})},rendering:function(a){if(0<a)this.stableTimer&&(clearTimeout(this.stableTimer),this.stableTimer=null),this.stable=!1;else{var b=this;this.stableTimer=setTimeout(function(){b.stable=!0},100)}},stable:function(a){console.log("rendering stable",
a)},location:function(a){this.$services.swagger.geoPosition=a},pages:function(a){this.loading||this.loadPages(a)},title:function(a){document.title=a},home:function(a){a&&!this.loading&&this.registerHome(a,this.homeUser)},homeUser:function(a){a&&!this.loading&&this.registerHome(this.home,a)},showConsole:function(a){if(this.canTest()){var b=document.querySelector("#nabu-console-instance");b&&b.parentNode.removeChild(b);a?(a=document.createElement("div"),a.setAttribute("id","nabu-console-instance"),
document.body.appendChild(a),this.$services.router.route("nabu-console",{initialTab:"features"},a),document.body.classList.add("has-nabu-console"),this.consoleTab=null):(document.body.classList.remove("has-nabu-console"),this.limitReports())}},branding:{deep:!0,handler:function(a){var b=this;Vue.nextTick(function(){b.updateBranding(b.branding)})}}}}),{name:"nabu.page.services.Page"});
document.addEventListener("mousemove",function(a){application&&application.services&&application.services.page&&(application.services.page.mouseX=a.pageX,application.services.page.mouseY=a.pageY,application.services.page.mouseXPassive=a.pageX,application.services.page.mouseYPassive=a.pageY)});var clearTemplates=function(){for(var a=document.head.getElementsByTagName("script"),b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])};
Vue.service("analysis",{services:["page"],data:function(){return{provider:null,id:1,mobile:application&&application.configuration&&application&&null!=application.configuration.mobile?application&&application.configuration.mobile:0<=navigator.userAgent.toLowerCase().indexOf("mobi"),language:application&&application.configuration?application.configuration.language:null,timezone:null,locale:null}},activate:function(a){this.start();Intl&&Intl.DateTimeFormat&&Intl.DateTimeFormat().resolvedOptions&&(this.timezone=
Intl.DateTimeFormat().resolvedOptions().timeZone,this.locale=Intl.DateTimeFormat().resolvedOptions().locale);a()},methods:{apply:function(a){nabu.page.providers("page-analysis").forEach(a)},start:function(){this.apply(function(a){a.start&&a.start()})},stop:function(){this.apply(function(a){a.stop&&a.stop()})},push:function(a){a.meta={mobile:this.mobile,browserLanguage:navigator.language,created:(new Date).toISOString(),url:window.location.href,userAgent:navigator.userAgent};document.referrer&&(a.meta.referrer=
document.referrer);this.language&&(a.meta.userLanguage=this.language);this.timezone&&(a.meta.timezone=this.timezone);this.locale&&(a.meta.locale=this.locale);a.eventId=this.id++;this.$services.page.location&&(a.location=this.$services.page.location);this.apply(function(b){b.push&&b.push(a)});this.$services.page.report("analysis",a.source?a.source:a.pageName?a.pageName:"$anonymous",a.type,a.event,a)}},clear:function(a){this.apply(function(b){b.reauthenticate&&b.reauthenticate()});a()}});
window.addEventListener("beforeunload",function(a){application.services&&application.services.analysis&&application.services.analysis.stop()});window.addEventListener("unload",function(a){application.services&&application.services.analysis&&application.services.analysis.stop()});
Vue.service("notifier",{methods:{activeProviders:function(){var a=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:-1E6;return nabu.page.providers("page-notifier").sort(function(b,c){null==b.priority&&(b.priority=0);null==c.priority&&(c.priority=0);return c.priority-b.priority}).filter(function(b){return b.priority>=a?(a=b.priority,!0):!1})},apply:function(a){this.activeProviders().forEach(a)},push:function(a){this.apply(function(b){b.push(a)})}}});
Vue.component("data-mixin",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.loadData();this.watchAll();Vue.set(this.state,"filter",this.filter);Vue.set(this.state,"records",this.records);Vue.set(this.state,"selected",this.selected)},data:function(){return{loadPromise:null,subscriptions:[],records:[],selected:[],paging:{},state:{},filter:{},loadTimer:null}},
methods:{clear:function(){this.records.splice(0)},loadDataAsync:function(){this.loadTimer&&(clearTimeout(this.loadTimer),this.loadTimer=null);this.loadTimer=setTimeout(this.loadData,100)},loadData:function(){var a=this;a.clear();this.loadPromise&&this.loadPromise.abort&&this.loadPromise.abort();this.loadPromise=this.$services.data.load({instance:this,limit:0,handler:function(b,c){a.clear();a.postProcess&&(b=a.postProcess(b));nabu.utils.arrays.merge(a.records,b)}})},select:function(a,b){b||this.selected.splice(0);
a instanceof Array?nabu.utils.arrays.merge(this.selected,a):a&&this.selected.push(a)},unsubscribe:function(){this.$services.data.unwatchAll(this.subscriptions)},watchAll:function(){this.unsubscribe();var a=this;nabu.utils.arrays.merge(this.subscriptions,this.$services.data.watchAll({instance:this,target:this.cell.state,handler:function(){Vue.set(a,"data",null);a.loadDataAsync();a.watchAll()}}))},getRuntimeAlias:function(){return this.cell.state.runtimeAlias},getRuntimeState:function(){return this.state},
getState:function(){return{properties:{filter:this.$services.data.getInputParameters(this.cell.state.operation),records:{type:"array",items:{type:"object",properties:this.$services.data.getDataDefinition({instance:this})}},selected:{type:"array",items:{type:"object",properties:this.$services.data.getDataDefinition({instance:this})}}}}}},beforeDestroy:function(){this.unsubscribe()}});
Vue.service("data",{services:["swagger"],methods:{getOperations:function(){return this.getSwaggerOperations()},getDataOperations:function(a){return this.getSwaggerDataOperations(a)},execute:function(a,b){return this.$services.swagger.execute(a,b)},getSwaggerOperations:function(a){var b=[],c=this.$services.swagger.operations;Object.keys(c).map(function(d){a(c[d])&&b.push(c[d])});b.sort(function(d,e){return d.id.localeCompare(e.id)});return b},getSwaggerDataOperations:function(a){var b=this;return this.getSwaggerOperations(function(c){var d=
"get"==c.method.toLowerCase()&&(!a||0<=c.id.toLowerCase().indexOf(a.toLowerCase()))&&c.responses["200"];if(d&&null!=c.responses["200"]&&null!=c.responses["200"].schema){var e=b.$services.swagger.definition(c.responses["200"].schema.$ref);d=!1;e.properties&&Object.keys(e.properties).map(function(g){"array"==e.properties[g].type&&(d=!0)})}return d})},getDefinition:function(a){var b={};if((a=this.$services.swagger.operations[a])&&a.responses["200"]){var c=this.$services.swagger.resolve(a.responses["200"].schema);
c.properties&&Object.keys(c.properties).map(function(d){"array"==c.properties[d].type&&(d=c.properties[d].items,d.properties&&nabu.utils.objects.merge(b,d.properties))})}return b},getInputParameters:function(a){var b={properties:{}},c=this;if((a=this.$services.swagger.operations[a])&&a.parameters){var d=["limit","offset","orderBy","connectionId"];a.parameters.filter(function(e){return 0>d.indexOf(e.name)}).map(function(e){b.properties[e.name]=c.$services.swagger.resolve(e)})}return b},normalizeInput:function(a){var b=
this,c=a.$vnode?a:a.instance;a.$vnode&&(a={});var d=a.target?a.target:c&&c.cell?c.cell.state:c.target,e=a.operation?a.operation:d?d.operation:null,g=a.array?a.array:d?d.array:null,k=a.bindings?a.bindings:d?d.bindings:null,m=a.filter?a.filter:c&&c.filter?c.filter:c&&c.state?c.state.filter:null,p=a.orderBy?a.orderBy:c&&c.state&&c.state.order?c.state.order.by:d?d.defaultOrderBy:null;null!=p&&(p instanceof Array||(p=[p]),p=p.map(function(t){return b.$services.page.isObject(t)?t.name+(t.direction?" "+
t.direction:""):t}));var q=a.page?a.page:c?c.page:null;c=a.pageInstance?a.pageInstance:q?this.$services.page.getPageInstance(q,c):null;return{handler:a.handler,target:d,operation:e,array:g,bindings:k,filter:m,orderBy:p,pageInstance:c,limit:a.limit,script:a.script?a.script:d?d.script:null,page:q,serviceContext:a.serviceContext,template:a.template?a.template:d?d.template:null,pageNumber:a.pageNumber}},getArrayOutputField:function(a){var b=this.$services.swagger.operations[a];if(b&&b.responses&&b.responses["200"]&&
b.responses["200"].schema){a={};var c=this.$services.swagger.resolve(b.responses["200"].schema);b=this.$services.page.getArrays(c);0<b.length&&(c=this.$services.page.getChildDefinition(c,b[0]))&&c.items&&c.items.properties&&(a[b[0]]=c.items.properties);return a}},getDataDefinition:function(a){a=this.normalizeInput(a);if(a.operation){var b=this.$services.swagger.operations[a.operation];if(b&&b.responses&&b.responses["200"]&&b.responses["200"].schema){var c={},d=this.$services.swagger.resolve(b.responses["200"].schema);
b=this.$services.page.getArrays(d);0<b.length&&(b=this.$services.page.getChildDefinition(d,b[0]))&&b.items&&b.items.properties&&nabu.utils.objects.merge(c,b.items.properties);d.properties&&Object.keys(d.properties).map(function(g){"array"==d.properties[g].type&&(g=d.properties[g].items,g.properties&&nabu.utils.objects.merge(c,g.properties))});return c}console.warn("Could not resolve data for operation",a.operation);return{}}if(a.array){var e=this.$services.page.getAvailableParameters(a.pageInstance.page,
null,!0);b=a.array;(d=this.$services.page.getChildDefinition({properties:e},b))||0!=b.indexOf("page.")||(d=this.$services.page.getChildDefinition({properties:e},b.substring(5)));!d&&0==b.indexOf("parent.")&&(e=this.$services.page.pages.filter(function(g){return g.content.name==a.pageInstance.page.content.pageParent})[0])&&(e=this.$services.page.getAvailableParameters(e,null,!0),d=this.$services.page.getChildDefinition({properties:e},b.substring(7)),null==d&&0==b.indexOf("parent.page.")&&(d=this.$services.page.getChildDefinition({properties:e},
b.substring(12))));if(d&&d.items&&d.items.properties)return d.items.properties;console.warn("Could not resolve data for array",a.array);return{}}},filterFields:function(a,b){a=this.getDataDefinition(a);a=this.$services.page.getSimpleKeysFor({properties:a},!0,!0);b&&(a=a.filter(function(c){return 0<=c.toLowerCase().indexOf(b.toLowerCase())}));return a},calculateLabelSeries(a,b){var c=[],d=[];a.forEach(function(e){e=b(e);0>d.indexOf(e.value)&&(d.push(e.value),c.push(e))});return c},getDataType:function(a){a=
this.normalizeInput(a);if(a.target&&a.target.template)if(a=this.$services.page.eval(a.target.template),a instanceof Array){if(a.length)return a[0]instanceof Array?"matrix":"series"}else return"point";return"series"},getTimeSeries:function(a,b,c,d,e){for(var g=[];a.getTime()<b.getTime();){var k=d(a),m=e?e(a):k;g.push({value:k,description:m});a=new Date(a.getTime()+c)}return g},normalizeSeries(a,b,c,d){d||=function(k){return k[k.length-1]};var e=[],g={};a.forEach(function(k){var m=b(k);null==g[m.value]&&
(g[m.value]=[]);g[m.value].push(k)});c.forEach(function(k){k=g[k.value];null==k?e.push(null):1==k.length?e.push(k[0]):e.push(d(k))});return e},normalizeMatrix(a,b,c,d){var e=[],g=this;a.forEach(function(k){e.push(g.normalizeSeries(k,b,c,d))});return e},createMatrix:function(a,b){return Object.values(this.group(a,b))},group:function(a,b){var c={};a.forEach(function(d){var e=b(d);e=e.value?e.value:e;null==c[e]&&(c[e]=[]);c[e].push(d)});return c},load:function(a){var b=this;a=this.normalizeInput(a);
var c=function(p){return a.script?(p=(new Function("with(this) { return "+a.script+" }")).call({value:p,$value:a.instance.$value,state:{data:p},$services:b.$services}),p instanceof Function&&(p=p.bind(this),p=p(value)),p):p},d=this.$services.q.defer(),e=function(p,q,t){p=c(p);a.handler&&a.handler(p,q,t);t?d.reject(t):d.resolve({records:p,paging:q})};if(a.operation){var g={};b=this;a.bindings&&Object.keys(a.bindings).map(function(p){if(a.bindings[p]){var q=b.$services.page.getBindingValue(a.pageInstance,
a.bindings[p],b);null!=q&&"undefined"!=typeof q&&(g[p]=q)}});a.filter&&Object.keys(a.filter).forEach(function(p){"record"!=p&&(g[p]=a.filter[p])});a.orderBy&&a.orderBy.length&&(g.orderBy=a.orderBy);null==g.limit&&(g.limit=null!=a.limit?a.limit:10);0==g.limit&&(g.limit=null);g.offset=g.limit*(a.pageNumber?a.pageNumber:0);a.serviceContext&&(g.$serviceContext=a.serviceContext);g.$serviceContext||(g.$serviceContext=a.pageInstance.getServiceContext());this.$services.swagger.execute(a.operation,g).then(function(p){if(p){var q=
null,t=null;q=Object.keys(b.getArrayOutputField(a.operation))[0];q=p[q];null==q&&(q=[]);var u=!1,w=function(y){Object.keys(y).forEach(function(B){"object"!==typeof y[B]||null==y[B]||u||(null!=y[B].current&&null!=y[B].total&&(t=y[B],u=!0),u||w(y[B]))})};w(p);e(null==q?[]:q,null==t?{}:t)}else e([],{})},function(p){e([],{},p)})}else if(a.array){var k=a.pageInstance.get(a.array);e(k?k:[],{})}else if(a.type&&(k=nabu.page.providers("page-repeat").filter(function(p){return p.name==a.type})[0])&&k.loadData){var m=
{records:[]};k=k.loadData(a.target,m,{},!1);k.then?k.then(function(){d.resolve(m.records)},d):d.resolve(m.records)}return d},uniquify:function(a){var b=0;a.forEach(function(c){c.hasOwnProperty("$position")&&c.$position>=b&&(b=c.$position+1)});a.forEach(function(c){c.hasOwnProperty("$position")||"string"==typeof c||c instanceof String||(c.$position=b++)})},unwatchAll:function(a){a&&a.forEach(function(b){b instanceof Function?b():b instanceof Array&&b.forEach(function(c){c instanceof Function&&c()})})},
watchAll:function(a){var b=this;a=this.normalizeInput(a);var c=[];a.target.pipelines?nabu.utils.arrays.merge(c,a.target.pipelines.map(function(d){var e={};nabu.utils.objects.merge(e,a);e.target=d;return b.watchAll(e)})):(c.push(this.watchArray(a)),a.bindings&&Object.keys(a.bindings).map(function(d){a.bindings[d]&&(d=a.bindings[d],0!=d.indexOf("parent.")&&(0==d.indexOf("page.")&&(d=d.substring(5)),console.log("watching",d,a.pageInstance.variables,a.handler),c.push(a.pageInstance.$watch("variables."+
d,a.handler,{deep:!0}))))}));return c},watchArray:function(a){var b=this;a=this.normalizeInput(a);var c=a.array;b=this;var d=a.pageInstance.get(c),e=null;if(null==d)e=a.pageInstance.$watch("variables",function(k){null!=a.pageInstance.get(c)&&(a.handler(),e(),e=b.watchArray(a))},{deep:!0});else{var g=JSON.stringify(d);0==c.indexOf("page.")&&(c=c.substring(5));e=a.pageInstance.$watch("variables."+c,function(k){JSON.stringify(a.pageInstance.get(c))!=g&&(a.handler(),e(),e=b.watchArray(a))},{deep:!0})}return function(){e&&
e()}}}});
Vue.service("image",{services:["q"],methods:{resize:function(a,b,c){var d=this,e=new FileReader,g=this.$services.q.defer();e.onload=function(k){var m=function(q){var t={};t.url=q;t.file=d.urlToBlob(q);t.file.name=a.name;t.name=a.name;t.type=a.type?a.type:"application/octet-stream";g.resolve(t)};if(a.type&&0==a.type.indexOf("image/")){var p=new Image;p.onload=function(q){q=document.createElement("canvas");var t=p.width,u=p.height,w=1;null!=b&&t>b&&(w=b/t);null!=c&&u>c&&(w=Math.min(w,c/u));t*=w;u*=
w;q.width=t;q.height=u;q.getContext("2d").drawImage(p,0,0,t,u);q=q.toDataURL(a.type?a.type:"image/jpeg");m(q)};p.src=k.target.result}else m(k.target.result)};e.readAsDataURL(a);return g},urlToBlob:function(a){if(0>a.indexOf(";base64,")){a=a.split(",");var b=a[0].split(":")[1];return new Blob([a[1]],{type:b})}a=a.split(";base64,");b=a[0].split(":")[1];return this.base64ToBlob(a[1],b)},base64ToBlob:function(a,b){a=window.atob(a);for(var c=a.length,d=new Uint8Array(c),e=0;e<c;++e)d[e]=a.charCodeAt(e);
return new Blob([d],{type:b})}}});
window.addEventListener("load",function(){nabu&&nabu.page&&nabu.page.provide&&nabu.page.provide("page-structure",{category:"Layouts",name:"Three Columns",description:"A simple layout with three columns",icon:"page/core/layouts/three-columns.png",content:{type:"page-row",content:{id:11,cells:[{id:14,rows:[{id:13,cells:[],"class":null,customId:null,instances:{},condition:null,direction:"vertical",align:null,on:null,collapsed:!1,name:"Column Contents"}],alias:null,bindings:{},name:"Column 1",state:{},
target:"page",on:null,"class":null,customId:null,width:1,height:null,instances:{},condition:null,devices:[],clickEvent:{eventFields:[],name:null}},{id:12,rows:[{id:16,cells:[],"class":null,customId:null,instances:{},condition:null,direction:"vertical",align:null,on:null,collapsed:!1,name:"Column Contents"}],alias:null,bindings:{},name:"Column 2",state:{},target:"page",on:null,"class":null,customId:null,width:1,height:null,instances:{},condition:null,devices:[],clickEvent:null},{id:15,rows:[{id:17,
cells:[],"class":null,customId:null,instances:{},condition:null,direction:"vertical",align:null,on:null,collapsed:!1,name:"Column Contents"}],alias:null,bindings:{},name:"Column 3",state:{},target:"page",on:null,"class":null,customId:null,width:1,height:null,instances:{},condition:null,devices:[],clickEvent:{eventFields:[],name:null}}],"class":null,customId:null,instances:{},condition:null,direction:null,align:null,on:null,collapsed:!1,name:"Columns"}}})});
Vue.component("n-form-attachment-uploader",{template:"#n-form-attachment-uploader",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},parentValue:{required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},edit:{type:Boolean,required:!1},name:{type:String,required:!1},readOnly:{type:Boolean,required:!1,default:!1},contentField:{type:String,default:"content"},nameField:{type:String,default:"contentName"},
typeField:{type:String,default:"contentType"},childComponents:{type:Object,required:!1}},data:function(){return{files:[],working:[],messages:[],valid:null}},computed:{isArray:function(){if(this.field.name){var a=this.$services.page.getAllArrays(this.page,this);if(0<=a.indexOf(this.field.name)||0<=a.indexOf("page."+this.field.name))return!0}return!1},maxFiles:function(){if(this.isArray){var a=this.field.maxFiles;if(a)return this.$services.page.interpret(a,this)}else return 1},remaining:function(){return this.isArray?
this.maxFiles?this.maxFiles-(this.value instanceof Array?this.value.length:0)-(this.field.reservationOperation?0:this.working.length):Number.MAX_SAFE_INTEGER:1},allowedFileTypes:function(){if(this.field.fileTypes)return this.field.fileTypes.filter(function(a){return!!a.contentType}).map(function(a){return a.contentType})}},methods:{validate:function(a){return[]},changed:function(){this.messages.splice(0);this.valid=null;this.files.length>this.remaining?this.messages.push({severity:"info",code:"too-many-files",
title:"%{You can only add {maximum} images}",values:{maximum:this.maxFiles}}):this.upload(this.files.splice(0))},upload:function(a){if(this.field.reservationOperation){var b=this;this.reserve(a).then(function(c){if(c)if(b.field.reservationOutputArrayName&&(c=b.$services.page.getValue(c,b.field.reservationOutputArrayName)),c instanceof Array)for(var d=0;d<c.length;d++)d<a.length&&b.uploadSingle(a[d],c[d]);else b.uploadSingle(a[0],c)})}else a.forEach(this.uploadSingle)},reserve:function(a){var b={},
c=this.$services.page.getPageInstance(this.page,this);if(this.field.reservationBindings){var d=this;a.forEach(function(e){var g={};Object.keys(d.field.reservationBindings).forEach(function(m){var p=d.field.reservationBindings[m];if(p){var q=null;"$file.fileName"==p?q=e.name:"$file.contentType"==p?q=e.type:0!=p.indexOf("$file")&&(q=d.$services.page.getBindingValue(c,p,d));q&&(0==m.indexOf("$reserved")?g[m.substring(10)]=q:d.$services.page.setValue(b,m,q))}});if(d.field.reservationInputArrayName){var k=
d.$services.page.getValue(b,d.field.reservationInputArrayName);k||(k=[],d.$services.page.setValue(b,d.field.reservationInputArrayName,k));k.push(g)}})}b.$serviceContext||(b.$serviceContext=c.getServiceContext());return this.$services.swagger.execute(this.field.reservationOperation,b)},uploadSingle:function(a,b){b&&(this.value instanceof Array?this.value.push(b):this.$emit("input",b));var c=this.$services.q.defer();if(this.field.uploadOperation){var d=this.$services.page.getPageInstance(this.page,
this);this.working.push(a);var e=this,g=function(){e.working.splice(e.working.indexOf(a),1)};e.$services.image.resize(a,e.field.maxWidth,e.field.maxHeight).then(function(k){var m={};m.body=k.file;e.field.uploadBindings&&Object.keys(e.field.uploadBindings).forEach(function(p){var q=e.field.uploadBindings[p];if(q){var t=null;"$file.fileName"==q?t=a.name:"$file.contentType"==q?t=a.type:0==q.indexOf("$reserved")?b&&(t=e.$services.page.getValue(b,q.substring(10))):0!=q.indexOf("$file")&&(t=e.$services.page.getBindingValue(d,
q,e));t&&e.$services.page.setValue(m,p,t)}});b&&e.field.urlField&&Vue.set(b,e.field.urlField,k.url);m.$serviceContext||(m.$serviceContext=d.getServiceContext());e.$services.swagger.execute(e.field.uploadOperation,m).then(function(p){b?Object.keys(p).forEach(function(q){q!=e.field.urlField&&Vue.set(b,q,p[q])}):this.value instanceof Array?e.value.push(p):e.$emit("input",p);g();c.resolve()},function(){g();c.reject()})})}else c.reject();return c},getChildComponents:function(){return[{title:"File Input",
name:"file-input",component:"column"},{title:"File Input Button",name:"file-input-button",component:"button"}]}}});
Vue.component("n-form-attachment-uploader-configure",{template:"#n-form-attachment-uploader-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},childComponents:{type:Object,required:!1}},created:function(){this.field.reservationBindings||Vue.set(this.field,"reservationBindings",{});this.field.uploadBindings||Vue.set(this.field,"uploadBindings",{});this.field.fileTypes||Vue.set(this.field,"fileTypes",[])},computed:{isArray:function(){if(this.field.name){var a=
this.$services.page.getAllArrays(this.page,this);if(0<=a.indexOf(this.field.name)||0<=a.indexOf("page."+this.field.name))return!0}return!1}},methods:{getOutputUrlFieldOptions:function(a){var b=this.$services.page.getSwaggerOperationOutputDefinition(this.field.uploadOperation);if(b){var c=this.$services.page.getArrays(b)[0];c&&(c.split(".").forEach(function(d){b=b.properties[d]}),b=b.items);return this.$services.page.getSimpleKeysFor(b,!1,!1).filter(function(d){return!a||0<=d.toLowerCase().indexOf(a.toLowerCase())})}return[]},
getReservationInputFields:function(){if(this.field.reservationOperation){var a=this.$services.page.getSwaggerOperationInputDefinition(this.field.reservationOperation);if(a){var b=this.$services.page.getArrays(a)[0],c=this.$services.page.getSimpleKeysFor(a,!1,!1);null!=b&&(b.split(".").forEach(function(d){a=a.properties[d]}),nabu.utils.arrays.merge(c,this.$services.page.getSimpleKeysFor({properties:{$reserved:a.items}},!1,!1)));return c}}return{}},getAvailableReservationParameters:function(){var a=
{};nabu.utils.objects.merge(a,this.$services.page.getAllAvailableParameters(this.page));a.$file={properties:{fileName:{type:"string"},contentType:{type:"string"}}};return a},getAvailableUploadParameters:function(){var a=this.getAvailableReservationParameters();if(this.field.reservationOperation){var b=this.$services.page.getSwaggerOperationOutputDefinition(this.field.reservationOperation);if(b){var c=this.$services.page.getArrays(b)[0];c?(c.split(".").forEach(function(d){b=b.properties[d]}),a.$reserved=
b.items):a.$reserved=b}}return a},getReservationOutputArrayName:function(){if(this.field.reservationOperation){var a=this.$services.page.getSwaggerOperationOutputDefinition(this.field.reservationOperation);if(a)return this.$services.page.getArrays(a)[0]}return null},getReservationInputArrayName:function(){if(this.field.reservationOperation){var a=this.$services.page.getSwaggerOperationInputDefinition(this.field.reservationOperation);if(a)return this.$services.page.getArrays(a)[0]}return null}},watch:{"field.reservationOperation":function(){this.field.reservationInputArrayName=
this.getReservationInputArrayName();this.field.reservationOutputArrayName=this.getReservationOutputArrayName()}}});
window.addEventListener("load",function(){application.bootstrap(function(a){nabu.page.provide("page-form-list-input",{component:"n-form-attachment-uploader",configure:"n-form-attachment-uploader-configure",name:"attachment-uploader",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"n-form-attachment-uploader",configure:"n-form-attachment-uploader-configure",name:"attachment-uploader",namespace:"nabu.page"});a.router.register({alias:"page-form-attachment-uploader",enter:function(b){var c=
{};nabu.utils.objects.merge(c,b);c.formComponent="n-form-attachment-uploader";c.configurationComponent="n-form-attachment-uploader-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"attachmentUploader",category:"Form",name:"Attachment uploader",description:"Uploads attachments and can resize images",icon:"page/core/images/image.svg"})})});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
Vue.view("page-image",{category:"Media",name:"Image",description:"Position an image",icon:"page/core/images/image.svg",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},activate:function(a){this.edit&&a();var b=this,c=[];if(this.cell.state.inline&&(this.cell.state.href||this.href)){b=this;var d=this.cell.state.href?this.cell.state.href:this.href;0!=d.indexOf("http://")&&
0!=d.indexOf("https://")&&0!=d.indexOf("/")&&(d="/"+d);nabu.utils.ajax({url:d}).then(function(k){b.inlineContent=k.responseText})}if(this.content){d=this.content instanceof Blob?this.content:nabu.utils.binary.blob(this.content,this.contentType?this.contentType:"image/jpeg");var e=new FileReader;e.readAsDataURL(d);var g=new nabu.utils.promise;c.push(g);e.onload=function(){var k=e.result;k.indexOf(",");b.encodedData=k;g.resolve()}}this.$services.q.all(c).then(a,a)},data:function(){return{inlineContent:null,
encodedData:null,href:null}},computed:{title:function(){return this.cell.state.title?this.$services.page.interpret(this.$services.page.translate(this.cell.state.title),this):null},emptyImage:function(){var a=application.configuration.root+"resources/modules/image/placeholder.svg";return this.cell.state.emptyImage?this.$services.page.interpret(this.cell.state.emptyImage):a},calculatedUrl:function(){if("operation"==this.cell.state.imageType)this.calculateRESTUrl();else if("static"==this.cell.state.imageType)this.calculateFixedUrl();
else if("bytes"==this.cell.state.imageType)this.calculateByteUrl();else if("variable"==this.cell.state.imageType){var a=this.$services.page.getPageInstance(this.page,this);return this.cell.state.imageUrlVariable?a.get(this.cell.state.imageUrlVariable):null}return this.href}},methods:{calculateByteUrl:function(){if(this.cell.state.byteValue){var a=this.$services.page.getPageInstance(this.page,this);if(a){var b=this,c=this.$services.page.getBindingValue(a,this.cell.state.byteValue);if(c){var d=null;
this.cell.state.contentTypeValue&&(d=this.$services.page.getBindingValue(a,this.cell.state.contentTypeValue));d||="image/jpeg";c=c instanceof Blob?c:nabu.utils.binary.blob(c,d);var e=new FileReader;e.readAsDataURL(c);var g=new nabu.utils.promise;e.onload=function(){var k=e.result;k.indexOf(",");b.href=k;g.resolve()};return g}}}},calculateFixedUrl:function(){var a=null;this.cell.state.href&&(a=this.$services.page.interpret(this.cell.state.href,this));if(a&&"data:"==a.substring(0,5))return this.href=
a;a&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&"/"!=a.substring(0,1)&&(a=application.configuration.root+a);a&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&this.cell.state.absolute?a=application.configuration.url+a:a&&"http://"!=a.substring(0,7)&&a.substring(0,8);!a&&this.edit&&(a=application.configuration.root+"resources/modules/image/placeholder.svg");this.href=a},calculateRESTUrl:function(){if(this.cell.state.imageOperation){var a=this.$services.swagger.operations[this.cell.state.imageOperation],
b=this.$services.page.getBindings(this.cell.state.bindings,this),c=this;if(a["x-temporary-id"]&&a["x-temporary-secret"]&&this.$services.user&&this.$services.user.ltp)this.$services.user.ltp(a.id).then(function(e){b[a["x-temporary-id"]]=e.authenticationId;b[a["x-temporary-secret"]]=e.secret;c.href=c.$services.swagger.parameters(a.id,b).url;if(e=c.$services.page.getPageInstance(c.page,c).getServiceContext())c.href+=(0<=c.href.indexOf("?")?"\x26":"?")+"$serviceContext\x3d"+e},function(e){c.href=null;
console.log("Could not get ltp for",a.id,e)});else{c.href=c.$services.swagger.properties(a.id,b).url;var d=c.$services.page.getPageInstance(c.page,c).getServiceContext();d&&(c.href+=(0<=c.href.indexOf("?")?"\x26":"?")+"$serviceContext\x3d"+d)}}},getChildComponents:function(){return[{title:"Image",name:"image",component:"image"}]},configurator:function(){return"page-image-configure"}}});
Vue.component("page-image-configure",{template:"#page-image-configure",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.load();this.cell.state.bindings||Vue.set(this.cell.state,"bindings",{})},computed:{hasPrevious:function(){var a=this,b=this.images.filter(function(c){return c.relativePath==a.cell.state.href})[0];return b&&0<this.images.indexOf(b)},hasNext:function(){if(!this.cell.state.href&&0<this.images.length)return!0;
var a=this,b=this.images.filter(function(c){return c.relativePath==a.cell.state.href})[0];return b&&this.images.indexOf(b)<this.images.length-1}},data:function(){return{images:[],files:[]}},methods:{next:function(){var a=this;if(this.cell.state.href){var b=this.images.filter(function(c){return c.relativePath==a.cell.state.href})[0];b&&(b=this.images.indexOf(b),this.cell.state.href=this.images[b+1].relativePath)}else Vue.set(this.cell.state,"href",this.images[0].relativePath)},previous:function(){var a=
this,b=this.images.filter(function(c){return c.relativePath==a.cell.state.href})[0];b&&(b=this.images.indexOf(b),this.cell.state.href=this.images[b-1].relativePath)},load:function(){var a=this;return this.$services.swagger.execute("nabu.web.page.core.v2.rest.resource.list",{path:this.cell.state.imagePath}).then(function(b){a.images.splice(0);b&&b.resources&&nabu.utils.arrays.merge(a.images,b.resources)})},upload:function(){var a=this;this.$services.swagger.execute("nabu.web.page.core.v2.rest.resource.create",
{path:this.cell.state.imagePath,body:this.files[0]}).then(function(b){a.load();b&&b.relativePath&&(a.cell.state.href=b.relativePath);a.files.splice(0,a.files.length)})},getAllKeys:function(a){var b=[];nabu.utils.arrays.merge(b,this.$services.page.getAllAvailableKeys(this.page,!0));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b}},watch:{"cell.state.imagePath":function(){this.load()}}});
Vue.view("page-markdown-text",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},computed:{rowHeight:function(){return Math.max(1,this.cell.state.content?this.cell.state.content.length-this.cell.state.content.replace(/\n/g,"").length+1:1)},formatted:function(){if(nabu.formatters&&nabu.formatters.markdown){var a=nabu.formatters.markdown.parse(this.cell.state.content),b=
nabu.formatters.markdown.asHtml(a,{tagUrl:"http://google.com?q\x3d",variables:{right:"left"}});0<Object.keys(b.promises).length&&Vue.nextTick(function(){nabu.formatters.markdown.replacePromises(b.promises)});return b.content}}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.Pages=Vue.extend({template:"#nabu-pages",data:function(){return{parameters:{},showing:!1,pageToRoute:null,opened:null,lastColor:{},selectedTab:"settings",showTemplates:!1,selectedTemplates:[]}},computed:{categories:function(){var a=[],b=!1;this.$services.page.pages.map(function(c){c.content.category?0>a.indexOf(c.content.category?c.content.category:null)&&a.push(c.content.category?c.content.category:null):b=!0});a.sort();b&&a.unshift(null);return a},hasTemplates:function(){return 0<
this.$services.page.pageTemplates.length},templateCategories:function(){var a=[];this.$services.page.pageTemplates.forEach(function(b){b.category&&0>a.indexOf(b.category)?a.push(b.category):null==b.category&&0>a.indexOf("Miscellaneous")&&a.push("Miscellaneous")});a.sort(function(b,c){return b.toLowerCase().localeCompare(c.toLowerCase())});return a}},created:function(){0<this.$services.page.pages.length&&(this.selectedTab="pages")},ready:function(){document.body.removeAttribute("page");document.body.removeAttribute("category");
this.$services.page.disableReload=!0;if(this.$services.page.canEdit()){var a=this;this.$el.addEventListener("paste",function(b){if(b=b.clipboardData.getData("text/plain")){var c=JSON.parse(b);c&&"page-category"==c.type?a.$confirm({message:"Are you sure you want to add the category '"+c.category+"' to this website?",type:"question",ok:"Add"}).then(function(){c.pages.map(function(d){a.$services.page.update(d)})}):c&&c.category&&c.name&&c.rows&&null!=c.counter&&a.$prompt(function(){return new nabu.page.views.PagesPaste({data:{category:c.category,
name:c.name}})}).then(function(d){c.name=d.name;c.label=a.$services.page.prettify(d.name);c.category=d.category;a.$services.page.update({content:c,name:c.name})})}})}else this.$services.router.route("login",null,null,!0)},beforeDestroy:function(){this.$services.page.disableReload=!1},methods:{getAdditionalSettings:function(){return nabu.page.providers("page-settings")},dropOnPages:function(a){if(this.$services.page.getDragData(a,"template-content"))if(a=JSON.parse(this.$services.page.getDragData(a,
"template-content")),console.log("dropped",a),"page"==a.type)console.log("dropped",a),this.$services.page.update({name:a.content.name,content:a.content});else if("pages"==a.type){var b=this;a.content.forEach(function(c){b.$services.page.update({name:c.name,content:c})})}},dragOverPages:function(a){if(this.$services.page.getDragData(a,"template-content")){var b=JSON.parse(this.$services.page.getDragData(a,"template-content"));"page"!=b.type&&"pages"!=b.type||a.preventDefault()}},toggleSelectionFor:function(a){var b=
this.selectedTemplates.indexOf(a);0<=b?this.selectedTemplates.splice(b,1):this.selectedTemplates.push(a)},dragTemplate:function(a,b){this.$services.page.setDragData(a,"template-content",b.content)},getTemplateCategory:function(a){return this.$services.page.pageTemplates.filter(function(b){return b.category==a||"Miscellaneous"==a&&null==b.category})},getDevice:function(a){var b=this.$services.page.devices.filter(function(c){return c.name==a})[0];null==b&&(b={name:a,width:null},this.$services.page.devices.push(b));
return b},addFunctionParameter:function(a,b){a[b].push({})},updatePageName:function(a,b){b&&(console.log("page name is",a.name,b),this.$services.page.rename(a,b))},customNameValidator:function(a){var b=[];0<this.$services.page.pages.filter(function(c){return c.content.name==a}).length&&b.push({severity:"error",title:"Name already in use",soft:!1});a.match(/^[a-zA-Z0-9-/]+$/)||b.push({severity:"error",title:"Can only use lower case letters, numbers and dashes in the page name",soft:!1});console.log("validating custom",
a,b);return b},copy:function(a){console.log("page is",a);nabu.utils.objects.copy(a.content)},copyCategory:function(a){nabu.utils.objects.copy({type:"page-category",category:a,pages:this.getPagesFor(a)})},getPagesFor:function(a){return this.$services.page.pages.filter(function(b){return!a&&!b.content.category||b.content.category==a}).sort(function(b,c){var d=!!b.content.defaultAnchor,e=!!c.content.defaultAnchor;b=!b.content.path;c=!c.content.path;return d&&!e?-1:!d&&e||b&&!c?1:!b&&c?-1:0})},getPageTypeBadge:function(a){return a.content.defaultAnchor?
"\x3cspan class\x3d'is-badge is-variant-neutral-outline is-border-full'\x3eSkeleton\x3c/span\x3e":a.content.path?"\x3cspan class\x3d'is-badge is-variant-primary-outline is-border-full'\x3ePage\x3c/span\x3e":"\x3cspan class\x3d'is-badge is-variant-secondary-outline is-border-full'\x3eComponent\x3c/span\x3e"},insertColor:function(a,b){this.$refs["editors_"+a.name][0].insert(b)},remove:function(a){var b=this;this.$confirm({title:"Delete page",message:"Are you sure you want to delete the page '"+a.name+
"'?"}).then(function(){b.$services.page.remove(a)})},create:function(a){var b=this;this.$prompt(function(){return new nabu.page.views.PageCreate({propsData:{validator:b.customNameValidator,categories:b.categories,fixedCategory:a}})}).then(function(c){b.$services.page.create(c.name,c.category)})},save:function(a){this.$services.page.update(a);this.$services.page.loadPages([a])},route:function(a){this.pageToRoute=a;var b=null;if(a.content.pageParent){var c=this.$services.page.pages.filter(function(e){return e.content.name==
a.content.pageParent})[0];c&&(b=this.$services.page.getPageParameters(c,!0,!0))}c=this.$services.page.getPageParameters(a,!0,!0);if(Object.keys(c.properties).length||b&&Object.keys(b.properties).length){var d={};b&&Object.keys(b.properties).map(function(e){d[e]=null});Object.keys(c.properties).map(function(e){d[e]=null});Vue.set(this,"parameters",d);this.showing=!0}else this.doRoute()},doRoute:function(){this.$services.router.route(this.$services.page.alias(this.pageToRoute),this.parameters)}}});
nabu.page.views.PageCreate=Vue.extend({template:"#nabu-create-page",props:{fixedCategory:{type:String,required:!1},validator:{type:Function,required:!1},categories:{type:Array,required:!1}},data:function(){return{category:null,name:null,newCategory:!1}},computed:{hasAnyCategories:function(){return 0<this.categories.length}},created:function(){this.hasAnyCategories||(this.newCategory=!0)},methods:{checkCategory:function(a){var b=[];nabu.utils.arrays.merge(b,this.categories.filter(function(c){return!!c}));
a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}),0>b.indexOf(a)&&b.unshift(a));console.log("categories are",b,a);return b}}});nabu.page.views.PagesPaste=Vue.extend({template:"#nabu-pages-paste",data:function(){return{category:null,name:null}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.formComponentConstructer=function(a){return Vue.component(a,{template:"#"+a,props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},data:function(){return{configuring:!1,subscriptions:[],result:{},reference:{},currentPage:null,autoMapFrom:null,messages:[],readOnly:!1,labels:{},doingIt:!1,started:null,error:null}},beforeDestroy:function(){this.subscriptions.map(function(b){b()})},
computed:{codes:function(){var b={};if(this.cell.state.codes){var c=this;this.cell.state.codes.forEach(function(d){b[d.code]=c.$services.page.translate(d.title)})}return b},analysisId:function(){var b=this.cell.state.analysisId;b||(b=this.cell.state.formId);b||(b=this.page.name);return b},operation:function(){return this.cell.state.operation?this.$services.swagger.operations[this.cell.state.operation]:null},body:function(){var b=this.$services.swagger.operations[this.cell.state.operation];if(b)for(var c=
0;c<b.parameters.length;c++){var d=b.parameters[c];if("body"==d.in)return this.$services.swagger.resolve(d)}return{}},availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)},fieldsToAdd:function(){var b=[];if(this.cell.state.pageForm){var c=this.$services.page.getPageParameters(this.page);nabu.utils.arrays.merge(b,this.$services.page.getSimpleKeysFor(c,!0,!0))}else this.cell.state.functionForm?this.cell.state.functionId&&(c=this.$services.page.getFunctionInput(this.cell.state.functionId),
nabu.utils.arrays.merge(b,this.$services.page.getSimpleKeysFor(c,!0,!0))):nabu.utils.arrays.merge(b,this.$services.page.getSimpleKeysFor({properties:this.getOperationInput()},!0,!0));return b},self:function(){return this},form:function(){return this}},created:function(){this.schemas={};this.normalize(this.cell.state);this.initialize();this.cell.cellState={form:this.createResultDefinition()};this.cell.state.allowReadOnly&&this.cell.state.startAsReadOnly&&(this.readOnly=!0);this.started=new Date;if(this.cell.state.submitOnEvent){var b=
this,c=b.$services.page.getPageInstance(b.page,b);this.cell.state.submitOnEvent.forEach(function(d){b.subscriptions.push(c.subscribe(d,function(){b.doIt()}))})}this.cell.state.cancelOnEvent&&(b=this,c=b.$services.page.getPageInstance(b.page,b),this.cell.state.cancelOnEvent.forEach(function(d){b.subscriptions.push(c.subscribe(d,function(){b.cancel()}))}))},ready:function(){var b=this;this.formListener=this.$root.$on("form-opened",function(c){b.cell.state.onlyOneEdit&&c!=b&&!b.readOnly&&b.cancel()})},
methods:{getChildComponents:function(){return[{title:"Form",name:"form-main",component:"form"},{title:"Form Container",name:"form-container",component:"form-section"},{title:"Form Title",name:"form-title",component:"h2"},{title:"Button Container",name:"form-button-container",component:"menu",default:["layout_align_space-between"]},{title:"Ok Button",name:"form-button-ok",component:"button",default:["button_variant_primary"]},{title:"Cancel Button",name:"form-button-cancel",component:"button",default:["button_variant_link"]},
{title:"Next Button",name:"form-button-next",component:"button",default:["button_variant_primary"]},{title:"Previous Button",name:"form-button-previous",component:"button",default:["button_variant_primary"]}]},isPageActive:function(b){var c=this.createResult();console.log("checking if page is active",b,c);return(!b.enabledIf||this.$services.page.isCondition(b.enabledIf,c,this))&&(!b.disabledIf||!this.$services.page.isCondition(b.disabledIf,c,this))},hasNextActivePage:function(b){b=this.cell.state.pages.indexOf(b);
if(!(b>=this.cell.state.pages.length-1))for(b+=1;b<this.cell.state.pages.length;b++)if(this.isPageActive(this.cell.state.pages[b]))return!0;return!1},getCellValue:function(b){if(0==b.indexOf("form."))return this.$services.page.getValue(this.createResult(),b.substring(5))},generateForm:function(){var b=this,c=this.cell.state.pages[0];this.cell.state.mode="component";var d=[];if(this.cell.state.operation){var e=this.$services.swagger.operations[this.cell.state.operation];e&&e.parameters&&nabu.utils.arrays.merge(d,
e.parameters.filter(function(g){return"path"==g.in}).map(function(g){return g.name}))}this.fieldsToAdd.forEach(function(g){if("body"!=g&&0>d.indexOf(g)){var k=g.split("."),m=b.getSchemaFor(g),p={arbitrary:!1,name:g,label:"%{"+b.$services.formatter.conventionize(k[k.length-1])+"}",description:null,type:"text",enumerations:[],value:null,group:null,joinGroup:!1};if(m.format&&0<=m.format.indexOf("date"))p.type="date";else if("boolean"==m.type)p.type="switch";else if("integer"==m.type)p.textType="number";
else if("uuid"==m.format){p.type="enumeration-operation";var q=k[k.length-1];"Id"==q.substring(q.length-2,q.length)&&(q=q.substring(0,q.length-2),b.$services.masterdata.categories.filter(function(t){return t.name==q})&&(p.enumerationOperation="nabu.cms.core.rest.masterdata.category.suggest",p.enumerationOperationLabel="label",p.enumerationOperationValue="id",p.enumerationOperationQuery="q"))}else 0<=g.indexOf("password")&&(p.type="password");c.fields.push(p)}})},dragOver:function(b){var c=b.dataTransfer.getData("form-name");
console.log("dragged",c);c&&(this.$services.page.pushDragItem(this.$el),this.$el.classList.add("hovering"),b.stopPropagation(),b.preventDefault())},dragExit:function(b){this.$el.classList.remove("hovering")},drop:function(b){var c=b.dataTransfer.getData("form-name");c&&(this.currentPage.fields.push({arbitrary:!1,name:null,label:null,description:null,type:c,enumerations:[],value:null,group:null,joinGroup:!1}),b.stopPropagation(),b.preventDefault())},getCurrentValue:function(b){var c=this.result[b.name];
this.result.hasOwnProperty(b.name)||(c=this.$services.page.getValue(this.result,b.name),null!=c&&Vue.set(this.result,b.name,c));return c},initializePageForm:function(){var b=this.$services.page.getPageInstance(this.page,this);b=this.$services.page.getPageParameterValues(this.page,b);Vue.set(this,"result",this.$services.page.cloneByReference(b));this.$services.page.explode(this.result,this.result);Vue.set(this,"reference",this.$services.page.cloneByReference(this.result))},hasChanged:function(b,c){if(this.cell.state.pageForm){b=
this.reference[b];if(c instanceof Array&&b instanceof Array){var d=!1;if(c.length!=b.length)d=!0;else for(var e=0;e<c.length;e++)c[e]!==b[e]&&JSON.stringify(c[e])!==JSON.stringify(b[e])&&(d=!0);return d}return c!==b}return!0},initialize:function(){var b=this,c=b.$services.page.getPageInstance(b.page,b);this.cell.state.pageForm?this.initializePageForm():this.cell.bindings&&Object.keys(this.cell.bindings).map(function(d){if(b.cell.bindings[d]){var e=b.$services.page.getBindingValue(c,b.cell.bindings[d]);
e instanceof Array?(e=e.map(function(g){return nabu.utils.objects.clone(g)}),b.result[d]instanceof Array?(b.result[d].splice(0),nabu.utils.arrays.merge(b.result[d],e)):Vue.set(b.result,d,e)):Vue.set(b.result,d,e)}});this.currentPage=this.cell.state.pages[0];this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"form",type:"form-page",counter:0,method:"start",group:this.analysisId,event:this.analysisId+"-page-0"});this.$services.analysis&&this.$services.analysis.emit&&
this.$services.analysis.emit("form-page-0",this.analysisId,null,!0)},automap:function(){var b=this.availableParameters[this.autoMapFrom],c=this;this.fieldsToAdd.forEach(function(d){if(!c.cell.bindings[d])for(var e=d;e;){if(b.properties[e]){Vue.set(c.cell.bindings,d,c.autoMapFrom+"."+e);break}var g=e.indexOf(".");if(0>g)break;e=e.substring(g+1)}})},isHidden:function(b){return!!b.hidden&&this.$services.page.isCondition(b.hidden,this.createResult(),this)},isDisabled:function(b){return!!b.disabled&&this.$services.page.isCondition(b.disabled,
this.createResult(),this)},pasteField:function(b){var c=this.$services.page.pasteItem("page-form-field");c&&(b.fields||Vue.set(b,"fields",[]),b.fields.push(c))},pastePage:function(){var b=this.$services.page.pasteItem("page-form-page");b&&this.cell.state.pages.push(b)},getGroupedFields:function(b){var c=[];b.fields.map(function(d){!0===d.joinGroup?(0==c.length&&c.push({fields:[]}),c[c.length-1].fields.push(d)):c.push({group:d.group,fields:[d]})});return c},nextPage:function(){var b=this.$refs.form.validate(),
c=this,d=function(){b.length?(c.showMessages(b),c.scrollToException(b)):(c.currentPage=c.cell.state.pages[c.cell.state.pages.indexOf(c.currentPage)+1],c.$services.analysis.push({pageName:c.page.content.name,pageCategory:c.page.content.category,category:"form",type:"form-page",counter:c.cell.state.pages.indexOf(c.currentPage),method:"next",group:c.analysisId,event:c.analysisId+"-page-"+c.cell.state.pages.indexOf(c.currentPage)}),c.$services.analysis&&c.$services.analysis.emit&&c.$services.analysis.emit("form-page-"+
c.cell.state.pages.indexOf(c.currentPage),c.analysisId,{method:"next"},!0))};b.then?b.then(d,d):d()},showMessages:function(b){this.cell.state.formValidationMessages&&0<parseInt(this.cell.state.formValidationMessages)&&(this.messages.splice(0),nabu.utils.arrays.merge(this.messages,b.filter(function(c){return!c.handled}).splice(0,Math.min(b.length,parseInt(this.cell.state.formValidationMessages)))))},scrollToException:function(b){for(var c=0;c<b.length;c++)if(b[c].component&&b[c].component.$el){b[c].component.$el.scrollIntoView(!0);
break}},previousPage:function(){1<=this.cell.state.pages.indexOf(this.currentPage)&&(this.currentPage=this.cell.state.pages[this.cell.state.pages.indexOf(this.currentPage)-1],this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"form",type:"form-page",counter:this.cell.state.pages.indexOf(this.currentPage),method:"previous",group:this.analysisId,event:this.analysisId+"-page-"+this.cell.state.pages.indexOf(this.currentPage)}),this.$services.analysis&&
this.$services.analysis.emit&&this.$services.analysis.emit("form-page-"+this.cell.state.pages.indexOf(this.currentPage),this.analysisId,{method:"previous"},!0))},setPage:function(b){if(!this.$refs.form.validate().length||this.edit)this.currentPage=b,this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"form",type:"form-page",counter:this.cell.state.pages.indexOf(this.currentPage),method:"choose",group:this.analysisId,event:this.analysisId+
"-page-"+this.cell.state.pages.indexOf(this.currentPage)}),this.$services.analysis&&this.$services.analysis.emit&&this.$services.analysis.emit("form-page-"+this.cell.state.pages.indexOf(this.currentPage),this.analysisId,{method:"choose"},!0)},deletePage:function(b){var c=this;this.$confirm({message:"Are you sure you want to delete the form page '"+b.name+"'?"}).then(function(){c.cell.state.pages.splice(c.cell.state.pages.indexOf(b),1)})},addPage:function(){this.cell.state.pages.push({name:"Unnamed Page",
title:null,fields:[]})},upPage:function(b){b=this.cell.state.pages.indexOf(b);if(0<b){var c=this.cell.state.pages[b-1];this.cell.state.pages.splice(b-1,1,this.cell.state.pages[b]);this.cell.state.pages.splice(b,1,c)}},downPage:function(b){b=this.cell.state.pages.indexOf(b);if(b<this.cell.state.pages.length-1){var c=this.cell.state.pages[b+1];this.cell.state.pages.splice(b+1,1,this.cell.state.pages[b]);this.cell.state.pages.splice(b,1,c)}},upAllPage:function(b){var c=this.cell.state.pages.indexOf(b);
0<c&&(this.cell.state.pages.splice(c,1),this.cell.state.pages.unshift(b))},downAllPage:function(b){var c=this.cell.state.pages.indexOf(b);c<this.cell.state.pages.length-1&&(this.cell.state.pages.splice(c,1),this.cell.state.pages.push(b))},copyPage:function(b){this.cell.state.pages.push(nabu.utils.objects.deepClone(b))},configurator:function(){null==this.cell.state.autoclose&&Vue.set(this.cell.state,"autoclose",!0);return"page-form-configure-all"},configure:function(){null==this.cell.state.autoclose&&
Vue.set(this.cell.state,"autoclose",!0);this.configuring=!0},normalize:function(b){b.hasOwnProperty("title")||Vue.set(b,"title",null);b.hasOwnProperty("immediate")||Vue.set(b,"immediate",!1);b.pages instanceof Array||Vue.set(b,"pages",[]);b.fields&&(b.pages.push({name:"Form Fields",title:null,fields:b.fields}),Vue.delete(b,"fields"));b.pages.length||b.pages.push({name:"Form Fields",title:null,fields:[]});b.hasOwnProperty("class")||Vue.set(b,"class",null);b.hasOwnProperty("ok")||Vue.set(b,"ok","%{Ok}");
b.hasOwnProperty("edit")||Vue.set(b,"edit","%{Edit}");b.hasOwnProperty("next")||Vue.set(b,"next","%{Next}");b.hasOwnProperty("cancel")||Vue.set(b,"cancel","%{Cancel}");b.hasOwnProperty("event")||Vue.set(b,"event",null);b.hasOwnProperty("synchronize")||Vue.set(b,"synchronize",!1)},getEvents:function(){var b={};if(this.cell.state.functionForm&&this.cell.state.event)b[this.cell.state.event]=this.cell.state.functionId?this.$services.page.getFunctionOutput(this.cell.state.functionId):{};else if(this.operation&&
this.cell.state.event){var c=this.operation.responses["200"],d=null;c&&c.schema&&(d=this.$services.swagger.resolve(c.schema));null==d&&(d={properties:this.getOperationInput()});b[this.cell.state.event]=d?d:{}}else this.cell.state.event&&(b[this.cell.state.event]=this.cell.on?this.cell.on:{});this.cell.state.submitEvent&&(b[this.cell.state.submitEvent]=this.cell.state.functionForm?this.$services.page.getFunctionInput(this.cell.state.functionId):{properties:this.getOperationInput()});this.cell.state.cancelEvent&&
(b[this.cell.state.cancelEvent]=this.cell.on?this.cell.on:{});this.cell.state.errorEvent&&(b[this.cell.state.errorEvent]=this.$services.swagger.resolve("#/definitions/StructuredErrorResponse"));this.cell.state.pages.forEach(function(e){e.fields&&e.fields.forEach(function(g){g=nabu.page.event.getName(g,"validationSuccessEvent");null!=g&&(b[g]={})})});nabu.utils.objects.merge(b,this.getEventsRecursively(this));return b},getEventsRecursively:function(b){var c={};if(b.$children){var d=this;b.$children.forEach(function(e){e.getEvents?
nabu.utils.objects.merge(c,e.getEvents()):nabu.utils.objects.merge(c,d.getEventsRecursively(e))})}return c},getOperationInput:function(){var b={},c=this;if(this.cell.state.operation){var d=this.$services.swagger.operations[this.cell.state.operation];d&&d.parameters&&d.parameters.forEach(function(e){if("body"==e.in){var g=c.$services.swagger.resolve(e);b[e.name]=g.schema}else b[e.name]=e})}return b},cancel:function(){if(!this.doingIt){if(this.cell.state.cancelEvent){var b=this.$services.page.getPageInstance(this.page,
this),c=null;this.cell.on&&(c=b.get(this.cell.on));null==c&&(c={});b.emit(this.cell.state.cancelEvent,c)}this.$emit("close");this.cell.state.allowReadOnly&&(this.readOnly=!0,this.initialize(),this.resetValidation());this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"form",type:"form-cancel",group:this.analysisId,event:this.analysisId+"-cancel"});this.$services.analysis&&this.$services.analysis.emit&&this.$services.analysis.emit("form-cancel",
this.analysisId,null,!0)}},resetValidation:function(b){null==b&&(b=this.$refs.form);null!=b.valid&&(b.valid=null);if(b.$children)for(var c=0;c<b.$children.length;c++)this.resetValidation(b.$children[c])},getOperations:function(b){return this.$services.page.getOperations(function(c){return("put"==c.method.toLowerCase()||"post"==c.method.toLowerCase()||"delete"==c.method.toLowerCase()||"patch"==c.method.toLowerCase())&&(!b||0<=c.id.toLowerCase().indexOf(b.toLowerCase()))})},getField:function(b){for(var c=
0;c<this.cell.state.pages.length;c++){var d=this.cell.state.pages[c].fields.filter(function(e){return e.name==b})[0];if(d)return d}},updateOperation:function(b){this.cell.state.operation=b?b.id:null;var c={};if(b&&b.parameters){var d=this;b.parameters.map(function(g){if("body"==g.in){var k=d.$services.swagger.resolve(g);k.schema.properties?Object.keys(k.schema.properties).map(function(m){if("object"!=k.schema.properties[m].type){var p="body."+m;c[p]=d.cell.bindings&&d.cell.bindings[p]?d.cell.bindings[p]:
null}("object"==k.schema.properties[m].type||"array"==k.schema.properties[m].type&&k.schema.properties[m].items.properties)&&Object.keys("array"==k.schema.properties[m].type?k.schema.properties[m].items.properties:k.schema.properties[m].properties).map(function(q){q="body."+m+"."+q;c[q]=d.cell.bindings&&d.cell.bindings[q]?d.cell.bindings[q]:null})}):"string"==k.schema.type&&"binary"==k.schema.format&&(c.body=d.cell.bindings&&d.cell.bindings.body?d.cell.bindings.body:null)}else c[g.name]=d.cell.bindings&&
d.cell.bindings[g.name]?d.cell.bindings[g.name]:null})}if(this.cell.on){d=this;var e=d.$services.page.getPageInstance(d.page,d).getEvents()[this.cell.on];e&&e.properties&&Object.keys(c).map(function(g){var k=g;0==k.indexOf("body.")&&(k=k.substring(5));e.properties[k]&&(c[g]=d.cell.on+"."+k)})}Vue.set(this.cell,"bindings",c)},getSchemaFor:function(b){if(!b)return null;if(!this.schemas[b]){var c=function(m,p,q){m.items&&(m=m.items);var t=m.properties;if(t&&t[p[q]]){if(q<p.length-1)return c(t[p[q]],
p,q+1);t=t[p[q]];t.required=t.required||m.required&&0<=m.required.indexOf(p[q]);return t}};if(this.cell.state.functionForm){var d=this.$services.page.getFunctionInput(this.cell.state.functionId),e=b.split(".");d=d?c(d,e,0):null}else if(this.cell.state.pageForm)d=this.$services.page.getPageParameters(this.page),e=b.split("."),d=d?c(d,e,0):null;else if(e=this.$services.swagger.operations[this.cell.state.operation],d=null,e)if(0==b.indexOf("body."))d=this.body,e=b.substring(5).split("."),d=d.schema?
c(d.schema,e,0):null;else for(var g=0;g<e.parameters.length;g++){var k=e.parameters[g];"body"!=k.in&&k.name==b&&(d=k)}this.schemas[b]=d}return this.schemas[b]},isList:function(b){return(b=this.getSchemaFor(b))&&"array"==b.type},isPartOfList:function(b){if(!b||0!=b.indexOf("body."))return!1;b=b.substring(5).split(".");for(var c=this.body.schema,d=0;d<b.length-1;d++)if(c.items&&(c=c.items),(c=c.properties[b[d]])&&"array"==c.type)return!0;return!1},set:function(b,c){this.result[b]=c},getProvidedListComponent:function(b){var c=
nabu.page.providers("page-form-list-input").filter(function(d){return d.name==b})[0];return c?c.component:null},addInstanceOfField:function(b){this.result[b.name]||Vue.set(this.result,b.name,[]);var c=this.getSchemaFor(b.name);c.items&&(c=c.items);var d=null;c.properties&&(d={},Object.keys(c.properties).map(function(e){d[e]=null}));this.result[b.name].push(d)},createResultDefinition:function(){var b={properties:{}};if(this.operation&&this.operation.parameters){var c=this;Object.keys(this.operation.parameters).map(function(d){b.properties[c.operation.parameters[d].name]=
c.operation.parameters[d].schema?c.$services.swagger.resolve(c.operation.parameters[d].schema):c.operation.parameters[d]})}return b},createResult:function(){var b=this.result,c={};Object.keys(b).map(function(g){for(var k=g.split("."),m=c,p=0;p<k.length-1;p++)null==m[k[p]]&&Vue.set(m,k[p],{}),m=m[k[p]];m[k[k.length-1]]!==b[g]&&(null!=m[k[k.length-1]]&&"object"==typeof m[k[k.length-1]]?nabu.utils.objects.merge(m[k[k.length-1]],b[g]):Vue.set(m,k[k.length-1],b[g]));0<g.indexOf(".")&&(c[g]=b[g])});var d=
this,e=d.$services.page.getPageInstance(d.page,d);Object.keys(this.cell.bindings).map(function(g){if(d.cell.bindings[g]&&0>Object.keys(c).indexOf(g)&&0>Object.keys(b).indexOf(g)){for(var k=g.split("."),m=c,p=0;p<k.length-1;p++)m[k[p]]||Vue.set(m,k[p],{}),m=m[k[p]];Vue.set(m,k[k.length-1],d.$services.page.getBindingValue(e,d.cell.bindings[g]))}});return c},changed:function(b){if(b&&this.cell.state.pages){var c=this;this.cell.state.pages.forEach(function(d){d.fields.forEach(function(e){(e.resetOnUpdate==
b||e.resetOnUpdate instanceof Array&&0<=e.resetOnUpdate.indexOf(b))&&Vue.set(c.result,e.name,null)})})}this.cell.state.immediate&&this.doIt();this.localState&&Vue.set(this.localState,"form",this.createResult())},doIt:function(){return this.execute()},execute:function(b){var c=this;if(!this.doingIt){var d=new Date,e=function(p){c.$services.analysis.push({pageName:c.page.content.name,pageCategory:c.page.content.category,category:"form",type:"form-finalize",group:c.analysisId,event:c.analysisId+(p?"-fail":
"-submit")});c.$services.analysis&&c.$services.analysis.emit&&c.$services.analysis.emit(p?"form-fail":"form-finalize",c.analysisId,{submitTime:(new Date).getTime()-d.getTime(),totalTime:(new Date).getTime()-c.started.getTime(),error:p},!0)};this.doingIt=!0;var g=this.cell.state.immediate&&"page"==this.cell.target?[]:this.$refs.form.validate(),k=function(){var p=null;if(g.length)c.doingIt=!1,c.showMessages(g),c.scrollToException(g);else{c.messages.splice(0,c.messages.length);var q=c.createResult();
if(c.cell.state.submitEvent){var t=c.$services.page.getPageInstance(c.page,c);t.emit(c.cell.state.submitEvent,q)}if(c.cell.state.pageForm)(null==c.cell.state.autoclose||c.cell.state.autoclose)&&c.$emit("close"),t=c.$services.page.getPageInstance(c.page,c),c.$services.page.getPageParameters(c.page),Object.keys(q).forEach(function(w){(null==q[w]||q[w]instanceof Array||null!=q&&(Object(q[w])!==q[w]||q[w]instanceof Date||q[w]instanceof File||q[w]instanceof Blob))&&c.hasChanged(w,q[w])&&t.set("page."+
w,q[w])}),c.cell.state.event&&(p=t.emit(c.cell.state.event,c.cell.on?t.get(c.cell.on):{})),c.cell.state.allowReadOnly&&(c.readOnly=!0),c.doingIt=!1,c.initializePageForm();else if(c.cell.state.functionForm){p=c.$services.q.defer();var u=c.$services.page.runFunction(c.cell.state.functionId,q,c,p);p.then(function(w){c.cell.state.event&&c.$services.page.getPageInstance(c.page,c).emit(c.cell.state.event,null==w?u:w);(null==c.cell.state.autoclose||c.cell.state.autoclose)&&c.$emit("close");c.cell.state.allowReadOnly&&
(c.readOnly=!0);c.doingIt=!1;e()},function(w){c.error="Form submission failed";w&&w.responseText&&(w=JSON.parse(w.responseText));if(w){w.code||(w.code="HTTP-"+(null!=w.status?w.status:500));try{c.cell.state.errorEvent&&(!c.cell.state.errorEventCodes||0<=c.cell.state.errorEventCodes.split(/[\\s]*,[\\s]*/).indexOf(w.code))&&c.$services.page.getPageInstance(c.page,c).emit(c.cell.state.errorEvent,w);var y=c.$services.page.translateErrorCode(w.code,w.title?w.title:w.message);c.error=y;c.messages.push({type:"request",
severity:"error",title:y})}catch(B){c.messages.push({type:"request",severity:"error",title:c.$services.page.translateErrorCode(w.status?"HTTP-"+w.status:"HTTP-500")})}}else c.messages.push({type:"request",severity:"error",title:c.$services.page.translateErrorCode("HTTP-500")});c.doingIt=!1;e(c.error)})}else if(c.cell.state.operation)try{return c.$services.swagger.execute(c.cell.state.operation,q).then(function(w){var y=c.$services.page.getPageInstance(c.page,c);c.cell.state.synchronize&&Object.keys(c.cell.bindings).map(function(B){if(null!=
c.cell.bindings[B]){var F=c.result[B],C=!1;if(F instanceof Array){var A=y.get(c.cell.bindings[B]);A instanceof Array&&(A.splice(0),nabu.utils.arrays.merge(A,F),C=!0)}C||y.set(c.cell.bindings[B],F)}});c.cell.state.event&&(w=null==w?q:w,y.emit(c.cell.state.event,null==w?{}:w));(null==c.cell.state.autoclose||c.cell.state.autoclose)&&c.$emit("close");c.cell.state.allowReadOnly&&(c.readOnly=!0);c.doingIt=!1;e()},function(w){c.error="Form submission failed";try{w.responseText&&(w=JSON.parse(w.responseText));
c.cell.state.errorEvent&&(!c.cell.state.errorEventCodes||0<=c.cell.state.errorEventCodes.split(/[\\s]*,[\\s]*/).indexOf(w.code))&&c.$services.page.getPageInstance(c.page,c).emit(c.cell.state.errorEvent,w);var y=c.$services.page.translateErrorCode(w.code,w.title?w.title:w.message);c.error=y;c.messages.push({type:"request",severity:"error",title:y})}catch(B){c.messages.push({type:"request",severity:"error",title:c.$services.page.translateErrorCode(w.status?"HTTP-"+w.status:"HTTP-500")})}c.doingIt=!1;
e(c.error)})}catch(w){c.doingIt=!1,console.error("Could not submit form",w),e(w.message),p=c.$services.q.defer(),p.reject(w)}else t=c.$services.page.getPageInstance(c.page,c),c.cell.state.event&&(p=t.emit(c.cell.state.event,{})),(null==c.cell.state.autoclose||c.cell.state.autoclose)&&c.$emit("close"),c.cell.state.allowReadOnly&&(c.readOnly=!0),c.doingIt=!1,e()}null==p&&(p=c.$services.q.defer(),p.reject());return p};if(g.then){var m=this.$services.q.defer();b=function(){k().then(m,m)};g.then(b,b);
return m}return k()}},up:function(b){b=this.cell.state.fields.indexOf(b);if(0<b){var c=this.cell.state.fields[b-1];this.cell.state.fields.splice(b-1,1,this.cell.state.fields[b]);this.cell.state.fields.splice(b,1,c)}},down:function(b){b=this.cell.state.fields.indexOf(b);if(b<this.cell.state.fields.length-1){var c=this.cell.state.fields[b+1];this.cell.state.fields.splice(b+1,1,this.cell.state.fields[b]);this.cell.state.fields.splice(b,1,c)}},upAll:function(b){var c=this.cell.state.fields.indexOf(b);
0<c&&(this.cell.state.fields.splice(c,1),this.cell.state.fields.unshift(b))},downAll:function(b){var c=this.cell.state.fields.indexOf(b);c<this.cell.state.fields.length-1&&(this.cell.state.fields.splice(c,1),this.cell.state.fields.push(b))}},watch:{readOnly:function(b){this.$root.$emit(b?"form-closed":"form-opened",this);if(!b&&this.cell.state.autofocus){var c=this;Vue.nextTick(function(){c.$refs.form.$el.querySelector("input").focus()})}}}})};nabu.page.formComponentConstructer("page-form");nabu.page.formComponentConstructer("page-form-configure-all");
Vue.component("page-form-field",{template:"#page-form-field",props:{page:{type:Object,required:!1},cell:{type:Object,required:!1},schema:{type:Object,required:!1},field:{type:Object,required:!0},value:{required:!0},label:{type:Boolean,required:!1,default:!0},timeout:{type:Number,required:!1,default:600},isDisabled:{type:Boolean,required:!1,default:!1},parentValue:{required:!1},readOnly:{type:Boolean,required:!1},schemaResolver:{type:Function,required:!1},validateTimeout:{required:!1},codes:{required:!1},
validateOnBlur:{required:!1}},created:function(){this.field.fixed&&this.$emit("input",this.field.value);if(this.field.listeners&&0<this.field.listeners.length){var a=this,b=a.$services.page.getPageInstance(a.page,a);this.field.listeners.forEach(function(c){a.subscriptions.push(b.subscribe(c.to.replace(/^([^.]+).*/,"$1"),function(d){d=d?a.$services.page.getValue(d,c.to.replace(/^[^.]+[.](.*)/,"$1")):null;a.$emit("input",d);a.validateOnBlur&&setTimeout(a.validate,1)}))})}},data:function(){return{labels:[],
subscriptions:[]}},computed:{definition:function(){return nabu.utils.vue.form.definition(this)},mandatory:function(){return nabu.utils.vue.form.mandatory(this)},fieldLabel:function(){return this.label?this.field.label?this.field.label:null:null}},methods:{blur:function(){this.validateOnBlur&&this.validate()},slowValidate:function(){null!=this.validateTimer&&(clearTimeout(this.validateTimer),this.validateTimer=null);this.validateTimeout&&(this.validateTimer=setTimeout(this.validate,this.validateTimeout))},
usesMultipleFields:function(a){var b=nabu.page.providers("page-form-input").filter(function(c){return c.name==a})[0];return b?b.multipleFields:!1},getProvidedComponent:function(a){var b=nabu.page.providers("page-form-input").filter(function(c){return c.name==a})[0];return b?b.component:null},fieldClasses:function(a){var b=[];b.push("p-"+a.type);a.styles&&(this.$services.page.getPageInstance(this.page,this),nabu.utils.arrays.merge(b,this.$services.page.getDynamicClasses(a.styles,this.state,this)));
return b},validate:function(a){a=nabu.utils.vue.form.validateChildren(this,a);if(this.validator){var b=this.validator(this.value);if(b&&b.length)for(var c=0;c<b.length;c++)b[c].component=this,"undefined"==typeof b[c].context&&(b[c].context=[]),a.push(b[c])}a.then?a.then(this.emitSuccess):this.emitSuccess(a);return a},emitSuccess:function(a){if(a&&!a.length&&(a=nabu.page.event.getName(this.field,"validationSuccessEvent"))){var b=this.$services.page.getPageInstance(this.page,this),c=nabu.page.event.getInstance(this.field,
"validationSuccessEvent",this.page,this);b.emit(a,null==c?{}:c)}}},events:{"$vue.child.added":function(a){a.label?this.labels.push({name:a.label,component:a}):!this.labels.length&&a.labels?nabu.utils.arrays.merge(this.labels,a.labels):this.labels.push(null)}}});
Vue.component("page-form-configure",{template:"#page-form-configure",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},title:{type:String,required:!0},possibleFields:{type:Array,required:!0},fields:{type:Array,required:!0},isList:{type:Function,required:!1},editName:{type:Boolean,required:!1},groupable:{type:Boolean,required:!1,default:!1},schemaResolver:{type:Function,required:!1,default:function(a){return null}},allowReadOnly:{type:Boolean,required:!1},rootTag:{type:String,required:!1,
default:"n-collapsible"},dark:{type:Boolean,required:!1,default:!1},allowPaste:{type:Boolean,required:!1,default:!1}},methods:{up:function(a){a=this.fields.indexOf(a);if(0<a){var b=this.fields[a-1];this.fields.splice(a-1,1,this.fields[a]);this.fields.splice(a,1,b)}},down:function(a){a=this.fields.indexOf(a);if(a<this.fields.length-1){var b=this.fields[a+1];this.fields.splice(a+1,1,this.fields[a]);this.fields.splice(a,1,b)}},upAll:function(a){var b=this.fields.indexOf(a);0<b&&(this.fields.splice(b,
1),this.fields.unshift(a))},downAll:function(a){var b=this.fields.indexOf(a);b<this.fields.length-1&&(this.fields.splice(b,1,replacement),this.fields.push(a))},pasteField:function(a){if(a=this.$services.page.pasteItem("page-form-field"))this.fields||Vue.set(this,"fields",[]),this.fields.push(a)},addField:function(a){a?this.fields.push({arbitrary:!0,route:null,bindings:{}}):this.fields.push({arbitrary:!1,name:null,label:null,description:null,type:null,enumerations:[],value:null,group:null,joinGroup:!1})}}});
Vue.component("page-form-configure-single",{template:"#page-form-configure-single",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},field:{type:Object,required:!0},possibleFields:{type:Array,required:!0},allowLabel:{type:Boolean,required:!1,default:!0},allowDescription:{type:Boolean,required:!1,default:!0},isList:{type:Function,required:!1},groupable:{type:Boolean,required:!1,default:!1},hidable:{type:Boolean,required:!1,default:!1},schema:{type:Object,required:!1},allowReadOnly:{type:Boolean,
required:!1}},created:function(){this.normalize(this.field)},computed:{types:function(){var a=[];this.isList&&this.isList(this.field.name)?nabu.utils.arrays.merge(a,nabu.page.providers("page-form-list-input").map(function(b){return b.name})):(a.push("fixed"),nabu.utils.arrays.merge(a,nabu.page.providers("page-form-input").map(function(b){return b.name})));a.sort();return a}},methods:{getAvailableRowGrouping:function(a){var b=[];this.$services.page.getArisComponentHierarchy("form-group").forEach(function(c){null!=
c.variants&&c.variants.forEach(function(d){0>b.indexOf(d.name)&&b.push(d.name)})});null!=a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b},filterFieldNames:function(a){return this.possibleFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},filterTypes:function(a){return this.types.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},usesMultipleFields:function(a){var b=nabu.page.providers("page-form-input").filter(function(c){return c.name==
a})[0];return b?b.multipleFields:!1},getProvidedConfiguration:function(a){var b=nabu.page.providers(this.isList&&this.isList(this.field.name)?"page-form-list-input":"page-form-input").filter(function(c){return c.name==a})[0];return b?b.configure:null},normalize:function(a){a.hasOwnProperty("name")||Vue.set(a,"name",null);a.hasOwnProperty("label")||Vue.set(a,"label",null);a.hasOwnProperty("description")||Vue.set(a,"description",null);a.hasOwnProperty("type")||Vue.set(a,"type",null);a.enumerations instanceof
Array||Vue.set(a,"enumerations",[]);a.hasOwnProperty("value")||Vue.set(a,"value",null)}}});
Vue.component("page-configure-arbitrary",{template:"#page-configure-arbitrary",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},target:{type:Object,required:!0},keys:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{hasConfigurator:!1}},created:function(){this.target.arbitraryId||Vue.set(this.target,"arbitraryId",Math.random());null==this.target.bindings&&(this.target.bindings={});var a=this,b=this.$services.page.getPageInstance(this.page,this).components[this.cell.id];
this.instance=null;b&&(b.$$arbitraryCellId==this.cell.id?this.instance=b:b instanceof Array&&b.forEach(function(c){c.$$arbitraryCellId==a.cell.id&&c.$$arbitraryId==a.target.arbitraryId&&(a.instance=c)}),this.hasConfigurator=null!=this.instance&&this.instance.configurator)},computed:{availableParameters:function(){var a=this.$services.page.getAvailableParameters(this.page,this.cell,!0);this.keys instanceof Array&&(a.record={properties:{}},this.keys.forEach(function(b){a.record.properties[b]={type:"string"}}));
return a}},methods:{getTargetParameters:function(a){a=this.$services.page.getRouteParameters(this.$services.router.get(a.route));a.properties&&(delete a.properties.cell,delete a.properties.page,delete a.properties.edit,delete a.properties.component);return a},filterRoutes:function(a){var b=this.$services.router.list().filter(function(c){return c.alias&&(!a||0<=c.alias.toLowerCase().indexOf(a.toLowerCase()))});b.sort(function(c,d){return c.alias.localeCompare(d.alias)});return b.map(function(c){return c.alias})},
getCellConfigurator:function(a){return this.instance?this.instance.configurator():"div"},getCellConfiguratorInput:function(a){var b={};if(this.instance){var c=this;this.instance.$options.props&&Object.keys(this.instance.$options.props).forEach(function(d){b[d]=c.instance[d]})}return b}}});
Vue.component("page-arbitrary",{template:"#page-arbitrary",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},target:{type:Object,required:!0},component:{type:Object,required:!0},edit:{type:Boolean,required:!1},record:{type:Object,required:!1}},data:function(){return{instance:null}},methods:{handle:function(){},getParameters:function(){var a=nabu.utils.objects.clone(this.cell);a.state=this.target;var b={page:this.page,cell:a,component:this.component,edit:this.edit};if(this.target.bindings){var c=
this,d=c.$services.page.getPageInstance(c.page,c);Object.keys(this.target.bindings).forEach(function(e){if(c.target.bindings[e])if(0==c.target.bindings[e].indexOf("record.")){var g=c.record?c.$services.page.getValue(c.record,c.target.bindings[e].substring(7)):null;null!=g&&(b[e]=g)}else b[e]=c.$services.page.getBindingValue(d,c.target.bindings[e])})}return b},created:function(a){this.$services.page.rendering++},mounted:function(a){this.instance=a;var b=this.$services.page.getPageInstance(this.page,
this);b.mounted(this.cell,null,null,a);this.instance.getEvents&&b.resetEvents();a.$$arbitraryCellId=this.cell.id;a.$$arbitraryId=this.target.arbitraryId},validate:function(a){if(this.instance&&this.instance.validate)return this.instance.validate(a)}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.FormComponentGenerator=function(a){return Vue.component(a,{template:"#"+a,props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},childComponents:{type:Object,required:!1},formComponent:{type:String,required:!1,default:"page-form-input-text"},configurationComponent:{type:String,required:!1,default:"page-form-input-text-configure"},edit:{type:Boolean},subTabs:{type:Array}},computed:{pageInstance:function(){return this.$services.page.getPageInstance(this.page,this)},computedValue:function(){return this.cell.state.useComputed&&
this.cell.state.computed?this.$services.page.eval(this.cell.state.computed,{},this):null},placeholder:function(){if(this.editable){if(this.language&&this.cell.state.translatable&&this.translationArrayPath){var b=this.pageInstance;b=b&&this.cell.state.name?b.get("page."+this.cell.state.name):null;if(null!=b)return b}return this.$services.page.interpret(this.$services.page.translate(this.cell.state.placeholder),this)}return this.$services.page.interpret(this.$services.page.translate(this.cell.state.defaultValue),
this)},value:function(){var b=this.pageInstance;if(this.language&&this.cell.state.translatable&&this.translationArrayPath){var c=this;b=b.get(c.translationArrayPath);if(null!=b){var d=this.cell.state.name.replace(/.*?\.([^.]+)$/,"$1");if(b=b.filter(function(e){return e.name==d&&e.language==c.language})[0])return b.translation}return null}return b&&this.cell.state.name?b.get("page."+this.cell.state.name):null},parentValue:function(){var b=this.pageInstance;return b?b.variables:null},disabled:function(){if(null!=
this.language&&!this.cell.state.translatable||this.running)return!0;var b=this.pageInstance;if(!b)return!0;b=this.$services.page.getPageState(b);return!!this.cell.state.disabled&&this.$services.page.isCondition(this.cell.state.disabled,b,this,null,!0)},readOnly:function(){if(this.cell.state.readOnly)return!0;if(this.cell.state.readOnlyCondition){var b=this.pageInstance;if(!b)return!0;b=this.$services.page.getPageState(b);return this.$services.page.isCondition(this.cell.state.readOnlyCondition,b,this,
null,!0)}b="readOnly";this.cell.state.customReadOnlyState&&(b=this.cell.state.customReadOnlyState);if(0<=this.getCurrentStates().indexOf(b))return!0;if(b=this.pageInstance&&this.pageInstance.fragmentParent?this.$services.page.getTargetPath(this.pageInstance.fragmentParent.page.content,this.cell.id,!0):this.$services.page.getTargetPath(this.page.content,this.cell.id,!0)){var c=this,d=null;b.forEach(function(e){"form"==e.renderer&&e.form&&(e.runtimeAlias&&c.pageInstance&&(d=c.pageInstance.get("page."+
e.runtimeAlias+".readOnly")),null==d&&e.form.readOnly&&(d=!0))});if(d)return d}return!1}},watch:{value:function(){this.computed?this.value instanceof Array&&this.notifyUpdate(this.value,this.value):this.computed=!0},readOnly:function(b){this.editable=!b}},created:function(){this.initializeArray();this.cell.state.rawName&&this.getPageInstance().set("page."+this.cell.state.rawName,null);this.editable=!this.readOnly;this.calculateInitialLanguage()},ready:function(){var b=this;this.$refs.input.$on("hook:beforeDestroy",
function(){b.$destroy()})},data:function(){return{running:!1,editable:!0,computed:!1,language:null,translationArrayPath:null}},methods:{calculateInitialLanguage:function(){var b=this.pageInstance&&this.pageInstance.fragmentParent?this.$services.page.getTargetPath(this.pageInstance.fragmentParent.page.content,this.cell.id,!0):this.$services.page.getTargetPath(this.page.content,this.cell.id,!0);if(b){var c=this,d=null;b.forEach(function(e){"form"==e.renderer&&e.form&&e.runtimeAlias&&c.pageInstance&&
(d=c.pageInstance.get("page."+e.runtimeAlias+".language"),c.translationArrayPath="page."+e.runtimeAlias+".translations")});null!=d&&(this.language=d)}},getPrettyName:function(b){if(b.state&&(b=b.state.label?b.state.label:b.state.placeholder,null!=b))return b=b.trim(),"{"==b.substring(0,1)&&(b=b.substring(1)),"}"==b.substring(b.length-1)&&(b=b.substring(0,b.length-1)),b=this.$services.page.prettify(b)},initializeArray:function(){null==this.value&&this.cell.state.initializeArray&&this.isArrayField()&&
(this.computed=!1,this.update([]))},isArrayField:function(){var b=this.$services.page.getAllArrays(this.page,this);return this.cell.state.name&&(0<=b.indexOf(this.cell.state.name)||0<=b.indexOf("page."+this.cell.state.name))?!0:!1},getTriggers:function(){return{update:{},blur:{}}},getAvailableSubTabs:function(){var b=["component"];this.subTabs&&nabu.utils.arrays.merge(b,this.subTabs);b.push("form");b.push("validation");return b},getEvents:function(){return this.$services.triggerable.getEvents(this.page,
this.cell.state)},isRequired:function(){return"condition"==this.cell.state.required?this.$services.page.isCondition(this.cell.state.requiredCondition,{},this):this.cell.state.required},getChildComponents:function(){var b=[];this.$refs.input&&this.$refs.input.getChildComponents&&nabu.utils.arrays.merge(b,this.$refs.input.getChildComponents());0==b.length&&b.push({title:"Form Component",name:"form-component",component:"form-component"});return b},configurator:function(){return"nabu-form-component-configuration"},
getPageInstance:function(){return this.$services.page.getPageInstance(this.page,this)},isDisabled:function(){var b=this.$services.page.getPageInstance(this.page,this);b=this.$services.page.getPageState(b);return!!this.cell.state.disabled&&this.$services.page.isCondition(this.cell.state.disabled,b,this)},getSchema:function(){if(!this.edit&&this.schemaResolved)return this.schema;if(!this.cell.state.name)return null;var b=function(e,g,k){e.items&&(e=e.items);var m=e.properties;if(m&&m[g[k]]){if(k<g.length-
1)return b(m[g[k]],g,k+1);m=m[g[k]];m.required=m.required||e.required&&0<=e.required.indexOf(g[k]);return m}},c=this.$services.page.getPageParameters(this.page),d=this.cell.state.name.split(".");c=c?b(c,d,0):null;this.edit||(this.schema=c,this.schemaResolved=!0);return c},availableFields:function(b){var c=[],d=this.$services.page.getPageParameters(this.page);nabu.utils.arrays.merge(c,this.$services.page.getSimpleKeysFor(d,!0,!0));c.sort();b&&(c=c.filter(function(e){return 0<=e.toLowerCase().indexOf(b.toLowerCase())}));
return c},updateLabel:function(b){this.getPageInstance().setLabel("page."+this.cell.state.name,b)},update:function(b,c,d){if(this.cell.state.name){var e=this.getPageInstance(),g=!1;if(null!=this.language){if(this.cell.state.translatable&&this.translationArrayPath){var k=this;g=e.get(k.translationArrayPath);null==g&&(g=[],e.set(k.translationArrayPath,g));var m=this.cell.state.name.replace(/.*?\.([^.]+)$/,"$1");e=g.filter(function(p){return p.name==m&&p.language==k.language})[0];null==e&&null!=b&&(e=
{name:m,language:k.language,translation:null},g.push(e));g=e.translation!=b;e.translation=b}}else g=b!==e.get("page."+this.cell.state.name),e.set("page."+this.cell.state.name,b,c),this.cell.state.rawName&&e.set("page."+this.cell.state.rawName,null!=d?d:b,c);g&&this.notifyUpdate(b,c,d)}else this.notifyUpdate(b,c,d)},notifyUpdate:function(b,c,d){var e=this,g=[];e.cell.state.triggers&&nabu.utils.arrays.merge(g,e.cell.state.triggers);e.cell.triggers&&nabu.utils.arrays.merge(g,e.cell.triggers);if(0<g.length){e.cell.state.lockDuringTrigger&&
(this.running=!0);var k=function(){e.running=!1};Vue.nextTick(function(){setTimeout(function(){e.$services.triggerable.trigger({triggers:g},"update",{value:b,rawValue:d},e).then(k,k);e.$emit("update",b,c,e.cell.state.name)},1)})}else e.$emit("update",b,c,e.cell.state.name)},validate:function(){if(this.$refs&&this.$refs.input)return this.$refs.input.validate()},blur:function(){this.cell.state.validateOnBlur&&this.validate();this.$services.triggerable.trigger({triggers:this.cell.triggers},"blur",{},
this)}}})};nabu.page.views.FormComponent=nabu.page.views.FormComponentGenerator("nabu-form-component");nabu.page.views.FormComponentGenerator("nabu-form-component-configuration");var nabu_form_dynamic_component_counter=0;
Vue.view("nabu-form-dynamic-component",{mixins:[Vue.component("data-mixin")],data:function(){return{localCounter:nabu_form_dynamic_component_counter++,removed:{},array:null,updatingSelf:!1}},props:{readOnly:{type:Boolean},disabled:{type:Boolean}},computed:{typeField:function(){return"type"},nameField:function(){return"key"},labelField:function(){return"label"},targetKeyField:function(){return"key"},targetValueField:function(){return"value"},parentValue:function(){var a=this.$services.page.getPageInstance(this.page,
this);return a&&this.cell.state.name?a.get("page."+this.cell.state.name):null}},methods:{getChildComponents:function(){return[{title:"Form container",name:"dynamic-field-container",component:"column"}]},postProcess:function(a){var b=this.getArray(),c=this,d=[];a.forEach(function(e){var g=e[c.nameField],k=b.filter(function(m){return m[c.targetKeyField]==g})[0];null==k&&(k={},k[c.targetKeyField]=g,k[c.targetValueField]=null==c.removed[g]?null:c.removed[g],b.push(k));d.push(e[c.targetKeyField])});b.filter(function(e){return 0>
d.indexOf(e[c.targetKeyField])}).forEach(function(e){c.removed[e[c.targetKeyField]]=e[c.targetValueField];b.splice(b.indexOf(e),1)});return a},configurator:function(){return"nabu-form-dynamic-component-configure"},getLabelFor:function(a){var b=this.labelField;null==b&&(b=this.nameField);return this.$services.page.translate(a[b])},getComponentFor:function(a){var b=a[this.typeField];a=a[this.nameField];if(this.cell.state.custom){var c=this.cell.state.custom.filter(function(e){return e.component&&e.name==
b})[0];if(c){var d=nabu.page.providers("page-form-input").filter(function(e){return e.name==c.component})[0];if(d)return d.component}}return"boolean"==b?"page-form-input-checkbox":"date"==b?"page-form-input-date":"string"==b&&a&&0<=a.toLowerCase().indexOf("password")?"page-form-input-password":"page-form-input-text"},getParametersFor:function(a){var b=a[this.typeField];return this.cell.state.custom&&(a=this.cell.state.custom.filter(function(c){return c.name==b})[0])?{state:a.configuration}:{state:{}}},
getTargetFor:function(a){var b=a[this.nameField],c=this;return this.getArray().filter(function(d){return d[c.targetKeyField]==b})[0]},getValueFor:function(a){return(a=this.getTargetFor(a))?a[this.targetValueField]:null},update:function(a,b,c){this.updatingSelf=!0;a=this.getTargetFor(a);Vue.set(a,this.targetValueField,b)},getArray:function(a){if(!this.array||a){var b=(a=this.$services.page.getPageInstance(this.page,this))&&this.cell.state.name?a.get("page."+this.cell.state.name):null;if(null==b)this.cell.state.stringified?
(b="{}",Vue.set(this,"array",[])):(b=[],Vue.set(this,"array",b)),(a=this.$services.page.getPageInstance(this.page,this))&&a.set("page."+this.cell.state.name,b);else if(this.cell.state.stringified){var c=JSON.parse(b),d=[];Object.keys(c).forEach(function(e){d.push({key:e,value:c[e]})});Vue.set(this,"array",d)}else Vue.set(this,"array",b)}return this.array},getParentValue:function(){var a=this.$services.page.getPageInstance(this.page,this);return a?a.variables:null}},watch:{parentValue:function(){this.updatingSelf?
this.updatingSelf=!1:this.getArray(!0)},array:{deep:!0,handler:function(){if(this.cell.state.stringified){var a={};this.array.forEach(function(c){null!=c.value&&(a[c.key]=c.value)});var b=this.$services.page.getPageInstance(this.page,this);b&&b.set("page."+this.cell.state.name,JSON.stringify(a,null,2))}}}}});
Vue.component("nabu-form-dynamic-component-configure",{template:"#nabu-form-dynamic-component-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.cell.state.custom||Vue.set(this.cell.state,"custom",[])},methods:{getCustomConfiguration:function(a){var b=nabu.page.providers("page-form-input").filter(function(c){return c.name==a.component})[0];
b=b&&b.configure?b.configure:a.component+"-configure";return Vue.component(b)?b:null},getAvailableComponents:function(a){return nabu.page.providers("page-form-input").filter(function(b){return!a||0<=b.name.toLowerCase().indexOf(a.toLowerCase())})},availableFields:function(a){if(this.cell.state.stringified){var b=[],c=this.$services.page.getPageParameters(this.page);nabu.utils.arrays.merge(b,this.$services.page.getSimpleKeysFor(c,!0,!0));b.sort();a&&(b=b.filter(function(d){return 0<=d.toLowerCase().indexOf(a.toLowerCase())}));
return b}c=this.$services.page.getAllArrays(this.page);c.sort();a&&(c=c.filter(function(d){return 0<=d.toLowerCase().indexOf(a.toLowerCase())}));return c}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
Vue.component("custom-validator-edit",{template:"#custom-validator-edit",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0}},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}},methods:{getOperationParameters:function(a,b){if(!this.$services.swagger.operations[a])return[];var c=this.$services.swagger.operations[a].parameters;return b?this.$services.page.getSwaggerParametersAsKeys(this.$services.swagger.operations[a]):
c?c.map(function(d){return d.name}):[]},getOperations:function(a){var b=Object.keys(this.$services.swagger.operations);a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},addValidation:function(){this.cell.state.validations||Vue.set(this.cell.state,"validations",[]);this.cell.state.validations.push({label:null,code:"error",condition:null,message:null,bindings:{}})},deleteValidation:function(a){this.cell.state.validations.splice(this.cell.state.validations.indexOf(a),
1)}}});
Vue.view("custom-validator",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},data:{required:!1},shouldStyle:{type:Boolean,required:!1,default:!0},label:{type:Boolean,required:!1,default:null},localState:{type:Object,required:!1},fieldsName:{type:String,required:!1,default:"fields"}},data:function(){return{configuring:!1,messages:[],subscriptions:[]}},created:function(){var a=this,b=a.$services.page.getPageInstance(a.page,a);
this.cell.state.validations&&this.cell.state.validations.forEach(function(c){c.resetListeners&&c.resetListeners.forEach(function(d){console.log("subscribing to ",d);a.subscriptions.push(b.subscribe(d.to,function(){a.messages.splice(0)}))})})},beforeDestroy:function(){this.subscriptions.map(function(a){a()})},methods:{getEvents:function(){var a=this,b={};this.cell.state.validations&&this.cell.state.validations.forEach(function(c){if(c.operationId&&c.operationSuccessEvent){var d=a.$services.swagger.operations[c.operationId].responses["200"],
e=null;d&&d.schema&&(e=a.$services.swagger.resolve(d.schema));b[c.operationSuccessEvent]=e?e:{}}});return b},configurator:function(){return"custom-validator-edit"},validate:function(a){Vue.set(this,"messages",[]);nabu.utils.schema.addAsyncValidation(this.messages);if(this.cell.state.validations){var b=this,c=b.$services.page.getPageInstance(b.page,b),d=this.$services.page.getPageState(c);this.cell.state.validations.forEach(function(e){if(null!=e.operationId){var g=b.$services.q.defer();b.messages.defer(g);
var k={};Object.keys(e.bindings).map(function(m){b.$services.page.setValue(k,m,b.$services.page.getBindingValue(c,e.bindings[m],b))});b.$services.swagger.execute(e.operationId,k).then(function(m){var p=[];m&&(e.operationSuccessEvent&&c.emit(e.operationSuccessEvent,m),Object.keys(m).forEach(function(t){m[t]instanceof Array&&0<m[t].length&&0==p.length&&m[t][0].severity&&nabu.utils.arrays.merge(p,m[t])}));e.condition&&(d.response=m,b.$services.page.isCondition(e.condition,d,b)&&p.push({severity:"error",
code:e.code?e.code:"custom",title:e.message?b.$services.page.translate(e.message):"%{An error has occured}",priority:1,variables:{},context:[]}));if(e.codes){var q=e.codes.map(function(t){return{code:t.code,title:b.$services.page.translate(t.title)}});nabu.utils.vue.form.rewriteCodes(p,q)}g.resolve(p)},g)}else e.condition&&b.$services.page.isCondition(e.condition,d,b)&&b.messages.push({severity:"error",code:e.code?e.code:"custom",title:e.message?b.$services.page.translate(e.message):"%{An error has occured}",
priority:1,variables:{},context:[]})})}return this.messages}}});Vue.view("default-offline",{alias:"offline",priority:-50,url:"/offline",props:{message:{type:String,default:"%{Sorry, we're down for scheduled maintenance right now.}"},recover:{type:String,default:"%{You can\x26nbsp;\x3ca class\x3d'is-color-link' href\x3d'javascript:void()' @click\x3d'location.reload()'\x3eretry\x3c/a\x3e.}"}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
Vue.view("typography-richtext",{template:"#typography-richtext",icon:"modules/richtext/logo.svg",description:"The rich text component can be used to write static texts with markup",name:"Rich Text",category:"Typography",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){console.log("editing?",this.edit);this.edit&&!this.cell.state.content&&Vue.set(this.cell.state,"content","")},methods:{configurator:function(){return"typography-richtext-configure"},
update:function(a){this.timer&&(clearTimeout(this.timer),this.timer=null);var b=this;this.timer=setTimeout(function(){b.cell.state.content=nabu.utils.elements.sanitize(a)},100)}}});Vue.view("typography-richtext-configure",{template:"#typography-richtext-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.Code=Vue.extend({template:"#page-code",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},localState:{type:Object,required:!1}},created:function(){this.normalize(this.cell.state)},data:function(){return{configuring:!1,state:{}}},methods:{configure:function(){this.configuring=!0},normalize:function(a){a.content||Vue.set(a,"content",null)},highlight:function(a){var b=nabu.page.providers("page-format").filter(function(c){return"highlight"==
c.name})[0];return b?b.format(a):a}}});
Vue.view("nabu-console",{props:{initialTab:{type:String,default:"features"}},data:function(){return{selected:null,search:null,tab:"features"}},computed:{enabledFeatures:function(){var a=this;return this.$services.page.availableFeatures.filter(function(b){return 0<=a.$services.page.enabledFeatures.indexOf(b.name)})},disabledFeatures:function(){var a=this;return this.$services.page.availableFeatures.filter(function(b){return 0>a.$services.page.enabledFeatures.indexOf(b.name)})},cleanedUpContent:function(){if(this.$services.page.inspectContent){var a=
0,b=this.$services.page.inspectContent;b=b.replace(/(\x3c!----\x3e)/g,"");for(var c=b.lastIndexOf("\x3c");0<=c;){var d="/"==b.substring(c+1,c+2);d||a--;for(var e="",g=0;g<a;g++)e+="\t";b=b.substring(0,c)+e+"\x26lt;"+b.substring(c+1);d&&a++;c=b.lastIndexOf("\x3c")}b=b.replace(/(&lt;[^/>]*)>[\s]*([^>]+?)[\s]*(&lt;\/)/g,"$1\x26gt;$2$3");b=b.replace(/>/g,"\x26gt;\n");return b=b.replace(/(&lt;.*?&gt;)/g,"\x3cspan class\x3d'console-highlight-tag'\x3e$1\x3c/span\x3e")}return"No content to inspect"}},created:function(){this.tab=
this.initialTab},methods:{isHidden:function(a){if(this.search){var b=this,c=function(d){return d&&d.toLowerCase().match(new RegExp(b.search.replace("*",".*"),"mi"))};return!(c(a.source)||c(a.type)||c(JSON.stringify(a.properties)))}return!1},resetFeatures:function(){this.$services.page.enabledFeatures.splice(0);nabu.utils.arrays.merge(this.$services.page.enabledFeatures,this.$services.page.availableFeatures.filter(function(a){return a.enabled}).map(function(a){return a.name}));this.$services.page.toggledFeatures.splice(0);
this.$services.swagger.toggledFeatures&&this.$services.swagger.toggledFeatures.splice(0)},enableFeature:function(a){var b=this.$services.page.availableFeatures.filter(function(d){return d.name==a.name})[0],c=this.$services.page.toggledFeatures.filter(function(d){return d.name==a.name})[0];c&&this.$services.page.toggledFeatures.splice(this.$services.page.toggledFeatures.indexOf(c),1);this.$services.page.enabledFeatures.push(b.name);b&&!b.enabled&&this.$services.page.toggledFeatures.push({name:a.name,
description:a.description,enabled:!0});this.$services.swagger.toggledFeatures&&(this.$services.swagger.toggledFeatures.splice(0),nabu.utils.arrays.merge(this.$services.swagger.toggledFeatures,this.$services.page.toggledFeatures))},disableFeature:function(a){var b=this.$services.page.availableFeatures.filter(function(d){return d.name==a.name})[0],c=this.$services.page.toggledFeatures.filter(function(d){return d.name==a.name})[0];c&&this.$services.page.toggledFeatures.splice(this.$services.page.toggledFeatures.indexOf(c),
1);c=this.$services.page.enabledFeatures.indexOf(b.name);0<=c&&this.$services.page.enabledFeatures.splice(c,1);b&&b.enabled&&this.$services.page.toggledFeatures.push({name:a.name,description:a.description,enabled:!1});this.$services.swagger.toggledFeatures&&(this.$services.swagger.toggledFeatures.splice(0),nabu.utils.arrays.merge(this.$services.swagger.toggledFeatures,this.$services.page.toggledFeatures))}}});
Vue.view("page-video",{category:"Content",name:"Video",description:"Add a video",icon:"page/core/images/image.svg",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},href:{type:String,required:!1}},activate:function(a){var b=this,c=[];this.edit&&c.push(this.load());if(this.cell.state.inline&&(this.cell.state.href||this.href)){b=this;var d=this.cell.state.href?this.cell.state.href:this.href;0!=d.indexOf("http://")&&
0!=d.indexOf("https://")&&0!=d.indexOf("/")&&(d="/"+d);nabu.utils.ajax({url:d}).then(function(e){b.inlineContent=e.responseText})}this.$services.q.all(c).then(a,a)},created:function(){this.normalize(this.cell.state)},data:function(){return{configuring:!1,images:[],files:[],inlineContent:null}},computed:{fullHref:function(){var a=null;this.href?a=this.href:this.cell.state.href&&(a=this.cell.state.href);a&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&"/"!=a.substring(0,1)&&(a="/"+a);a&&
"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&this.cell.state.absolute?a="${environment('url')}"+a:a&&"http://"!=a.substring(0,7)&&a.substring(0,8);return a}},methods:{load:function(){var a=this;return this.$services.swagger.execute("nabu.web.page.core.rest.resource.list",{path:this.cell.state.videoPath}).then(function(b){a.images.splice(0,a.images.length);b&&b.resources&&nabu.utils.arrays.merge(a.images,b.resources)})},upload:function(){var a=this;this.$services.swagger.execute("nabu.web.page.core.rest.resource.create",
{path:this.cell.state.videoPath,body:this.files[0]}).then(function(b){a.load();b&&b.relativePath&&(a.cell.state.href=b.relativePath);a.files.splice(0,a.files.length)})},configure:function(){this.configuring=!0},normalize:function(a){a.href||Vue.set(a,"href",null);a.title||Vue.set(a,"title",null);a.height||Vue.set(a,"height","15rem");a.videoPath||Vue.set(a,"videoPath","videos")}},watch:{"cell.state.videoPath":function(){this.load()}}});nabu||={};nabu.page||(nabu.page={});
nabu.page.views||(nabu.page.views={});
nabu.page.views.Youtube=Vue.extend({template:"#page-youtube",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},localState:{type:Object,required:!1}},data:function(){return{configuring:!1}},created:function(){var a=this,b=setInterval(function(){var c=document.activeElement;c&&c==a.$refs.iframe&&(clearInterval(b),a.analyze())},100)},computed:{url:function(){if(this.cell.state.url){var a=this.cell.state.url,b=null;
a.match(/\\?v=/)?b=a.replace(/^.*\\?v=([^&]+).*/,"$1"):a.match(/.*youtu\.be/)&&(b=a.replace(/^.*youtu\.be\/(.*)+/,"$1"));null!=b&&(a="https://www.youtube.com/embed/"+b);this.cell.state.hideControls&&(a+="?controls\x3d0");return a}return null}},methods:{configure:function(){this.configuring=!0},analyze:function(){this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"media",type:"media-view",event:"youtube",url:this.url});this.$services.analysis&&
this.$services.analysis.emit&&this.$services.analysis.emit("watch-youtube",this.url,null,!0)}}});
Vue.view("page-share-social",{props:{page:{type:Object,required:!0},cell:{type:Object,required:!0}},data:function(){return{configuring:!1}},methods:{configure:function(){this.cell.state.share||Vue.set(this.cell.state,"share",[]);this.configuring=!0},analyze:function(a){this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"social",type:"social-share",event:a});this.$services.analysis&&this.$services.analysis.emit&&this.$services.analysis.emit("share-"+
a,{url:window.location},null,!0)},generateLink:function(a){var b=this.cell.state.link?0==this.cell.state.link.indexOf("http:")||0==this.cell.state.link.indexOf("https:")?encodeURIComponent(this.cell.state.link):0==this.cell.state.link.indexOf("/")?encodeURIComponent(window.location.protocol+"//"+window.location.host+this.cell.state.link):encodeURIComponent(window.location.protocol+"//"+window.location.host+"/"+this.cell.state.link):encodeURIComponent(window.location);var c=[],d=null;"facebook"==a?
d="https://www.facebook.com/sharer/sharer.php?u\x3d"+b:"twitter"==a?(d="http://twitter.com/share?url\x3d"+b,null!=c&&c.length&&(d+="\x26hashtags\x3d"+c.join(","))):"google-plus"==a?d="https://plus.google.com/share?url\x3d"+b:"linkedin"==a?d="https://www.linkedin.com/shareArticle?mini\x3dtrue\x26url\x3d"+b:"email"==a?d="mailto:?subject\x3d"+b:"pinterest"==a&&(d="https://pinterest.com/pin/create/button/?url\x3d"+b);return d}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.PageAddCell=Vue.extend({template:"#page-add-cell",props:{page:{type:Object,required:!0}},data:function(){return{route:null,bindings:{},target:"page",on:null}},computed:{availableEvents:function(){var a=nabu.utils.objects.clone(this.$services.page.instances[this.page.name].getEvents());return Object.keys(a)},parameters:function(){return this.route?this.$services.page.getRouteParameters(this.route):[]},availableParameters:function(){var a=nabu.utils.objects.clone(this.$services.page.instances[this.page.name].getEvents()),
b={};this.on&&(b[this.on]=a[this.on]);b.page=this.$services.page.getPageParameters(this.page);return b}},methods:{filterRoutes:function(a){var b=this.$services.router.list().filter(function(c){return c.alias&&(!a||0<=c.alias.toLowerCase().indexOf(a.toLowerCase()))});b.sort(function(c,d){return c.alias.localeCompare(d.alias)});return b},set:function(){this.$resolve({alias:this.route.alias,bindings:this.bindings,target:this.on?this.target:"page",on:this.on})}}});
Vue.view("page-components-selector",{props:{components:{type:Array,required:!0}}});
Vue.component("page-components-overview",{template:"#page-components-overview",computed:{structures:function(){return nabu.page.providers("page-structure")},components:function(){var a=this.$services.router.router.routes.filter(function(b){return b.icon&&b.name});nabu.utils.arrays.merge(a,this.$services.page.templates);return a},componentCategories:function(){var a=[];this.components.forEach(function(b){b.category&&0>a.indexOf(b.category)?a.push(b.category):null==b.category&&0>a.indexOf("Miscellaneous")&&
a.push("Miscellaneous")});a.sort(function(b,c){return b.toLowerCase().localeCompare(c.toLowerCase())});return a},templateCategories:function(){var a=[];this.$services.page.templates.forEach(function(b){b.category&&0>a.indexOf(b.category)?a.push(b.category):null==b.category&&0>a.indexOf("Miscellaneous")&&a.push("Miscellaneous")});a.sort(function(b,c){return b.toLowerCase().localeCompare(c.toLowerCase())});return a}},data:function(){return{selected:"components",operationSearch:null,templateSearch:null,
componentSearch:null}},methods:{hasAnyOperationMatch:function(a,b){if(!this.operationSearch)return!0;var c=[];b?c.push(b.id):nabu.utils.arrays.merge(c,this.getOperationCategory(a).map(function(e){return e.id}));var d=new RegExp(this.operationSearch.toLowerCase().replace(/[\s]+/g,".*"));return 0<c.filter(function(e){return!!e.toLowerCase().match(d)}).length},getOperationIds:function(){return Object.keys(this.$services.swagger.operations).filter(function(a){return 0>a.indexOf("nabu.cms.dynamic.")&&
0>a.indexOf("nabu.web.page.")&&0>a.indexOf("nabu.page.")&&"nabu.passwordProtect"!=a})},getOperationCategories:function(){var a=this,b=[];this.getOperationIds().forEach(function(c){(c=a.$services.swagger.operations[c])&&c.tags&&c.tags.forEach(function(d){0>b.indexOf(d)&&b.push(d)})});b.sort();return b},getOperationCategory:function(a){var b=this,c=[];this.getOperationIds().forEach(function(d){(d=b.$services.swagger.operations[d])&&d.tags&&0<=d.tags.indexOf(a)&&c.push(d)});return c},dragOperation:function(a,
b){this.$services.page.setDragData(a,"operation",b.id)},prettyPrintOperation:function(a){return this.$services.page.prettify(a.replace(/.*\.([^.]+)\.([^.]+)$/,"$2"))},operationFolder:function(a){return a.replace(/(.*)\.[^.]+$/,"$1")},getTemplateCategory:function(a){return this.$services.page.templates.filter(function(b){return b.category==a||"Miscellaneous"==a&&null==b.category})},getComponentCategory:function(a){return this.components.filter(function(b){return b.category==a||"Miscellaneous"==a&&
null==b.category})},dragComponent:function(a,b){!b.alias&&b.content?this.dragTemplate(a,b):(this.$services.page.setDragData(a,"component-alias",b.alias),b.form&&this.$services.page.setDragData(a,"form-name",b.form))},dragTemplate:function(a,b){this.$services.page.setDragData(a,"template-content",b.content)},prettyPrint:function(a){a=a.replace(/([A-Z]+)/," $1");return a.substring(0,1).toUpperCase()+a.substring(1)}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.mixins||(nabu.page.mixins={});Vue.component("shortkey",{template:"#page-shortkey",props:{ctrl:{type:Boolean,default:!1},alt:{type:Boolean,default:!1}}});
Vue.mixin({props:{localState:{type:Object,required:!1},pageInstanceId:{type:Number,required:!1}},data:function(){return{runtimeId:null}},computed:{$self:function(){return this}},beforeDestroy:function(){var a=this.$$target;a||(a=this.$$cell);a&&a.triggers&&this.$services.triggerable.untrigger(a,null,this);a&&a.state&&a.state.triggers&&this.$services.triggerable.untrigger(a.state,null,this)},methods:{getPotentialStates:function(){return this.$parent?this.$parent.getPotentialStates():[]},getCurrentStates:function(){return this.$parent?
this.$parent.getCurrentStates():[]},getChildComponentClasses:function(a){var b=[];this.childComponents&&this.childComponents[a]&&this.childComponents[a].classes&&nabu.utils.arrays.merge(b,this.childComponents[a].classes);var c=this;this.getCurrentStates().forEach(function(d){var e=a+"--"+d;c.childComponents&&c.childComponents[e]&&c.childComponents[e].classes&&nabu.utils.arrays.merge(b,c.childComponents[e].classes);b.push("is-"+d)});return b},$updateEvents:function(){if(this.page){var a=this.$services.page.getPageInstance(this.page,
this);a&&a.resetEvents()}},$is:function(a){return 0<=this.getCurrentStates().indexOf(a)},$value:function(a,b){b||=application&&application.configuration&&(null==application.configuration.interpretValues||0==application.configuration.interpretValues);var c=null;this.page?(c=this.$services.page.getPageInstance(this.page,this),c=this.$services.page.getBindingValue(c,a)):0==a.indexOf("application.")&&(c=(c=this.$services.page.properties.filter(function(d){return d.key==a.substring(12)})[0])?c.value:null);
return b?c:this.$services.page.parseValue(c)}}});nabu.page.mixins.renderer={created:function(){this.$services.page.getPageInstance(this.page,this).mountRenderer(this.target,this)}};
nabu.page.views.Page=Vue.component("n-page",{template:"#nabu-page",props:{fragmentParent:{type:Object,required:!1},page:{type:Object,required:!0},parameters:{type:Object,required:!1,default:function(){return{}}},embedded:{type:Boolean,required:!1},editable:{type:Boolean,required:!1},masked:{typed:Boolean,required:!1},stopRerender:{type:Boolean,required:!1,default:!1},pageInstanceId:{required:!1,default:function(){return application.services.page.pageCounter++}},recordIndex:{type:Number},$setValue:{type:Function,
required:!1}},activate:function(a){this.page.content.path&&(document.body.setAttribute("page",this.page.name),document.body.setAttribute("category",this.page.content.category),document.body.setAttribute("page-type",this.page.content.pageType?this.page.content.pageType:"page"));var b=this,c=function(){b.oldTitle=document.title;document.title=b.$services.page.templateTitle(b.page);b.page.content.autoRefresh&&(b.autoRefreshTimeout=setTimeout(function(){if(!b.edit&&!b.$services.page.wantEdit){var m=nabu.utils.router.self(b.$el);
b.$services.router.route(b.$services.page.alias(b.page),b.parameters,m)}},parseInt(b.page.content.autoRefresh)));b.initializeDefaultParameters();b.page.content.initialEvents&&b.page.content.initialEvents.forEach(function(m){b.fireInitialEvent(m)});b.page.content.parameters&&b.page.content.parameters.forEach(function(m){null!=m.name&&m.defaults&&m.defaults.length&&m.defaults.forEach(function(p){if(p.query&&p.value&&null==b.$services.page.getValue(b.variables[m.name],p.query)){null==b.variables[m.name]&&
Vue.set(b.variables,m.name,{});var q=b.$services.page.parseValue(b.$services.page.translate(b.$services.page.interpret(p.value,b)));b.$services.page.setValue(b.variables[m.name],p.query,q)}})});b.registerStateListeners();a()};if(this.page.content.states.length){this.page.content.states.filter(function(m){return!!m.name&&m.inherited}).forEach(function(m){Vue.set(b.variables,m.name,nabu.utils.objects.clone(b.$services.page.variables[m.applicationName]));b.$watch("$services.page.variables."+m.applicationName,
function(p){b.variables[m.name]?b.$services.page.mergeObject(b.variables[m.name],p):Vue.set(b.variables,m.name,p);nabu.page.event.getName(m,"updateEvent")&&b.emit(nabu.page.event.getName(m,"updateEvent"),nabu.page.event.getInstance(m,"updateEvent",b.page,b))},{deep:!1})});this.page.content.states.filter(function(m){return!!m.name&&!m.inherited&&m.enableParameterWatching}).forEach(function(m){var p=null;Object.keys(m.bindings).map(function(q){(q=m.bindings[q])&&0!=q.indexOf("parent.")&&(0==q.indexOf("page.")&&
(q=q.substring(5)),b.$watch("variables."+q,function(){null!=p&&(clearTimeout(p),p=null);p=setTimeout(function(){b.loadInitialState(m,!0)},100)}))})});var d={};this.page.content.states.filter(function(m){return!!m.name&&!m.inherited&&(!m.condition||b.$services.page.isCondition(m.condition,b.variables,b))}).forEach(function(m){d[m.name]=b.$services.q.defer()});var e=this.page.content.states.filter(function(m){return!!m.name&&!m.inherited&&(!m.condition||b.$services.page.isCondition(m.condition,b.variables,
b))}).map(function(m){var p=d[m.name],q=[];Object.keys(m.bindings).map(function(t){null!=m.bindings[t]&&0==m.bindings[t].indexOf("page.")&&Object.keys(d).forEach(function(u){0==m.bindings[t].indexOf("page."+u+".")&&q.push(d[u])})});b.$services.q.all(q).then(function(){var t={};Object.keys(m.bindings).map(function(u){null!=m.bindings[u]&&(t[u]=b.$services.page.getBindingValue(b,m.bindings[u]))});t.$serviceContext||(t.$serviceContext=b.getServiceContext());try{b.$services.swagger.execute(m.operation,
t).then(function(u){null!=u&&b.initialStateLoaded.push(m.name);Vue.set(b.variables,m.name,u?u:null);p.resolve(u);b.$services.triggerable.trigger(m,"initial",null,b).then(p,p)},p)}catch(u){console.error("Could not execute",m.operation,u),p.reject(u)}},p);return p}),g=this.page.content.errorInSelf,k=function(m,p){p||=1;if(!b.$el&&5>p&&g)Vue.nextTick(function(){k(m,p+1)});else{console.log("error is",m);var q="error";m instanceof Array?m.forEach(function(t){!t||503!=t.status&&502!=t.status||(q="offline")}):
!m||503!=m.status&&502!=m.status||(q="offline");"error"==q&&m.forEach&&m.forEach(function(t){t&&t.code&&b.page.content.stateErrors&&b.page.content.stateErrors.forEach(function(u){u.code==t.code&&(q=u.route)})});console.log("error route is",q);b.$services.page.canEdit()?b.$services.notifier.push({message:"Blocking error routing to '"+q+"' due to editor permissions",severity:b.$services.page.notificationStyle}):b.$services.router.route(q,{code:"page-load-failed",message:"The page you requested could not be loaded, please\x26nbsp;\x3ca class\x3d'is-color-link' href\x3d'javascript:void(0)' @click\x3d'$window.location.reload()'\x3etry again\x3c/a\x3e"},
g&&b.$el?nabu.utils.router.self(b.$el):null,!0)}};this.$services.q.all(e).then(c,function(m){b.edit||b.$services.page.wantEdit?c():(a(),k(m,0))})}else c()},beforeDestroy:function(){this.page.content.readOnly||this.stopEdit();this.autoRefreshTimeout&&(clearTimeout(this.autoRefreshTimeout),this.autoRefreshTimeout=null);this.oldTitle&&(document.title=this.oldTitle);this.oldBranding&&this.$services.page.updateBranding(this.oldBranding);this.timers.forEach(function(a){clearTimeout(a)});this.oldBodyClasses.length&&
document.body.classList.remove.apply(document.body.classList,this.oldBodyClasses.splice(0))},ready:function(){this.$services.page.rendering--;this.rendered=!0;this.postRender.splice(0).forEach(function(a){a()});this.emit("$load",{});this.$emit("ready",this);this.page.content.branding&&(this.oldBranding=nabu.utils.objects.deepClone(this.$services.page.currentBranding),this.$services.page.updateBranding(this.page.content.branding,this))},created:function(){this.$services.page.rendering++;this.$services.page.setPageInstance(this.page,
this);var a=this;this.initializeDefaultParameters(!0);this.editable&&(this.edit=!0);this.embedded||this.plugins.forEach(function(b){new (Vue.component(b.component))({propsData:{page:a.page,edit:a.edit,instance:a}})});this.$services.page.listCloseableItems(this.page,null,!0).forEach(function(b){b.startVisible||Vue.set(a.closed,b.id,b.on?b.on:"$any");b.showTimeout&&a.$watch("closed."+b.id,function(c){a.showTimeouts||(a.showTimeouts={});a.showTimeouts[b.id]&&(clearTimeout(a.showTimeouts[b.id]),delete a.showTimeouts[b.id]);
null==c&&(a.showTimeouts[b.id]=setTimeout(function(){Vue.set(a.closed,b.id,b.on?b.on:"$any")},parseInt(b.showTimeout)))})})},beforeMount:function(){this.$services.page.setPageInstance(this.page,this);this.$emit("beforeMount",this)},destroyed:function(){this.$services.page.destroyPageInstance(this.page,this)},computed:{events:function(){return this.getEvents()},availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,null,!0)},bodyClasses:function(){return this.page.content.bodyStyles&&
this.page.content.bodyStyles.length?this.$services.page.getDynamicClasses(this.page.content.bodyStyles,this.variables,this):[]},classes:function(){var a=[];this.edit&&(a.push("is-editing"),this.$services.page.activeViews.length&&a.push("is-active-view"),this.$services.page.activeViews.forEach(function(c){a.push("is-active-view-"+c)}));this.page.content.class&&a.push(this.page.content.class);if(this.page.content.styles&&this.page.content.styles.length){var b=this.$services.page.getDynamicClasses(this.page.content.styles,
this.variables,this);nabu.utils.arrays.merge(a,b)}this.page.content.pageType?a.push("page-type-"+this.page.content.pageType):a.push("page-type-page");a.push("is-page-"+this.page.name);return a},plugins:function(){return nabu.page.providers("page-plugin").filter(function(a){return"page"==a.target})}},data:function(){return{collapsedMenu:!1,activeViews:["main"],selectedItemPath:[],autoRefreshTimeout:null,refs:{},edit:!1,components:{},instanceCounter:0,variables:{},labels:{},configuring:!1,closed:{},
storage:{},subscriptions:{},autoMapFrom:null,cachedEvents:null,saveContentTimer:null,saveContents:[],savePageTimer:null,selectedItem:null,selectedType:null,cell:null,row:null,viewComponents:!1,closing:!1,saved:null,timers:[],postRender:[],rendered:!1,oldBodyClasses:[],initialStateLoaded:[],activeTab:"layout",waitingForMount:{},hidden:{}}},methods:{addTargetState:function(a){a.states||Vue.set(a,"states",[]);a.states.push({name:null,condition:null})},isArrayField:function(a){var b=this.$services.page.getAllArrays(this.page);
return 0<=b.indexOf(a)||0<=b.indexOf("page."+a)?!0:!1},getActions:function(a,b,c){a=[];(b=this.page.content.states&&this.page.content.states.length)||this.page.content.parameters&&(b=0<this.page.content.parameters.filter(function(d){return d.default||d.defaultScript}).length);b&&a.push({title:"Refresh State",name:"refresh-state",description:"Configure the name of the variable that needs to be refreshed",input:{name:{type:"string"}},output:{}});return a},runAction:function(a,b){"refresh-state"==a&&
b&&b.name&&(this.page.content.states&&(a=this.page.content.states.filter(function(c){return c.name==b.name})[0])&&this.loadInitialState(a,!0),this.page.content.parameters&&(a=this.page.content.parameters.filter(function(c){return c.name==b.name&&(c.default||c.defaultScript)&&c.private})[0])&&this.loadParameterState(a.name,!0))},isActiveView:function(a){return 0<=this.$services.page.activeViews.indexOf(a)},acivateView:function(a){this.activeViews.splice(0);this.activeViews.push(a)},updateEvent:function(a,
b,c){this.$emit("update",a,b,c)},registerStateListeners:function(){var a={},b=this;this.page.content.parameters&&this.page.content.parameters.forEach(function(c){(c.triggers&&c.triggers.length||c.store||c.emitUpdate)&&c.name&&(a[c.name]||(a[c.name]=[],b.$watch("variables."+c.name,function(){a[c.name].forEach(function(d){d()})},{deep:!0})),c.triggers&&c.triggers.length&&a[c.name].push(function(){b.$services.triggerable.trigger(c,"change",{},b)}),c.store&&a[c.name].push(function(){setTimeout(function(){var d=
b.variables[c.name];null!=d&&(d=JSON.stringify(d));var e=b.getServiceContext();localStorage.setItem(b.page.content.name+(e?"-"+e:"")+"-state-"+c.name,d)},1)}),c.emitUpdate&&a[c.name].push(function(){setTimeout(function(){b.updateEvent(b.variables[c.name],b.labels[c.name],c.name)},1)}))})},getServiceContext:function(){return this.fragmentParent?this.fragmentParent.getServiceContext():!this.page.content.useFixedServiceContext&&this.page.content.serviceContext?this.get(this.page.content.serviceContext):
this.page.content.useFixedServiceContext&&this.page.content.fixedServiceContext?this.page.content.fixedServiceContext:null},updateTemplates:function(){var a=this;this.$confirm({message:"Are you sure you want to update all templates?"}).then(function(){a.$services.page.updateToLatestTemplate(a.page.content,!0)})},isContentHidden:function(a){null==this.hidden[a.id]&&Vue.set(this.hidden,a.id,!1);return this.hidden[a.id]},getSlots:function(a){a=this.$services.page.getTargetPath(this.page.content,a.id);
a.reverse();if(2<=a.length&&a[1].renderer){var b=this.$services.page.getRenderer(a[1].renderer);if(b.getSlots)return b.getSlots(a[1])}},getParentConfig:function(a){var b=this.$services.page.getTargetPath(this.page.content,a.id);b.reverse();for(var c=1;c<b.length;c++)if(b[c].renderer){var d=this.$services.page.getRenderer(b[c].renderer);if(d.getChildConfig&&(d=d.getChildConfig(b[c],a,b)))return d}},getDefaultTriggers:function(){return{click:{properties:{shift:{type:"boolean"},ctrl:{type:"boolean"},
alt:{type:"boolean"},meta:{type:"boolean"}}},hover:{properties:{}}}},getTriggersForCell:function(a){var b=this.components[a.id];b instanceof Array&&(b=b[0]);var c=this.getDefaultTriggers(),d=[];if(b){var e=this.$services.page.getActions(b,a,this);e&&nabu.utils.arrays.merge(d,e);b.getTriggers&&(b=b.getTriggers(a,this,this.$services))&&nabu.utils.objects.merge(c,b)}a.renderer&&(b=this.$services.page.getRenderer(a.renderer),(e=this.$services.page.getActions(b,a,this))&&nabu.utils.arrays.merge(d,e),b.getTriggers&&
(b=b.getTriggers(a,this,this.$services))&&nabu.utils.objects.merge(c,b));if(0<d.length){var g=this;d.forEach(function(k){var m=g.$services.page.getActionInput(g,a.id,k.name),p=g.$services.page.getActionOutput(g,a.id,k.name);c[k.name+":before"]=m?m:{};c[k.name+":after"]=p?p:{};c[k.name+":error"]={}})}return c},getPageArisComponents:function(){return[{title:"Page Grid",name:"page-grid",component:"grid"}]},getGridClasses:function(){var a=[];if(this.$services.page.useAris&&this.page.content.aris&&this.page.content.aris.components){var b=
this.$services.page.calculateArisComponents(this.page.content.aris,null,this);b["page-grid"]&&b["page-grid"].classes&&nabu.utils.arrays.merge(a,b["page-grid"].classes)}return a},getComponent:function(a){var b=this.$services.q.defer();this.components[a]?b.resolve(this.components[a]):(this.waitingForMount.hasOwnProperty(a)||Vue.set(this.waitingForMount,a,[]),this.waitingForMount[a].push(b));return b},addNotification:function(){this.page.content.notifications||Vue.set(this.page.content,"notifications",
[]);this.page.content.notifications.push({name:null,duration:null,on:null,condition:null,title:null,message:null,severity:null,closeable:null,icon:null,actions:[],chainEvent:{name:"enrich"}})},moveTriggerUp:function(a){var b=this.page.content.actions.indexOf(a);0<b&&(this.page.content.actions.splice(b,1),this.page.content.actions.splice(b-1,0,a))},moveTriggerDown:function(a){var b=this.page.content.actions.indexOf(a);b<this.page.content.actions.length-1&&(this.page.content.actions.splice(b,1),this.page.content.actions.splice(b+
1,0,a))},moveInternalUp:function(a){var b=this.page.content.parameters.indexOf(a);0<b&&(this.page.content.parameters.splice(b,1),this.page.content.parameters.splice(b-1,0,a))},moveInternalDown:function(a){var b=this.page.content.parameters.indexOf(a);b<this.page.content.parameters.length-1&&(this.page.content.parameters.splice(b,1),this.page.content.parameters.splice(b+1,0,a))},getOperationArrays:function(a){return a&&(a=this.$services.swagger.operations[a])&&null!=a.responses["200"]&&null!=a.responses["200"].schema&&
(a=a.responses["200"].schema,a.$ref)?(a=this.$services.swagger.resolve(a.$ref),this.$services.page.getArrays(a)):[]},moveActionTop:function(a){var b=this.page.content.actions.indexOf(a);0<b&&(this.page.content.actions.splice(b,1),this.page.content.actions.unshift(a))},getHideMode:function(a){if(!a.state||!a.state.hasOwnProperty("hideMode")){var b=null;a.on?b="event":a.condition?b="script":a.devices&&a.devices.length?b="device":a.closeable&&(b="toggle");a.state||Vue.set(a,"state",{});Vue.set(a.state,
"hideMode",b)}return a.state.hideMode},setHideMode:function(a,b){Vue.set(a.state,"hideMode",b);Vue.set(a,"closeable","toggle"==b);"event"!=a.state.mode&&(a.on=null);"script"!=a.state.mode&&(a.condition=null);"devices"!=a.state.mode&&a.devices&&a.devices.splice(0)},moveActionBottom:function(a){var b=this.page.content.actions.indexOf(a);0<=b&&(this.page.content.actions.splice(b,1),this.page.content.actions.push(a))},moveAction:function(a,b){a=this.page.content.actions.indexOf(a);if(0<=a&&(b=a+b,0<=
b&&b<=this.page.content.actions.length-1)){var c=this.page.content.actions[b];this.page.content.actions.splice(b,1,this.page.content.actions[a]);this.page.content.actions.splice(a,1,c)}},route:function(a,b,c,d){var e=this,g=function(){e.$services.router.route(a,b,c,d)};if(this.rendered)return g();this.postRender.push(g)},fireInitialEvent:function(a){var b=this;if(nabu.page.event.getName(a,"definition")&&(!a.condition||b.$services.page.isCondition(a.condition,b.$services.page.getPageState(b),b)))try{b.emit(nabu.page.event.getName(a,
"definition"),nabu.page.event.getInstance(a,"definition",b.page,b))}catch(d){console.error("Could not fire initial event",d)}if(a.timeout){var c=setTimeout(function(){var d=b.timers.indexOf(c);0<=d&&b.timers.splice(d,1);b.fireInitialEvent(a)},parseInt(a.timeout));b.timers.push(c)}},initializeDefaultParameters:function(a,b,c){var d=this;this.page.content.parameters&&this.page.content.parameters.map(function(e){if(null!=e.name&&(!b||0<=b.indexOf(e.name))&&(0>d.initialStateLoaded.indexOf(e.name)||c))if(null==
d.parameters[e.name]){var g=null;e.store&&(g=localStorage.getItem(d.page.content.name+"-"+d.getServiceContext()+"-state-"+e.name),null!=g&&(g=JSON.parse(g)));null==g&&(g=e.complexDefault?d.calculateVariable(e.defaultScript):d.$services.page.interpret(e.default,d));null==g&&application.state&&null!=application.state[e.name]&&(g=application.state[e.name]);(null!=g||a)&&Vue.set(d.variables,e.name,null==g?null:g)}else a&&Vue.set(d.variables,e.name,d.parameters[e.name])})},selectTarget:function(a){if(a.cells)this.selectItem(a,
null,"row");else if(a.rows){var b=this.$services.page.getTargetPath(this.page.content,a.id);this.selectItem(b[b.length-2],a,"cell")}},selectItem:function(a,b,c,d){Vue.set(this,"row",a);Vue.set(this,"cell",b);Vue.set(this,"selectedType",c);d&&(this.activeTab=d?d:"selected");if(c){a=this.$services.page.getTargetPath(this.page.content,"cell"==this.selectedType?this.cell.id:this.row.id);var e=!1;if(a.length<this.selectedItemPath.length){e=!0;var g=this;a.forEach(function(k,m){e&&g.selectedItemPath[m].id!=
k.id&&(e=!1)})}e||(this.selectedItemPath.splice(0),nabu.utils.arrays.merge(this.selectedItemPath,a))}a=this.canConfigureInline(b);this.$services.page.availableSubTabs.splice(0);a&&a.getAvailableSubTabs&&nabu.utils.arrays.merge(this.$services.page.availableSubTabs,a.getAvailableSubTabs());a=["container","styling","triggers","analysis"];this.$services.page.availableSubTabs.length?nabu.utils.arrays.merge(a,this.$services.page.availableSubTabs):b?a.push("component"):a.push("container");0>a.indexOf(this.$services.page.activeSubTab)&&
(this.$services.page.activeSubTab=a[0])},stopEdit:function(){if(this.edit&&!this.closing){this.closing=!0;var a=document.querySelector(".is-sidebar.right");a&&a.__vue__&&a.__vue__.close?a.__vue__.close():a&&a.$$close&&a.$$close();(a=document.querySelector(".is-sidebar.left"))&&a.__vue__&&a.__vue__.close?a.__vue__.close():a&&a.$$close&&a.$$close();this.$services.page.editing&&(this.$services.page.editing.edit=!1,this.$services.page.editing=null);this.edit=this.closing=!1;document.querySelectorAll(".is-hovering").forEach(function(b){b.classList.remove("is-hovering",
"is-hover-top","is-hover-bottom","is-hover-left","is-hover-right")});document.body.removeAttribute("page-editing")}},goIntoEdit:function(){this.edit||(this.page.content.formatters||Vue.set(this.page.content,"formatters",[]),this.$services.page.editing&&(this.$services.page.editing.edit&&this.$services.page.editing.stopEdit(),this.$services.page.editing=null),this.edit=!0,this.$services.page.editing=this,this.viewComponents=!0)},addInitialEvent:function(){this.page.content.initialEvents||Vue.set(this.page.content,
"initialEvents",[]);this.page.content.initialEvents.push({condition:null,definition:{}})},listFields:function(a,b){try{return a=this.$services.swagger.resolve(a),this.$services.page.getSimpleKeysFor(a).filter(function(c){return!b||c&&0<=c.toLowerCase().indexOf(b.toLowerCase())})}catch(c){return console.warn("Could not list fields for",a,c),[]}},validateStateName:function(a){var b=["page","application","record","state","localState"],c=[];a&&0<=b.indexOf(a)&&c.push({type:"error",title:"This name is not allowed"});
return c},isGet:function(a){return(a=this.$services.swagger.operations[a])&&a.method&&"get"==a.method.toLowerCase()},getParameterTypes:function(a){var b=["string","boolean","number","integer"];nabu.utils.arrays.merge(b,Object.keys(this.$services.swagger.swagger.definitions));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},store:function(a,b){"object"==typeof b?(this.storage[a]||Vue.set(this.storage,a,{}),Object.keys(b).map(function(c){Vue.set(this.storage[a],
c,b[c])})):Vue.set(this.storage,a,b)},retrieve:function(a){return this.storage[a]},automap:function(a){var b=this,c=b.$services.page.getSimpleKeysFor(this.availableParameters[this.autoMapFrom]);this.getOperationParameters(a.operation,!0).map(function(d){if(!a.bindings[d]){var e=0>d.indexOf(".")?d:d.substring(d.indexOf(".")+1),g=c.filter(function(k){return k==e||k.length>e.length+1&&k.substring(k.length-(e.length+1))=="."+e});0<g.length&&Vue.set(a.bindings,d,b.autoMapFrom+"."+g[0])}})},pasteRow:function(a){a?
a.rows.push(this.$services.page.renumber(this.page,this.$services.page.copiedRow)):this.page.content.rows.push(this.$services.page.renumber(this.page,this.$services.page.copiedRow));this.$services.page.copiedRow=null},getStateOperations:function(a){return this.$services.page.getStateOperations(a)},setStateOperation:function(a,b){a.operation=b;var c={};b&&this.$services.swagger.operations[b].parameters.map(function(d){c[d.name]=null});Vue.set(a,"bindings",c)},addState:function(){this.page.content.states.push({name:null,
operation:null,bindings:{},condition:null})},addApplicationState:function(){this.page.content.states.push({inherited:!0,name:null,applicationName:null})},dragMenu:function(a){this.$services.page.setDragData(a,"page-menu",this.page.name)},dragOver:function(a){this.$services.page.hasDragData(a,"page-menu")?a.preventDefault():this.$services.page.hasDragData(a,"component-alias")?a.preventDefault():this.$services.page.hasDragData(a,"template-content")?a.preventDefault():this.$services.page.hasDragData(a,
"operation")&&a.preventDefault()},dropMenu:function(a){var b=this;if(this.$services.page.getDragData(a,"page-menu")){var c=this.$el.getBoundingClientRect();Vue.set(this.page.content,"menuX",a.clientX-c.left);Vue.set(this.page.content,"menuY",a.clientY-c.top);a.preventDefault();a.stopPropagation()}this.$services.page.getDragData(a,"component-alias")&&(c=this.addRow(this.page.content),this.addCell(c).alias=this.$services.page.getDragData(a,"component-alias"),a.preventDefault(),a.stopPropagation());
if(this.$services.page.getDragData(a,"template-content")){c=JSON.parse(this.$services.page.getDragData(a,"template-content"));if("page-row"==c.type)b.page.content.rows||Vue.set(b.page.content,"rows",[]),c.content instanceof Array?c.content.forEach(function(e){b.page.content.rows.push(b.$services.page.renumber(b.page,b.$services.page.normalizeRow(e)))}):b.page.content.rows.push(b.$services.page.renumber(b.page,b.$services.page.normalizeRow(c.content)));else{if(c.rows instanceof Array){var d=c.rows.map(function(e){return b.$services.page.renumber(b.page,
e)});nabu.utils.arrays.merge(this.page.content.rows,d)}c.actions instanceof Array&&nabu.utils.arrays.merge(this.page.content.actions,c.actions)}a.preventDefault();a.stopPropagation()}this.$services.page.getDragData(a,"operation")&&(this.initializeOperation(function(e){return b.addRow(e?e:b.page.content)},function(e){return b.addCell(e)}),a.preventDefault(),a.stopPropagation())},initializeOperation:function(a,b){var c=this,d=this.$services.page.getDragData(event,"operation");d&&(this.$services.swagger.operations[d]?
this.initializeOperationInternal(a,b,d):this.$services.page.reloadSwagger().then(function(){c.$services.swagger.operations[d]?c.initializeOperationInternal(a,b,d):console.error("Can not find operation",d)}))},initializeOperationInternal:function(a,b,c){var d=this,e=this.$services.router.router.list().filter(function(m){m.accept&&console.log("found acceptor",m.alias);return m.accept&&m.accept("operation",c)});1<e.length&&(e=e.filter(function(m){return m.icon&&m.name}));var g=nabu.page.providers("page-generator").filter(function(m){m.accept&&
console.log("found generator",m.name);return m.accept&&m.accept("operation",c)});nabu.utils.arrays.merge(e,g);var k=function(m){var p=a(),q=b(p);q.alias=m.alias;m.initialize&&(q.$$initialize=function(t){m.initialize("operation",c,t,q,p,d,a,b)});event.preventDefault();event.stopPropagation();d.$services.page.slowNormalizeAris(d.page,p,"row");d.$services.page.slowNormalizeAris(d.page,q)};console.log("accepted routes are",e);1==e.length?e[0].alias?k(e[0]):e[0].initialize&&e[0].initialize("operation",
c,d,a,b):1<e.length&&this.$prompt("page-components-selector",{components:e}).then(function(m){m&&(m.alias?k(m):m.initialize&&m.initialize("operation",c,d,a,b))})},save:function(a){if(this.edit){var b=this;this.$services.page.update(this.page).then(function(){b.saved=new Date;b.$services.notifier.push({message:"Page '"+b.page.content.name+"' saved!",severity:b.$services.page.notificationStyle})},function(c){b.$services.notifier.push({message:"Could not save page '"+b.page.content.name+"'",severity:"danger-outline"})});
a.preventDefault();a.stopPropagation()}},getOperationParameters:function(a,b){if(!this.$services.swagger.operations[a])return[];var c=this.$services.swagger.operations[a].parameters;return b?this.$services.page.getSwaggerParametersAsKeys(this.$services.swagger.operations[a]):c?c.map(function(d){return d.name}):[]},addEventReset:function(a){null==a.eventResets&&Vue.set(a,"eventResets",[]);a.eventResets.push("")},getOperations:function(a){var b=Object.keys(this.$services.swagger.operations);a&&(b=b.filter(function(c){return 0<=
c.toLowerCase().indexOf(a.toLowerCase())}));return b},getAvailableEvents:function(a){var b=this.getEvents();b=Object.keys(b);b=b.filter(function(c){return null!=c&&"string"==typeof c});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b},addAnalysis:function(){this.page.content.analysis||Vue.set(this.page.content,"analysis",[]);this.page.content.analysis.push({name:null,on:null,condition:null})},addAction:function(){this.page.content.actions.push({name:null,
on:null,confirmation:null,operation:null,route:null,event:null,anchor:null,bindings:{},expandBindings:!0})},removeQuery:function(a){this.page.content.query.splice(a,1)},ref:function(a){return this.refs[a]},destroyComponent:function(a,b){this.components["instance_"+a.$$pageInstanceCounter]&&Vue.delete(this.components,"instance_"+a.$$pageInstanceCounter,null);if(a.getRuntimeAlias&&null!=a.getRuntimeAlias()){Vue.delete(this.components,"alias_"+a.getRuntimeAlias(),null);this.set(a.getRuntimeAlias(),null);
var c=this;Object.keys(c.labels).forEach(function(e){e!=a.getRuntimeAlias()&&0!=e.indexOf(a.getRuntimeAlias()+".")||Vue.set(c.labels,e,null)})}if(null!=this.components[b.id])if(this.components[b.id]instanceof Array){var d=this.components[b.id].indexOf(a);0<=d&&this.components[b.id].splice(d,1);0==this.components[b.id].length?Vue.delete(this.components,b.id,null):1==this.components[b.id].length&&(this.components[b.id]=this.components[b.id][0])}else this.components[b.id]==a&&Vue.delete(this.components,
b.id,null)},getComponentForCell:function(a){a=this.components[a];return a instanceof Array?a[a.length-1]:a},mountRenderer:function(a,b){if(a.renderer&&a.runtimeAlias&&b.getRuntimeState){var c=null;a.mergeState&&null!=this.variables[a.runtimeAlias]&&(c=this.variables[a.runtimeAlias]);this.set(a.runtimeAlias,b.getRuntimeState());null!=c&&this.$services.page.mergeObject(this.variables[a.runtimeAlias],c)}b.$$target=a;var d=this;b.$on("hook:beforeDestroy",function(){d.components[a.id]==b&&(a.renderer&&
a.runtimeAlias&&b.getRuntimeState&&!a.retainState&&d.set(a.runtimeAlias,null),a.renderer&&(d.components[a.id]=null))});this.waitingForMount[a.id]instanceof Array&&(this.waitingForMount[a.id].forEach(function(e){e.resolve(b)}),Vue.delete(this.waitingForMount,a.id));a.renderer&&(this.components[a.id]=b)},mounted:function(a,b,c,d){var e=this;d.$mounted?e.$services.page.rendering--:d.$on("hook:mounted",function(){e.$services.page.rendering--});d.$on("update",function(k,m,p){a.bindings&&a.bindings[p]&&
e.set(a.bindings[p],k,m);a.contentRuntimeAlias&&e.set(a.contentRuntimeAlias+"."+p,k,m);e.fragmentParent?e.$emit("update",k,m,p):d.$parent&&d.$parent.$emit("update",k,m,p)});d.$on("close",function(){var k=!1;e.$services.page.isCloseable(a)&&(k=!0,Vue.set(e.closed,a.id,a.on?a.on:"$any"));b&&e.$services.page.isCloseable(b)&&(k=!0,Vue.set(e.closed,b.id,b.on?b.on:"$any"));!k&&d.$parent&&d.$parent.$emit("close")});d.isCellHidden&&(Vue.set(e.hidden,a.id,d.isCellHidden()),d.$on("hide",function(){Vue.set(e.hidden,
a.id,!0)}),d.$on("show",function(){Vue.set(e.hidden,a.id,!1)}));d.$$pageInstanceCounter=this.instanceCounter++;this.components["instance_"+d.$$pageInstanceCounter]=d;d.$$cell=a;d.getRuntimeAlias&&null!=d.getRuntimeAlias()&&(this.components["alias_"+d.getRuntimeAlias()]=d,d.getRuntimeState&&Vue.set(this.variables,d.getRuntimeAlias(),d.getRuntimeState()));a.$$initialize&&(a.$$initialize(d),a.$$initialize=null);a.ref&&(this.refs[a.ref]=d);d.$on("hook:beforeDestroy",function(){null!=d.$pageSubscriptions&&
d.$pageSubscriptions.forEach(function(k){k()});a.ref&&(e.refs[a.ref]=null);e.destroyComponent(d,a)});this.cachedEvents=null;null!=this.components[a.id]?(this.components[a.id]instanceof Array||(this.components[a.id]=[this.components[a.id]]),this.components[a.id].push(d)):this.components[a.id]=d;d.$on("updatedEvents",function(){e.resetEvents()});e=this;if(d.getEvents&&(e=this,c=d.getEvents())){var g=function(k){e.variables[k]||Vue.set(e.variables,k,null);d.$on(k,function(m){e.emit(k,m)})};"string"==
typeof c?g(c):c instanceof Array||Object.keys(c).map(g)}d.$options.events&&(null==d.$pageSubscriptions&&(d.$pageSubscriptions=[]),e=this,Object.keys(d.$options.events).forEach(function(k){d.$pageSubscriptions.push(e.subscribe(k,d.$options.events[k].bind(d)))}));this.waitingForMount[a.id]instanceof Array&&(this.waitingForMount[a.id].forEach(function(k){k.resolve(d)}),Vue.delete(this.waitingForMount,a.id))},hasConfigureListener:function(a){a||(a=this.page.content.rows);if(a)for(var b=0;b<a.length;b++){if("$configure"==
a[b].on)return!0;if(a[b].cells)for(var c=0;c<a[b].cells.length;c++){var d=a[b].cells[c];if("$configure"==d.on||d.rows&&this.hasConfigureListener(d.rows))return!0}}return!1},addCell:function(a,b){a.cells||Vue.set(a,"cells",[]);var c={id:this.page.content.counter++,rows:[],alias:null,bindings:{},name:null,state:{},target:"page",on:null,class:null,customId:null,width:null,height:null,condition:null,devices:[],clickEvent:null};b||(a.cells.push(c),this.$services.page.normalizeAris(this.page,c));return c},
addRow:function(a,b){a.rows||Vue.set(a,"rows",[]);var c={id:this.page.content.counter++,state:{},cells:[],class:null,customId:null,condition:null,direction:null,align:null,on:null,collapsed:!1,name:null};b||(a.rows.push(c),this.$services.page.normalizeAris(this.page,c,"row"));return c},addPageParameter:function(){this.page.content.parameters||Vue.set(this.page.content,"parameters",[]);this.page.content.parameters.push({name:null,type:null,format:null,default:null,global:!1,listeners:[]})},removeRow:function(a){this.page.content.rows.splice(this.page.content.rows(indexOf(a),
1))},resetEvents:function(){this.cachedEvents=null},getDraggables:function(){var a={},b=this;Object.keys(this.components).map(function(c){c=b.components[c];var d=function(e){if(e&&e.getDraggables&&!b.$services.page.isPage(e)){var g=e.getDraggables();g&&Object.keys(g).forEach(function(k){a[k]=g[k]})}};c instanceof Array?c.forEach(d):d(c)});return a},getStateEvents:function(){return{change:{}}},getEvents:function(){if(!this.cachedEvents){var a={$configure:{properties:{}},$clear:{properties:{}},$load:{properties:{}}},
b=this;this.cachedEvents=a;if(this.page.content.globalEventSubscriptions){var c=this.$services.page.getGlobalEvents();this.page.content.globalEventSubscriptions.map(function(d){a[null==d.localName?d.globalName:d.localName]=c[d.globalName]?c[d.globalName]:{properties:{}}})}this.page.content.actions&&(this.page.content.actions.filter(function(d){return null!=d.event&&null!=d.operation}).map(function(d){if(null==b.$services.swagger.operations[d.operation])console.error("Could not find operation for action",
d.operation,d.name,d.event);else{var e=b.$services.swagger.operations[d.operation].responses["200"],g=null;e&&e.schema&&(g=b.$services.swagger.resolve(e.schema));if(d.singlify){e=d.singlify.split(".");for(var k=0;k<e.length;k++)g=g.properties[e[k]];g.items&&(g=g.items)}a[d.event]=g?g:{}}}),this.page.content.actions.filter(function(d){return null!=d.errorEvent&&null!=d.operation}).map(function(d){a[d.errorEvent]=b.$services.swagger.resolve("#/definitions/StructuredErrorResponse")}),this.page.content.actions.filter(function(d){return null!=
nabu.page.event.getName(d,"chainEvent")}).forEach(function(d){var e=nabu.page.event.getType(d,"chainEvent");e.properties&&0==Object.keys(e.properties).length&&d.on&&(e=d.on);a[nabu.page.event.getName(d,"chainEvent")]=e}),this.page.content.actions.filter(function(d){return null!=nabu.page.event.getName(d,"timeoutEvent")}).forEach(function(d){var e=nabu.page.event.getType(d,"timeoutEvent");e.properties&&0==Object.keys(e.properties).length&&d.on&&(e=d.on);a[nabu.page.event.getName(d,"timeoutEvent")]=
e}),this.page.content.actions.filter(function(d){return null!=nabu.page.event.getName(d,"downloadFailedEvent")}).forEach(function(d){var e=nabu.page.event.getType(d,"downloadFailedEvent");e.properties&&0==Object.keys(e.properties).length&&d.on&&(e=d.on);a[nabu.page.event.getName(d,"downloadFailedEvent")]=e}),this.page.content.actions.filter(function(d){return d.function&&d.functionOutputEvent}).forEach(function(d){a[d.functionOutputEvent]=b.$services.page.getFunctionOutputFull(d.function)}));nabu.utils.objects.merge(a,
this.$services.triggerable.getEvents(this.page,this.page.content));this.page.content.rows.map(function(d){b.getNestedEvents(d,a)});Object.keys(this.components).map(function(d){if(d=b.components[d]){var e=function(g){if(g&&g.getEvents&&!b.$services.page.isPage(g)){var k=g.getEvents();k&&("string"==typeof k?a[k]={}:k instanceof Array||Object.keys(k).map(function(m){a[m]=k[m]}))}};d instanceof Array?d.forEach(e):e(d);(e=d.target?d.target:d.cell?d.cell:d.row)&&e.triggers&&nabu.utils.objects.merge(a,b.$services.triggerable.getEvents(b.page,
e,d))}});Object.keys(a).map(function(d){"string"==typeof a[d]&&(a[a[d]]?a[d]=a[a[d]]:(console.warn("Can not find event: "+a[a[d]]),a[d]={}))});this.page.content.initialEvents&&this.page.content.initialEvents.forEach(function(d){var e=nabu.page.event.getName(d,"definition");e&&(a[e]=nabu.page.event.getType(d,"definition"))});this.page.content.states&&this.page.content.states.forEach(function(d){var e=nabu.page.event.getName(d,"updateEvent");e&&(a[e]=nabu.page.event.getType(d,"updateEvent"));d.triggers&&
nabu.utils.objects.merge(a,b.$services.triggerable.getEvents(b.page,d))})}return this.cachedEvents},getRendererEvents:function(a,b){var c=nabu.page.providers("page-renderer").filter(function(e){return e.name==a})[0],d=null;c&&c.getEvents&&(d=c.getEvents(b));return d?d:{}},getNestedEvents:function(a,b){a.renderer&&nabu.utils.objects.merge(b,this.getRendererEvents(a.renderer,a));var c=this;a.cells&&a.cells.forEach(function(d){d.renderer&&nabu.utils.objects.merge(b,c.getRendererEvents(d.renderer,d));
nabu.page.event.getName(d,"clickEvent")&&(b[nabu.page.event.getName(d,"clickEvent")]=nabu.page.event.getType(d,"clickEvent"));d.clickEvent&&"string"==typeof d.clickEvent&&(b[d.clickEvent]={properties:{value:{type:"string"}}});d.rows&&d.rows.map(function(e){c.getNestedEvents(e,b)})})},subscribe:function(a,b){this.subscriptions[a]||(this.subscriptions[a]=[]);this.subscriptions[a].push(b);var c=this;return function(){var d=c.subscriptions[a].indexOf(b);0<=d&&c.subscriptions[a].splice(d,1)}},reset:function(a){Vue.delete(this.variables,
a)},calculateVariable:function(a){try{return this.$services.page.eval(a,this.variables,this)}catch(b){return console.warn("Could not execute script",a,b),null}},isBinaryDownload:function(a){return(a=this.$services.swagger.operations[a])&&"get"==a.method&&a.produces&&a.produces.length&&"application/octet-stream"==a.produces[0]},emit:function(a,b,c){this.$services.page.report("emit",this.page.content.name,null,a,b);var d=this;Vue.set(this.variables,a,b);var e=[];c||(this.page.content.analysis&&this.page.content.analysis.filter(function(g){return g.on==
a}).map(function(g){if(!g.condition||d.$services.page.isCondition(g.condition,b,d)){d.$services.page.getPageInstance(d.page,d);var k=nabu.page.event.getInstance(g,"chainEvent",d.page,d);d.$services.analysis.push({pageName:d.page.content.name,pageCategory:d.page.content.category,category:"trigger",type:"page-analysis",event:nabu.page.event.getName(g,"chainEvent"),content:k,data:k})}}),this.page.content.notifications&&this.page.content.notifications.filter(function(g){return g.on==a}).map(function(g){if(!g.condition||
d.$services.page.isCondition(g.condition,b,d)){d.$services.page.getPageInstance(d.page,d);var k=b?nabu.utils.objects.clone(b):{},m=nabu.page.event.getInstance(g,"chainEvent",d.page,d);m&&Object.keys(m).forEach(function(q){k[q]=m[q]});var p=nabu.utils.objects.clone(g);Object.keys(p).forEach(function(q){p[q]=d.$services.page.interpret(d.$services.page.translate(p[q]),d,k)});p.data=k;d.$services.notifier.push(p)}}),this.page.content.actions.map(function(g){if(g.on==a&&(!g.condition||d.$services.page.isCondition(g.condition,
b,d))){var k=d.$services.q.defer(),m=function(){g.isSlow&&d.$wait({promise:k});var C=d.$services.page.getRunnableFunction(g.function);if(!C)throw"Could not find function: "+g.function;var A={};g.bindings&&Object.keys(g.bindings).forEach(function(O){if(g.bindings[O]){var H=d.$services.page.getBindingValue(d,g.bindings[O],d);d.$services.page.setValue(A,O,H)}});C=d.$services.page.runFunction(C,A,d,k);g.functionOutputEvent&&(d.$services.page.getFunctionDefinition(g.function).async?k.then(function(O){d.emit(g.functionOutputEvent,
O?O:{})}):d.emit(g.functionOutputEvent,C?C:{}));return C},p=function(){if(g.script){var C=g.script;0!=C.trim().indexOf("function")&&(C="function(){ "+C+"}");d.$services.page.eval(C,d.variables,d)}};e.push(k);var q={};Object.keys(g.bindings).map(function(C){d.$services.page.setValue(q,C,d.$services.page.getBindingValue(d,g.bindings[C]))});var t=function(){null!=g.eventResets&&null!=b&&g.eventResets.forEach(function(C){d.emit(C,null,!0)})},u=function(C){g.name&&d.$services.analysis.push({pageName:d.page.content.name,
pageCategory:d.page.content.category,category:"trigger",type:"page-trigger",event:g.name})};nabu.page.event.getName(g,"chainEvent")&&k.then(function(){var C=d.$services.page.getPageInstance(d.page,d),A=nabu.page.event.getInstance(g,"chainEvent",d.page,d);0==Object.keys(A).length&&(A=b);var O=function(){C.emit(nabu.page.event.getName(g,"chainEvent"),A)};g.chainTimeout?setTimeout(O,parseInt(g.chainTimeout)):O()});k.then(function(){u()},function(C){u(C)});var w=g.timeout&&nabu.page.event.getName(g,"timeoutEvent")?
function(){var C=nabu.page.event.getInstance(g,"timeoutEvent",d.page,d);0==Object.keys(C).length&&(C=b);d.emit(nabu.page.event.getName(g,"timeoutEvent"),C)}:null,y=function(){nabu.page.event.getName(g,"downloadFailedEvent")&&d.emit(nabu.page.event.getName(g,"downloadFailedEvent"),nabu.page.event.getInstance(g,"downloadFailedEvent",d.page,d))};if(g.confirmation)d.$confirm({message:d.$services.page.translate(d.$services.page.interpret(g.confirmation,d))}).then(function(){w&&d.$services.q.wait(k,parseInt(g.timeout),
w);var C=null,A=!1;g.scroll&&((C=document.querySelector(g.scroll))||(C=document.getElementById(g.scroll)));if(g.url){var O=d.$services.page.interpret(g.url,d);"$blank"==g.anchor?window.open(O):window.location=O}else g.route?(O=null,t(),"$blank"==g.anchor?window.open(d.$services.router.template(g.route,q)):"$window"==g.anchor?window.location=d.$services.router.template(g.route,q):O=d.route(g.route,q,g.anchor?g.anchor:null,g.anchor?!0:!1),C&&(O&&O.then?O.then(function(){C.scrollIntoView()}):C.scrollIntoView())):
g.scroll?(t(),C&&C.scrollIntoView()):g.operation&&d.isGet(g.operation)&&"$blank"==g.anchor?window.open(d.$services.swagger.parameters(g.operation,q).url,"_blank"):g.operation?(g.isSlow&&d.$wait({promise:k}),O=d.$services.swagger.operations[g.operation],"nabu.cms.attachment.rest.internal.get"==O.operationId?(this.$services.attachment.download(q.nodeId,q.attachmentId),t()):"get"==O.method&&O.produces&&O.produces.length&&"application/octet-stream"==O.produces[0]?("$window"!=g.anchor?d.$services.page.download(d.$services.swagger.parameters(g.operation,
q).url,y):window.location=d.$services.swagger.parameters(g.operation,q).url,t()):(A=!0,d.$services.swagger.execute(g.operation,q).then(function(H){g.singlify&&(H=(H=d.$services.page.getValue(H,g.singlify))&&0<H.length?H[0]:null);g.event&&d.emit(g.event,null==H?{}:H);t();k.resolve(H)},function(H){g.errorEvent&&d.emit(g.errorEvent,H);k.reject(H)}))):g.function?m():t();p();A||k.resolve()},function(){k.reject()});else{w&&d.$services.q.wait(k,parseInt(g.timeout),w);var B=!1;if(g.url){var F=d.$services.page.interpret(g.url,
d);g.anchor?window.open(F):window.location=F}else g.scroll?(t(),(F=document.querySelector(g.scroll))||(F=document.getElementById(g.scroll)),F&&F.scrollIntoView()):g.route?(t(),"$blank"==g.anchor?window.open(d.$services.router.template(g.route,q)):"$window"==g.anchor?window.location=d.$services.router.template(g.route,q):d.route(g.route,q,g.anchor?g.anchor:null,g.anchor?!0:!1)):g.operation&&d.isGet(g.operation)&&"$blank"==g.anchor?window.open(d.$services.swagger.parameters(g.operation,q).url,"_blank"):
g.operation?(g.isSlow&&d.$wait({promise:k}),F=d.$services.swagger.operations[g.operation],"nabu.cms.attachment.rest.internal.get"==F.operationId?(this.$services.attachment.download(q.nodeId,q.attachmentId),t()):"get"==F.method&&F.produces&&F.produces.length&&"application/octet-stream"==F.produces[0]?("$window"!=g.anchor?d.$services.page.download(d.$services.swagger.parameters(g.operation,q).url,y):window.location=d.$services.swagger.parameters(g.operation,q).url,t()):(B=!0,d.$services.swagger.execute(g.operation,
q).then(function(C){g.singlify&&(C=(C=d.$services.page.getValue(C,g.singlify))&&0<C.length?C[0]:null);g.event&&d.emit(g.event,null==C?{}:C);t();k.resolve(C)},function(C){g.errorEvent&&d.emit(g.errorEvent,C);k.reject(C)}))):g.function?m():t();p();B||k.resolve()}}}),e.push(this.$services.triggerable.trigger(this.page.content,a,b,this)));this.subscriptions[a]?this.subscriptions[a].forEach(function(g){(g=g(b))&&g.then&&e.push(g)}):this.subscriptions.$any&&this.subscriptions.$any.forEach(function(g){(g=
g(a,b))&&g.then&&e.push(g)});this.page.content.states.length&&!c&&nabu.utils.arrays.merge(e,this.page.content.states.filter(function(g){return null!=g.refreshOn&&0<=g.refreshOn.indexOf(a)&&(!g.condition||d.$services.page.isCondition(g.condition,d.variables,d))}).map(function(g){return d.loadInitialState(g,!0)}));Object.keys(this.closed).map(function(g){d.closed[g]==a&&Vue.set(d.closed,g,null)});return this.$services.q.all(e).then(function(){if(d.page.content.globalEvents&&!c){var g=d.page.content.globalEvents.filter(function(k){return k.localName==
a})[0];g&&d.$services.page.emit(g.globalName?g.globalName:a,b,c)}})},loadState:function(a,b){var c=this.$services.q.defer(),d=this.page.content.states.filter(function(e){return e.name==a})[0];d?(b=this.loadInitialState(d,!b))&&b.then?b.then(c,c):c.reject():(this.loadParameterState(a,!b),c.resolve());return c},loadParameterState:function(a,b){(a=this.page.content.parameters.filter(function(c){return c==a||c.name==a})[0])&&this.initializeDefaultParameters(!0,[a.name],!0)},loadInitialState:function(a,
b){if(a=this.page.content.states.filter(function(k){return k==a||k.name==a})[0]){var c=this,d=function(k){nabu.page.event.getName(k,"updateEvent")&&c.emit(nabu.page.event.getName(k,"updateEvent"),nabu.page.event.getInstance(k,"updateEvent",c.page,c))};if(a.inherited){if(b)return c.$services.page.reloadState(a.applicationName).then(function(k){d(a)})}else{var e={};Object.keys(a.bindings).map(function(k){e[k]=c.$services.page.getBindingValue(c,a.bindings[k])});e.$serviceContext||(e.$serviceContext=
c.getServiceContext());try{var g=c.$services.q.defer();c.$services.swagger.execute(a.operation,e).then(function(k){if(null!=c.variables[a.name])if(c.variables[a.name]instanceof Array)c.variables[a.name].splice(0),k instanceof Array?nabu.utils.arrays.merge(c.variables[a.name],k):k&&c.variables[a.name].push(k);else if(k){var m=Object.keys(k);Object.keys(c.variables[a.name]).forEach(function(p){0>m.indexOf(p)&&(c.variables[a.name][p]=null)});m.forEach(function(p){Vue.set(c.variables[a.name],p,k[p])})}else Vue.set(c.variables,
a.name,null);else Vue.set(c.variables,a.name,k?k:null);d(a);c.$services.triggerable.trigger(a,b?"update":"initial",null,c).then(g,g)},g);return g}catch(k){return console.error("Could not execute",a.operation,k),g=c.$services.q.defer(),g.reject(k),g}}}},addGlobalEvent:function(){this.page.content.globalEvents||Vue.set(this.page.content,"globalEvents",[]);this.page.content.globalEvents.push({localName:null,globalName:null})},addGlobalEventSubscription:function(){this.page.content.globalEventSubscriptions||
Vue.set(this.page.content,"globalEventSubscriptions",[]);this.page.content.globalEventSubscriptions.push({localName:null,globalName:null})},getLabel:function(a){return null==this.get(a)?null:this.$services.page.getValue(this.labels,a)},setLabel:function(a,b){this.$services.page.setValue(this.labels,a,b)},get:function(a){if(!a)return null;if("page"==a)return this.fragmentParent?this.fragmentParent.get(a):this.variables;if("page.$this"==a||"$page"==a||"$this"==a)return this.fragmentParent?this.fragmentParent.get(a):
this;if("parent.$this"==a||"$parent"==a){var b=this.page.content.pageParent?this.$services.page.getPageInstanceByName(this.page.content.pageParent):null;null==b&&(b=this.$services.page.getParentInstance(this));return b}if("parent"==a)return b=this.page.content.pageParent?this.$services.page.getPageInstanceByName(this.page.content.pageParent):null,null==b&&(b=this.$services.page.getParentInstance(this)),b?b.variables:null;if("application.title"==a)return this.$services.page.title;if(0==a.indexOf("application."))return a=
a.substring(12),b=this.$services.page.properties.filter(function(q){return q.key==a})[0],null==b&&(b=this.$services.page.environmentProperties.filter(function(q){return q.key==a})[0]),b?b.value:null;if(0==a.indexOf("parent.")){a=a.substring(7);var c=(b=this.page.content.pageParent?this.$services.page.getPageInstanceByName(this.page.content.pageParent):this.$services.page.getParentInstance(this))?b.get(a):null;null==c&&b&&(c=b.get("parent."+a));return c}if(0==a.indexOf("page.")){a=a.substring(5);b=
a.indexOf(".");var d=0<=b?a.substring(0,b):a;b=0<=b?a.substring(b+1):null;var e=this.$services.page.properties.filter(function(q){return q.key==d})[0],g=this.page.content.parameters?this.page.content.parameters.filter(function(q){return q.name==d})[0]:null,k=this.page.content.states?this.page.content.states.filter(function(q){return q.name==d})[0]:null;c=null;e?c=e.value:null!=g?c=this.variables[g.name]:null!=k?c=this.variables[k.name]:(c=this.parameters?this.parameters[a]:null,null==c&&(c=this.variables[d]),
null==c&&this.fragmentParent&&(c=this.fragmentParent.get(a)),null==c&&(this.variables.hasOwnProperty(d)||Vue.set(this.variables,d,null),c=this.variables[d]));if(null!=c&&null!=b)for(var m=b.split("."),p=0;p<m.length&&(c=c[m[p]],null!=c);p++);return c}c=null;nabu.page.providers("page-bindings").forEach(function(q){q=q();0<=Object.keys(q.definition).indexOf(m[0])&&(c=q.resolve(a.substring(a.indexOf(".")+1)))});if(null!=c)return c;m=a.split(".");this.variables.hasOwnProperty(m[0])||Vue.set(this.variables,
m[0],null);c=this.variables[m[0]];if(null==c||1==m.length||2==m.length&&"$all"==m[1])return c;b=this.variables[m[0]];for(p=1;p<m.length;p++)b&&=b instanceof Array?b.map(function(q){return q[m[p]]}):b[m[p]];return b},savePage:function(){this.savePageTimer&&(clearTimeout(this.savePageTimer),this.savePageTimer=null);var a=this;this.savePageTimer=setTimeout(function(){a.$services.page.update(a.page)},300)},isDevelopment:function(){return!0},hasLanguageSet:function(){return this.$services.language.current&&
this.$services.language.cookieValue},triggerConfiguration:function(){this.isDevelopment()||!this.$services.language||this.$services.language.current?this.emit("$configure",{}):this.$confirm({message:"You must select a language"})},setRouteParameters:function(a){var b="page cell childComponents edit pageInstanceId stopRerender".split(" "),c=this;Object.keys(a).forEach(function(d){if(0>b.indexOf(d)){var e=d;0!=d.indexOf("page.")&&(e="page."+d);console.log("setting",d,e,a[d]);c.set(e,a[d])}});return!1},
set:function(a,b,c){this.$setValue instanceof Function?this.$setValue(this,a,b,c):this.internalSet(a,b,c)},internalSet:function(a,b,c){var d=null,e=null,g=!1;if(a.indexOf&&0==a.indexOf("page.")){d=this.page.content.parameters?this.page.content.parameters.filter(function(p){return p.name==a.substring(5).split(".")[0]})[0]:null;e=a.substring(5).split(".");var k=this.$services.page.isPublicPageParameter(this.page,a.substring(5));d?(d=this.variables,g=k&&!this.masked):k?(d=this.parameters,this.masked||
(g=!0)):d=this.variables}else a.split&&(e=a.split("."),d=this.variables);if(e&&d){for(k=0;k<e.length-1;k++)d[e[k]]||Vue.set(d,e[k],{}),d=d[e[k]];Vue.set(d,e[e.length-1],b);this.$services.page.setValue(this.labels,a,null==c||c==b?null:c);g&&null!=this.$services.router.get(this.$services.page.alias(this.page)).url&&(b=this.$services.page.alias(this.page),c=this.$services.router.router.template(b,this.parameters),this.$services.router.router.updateUrl(b,c,this.parameters));if(a.indexOf&&0==a.indexOf("page."))for(;null!=
a;){if(this.subscriptions[a]){var m=this.get(a);this.subscriptions[a].forEach(function(p){p(m)})}b=a.lastIndexOf(".");if(0>b){a=null;break}else a=a.substring(0,b)}}else console.log("Could not set",a,b)},pageContentTag:function(){if(!this.page.content.pageType||"page"==this.page.content.pageType)return null;var a=this,b=nabu.page.providers("page-type").filter(function(c){return c.name==a.page.content.pageType})[0];return b?b.pageContentTag:null},pageTag:function(){if(!this.page.content.pageType||"page"==
this.page.content.pageType)return"div";var a=this,b=nabu.page.providers("page-type").filter(function(c){return c.name==a.page.content.pageType})[0];return this.edit&&b&&b.pageTagEdit?b.pageTagEdit:b&&b.pageTag?b.pageTag:"div"},getPageTypes:function(a){var b=["page"];nabu.utils.arrays.merge(b,nabu.page.providers("page-type").map(function(c){return c.name}));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b},hasConfigure:function(a){return(a=this.getComponentForCell(a.id))&&
a.configure},getRouteParameters:function(a){return(a=this.$services.router.get(a.alias))?this.$services.page.getRouteParameters(a):{}},getAvailableParameters:function(a){return this.$services.page.getAvailableParameters(this.page,a,!0)},canConfigureInline:function(a){return a?(a=this.getComponentForCell(a.id))&&a.configurator?a:!1:!1},getCellConfigurator:function(a){return(a=this.getComponentForCell(a.id))&&a.configurator()},getCellConfiguratorInput:function(a){var b=this.getComponentForCell(a.id),
c={};b.$options.props&&Object.keys(b.$options.props).forEach(function(d){c[d]=b[d]});return c},addDevice:function(a){a.devices||Vue.set(a,"devices",[]);a.devices.push({name:null,operator:"\x3e"})},suggestDevices:function(a){var b=this.$services.page.devices.map(function(c){return c.name});a&&a.match(/[0-9]+/)&&b.unshift(a);return b},removeCell:function(a,b){var c=this;this.$confirm({title:"Delete cell",message:"Are you sure you want to delete this cell?"}).then(function(){c.$services.page.closeRight();
a.splice(a.indexOf(b),1)})},removeInstance:function(a,b){Vue.set(a,"instances",{})},renameInstance:function(a,b,c){Vue.set(a.instances,c,a.instances[b]);Vue.delete(a.instances,b)},setContent:function(a){var b=this;this.$prompt(function(){return new nabu.page.views.PageAddCell({propsData:{page:b.page}})}).then(function(c){nabu.utils.objects.merge(a,c)})},copyCell:function(a){nabu.utils.objects.copy({type:"page-cell",content:a});this.$services.page.copiedCell=JSON.parse(JSON.stringify(a));this.$services.page.copiedRow=
null},copyRow:function(a){nabu.utils.objects.copy({type:"page-row",content:a});this.$services.page.copiedRow=JSON.parse(JSON.stringify(a));this.$services.page.copiedCell=null},pasteCell:function(a){a.cells.push(this.$services.page.renumber(this.page,this.$services.page.copiedCell));this.$services.page.copiedCell=null}},watch:{"page.content.globalEvents":{deep:!0,handler:function(a){var b=this;a&&a.forEach(function(c){c.properties=b.getEvents()[c.localName]})}},bodyClasses:function(a){document.body.classList.remove.apply(document.body.classList,
this.oldBodyClasses.splice(0));document.body.classList.add.apply(document.body.classList,a);nabu.utils.arrays.merge(this.oldBodyClasses,a)},"cell.aris":{deep:!0,handler:function(a){this.$services.page.setRerender(a)}},edit:function(a){a?document.body.setAttribute("page-editing",this.collapsedMenu?"small":"large"):document.body.removeAttribute("page-editing")},collapsedMenu:function(a){this.edit&&document.body.setAttribute("page-editing",a?"small":"large")},activeTab:function(a){this.edit&&(this.collapsedMenu=
!1)}}});
Vue.component("n-page-rows",{template:"#page-rows",props:{page:{type:Object,required:!0},rows:{type:Array,required:!0},edit:{type:Boolean,required:!1},parameters:{type:Object,required:!1},events:{type:Object,required:!0},localState:{type:Object,required:!1},root:{type:Boolean,required:!1,default:!1},stopRerender:{type:Boolean,required:!1,default:!1},depth:{type:Number,default:0}},methods:{rowsTag:function(){if(0<this.depth||!this.page.content.pageType||"page"==this.page.content.pageType)return"div";var a=
this,b=nabu.page.providers("page-type").filter(function(c){return c.name==a.page.content.pageType})[0];return this.edit&&b&&b.pageContentTagEdit?b.pageContentTagEdit:b&&b.pageContentTag?b.pageContentTag:"div"}}});nabu.page.views.PageOptimized=Vue.component("n-page-optimized",{mixins:[Vue.component("n-page")],template:"#nabu-optimized-page"});nabu.page.views.PageOptimized=Vue.component("n-page-optimized-column",{mixins:[Vue.component("n-page")],template:"#nabu-optimized-page-column"});
Vue.component("n-page-row",{template:"#page-row",props:{page:{type:Object,required:!0},row:{type:Object,required:!0},edit:{type:Boolean,required:!1},parameters:{type:Object,required:!1},stopRerender:{type:Boolean,required:!1,default:!1},depth:{type:Number,default:0},root:{type:Boolean,required:!1,default:!1},activeViews:{type:Array,default:function(){return[]}}},data:function(){return{configuring:null,permissionRendering:{},states:[]}},created:function(){var a=this;this.$on("close",function(){a.$parent.$emit("close")})},
methods:{getCurrentStates:function(){var a=[];nabu.utils.arrays.merge(a,this.states);this.$parent&&nabu.utils.arrays.merge(a,this.$parent.getCurrentStates());return a},isNoActiveView:function(){return 0==this.$services.page.activeViews.length},isActiveView:function(a){return 0<=this.$services.page.activeViews.indexOf(a)},acivateView:function(a){this.activeViews.splice(0);this.activeViews.push(a)},updateEvent:function(a,b,c){this.$parent&&this.$parent.$emit("update",a,b,c)},isContentHidden:function(a){return this.$services.page.getPageInstance(this.page,
this).isContentHidden(a)},getRendererParameters:function(a){var b={};if(a&&a.rendererBindings){var c=this,d=c.$services.page.getPageInstance(c.page,c);Object.keys(a.rendererBindings).forEach(function(e){var g=c.$services.page.getBindingValue(d,a.rendererBindings[e]);null!=g&&c.$services.page.setValue(b,e,g)})}return b},copyArisStyling:function(a,b){if(b.aris){var c=this.$services.page.getPageInstance(this.page,this);this.$services.page.copiedStyling=JSON.parse(JSON.stringify(b.aris));this.$services.notifier.push({message:"Copied styling for '"+
this.$services.page.formatPageItem(c,b)+"'",severity:this.$services.page.notificationStyle})}a.stopPropagation();a.preventDefault()},pasteArisStyling:function(a,b){if(this.$services.page.copiedStyling){null==b.aris&&Vue.set(b,"aris",{components:{}});var c=this.$services.page.getPageInstance(this.page,this);Vue.set(b,"aris",this.$services.page.copiedStyling);this.$services.page.setRerender(b.aris);this.$services.notifier.push({message:"Pasted styling onto '"+this.$services.page.formatPageItem(c,b)+
"'",severity:this.$services.page.notificationStyle})}a.stopPropagation();a.preventDefault()},goto:function(a,b,c,d){if(this.edit){this.$emit("select",b,c,c?"cell":"row",d?d:"selected");d=!0;var e;null!=c?(this.canConfigureInline(c)?this.configuring=c.id:(e=this.$services.page.getPageInstance(this.page,this).getComponentForCell(c.id))&&e.configure&&(e.configure(),d=!1),e=document.getElementById("layout-entry-"+c.id)):e=document.getElementById("layout-entry-"+b.id);d&&(this.configuring=c?c.id:b.id);
e&&e.scrollIntoView();a&&(a.stopPropagation(),a.preventDefault())}},suggesPageRowClasses:function(a){return this.$services.page.classes("page-row",a).filter(function(b){return 0>"empty is-hover-top is-hover-bottom is-hover-left is-hover-right is-hovering".split(" ").indexOf(b)})},getCellById:function(a,b){return!b.customId||b.alias||b.rows.length||b.renderer?document.getElementById(this.page.name+"_"+a.id+"_"+b.id):document.getElementById(b.customId)},getRowById:function(a){return a.customId&&!a.renderer?
document.getElementById(a.customId):document.getElementById(this.page.name+"_"+a.id)},dropCell:function(a,b,c){if(!c.alias){var d=this.$services.page.getDragData(a,"component-alias");this.getCellById(b,c);if(d)c.alias=d,a.preventDefault(),a.stopPropagation();else if(d=this.$services.page.getDragData(a,"template-content")){var e=JSON.parse(d);"page-cell"==e.type&&(this.$services.page.renumber(this.page,e.content),e=e.content,Object.keys(e).forEach(function(g){Vue.set(c,g,e[g])}),a.preventDefault(),
a.stopPropagation())}}},drop:function(a,b){var c=this.$services.page.getDragData(a,"component-alias"),d=document.getElementById(this.page.name+"_"+b.id).getBoundingClientRect(),e=Math.abs(a.clientY-d.top)>=d.height-d.height/6;d=Math.abs(a.clientY-d.top)<=d.height/6;if(c){if(e){var g=this.$services.page.getTarget(this.page.content,b.id,!0),k=g.rows.indexOf(b);b=this.addRow(g,!0);g.rows.splice(k+1,0,b)}else d&&(g=this.$services.page.getTarget(this.page.content,b.id,!0),k=g.rows.indexOf(b),b=this.addRow(g,
!0),g.rows.splice(k,0,b));this.addCell(b).alias=c;a.preventDefault();a.stopPropagation()}else if(c=this.$services.page.getDragData(a,"template-content")){c=JSON.parse(c);if("page-row"==c.type||"page-cell"==c.type)c=c.content;this.$services.page.renumber(this.page,c);c.cells?(g=this.$services.page.getTarget(this.page.content,b.id,!0),k=g.rows.indexOf(b),e?k==g.rows.length-1?g.rows.push(c):g.rows.splice(k+1,0,c):d?0==k?g.rows.unshift(c):g.rows.splice(k,0,c):g.rows.push(c)):c.rows&&(g=this.$services.page.getTarget(this.page.content,
b.id,!0),k=g.rows.indexOf(b),e?k>=g.rows.length-1?b=this.addRow(g):(b=this.addRow(g,!0),g.rows.splice(k+1,0,b)):d&&(0==k?(b=this.addRow(g,!0),g.rows.unshift(b)):(b=this.addRow(g,!0),g.rows.splice(k,0,b))),b.cells.push(c));c.actions&&nabu.utils.arrays.merge(this.page.content.actions,c.actions);a.preventDefault();a.stopPropagation()}},dragOverCell:function(a,b,c){if(!c.alias&&this.edit){var d=this.$services.page.hasDragData(a,"component-alias");d||(d=this.$services.page.hasDragData(a,"template-content"))&&
"page-cell"!=JSON.parse(this.$services.page.getDragData(event,"template-content")).type&&(d=null);d&&(b=document.getElementById(this.page.name+"_"+b.id+"_"+c.id),this.$services.page.pushDragItem(b),b.getBoundingClientRect(),b.classList.remove("is-hovering","is-hover-top","is-hover-bottom","is-hover-left","is-hover-right"),b.classList.add("is-hovering"),a.preventDefault(),a.stopPropagation())}},dragOver:function(a,b){if(this.edit){var c=this.$services.page.hasDragData(a,"component-alias");c||=this.$services.page.hasDragData(a,
"template-content");c&&(b=document.getElementById(this.page.name+"_"+b.id),this.$services.page.pushDragItem(b),c=b.getBoundingClientRect(),b.classList.remove("is-hovering","is-hover-top","is-hover-bottom","is-hover-left","is-hover-right"),Math.abs(event.clientY-c.top)>=c.height-c.height/6?b.classList.add("is-hover-bottom"):Math.abs(event.clientY-c.top)<=c.height/6?b.classList.add("is-hover-top"):b.classList.add("is-hovering"),a.preventDefault(),a.stopPropagation())}},dragExitCell:function(a,b,c){!c.alias&&
this.edit&&((b=document.getElementById(this.page.name+"_"+b.id+"_"+c.id))&&b.classList.remove("is-hovering"),a.preventDefault(),a.stopPropagation())},dragExit:function(a,b){(b=document.getElementById(this.page.name+"_"+b.id))&&b.classList.remove("is-hovering");a.preventDefault();a.stopPropagation()},setRowConfiguring:function(a){this.configuring=a},rowTagFor:function(a){var b=null==a.renderer?null:nabu.page.providers("page-renderer").filter(function(g){return g.name==a.renderer})[0];if(null==b){var c=
(b=this.getPageType(a))?b.pageType:null;if(!c||"page"==c)return this.isLinkContainer(a)?"a":"div";var d=nabu.page.providers("page-type").filter(function(g){return g.name==c})[0],e=null;d&&d.rowTag instanceof Function?e=d.rowTag(a,this.depth,this.edit,b.path,this.page):this.edit&&d&&d.rowTagEdit?e=d.rowTagEdit:d&&d.rowTag&&(e=d.rowTag);return e?e:"div"}return b.component},getPageType:function(a){return this.$services.page.getPageType(this.page,a)},targetHref:function(a){if(this.isLinkContainer(a))return this.$services.triggerable.calculateUrl(a.triggers[0].actions[0],
this,{})},isLinkContainer:function(a){return null==a.renderer&&null==a.alias&&a.triggers&&1==a.triggers.length&&1==a.triggers[0].actions.length&&"route"==a.triggers[0].actions[0].type?!0:!1},isDraggable:function(a){if(this.isLinkContainer(a))return!1},cellTagFor:function(a,b){var c=null==b.renderer?null:nabu.page.providers("page-renderer").filter(function(k){return k.name==b.renderer})[0];if(null==c||b.alias){var d=(c=this.getPageType(b))?c.pageType:null;if(!d||"page"==d)return this.isLinkContainer(b)?
"a":"div";var e=nabu.page.providers("page-type").filter(function(k){return k.name==d})[0],g=null;e&&e.cellTag instanceof Function?g=e.cellTag(a,b,this.depth,this.edit,c.path,this.page):this.edit&&e&&e.cellTagEdit?g=e.cellTagEdit:e&&e.cellTag&&(g=e.cellTag);return g?g:"div"}return c.component},getInstance:function(){return this.$services.page.instances[this.name]},getState:function(a,b){var c=this.getLocalState(a,b),d=this.$services.page.getPageInstance(this.page,this);Object.keys(d.variables).map(function(e){"undefined"==
typeof c[e]&&(c[e]=d.variables[e])});a=this.$services.page.getPageParameterValues(this.page,d);Object.keys(a).length&&(c.page=a);return c},getLocalState:function(a,b){var c={};if(this.localState){var d=this;Object.keys(this.localState).map(function(e){c[e]=d.localState[e]})}a&&a.data&&Object.keys(a.data).map(function(e){c[e]=a.data[e]});b&&b.data&&Object.keys(b.data).map(function(e){c[e]=b.data[e]});return c},getSideBarStyles:function(a){var b=[];null!=a.width&&("number"==typeof a.width||a.width.match&&
a.width.match(/^[0-9.]+$/)?b.push({"flex-grow":a.width}):b.push({"min-width":a.width}));return b},getStyles:function(a){var b=a.width,c=[];null!=b&&("number"==typeof b||b.match&&b.match(/^[0-9.]+$/)?c.push({"flex-grow":b}):c.push({"min-width":b}));a.height&&c.push({height:a.height});a.styleVariables&&this.$services.page.getDynamicVariables(a.styleVariables,this.variables,this).forEach(function(d){var e={};e["--"+d.name]=d.value;c.push(e)});return c},hasPageRoute:function(a){return a.alias&&(a=this.$services.router.get(a.alias))&&
a.isPage?!0:!1},up:function(a){var b=this.rows.indexOf(a);if(0<b){var c=this.rows[b-1];this.rows.splice(b-1,1,a);this.rows.splice(b,1,c)}},down:function(a){var b=this.rows.indexOf(a);if(b<this.rows.length-1){var c=this.rows[b+1];this.rows.splice(b+1,1,a);this.rows.splice(b,1,c)}},cellDown:function(a,b){var c=this.rows.indexOf(a);c<this.rows.length-1&&(c=this.rows[c+1],a.cells.splice(a.cells.indexOf(b)),c.cells.push(b))},cellUp:function(a,b){var c=this.rows.indexOf(a);0<c&&(c=this.rows[c-1],a.cells.splice(a.cells.indexOf(b)),
c.cells.push(b))},left:function(a,b){var c=a.cells.indexOf(b);if(0<c){var d=a.cells[c-1];a.cells.splice(c-1,1,b);a.cells.splice(c,1,d)}},right:function(a,b){var c=a.cells.indexOf(b);if(c<a.cells.length-1){var d=a.cells[c+1];a.cells.splice(c+1,1,b);a.cells.splice(c,1,d)}},canConfigure:function(a){return(a=this.$services.page.getPageInstance(this.page,this).getComponentForCell(a.id))&&a.configure},canConfigureInline:function(a){return(a=this.$services.page.getPageInstance(this.page,this).getComponentForCell(a.id))&&
a.configurator?a:!1},configureCell:function(a,b,c){var d=this.$services.page.getPageInstance(this.page,this).getComponentForCell(c.id);d&&d.configurator?this.goto(a,b,c,"cell"):d.configure?d.configure():this.goto(a,b,c,"cell")},close:function(a,b,c){var d=this.$services.page.getPageInstance(this.page,this),e=!1;b&&this.$services.page.isCloseable(b)&&(e=!0,Vue.set(d.closed,b.id,b.on?b.on:"$any"),b.cascadeClose&&(e=!1));a&&this.$services.page.isCloseable(a)&&(e=!0,Vue.set(d.closed,a.id,a.on?a.on:"$any"),
a.cascadeClose&&(e=!1));c&&this.$services.page.isCloseable(c)&&(e=!0,Vue.set(d.closed,c.id,c.on?c.on:"$any"),c.cascadeClose&&(e=!1));e||this.$parent.$emit("close")},shouldRenderRow:function(a){if(this.edit)return!0;if(a.devices&&!this.isDevice(a.devices)||a.condition&&!this.$services.page.isCondition(a.condition,this.getState(a),this))return!1;var b=this,c=b.$services.page.getPageInstance(b.page,b);if(a.permission||a.permissionContext||a.permissionServiceContext){var d=a.permission&&0==a.permission.indexOf("\x3d")?
this.$services.page.interpret(a.permission,this):a.permission,e=a.permissionContext&&0==a.permissionContext.indexOf("\x3d")?this.$services.page.interpret(a.permissionContext,this):a.permissionContext,g=a.permissionServiceContext&&0==a.permissionServiceContext.indexOf("\x3d")?this.$services.page.interpret(a.permissionServiceContext,this):a.permissionServiceContext;g||=c.getServiceContext();var k=g+"::"+e+"::"+d;this.permissionRendering.hasOwnProperty(k)||(Vue.set(this.permissionRendering,k,!1),this.$services.user.can({context:e,
name:d,serviceContext:g}).then(function(){Vue.set(b.permissionRendering,k,!0)}));if(!1===this.permissionRendering[k])return this.permissionRendering[k]}if(a.on){if(c.closed[a.id]||!c.get(a.on))return!1}else if(this.$services.page.isCloseable(a)&&c.closed[a.id])return!1;return this.$services.page.isCloseable(a)?!c.closed[a.id]:!0},isDevice:function(a){return this.$services.page.isDevice(a)},cellId:function(a){var b="page_"+this.pageInstanceId+"_cell_"+a.id;a.on&&a.optimizeVueKey&&(a=this.$services.page.getPageInstance(this.page,
this).get(a.on))&&(b+=JSON.stringify(a));return b},cellClasses:function(a){var b=this,c=[];if(a.renderer){var d=this.$services.page.getRenderer(a.renderer);d&&d.cssComponent&&c.push("is-"+d.cssComponent)}d=null;if(0==c.length){var e=this.getPageType(a),g=e?e.pageType:null;if(g){var k=nabu.page.providers("page-type").filter(function(q){return q.name==g})[0];k&&a.renderer&&k[a.renderer+"Component"]instanceof Function?d=k[a.renderer+"Component"](a):k&&a.renderer&&k[a.renderer+"Component"]?d=k[a.renderer+
"Component"]:k&&k.cellComponent instanceof Function?d=k.cellComponent(a,e.path,this.page):k&&k.cellComponent&&(d=k.cellComponent);d&&c.push("is-"+d)}}0==c.length&&(d="page-column",this.edit||!a.target||"page"==a.target?c.push("is-page-column"):("prompt"==a.target||"sidebar"==a.target||"absolute"==a.target)&&c.push("is-page-column"));if("pane"==a.target){c.push("is-pane-layer");var m=0;document.querySelectorAll(".is-pane-layer").forEach(function(q){q.getAttribute("cell-id")!=a.id&&q.classList.forEach(function(t){0==
t.indexOf("is-pane-layer")&&(t=t.substring(13))&&parseInt(t)>m&&(m=parseInt(t))})});c.push("is-pane-layer-"+(m+1))}this.$services.page.useAris&&a.aris&&a.aris.components&&(e=this.$services.page.calculateArisComponents(a.aris,a.alias,this),e[d]&&e[d].classes&&nabu.utils.arrays.merge(c,e[d].classes));if(a.styles){var p=b.$services.page.getPageInstance(b.page,b);nabu.utils.arrays.merge(c,this.$services.page.getDynamicClasses(a.styles,p.variables,this))}a.states&&(p=b.$services.page.getPageInstance(b.page,
b),a.states.forEach(function(q){q.condition&&!b.$services.page.isCondition(q.condition,p.variables,b)||c.push("is-"+q.name)}));return c},rowClasses:function(a){var b=[];if(a.renderer){var c=this.$services.page.getRenderer(a.renderer);c&&c.cssComponent&&b.push("is-"+c.cssComponent)}c=null;if(0==b.length){var d=this.getPageType(a),e=d?d.pageType:null;if(e){var g=nabu.page.providers("page-type").filter(function(k){return k.name==e})[0];g&&a.renderer&&g[a.renderer+"Component"]instanceof Function?c=g[a.renderer+
"Component"](a):g&&a.renderer&&g[a.renderer+"Component"]?c=g[a.renderer+"Component"]:g&&g.rowComponent instanceof Function?c=g.rowComponent(a,d.path,this.page):g&&g.rowComponent&&(c=g.rowComponent);c&&b.push("is-"+c)}}0==b.length&&(c="page-row",b.push("is-page-row"));this.$services.page.useAris&&a.aris&&a.aris.components&&(d=this.$services.page.calculateArisComponents(a.aris,a.renderer,this),d[c]&&d[c].classes&&nabu.utils.arrays.merge(b,d[c].classes));a.styles&&(c=this.$services.page.getPageInstance(this.page,
this),nabu.utils.arrays.merge(b,this.$services.page.getDynamicClasses(a.styles,c.variables,this)));return b},hasCellClickEvent:function(a){return a.clickEvent?"string"==typeof a.clickEvent?!0:nabu.page.event.getName(a,"clickEvent"):!1},shouldRenderCell:function(a,b){if(this.edit)return!0;if(!b.alias&&!b.rows.length&&!b.customId||b.devices&&!this.isDevice(b.devices)||b.condition&&!this.$services.page.isCondition(b.condition,this.getState(a,b),this))return!1;var c=this;a=c.$services.page.getPageInstance(c.page,
c);if(b.permission||b.permissionContext||b.permissionServiceContext){var d=b.permission&&0==b.permission.indexOf("\x3d")?this.$services.page.interpret(b.permission,this):b.permission,e=b.permissionContext&&0==b.permissionContext.indexOf("\x3d")?this.$services.page.interpret(b.permissionContext,this):b.permissionContext,g=b.permissionServiceContext&&0==b.permissionServiceContext.indexOf("\x3d")?this.$services.page.interpret(b.permissionServiceContext,this):b.permissionServiceContext;g||=a.getServiceContext();
var k=g+"::"+e+"::"+d+(b.permissionInversion?"::inverse":"");this.permissionRendering.hasOwnProperty(k)||(Vue.set(this.permissionRendering,k,!1),this.$services.user.can({context:e,name:d,serviceContext:g}).then(function(){Vue.set(c.permissionRendering,k,b.permissionInversion?!1:!0)}));if(!1===this.permissionRendering[k])return this.permissionRendering[k]}if(b.on){if(a.closed[b.id]||!a.get(b.on))return!1}else if(this.$services.page.isCloseable(b)&&a.closed[b.id])return!1;var m=[];nabu.page.providers("page-enumerate").map(function(p){m.push(p.name)});
return Object.keys(b.bindings).reduce(function(p,q){b.bindings[q]&&b.bindings[q].indexOf&&0==b.bindings[q].indexOf("fixed")||b.bindings[q]&&b.bindings[q].label&&"fixed"==b.bindings[q].label||b.bindings[q]&&b.bindings[q].split&&m.indexOf(b.bindings[q].split(".")[0]);return p},!0)},shouldRerenderCell:function(a,b){return b&&b.length?Object.keys(a.bindings).reduce(function(c,d){return c||0<=b.indexOf(a.bindings[d])},!1):!1},getCreatedComponent:function(a,b){return this.createdComponent.bind(this,a,b)},
createdComponent:function(a,b,c){this.$services.page.rendering++},mounted:function(a,b,c,d){var e=this,g=e.$services.page.getPageInstance(e.page,e);if(g)g.mounted(a,b,c,d);else for(g=this;g.$parent;)if(g=g.$parent,g.mounted){g.mounted(a,b,c,d);break}d.$on("close",function(){e.close(a)})},getMountedFor:function(a,b){return this.mounted.bind(this,a,b,this.getLocalState(b,a))},getCell:function(a){for(var b=0;b<this.rows.length;b++)if(this.rows[b].cells)for(var c=0;c<this.rows[b].cells.length;c++)if(this.rows[b].cells[c].id==
a)return this.rows[b].cells[c];return null},getRowEditStyle:function(a){return"background-color:"+this.getNameColor(a.name)+"; color: #fff"},getCellEditStyle:function(a){return"background-color:"+this.getNameColor(a.name)+"; color: #fff"},getNameColor:function(a){for(var b=0,c=0;c<a.length;c++)b=a.charCodeAt(c)+((b<<5)-b);return"hsl("+b%360+", 80%, 40%)"},getParameters:function(a,b){var c=this,d=c.$services.page.getPageInstance(c.page,c),e=null;b.contentRuntimeAlias&&!this.edit&&(e=d.variables[b.contentRuntimeAlias],
null==e&&(e={},Vue.set(d.variables,b.contentRuntimeAlias,e)));null==e&&(e={});e.page||(e.page=this.page);e.cell||(e.cell=b);null==e.edit&&(e.edit=this.edit);null==e.pageInstanceId&&(e.pageInstanceId=this.pageInstanceId);null==e.stopRerender&&(e.stopRerender=this.edit);this.$services.page.useAris&&b&&b.aris&&b.aris.components&&(e.childComponents=this.$services.page.calculateArisComponents(b.aris,null,this));b.on&&(e[b.on]=d.variables[b.on]);Object.keys(b.bindings).map(function(g){if(b.bindings[g]){var k=
c.$services.page.getBindingValue(d,b.bindings[g]);"undefined"!=typeof k&&null!=k&&(e[g]=k)}});return e},resetEvents:function(){this.$services.page.getPageInstance(this.page,this).resetEvents()},getClickParameters:function(a){var b={};b.ctrl=!!a.ctrlKey;b.shift=!!a.shiftKey;b.alt=!!a.altKey;b.meta=!!a.metaKey;return b},clickOnCell:function(a,b,c){!this.edit&&b&&b.state&&b.state.stopClickPropagation&&c&&c.stopPropagation();if(!this.edit&&this.$services.triggerable.canTrigger(b,"click"))return c&&c.preventDefault(),
this.$services.triggerable.trigger(b,"click",this.getClickParameters(c),this)},clickOnRow:function(a,b){!this.edit&&a&&a.state&&a.state.stopClickPropagation&&b&&b.stopPropagation();if(!this.edit&&this.$services.triggerable.canTrigger(a,"click"))return b&&b.preventDefault(),this.$services.triggerable.trigger(a,"click",this.getClickParameters(b),this)},clickOnContentCell:function(a,b){},autocloseCell:function(a,b,c){this.close(a,b)},addCell:function(a){var b={id:this.page.content.counter++,rows:[],
alias:null,bindings:{},name:null,state:{},target:"page",on:null,class:null,customId:null,width:null,height:null,condition:null,devices:[],clickEvent:null};a.cells||Vue.set(a,"cells",[]);this.$services.page.normalizeAris(this.page,b);a.cells.push(b);return b},addRow:function(a,b){a.rows||Vue.set(a,"rows",[]);var c={id:this.page.content.counter++,state:{},cells:[],class:null,customId:null,condition:null,direction:null,align:null,on:null,collapsed:!1,name:null};b||(a.rows.push(c),this.$services.page.normalizeAris(this.page,
c,"row"));return c},rowStyles:function(a){var b=[];"horizontal"==a.direction?b.push({"flex-direction":"row"}):"vertical"==a.direction&&b.push({"flex-direction":"column"});a.align&&b.push({"align-items":a.align});a.justify&&b.push({"justify-content":a.justify});a.styleVariables&&this.$services.page.getDynamicVariables(a.styleVariables,this.variables,this).forEach(function(c){var d={};d["--"+c.name]=c.value;b.push(d)});return b},rowButtonStyle:function(a){var b=[];"vertical"==a.direction&&b.push({display:"inline-block"});
return b},mouseOut:function(a,b,c){this.edit?((a=document.getElementById(this.page.name+"_"+b.id))&&a.classList.remove("is-hovering"),c&&(b=document.getElementById(this.page.name+"_"+b.id+"_"+c.id))&&b.classList.remove("is-hovering")):(c&&c.state&&c.state.stopHoverPropagation&&a.stopPropagation(),c&&this.$services.triggerable.untrigger(c,"hover",this),this.$services.triggerable.untrigger(b,"hover",this),b&&b.state&&b.state.stopHoverPropagation&&a.stopPropagation())},mouseOver:function(a,b,c){if(this.edit){var d=
document.getElementById(this.page.name+"_"+b.id);d&&d.classList.add("is-hovering");c&&((b=document.getElementById(this.page.name+"_"+b.id+"_"+c.id))&&b.classList.add("is-hovering"),a.shiftKey||a.stopPropagation())}else c&&c.state&&c.state.stopHoverPropagation&&a.stopPropagation(),c&&this.$services.triggerable.trigger(c,"hover",null,this),this.$services.triggerable.trigger(b,"hover",null,this),b&&b.state&&b.state.stopHoverPropagation&&a.stopPropagation()},menuHover:function(a){this.edit&&(a.target.$unhover&&
(clearTimeout(a.target.$unhover),a.target.$unhover=null),a.target.classList.add("is-menu-hovering"))},menuUnhover:function(a){this.edit&&(a.target.$unhover=setTimeout(function(){a.target.classList.remove("is-menu-hovering");a.target.$unhover=null},500))}}});Vue.component("n-prompt",{template:"#n-prompt",props:{autoclose:{type:Boolean,required:!1}}});
Vue.component("n-absolute",{template:"#n-absolute",props:{top:{required:!1},bottom:{required:!1},left:{required:!1},right:{required:!1},fixed:{required:!1},autoclose:{type:Boolean,required:!1},snapPoint:{type:String,default:"top-left"}},data:function(){return{relativeX:0,relativeY:0}},ready:function(){var a=this.$el.offsetParent;a&&(a=a.getBoundingClientRect(),this.relativeX=a.left,this.relativeY=a.top)},methods:{getStyles:function(){var a=[];null!=this.top&&a.push({top:this.top});null!=this.bottom&&
a.push({bottom:this.bottom});null!=this.left&&a.push({left:this.left});null!=this.right&&a.push({right:this.right});if(a.length)"center"==this.snapPoint?a.push({transform:"translate(-50%, -50%)"}):"bottom-right"==this.snapPoint?a.push({transform:"translate(-100%, -100%)"}):"bottom-left"==this.snapPoint?a.push({transform:"translate(0, -100%)"}):"top-right"==this.snapPoint&&a.push({transform:"translate(-100%, 0%)"});else{var b=this.$services.page.mouseYPassive-this.relativeY;a.push({left:+(this.$services.page.mouseXPassive-
this.relativeX)+"px"});a.push({top:+b+"px"})}this.fixed?a.push({position:"fixed"}):a.push({position:"absolute"});return a}}});
Vue.component("page-sidemenu",{template:"#page-sidemenu",props:{page:{type:Object,required:!0},rows:{type:Array,required:!0},selected:{type:Object,required:!1}},data:function(){return{opened:[],editing:null,aliasing:null,showMenuItem:null,showMenuType:null,offsetX:0,offsetY:0}},methods:{showMenu:function(a,b,c){this.offsetX=c.offsetX;this.offsetY=c.offsetY;console.log("offset",this.offsetX,this.offsetY);b?(this.showMenuType="cell",this.showMenuItem=b):a&&(this.showMenuType="row",this.showMenuItem=
a)},closeMenu:function(){this.showMenuItem=this.showMenuType=null},getCellIcon:function(a){if(a.templateIcon)return a.templateIcon;if(a.templateReferenceId)var b=this.$services.page.templates.filter(function(c){return c.id==a.templateReferenceId})[0];return b&&b.icon?b.icon:"cube"},formatPageItem:function(a){var b=this.$services.page.getPageInstance(this.page,this);return this.$services.page.formatPageItem(b,a)},requestFocusCell:function(a){this.$refs["cell_"+a.id]&&this.$refs["cell_"+a.id].length&&
this.$refs["cell_"+a.id][0].focus()},requestFocus:function(){var a=this;Vue.nextTick(function(){console.log("input is",a.$el.querySelector("input"));a.$el.querySelector("input").focus()})},wrapCell:function(a,b){var c=this.addCell(a,!0);c.aris=b.aris;c.name="Wrapper"+(b.alias?" for "+this.$services.page.prettifyRouteAlias(b.alias):"");b.aris=null;var d=a.cells.indexOf(b);a.cells.splice(d,1,c);a=this.addRow(c);a.cells.push(b)},rotate:function(a){this.$services.page.normalizeAris(this.page,a,"row");
a=a.aris.components["page-row"].options;var b=a.indexOf("direction_vertical");0<=b?a.splice(b,1):(b=a.indexOf("direction_horizontal"),0<=b&&a.splice(b,1),a.push("direction_vertical"))},up:function(a){var b=this.rows.indexOf(a);if(0<b){var c=this.rows[b-1];this.rows.splice(b-1,1,a);this.rows.splice(b,1,c);Vue.nextTick(function(){document.getElementById("layout-entry-"+a.id).querySelector("[tabindex]").focus()})}},down:function(a){var b=this.rows.indexOf(a);if(b<this.rows.length-1){var c=this.rows[b+
1];this.rows.splice(b+1,1,a);this.rows.splice(b,1,c);Vue.nextTick(function(){document.getElementById("layout-entry-"+a.id).querySelector("[tabindex]").focus()})}},cellDown:function(a,b){console.log("moving cell down!");var c=this.rows.indexOf(a);c<this.rows.length-1&&(c=this.rows[c+1],a.cells.splice(a.cells.indexOf(b)),c.cells.push(b),Vue.nextTick(function(){document.getElementById("layout-entry-"+b.id).querySelector("[tabindex]").focus()}))},cellUp:function(a,b){var c=this.rows.indexOf(a);0<c&&(c=
this.rows[c-1],a.cells.splice(a.cells.indexOf(b)),c.cells.push(b),Vue.nextTick(function(){document.getElementById("layout-entry-"+b.id).querySelector("[tabindex]").focus()}))},left:function(a,b){var c=a.cells.indexOf(b);if(0<c){var d=a.cells[c-1];a.cells.splice(c-1,1,b);a.cells.splice(c,1,d);Vue.nextTick(function(){document.getElementById("layout-entry-"+b.id).querySelector("[tabindex]").focus()})}},right:function(a,b){var c=a.cells.indexOf(b);if(c<a.cells.length-1){var d=a.cells[c+1];a.cells.splice(c+
1,1,b);a.cells.splice(c,1,d);Vue.nextTick(function(){document.getElementById("layout-entry-"+b.id).querySelector("[tabindex]").focus()})}},mouseOut:function(a,b,c){(a=document.getElementById(this.page.name+"_"+b.id))&&a.classList.remove("is-hovering");c&&(b=document.getElementById(this.page.name+"_"+b.id+"_"+c.id))&&b.classList.remove("is-hovering")},mouseOver:function(a,b,c){var d=document.getElementById(this.page.name+"_"+b.id);d&&d.classList.add("is-hovering");c&&((b=document.getElementById(this.page.name+
"_"+b.id+"_"+c.id))&&b.classList.add("is-hovering"),a.shiftKey||a.stopPropagation())},showHtml:function(a,b){var c=document.getElementById(this.page.name+"_"+a.id);b&&(c=document.getElementById(this.page.name+"_"+a.id+"_"+b.id));null!=c&&this.$services.page.showContent(c.innerHTML)},scrollIntoView:function(a,b){a=this.page.name+"_"+a.id;b&&(a+="_"+b.id);document.getElementById(a).scrollIntoView()},hasConfigure:function(a){return(a=this.$services.page.getPageInstance(this.page,this).getComponentForCell(a.id))&&
a.configure},configure:function(a){this.$services.page.getPageInstance(this.page,this).getComponentForCell(a.id).configure()},toggleRow:function(a){var b=this.opened.indexOf(a.id);0>b?this.opened.push(a.id):this.opened.splice(b,1)},selectRow:function(a){var b=this.selected==a;this.$emit("select",a,null,"row");var c=this.opened.indexOf(a.id);0>c?(this.configureRow(a),this.opened.push(a.id)):b?this.opened.splice(c,1):this.configureRow(a)},configureRow:function(a){for(var b=this.getRowById(a).parentNode;!(null==
b||b.__vue__&&b.__vue__.setRowConfiguring);)b=b.parentNode;b&&b.__vue__.setRowConfiguring(a.id)},selectCell:function(a,b){this.$emit("select",a,b,"cell");this.configureCell(a,b)},getCellById:function(a,b){return!b.customId||b.alias||b.rows.length||b.renderer?document.getElementById(this.page.name+"_"+a.id+"_"+b.id):document.getElementById(b.customId)},getRowById:function(a){return a.customId&&!a.renderer?document.getElementById(a.customId):document.getElementById(this.page.name+"_"+a.id)},configureCell:function(a,
b){a=this.getCellById(a,b);if(null!=a){for(a=a.parentNode;!(null==a||a.__vue__&&a.__vue__.setRowConfiguring);)a=a.parentNode;a&&a.__vue__.setRowConfiguring(b.id)}},addRow:function(a){a.rows||Vue.set(a,"rows",[]);var b={id:this.page.content.counter++,state:{},cells:[],class:null,customId:null,condition:null,direction:null,align:null,on:null,collapsed:!1,name:null};a.rows.push(b);return b},removeCell:function(a,b){this.$confirm({message:"Are you sure you want to remove this cell?"}).then(function(){a.splice(a.indexOf(b),
1)})},removeRow:function(a,b){self.$services.page.closeRight();a.rows.splice(a.rows(indexOf(b),1))},addCell:function(a,b){a.cells||Vue.set(a,"cells",[]);var c={id:this.page.content.counter++,rows:[],alias:null,bindings:{},name:null,state:{},target:"page",on:null,class:null,customId:null,width:null,height:null,condition:null,devices:[],clickEvent:null};b||(a.cells.push(c),this.$services.page.normalizeAris(this.page,c));return c},copyCell:function(a){nabu.utils.objects.copy({type:"page-cell",content:a});
this.$services.page.copiedCell=JSON.parse(JSON.stringify(a));this.$services.page.copiedRow=null},copyRow:function(a){nabu.utils.objects.copy({type:"page-row",content:a});this.$services.page.copiedRow=JSON.parse(JSON.stringify(a));this.$services.page.copiedCell=null},pasteCell:function(a){a.cells.push(this.$services.page.renumber(this.page,this.$services.page.copiedCell));this.$services.page.copiedCell=nabu.utils.objects.deepClone(this.$services.page.copiedCell)},pasteRow:function(a){a.rows||Vue.set(a,
"rows",[]);a.rows.push(this.$services.page.renumber(this.page,this.$services.page.copiedRow));this.$services.page.copiedRow=nabu.utils.objects.deepClone(this.$services.page.copiedRow)},dragCell:function(a,b,c){this.$services.page.setDragData(a,"page-cell",c.id);a.ctrlKey&&this.$services.page.setDragData(a,"drag-action","copy")},dragRow:function(a,b){this.$services.page.setDragData(a,"page-row",b.id);a.ctrlKey&&this.$services.page.setDragData(a,"drag-action","copy")},acceptDragRow:function(a,b){this.$services.page.hasDragData(a,
"page-cell")?a.preventDefault():this.$services.page.hasDragData(a,"page-row")&&(this.$services.page.pushDragItem(a.target),b=a.target.getBoundingClientRect(),Math.abs(a.clientY-b.top)>=b.height/2?(a.target.classList.remove("is-hover-top"),a.target.classList.add("is-hover-bottom")):(a.target.classList.remove("is-hover-bottom"),a.target.classList.add("is-hover-top")),a.preventDefault())},acceptDragCell:function(a,b,c){this.$services.page.hasDragData(a,"page-row")?a.preventDefault():this.$services.page.hasDragData(a,
"page-cell")&&(this.$services.page.pushDragItem(a.target),b=a.target.getBoundingClientRect(),Math.abs(a.clientY-b.top)>=b.height/2?(a.target.classList.remove("is-hover-top"),a.target.classList.add("is-hover-bottom")):(a.target.classList.remove("is-hover-bottom"),a.target.classList.add("is-hover-top")),a.preventDefault())},dropRow:function(a,b){var c=this.$services.page.getDragData(a,"page-cell"),d=this.$services.page.getDragData(a,"page-row");if(c){c=this.$services.page.getTarget(this.page.content,
c);var e=this.$services.page.getDragData(a,"drag-action");b.cells||Vue.set(b,"cells",[]);if("copy"==e)c=JSON.parse(JSON.stringify(c)),this.$services.page.renumber(this.page,c);else{var g=this.$services.page.getTarget(this.page.content,c.id,!0);if(g==b)return null;e=g.cells.indexOf(c);if(0<=e&&(g.cells.splice(e,1),0==g.cells.length)){var k=this.$services.page.getTarget(this.page.content,g.id,!0);e=k.rows.indexOf(g);k.rows.splice(e,1)}}b.cells.push(c)}d&&b.id!=d&&(c=this.$services.page.getTarget(this.page.content,
d),e=this.$services.page.getDragData(a,"drag-action"),g=this.$services.page.getTarget(this.page.content,b.id,!0),"copy"==e?(c=JSON.parse(JSON.stringify(c)),this.$services.page.renumber(this.page,c)):(this.$services.page.closeRight(),d=this.$services.page.getTarget(this.page.content,c.id,!0),e=d.rows.indexOf(c),0<=e&&(d.rows.splice(e,1),0==d.rows.length&&d.id&&!d.alias&&(k=this.$services.page.getTarget(this.page.content,d.id,!0),e=k.cells.indexOf(d),k.cells.splice(e,1)))),d=a.target.getBoundingClientRect(),
e=g.rows.indexOf(b),Math.abs(a.clientY-d.top)>=d.height/2?g.rows.splice(e+1,0,c):g.rows.splice(e,0,c));this.$services.page.clearAllDrag()},dropCell:function(a,b,c){var d=this.$services.page.getDragData(a,"page-cell"),e=this.$services.page.getDragData(a,"page-row");if(d&&c.id!=d){d=this.$services.page.getTarget(this.page.content,d);var g=this.$services.page.getDragData(a,"drag-action"),k=this.$services.page.getTarget(this.page.content,c.id,!0);if("copy"==g)d=JSON.parse(JSON.stringify(d)),this.$services.page.renumber(this.page,
d);else{this.$services.page.closeRight();var m=this.$services.page.getTarget(this.page.content,d.id,!0);g=m.cells.indexOf(d);if(0<=g&&(m.cells.splice(g,1),0==m.cells.length)){var p=this.$services.page.getTarget(this.page.content,m.id,!0);g=p.rows.indexOf(m);p.rows.splice(g,1)}}m=a.target.getBoundingClientRect();g=k.cells.indexOf(c);Math.abs(a.clientY-m.top)>=m.height/2?k.cells.splice(g+1,0,d):k.cells.splice(g,0,d)}e&&b.id!=e&&(d=this.$services.page.getTarget(this.page.content,e),g=this.$services.page.getDragData(a,
"drag-action"),"copy"==g?(d=JSON.parse(JSON.stringify(d)),this.$services.page.renumber(this.page,d)):(k=this.$services.page.getTarget(this.page.content,d.id,!0),g=k.rows.indexOf(d),0<=g&&(k.rows.splice(g,1),0==k.rows.length&&k.id&&!k.alias&&(p=this.$services.page.getTarget(this.page.content,k.id,!0),g=p.cells.indexOf(k),p.cells.splice(g,1)))),a.target.getBoundingClientRect(),c.rows||Vue.set(c,"rows",[]),c.rows.push(d));this.$services.page.clearAllDrag()}},watch:{selected:function(a){if(0<=this.rows.indexOf(a))0>
this.opened.indexOf(a.id)&&this.opened.push(a.id),this.$emit("open");else{var b=this;this.rows.forEach(function(c){c.cells&&0<=c.cells.indexOf(a)&&(0>b.opened.indexOf(c.id)&&b.opened.push(c.id),b.$emit("open"))})}}}});
Vue.component("aris-editor",{template:"#aris-editor",props:{childComponents:{type:Array,required:!0},container:{type:Object,required:!0},specific:{type:String,required:!1}},data:function(){return{conditioning:null,search:null}},methods:{hasAnySearchHits:function(a,b){if(!this.search)return!0;var c=[];b?c.push(b):nabu.utils.arrays.merge(c,a.options);var d=!1,e=new RegExp(this.search.toLowerCase().replace(/[\s]+/g,".*"));c.forEach(function(g){d||!g.name.toLowerCase().match(e)&&!g.body.toLowerCase().match(e)||
(d=!0)});return d},getAmountOfAppliedOptions:function(a){var b=this,c=this.getAvailableModifiers(a);c=Object.keys(c).filter(function(e){return b.isActiveModifier(a,e)}).length;var d=0;this.getAvailableDimensions(a).forEach(function(e){d+=e.options.filter(function(g){return b.isActiveOption(a,e,g.name)}).length});return d+c},getFormattedAmountOfAppliedOptions:function(a){var b=this.getAmountOfAppliedOptions(a);return this.search?(a=this.getAmountOfSearchHits(a),b?" ("+b+" active, "+a+" matches)":" ("+
a+" matches)"):b?" ("+b+" active)":""},getAmountOfSearchHits:function(a){if(!this.search)return 0;var b=this;return this.getAvailableDimensions(a).filter(function(c){return b.hasAnySearchHits(c)}).length},formatBody:function(a){return("\t"+a).replace(/[\n]+/g,"\x3cbr/\x3e").replace(/[\t]/g,"\x26nbsp;\x26nbsp;\x26nbsp;")},getAvailableDimensions:function(a){var b=[],c=this;this.$services.page.getArisComponentHierarchy(a.component).forEach(function(d){d.dimensions&&d.dimensions.forEach(function(e){var g=
b.filter(function(k){return k.name==e.name})[0];g||(g={name:e.name},b.push(g));g.options||(g.options=[]);g.components||(g.components=[]);g.components.push(d.name);0<g.options.length?e.options.forEach(function(k){var m=g.options.filter(function(p){return p.name==k.name})[0];null==m?g.options.push(JSON.parse(JSON.stringify(k))):0>m.body.indexOf(k.body)&&(m.body+="\n"+k.body)}):nabu.utils.arrays.merge(g.options,e.options);g.options=g.options.filter(function(k){return c.$services.page.isThemeCompliant(k)})})});
b=b.filter(function(d){return 0<d.options.length});b.sort(function(d,e){return d.name.localeCompare(e.name)});return b},getAvailableVariants:function(a){var b=[],c=this;this.$services.page.getArisComponentHierarchy(a.component).forEach(function(d){null!=d.variants&&d.variants.filter(function(e){return c.$services.page.isThemeCompliant(e)}).forEach(function(e){e=JSON.parse(JSON.stringify(e));e.component=d.name;b.push(e)})});return b},getAvailableVariantNames:function(a,b){var c=[];this.getAvailableVariants(a).forEach(function(d){0>
c.indexOf(d.name)&&c.push(d.name)});b&&(c=c.filter(function(d){return 0<=d.toLowerCase().indexOf(b.toLowerCase())}));c.sort();return c},isActiveModifier:function(a,b){return 0<=this.container.components[a.name].modifiers.indexOf(b)},hasCondition:function(a,b){return null!=this.container.components[a.name].conditions[b]},getCondition:function(a,b){return this.container.components[a.name].conditions[b]},setCondition:function(a,b,c){this.container.components[a.name].conditions[b]=null==c?null:c},toggleModifier:function(a,
b){var c=this.container.components[a.name].modifiers.indexOf(b);0<=c?(this.container.components[a.name].modifiers.splice(c,1),this.container.components[a.name].conditions[b]=null):this.container.components[a.name].modifiers.push(b)},getAvailableModifiers:function(a){var b=this.container.components[a.name].variant,c={},d=this;this.getAvailableVariants(a).filter(function(e){return d.$services.page.isThemeCompliant(e)&&("default"==e.name||e.name==b)}).forEach(function(e){e.modifiers&&e.modifiers.forEach(function(g){null==
c[g]&&(c[g]=[]);c[g].push({variant:e.name,component:e.component})})});return c},getAvailableModifierNames:function(a){a=Object.keys(this.getAvailableModifiers(a));a.sort();return a},getAvailableOptions:function(a,b){var c=this;return(a=this.getAvailableDimensions(a).filter(function(d){return c.$services.page.isThemeCompliant(d)&&d.name==b.name}))?a.options:[]},toggleOption:function(a,b,c){var d=this.container.components[a.name].options.indexOf(b.name+"_"+c);0<=d?(this.container.components[a.name].options.splice(d,
1),this.container.components[a.name].conditions[b.name+"_"+c]=null):this.container.components[a.name].options.push(b.name+"_"+c)},isActiveOption:function(a,b,c){return 0<=this.container.components[a.name].options.indexOf(b.name+"_"+c)},listActiveOptions:function(a,b){a=this.container.components[a.name].options.filter(function(c){return 0==c.indexOf(b.name+"_")}).map(function(c){return c.substring((b.name+"_").length)});return 0==a.length?null:a.join(", ")},listActiveModifiers:function(a){a=this.container.components[a.name].modifiers;
return 0==a.length?null:a.join(", ")},clearOptions:function(a){this.container.components[a.name].variant=null;this.container.components[a.name].options.splice(0);this.container.components[a.name].modifiers.splice(0)},clearDimension:function(a,b){var c=this.container.components[a.name].options.filter(function(d){return 0>d.indexOf(b+"_")});this.container.components[a.name].options.splice(0);nabu.utils.arrays.merge(this.container.components[a.name].options,c)},saveAsDefaultAris:function(a){var b=this.container.components[a.name];
if(b){var c="";null!=b.variant&&"default"!=b.variant&&this.getAvailableVariants(a).filter(function(g){return g.name==b.variant}).forEach(function(g){c+="\t@include "+g.component+"_variant_"+b.variant+";\n"});var d=this.getAvailableDimensions(a);b.options.forEach(function(g){g=g.split("_");var k=g[0],m=g[1];(g=d.filter(function(p){return p.name==k})[0])&&g.components.forEach(function(p){c+="\t@include "+p+"_"+k+"_"+m+";\n"})});var e=this.getAvailableModifiers(a);b.modifiers.forEach(function(g){null!=
e[g]&&e[g].forEach(function(k){c+="\t@include "+k.component+"-"+k.variant+"_modifier_"+g+";\n"})});this.$services.swagger.execute("nabu.web.page.core.v2.rest.aris.variant.update",{variant:a.component+"_variant_"+(a.defaultVariant?a.defaultVariant:a.name)+(this.specific&&"page-column"==a.name?"-"+this.specific:""),body:{content:0==c.length?null:c.substring(0,c.length-1)}})}this.clearOptions(a)},prettifyOption:function(a){return a}},watch:{container:{deep:!0,handler:function(a){a&&!a.hasOwnProperty("rerender")?
Object.defineProperty(a,"rerender",{value:!0,enumerable:!1,writable:!0}):a.rerender=!0}}}});
Vue.component("renderer-bindings",{template:"#renderer-bindings",props:{page:{type:Object,required:!0},target:{type:Object,required:!0}},created:function(){console.log("created bindings thing",this.fields);this.target.rendererBindings||Vue.set(this.target,"rendererBindings",{})},computed:{fields:function(){var a=[];if(this.target.renderer){var b=this.$services.page.getRendererState(this.target.renderer,this.target,this.page,this.$services.page.getAllAvailableParameters(this.page));b&&nabu.utils.arrays.merge(a,
this.$services.page.getSimpleKeysFor(b,!0,!0))}console.log("fields are",a);return a}},data:function(){return{automapFrom:null}},methods:{automap:function(){if(this.automapFrom){var a=nabu.page.providers("page-generator").filter(function(c){return"form"==c.name.toLowerCase()})[0],b=this.$services.page.getPageInstance(this.page,this);a.automap(this.target,b,this.automapFrom)}}}});
Vue.component("template-manager",{template:"#template-manager",props:{page:{type:Object,required:!0},target:{type:Object,required:!0}},computed:{path:function(){return this.$services.page.getTargetPath(this.page.content,this.target.id)},excluded:function(){var a=this;return 0<this.path.filter(function(b){return b.id!=a.target.id&&!!b.excludeFromTemplate}).length},partOfTemplate:function(){var a=this;return 0<this.path.filter(function(b){return b.id!=a.target.id&&!!b.isTemplate}).length},latestAvailableVersion:function(){var a=
this,b=this.$services.page.templates.filter(function(c){return c.id==a.target.templateReferenceId})[0];console.log("current version is",b);return b?b.templateVersion:null}},methods:{release:function(){this.target.templateVersion++;this.target.templateStable=JSON.parse(JSON.stringify(this.target));this.target.templateStable.templateStable=null;this.target.templateStable.isTemplate=!1;this.target.templateStable.isTemplateInstance=!0;this.target.templateStable.templateId=null;var a=this,b=function(c){c.templateReferenceId=
a.target.templateId;c.templateFragmentId=c.id;var d=c.cells?c.cells:c.rows;d&&(d.filter(function(e){return!!e.excludeFromTemplate}).forEach(function(e){d.splice(d.indexOf(e),1)}),d.forEach(function(e){b(e)}))};b(this.target.templateStable)},updateToLatest:function(){var a=this,b=this.$services.page.templates.filter(function(g){return g.id==a.target.templateReferenceId})[0],c=JSON.parse(b.content).content,d=function(g,k){if(g.id==k)return g;if(g.cells)return g.cells.reduce(function(m,p){return null==
m?d(p,k):m},null);if(g.rows)return g.rows.reduce(function(m,p){return null==m?d(p,k):m},null)},e=function(g){var k=d(c,g.templateFragmentId);k&&k.aris&&(Vue.set(g,"aris",k.aris),a.$services.page.setRerender(g.aris));g.cells&&g.cells.forEach(e);g.rows&&g.rows.forEach(e)};e(this.target);this.target.templateVersion=b.templateVersion}},watch:{"target.isTemplate":function(a){a&&(Vue.set(this.target,"templateVersion",0),Vue.set(this.page.content,"hasTemplates",!0),Vue.set(this.target,"templateId",this.page.content.name+
"-"+this.target.id))}}});
document.addEventListener("keydown",function(a){if("s"==a.key&&(a.ctrlKey||a.metaKey)&&application.services.page.editing)application.services.page.editing.save(a);else if("d"==a.key&&(a.ctrlKey||a.metaKey)&&application.services.page.editing)application.services.page.editing.activeTab="layout",a.preventDefault(),a.stopPropagation();else if("g"==a.key&&(a.ctrlKey||a.metaKey)&&application.services.page.editing){if(application.services.page.editing.cell||application.services.page.editing.row)application.services.page.editing.activeTab="selected",
a.preventDefault();a.stopPropagation()}else if("b"==a.key&&(a.ctrlKey||a.metaKey)&&application.services.page.editing)application.services.page.editing.activeTab="settings",a.preventDefault(),a.stopPropagation();else if("Digit1"==a.code&&a.altKey&&application.services.page.editing)application.services.page.activeSubTab="container",a.preventDefault();else if("Digit2"==a.code&&a.altKey&&application.services.page.editing)application.services.page.activeSubTab="styling",a.preventDefault();else if("Digit3"==
a.code&&a.altKey&&application.services.page.editing)application.services.page.activeSubTab="triggers",a.preventDefault();else if(("Digit4"==a.code||"Digit5"==a.code||"Digit6"==a.code||"Digit7"==a.code||"Digit8"==a.code||"Digit9"==a.code)&&a.altKey&&application.services.page.editing){var b=parseInt(a.code.substring(5))-4;application.services.page.activeSubTab=b<application.services.page.availableSubTabs.length?application.services.page.availableSubTabs[b]:0==application.services.page.availableSubTabs.length&&
"Digit4"==a.code?"component":"analysis";a.preventDefault()}else"s"==a.key&&a.altKey&&application.services.page.editing?(application.services.page.editing.activeTab="selected",application.services.page.activeSubTab="styling",a.preventDefault(),a.stopPropagation()):"t"==a.key&&a.altKey&&application.services.page.editing?(application.services.page.editing.activeTab="selected",application.services.page.activeSubTab="triggers",a.preventDefault(),a.stopPropagation()):"e"==a.key&&(a.ctrlKey||a.metaKey)&&
application.services.page.editing&&(application.services.page.editing.stopEdit(),a.preventDefault(),a.stopPropagation())},!0);document.addEventListener("dragend",function(){application.services.page.clearAllDrag()});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.PageFieldsEdit=Vue.component("page-fields-edit",{template:"#page-fields-edit",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},allowMultiple:{type:Boolean,required:!1,default:!0},keys:{type:Array,required:!1},allowEditable:{type:Boolean,required:!1,default:!1},localState:{type:Object,required:!1},fieldsName:{type:String,required:!1,default:"fields"},basic:{type:Boolean,required:!1,default:!1},allowArbitrary:{type:Boolean,required:!1,default:!0},allowEvents:{type:Boolean,
default:!0}},data:function(){return{addAllSelector:null}},created:function(){this.cell.state[this.fieldsName]||Vue.set(this.cell.state,this.fieldsName,[]);this.allowMultiple||this.cell.state[this.fieldsName].length||this.addField();this.normalize()},computed:{fragmentTypes:function(){var a=nabu.page.providers("page-field-fragment");this.allowEditable||(a=a.filter(function(b){return!b.editable}));a=a.map(function(b){return b.name});a.sort();return a}},methods:{addAll:function(){if(this.addAllSelector){var a=
this;this.getKeys(this.addAllSelector).forEach(function(b){var c=a.addField(!1);c.fragments[0].key=b;b=b.split(".");b=b[b.length-1];c.label="%{"+b.substring(0,1).toUpperCase()+b.substring(1).replace(/([A-Z])/g," $1")+"}"});this.addAllSelector=null}},getProvidedConfiguration:function(a){var b=nabu.page.providers("page-field-fragment").filter(function(c){return c.name==a})[0];return b?b.configure:null},normalize:function(){this.cell.state[this.fieldsName].map(function(a){a.label||Vue.set(a,"label",
null);a.fragments||Vue.set(a,"fragments",[]);a.styles||Vue.set(a,"styles",[]);a.hidden||Vue.set(a,"hidden",null);a.fragments.map(function(b){b.type||Vue.set(b,"type","data");b.content||Vue.set(b,"content",null);b.format||Vue.set(b,"format",null);b.javascript||Vue.set(b,"javascript",null);b.template||Vue.set(b,"template",null);b.class||Vue.set(b,"class",null);b.key||Vue.set(b,"key",null);b.form||Vue.set(b,"form",{})})})},addStyle:function(a){a.styles.push({class:null,condition:null})},fieldUp:function(a){var b=
this.cell.state[this.fieldsName].indexOf(a);if(0<b){var c=this.cell.state[this.fieldsName][b-1];this.cell.state[this.fieldsName].splice(b-1,1,a);this.cell.state[this.fieldsName].splice(b,1,c)}},fieldDown:function(a){var b=this.cell.state[this.fieldsName].indexOf(a);if(b<this.cell.state[this.fieldsName].length-1){var c=this.cell.state[this.fieldsName][b+1];this.cell.state[this.fieldsName].splice(b+1,1,a);this.cell.state[this.fieldsName].splice(b,1,c)}},fieldBeginning:function(a){var b=this.cell.state[this.fieldsName].indexOf(a);
0<b&&(this.cell.state[this.fieldsName].splice(b,1),this.cell.state[this.fieldsName].unshift(a))},fieldEnd:function(a){var b=this.cell.state[this.fieldsName].indexOf(a);b<this.cell.state[this.fieldsName].length-1&&(this.cell.state[this.fieldsName].splice(b,1),this.cell.state[this.fieldsName].push(a))},up:function(a,b){var c=a.fragments.indexOf(b);if(0<c){var d=a.fragments[c-1];a.fragments.splice(c-1,1,b);a.fragments.splice(c,1,d)}},down:function(a,b){var c=a.fragments.indexOf(b);if(c<a.fragments.length-
1){var d=a.fragments[c+1];a.fragments.splice(c+1,1,b);a.fragments.splice(c,1,d)}},addField:function(a){a={label:null,info:null,infoIcon:null,fragments:[],hidden:null,styles:[],arbitrary:!!a};this.cell.state[this.fieldsName].push(a);this.addFragment(a);return a},addFragment:function(a){var b={type:"data",content:null,format:null,javascript:null,template:null,class:null,key:null,disabled:null,hidden:null,form:{}};a.fragments.push(b);return b},getKeys:function(a){if(this.keys)var b=this.keys;else b=
this.$services.page.getAvailableParameters(this.page,this.cell,!0),b=this.$services.page.getSimpleKeysFor({properties:b},!0);return a?b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}):b}}});
Vue.component("page-fields-edit-main",{template:"#page-fields-edit-main",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},data:{required:!1},shouldStyle:{type:Boolean,required:!1,default:!0},label:{type:Boolean,required:!1,default:null},localState:{type:Object,required:!1},fieldsName:{type:String,required:!1,default:"fields"}}});
nabu.page.views.PageFields=Vue.component("page-fields",{template:"#page-fields",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},data:{required:!1},shouldStyle:{type:Boolean,required:!1,default:!0},label:{type:Boolean,required:!1,default:null},localState:{type:Object,required:!1},fieldsName:{type:String,required:!1,default:"fields"}},data:function(){return{configuring:!1}},created:function(){this.normalize(this.cell.state)},
methods:{configurator:function(){return"page-fields-edit-main"},normalize:function(a){a.class||Vue.set(a,"class",null)},getEvents:function(){var a={},b=this;this.cell.state[this.fieldsName]&&this.cell.state[this.fieldsName].forEach(function(c){c.fragments&&c.fragments.forEach(function(d){if(d.clickEvent)if("string"==typeof d.clickEvent)a[d.clickEvent]={};else if(nabu.page.event.getName(d,"clickEvent")&&"$close"!=nabu.page.event.getName(d,"clickEvent")){var e=nabu.page.event.getType(d,"clickEvent");
e.properties&&0==Object.keys(e.properties).length&&b.cell.on&&(e=b.cell.on);a[nabu.page.event.getName(d,"clickEvent")]=e}})});return a}}});
nabu.page.views.PageFieldsTable=Vue.component("page-fields-table",{template:"#page-fields-table",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},data:{required:!1},shouldStyle:{type:Boolean,required:!1,default:!0},label:{type:Boolean,required:!1,default:null},localState:{type:Object,required:!1},fieldsName:{type:String,required:!1,default:"fields"}},data:function(){return{configuring:!1}},created:function(){this.normalize(this.cell.state)},
methods:{configure:function(){this.configuring=!0},normalize:function(a){a.class||Vue.set(a,"class",null);a.display||Vue.set(a,"class","row")},getEvents:function(){var a={},b=this;this.cell.state[this.fieldsName]&&this.cell.state[this.fieldsName].forEach(function(c){c.fragments&&c.fragments.forEach(function(d){if(d.clickEvent)if("string"==typeof d.clickEvent)a[d.clickEvent]={};else if(nabu.page.event.getName(d,"clickEvent")&&"$close"!=nabu.page.event.getName(d,"clickEvent")){var e=nabu.page.event.getType(d,
"clickEvent");e.properties&&0==Object.keys(e.properties).length&&b.cell.on&&(e=b.cell.on);a[nabu.page.event.getName(d,"clickEvent")]=e}})});return a}}});
Vue.component("page-field",{template:"#page-field",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},data:{type:Object,required:!0},field:{type:Object,required:!0},shouldStyle:{type:Boolean,required:!1},label:{type:Boolean,required:!1},edit:{type:Boolean,required:!1},actions:{type:Array,required:!1,default:function(){return[]}}},computed:{fieldAction:function(){return this.actions.filter(function(a){return!a.icon&&!a.label})[0]},otherActions:function(){return this.actions.filter(function(a){return a.icon||
a.label})}},methods:{trigger:function(a){if(a&&(!a.condition||this.$services.page.isCondition(a.condition,{record:this.data},this)))return this.$services.page.getPageInstance(this.page,this).emit(a.name,this.data)},hasClickEvent:function(a){return a.clickEvent?"string"==typeof a.clickEvent?!0:nabu.page.event.getName(a,"clickEvent"):!1},handleClick:function(a){this.hasClickEvent(a)&&this.$services.page.getPageInstance(this.page,this).emit(nabu.page.event.getName(a,"clickEvent"),nabu.page.event.getInstance(a,
"clickEvent",this.page,this))},getDynamicClasses:function(a){a=this.shouldStyle?this.$services.page.getDynamicClasses(a.styles,this.data,this):[];this.label&&a.push("with-label");this.fieldAction&&a.push("with-action");return a},getProvidedComponent:function(a){var b=nabu.page.providers("page-field-fragment").filter(function(c){return c.name==a})[0];return b?b.component:null},isHidden:function(a){return a.hidden?this.$services.page.isCondition(a.hidden,{record:this.data},this):!1}}});
Vue.component("page-formatted-configure",{template:"#page-formatted-configure",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},fragment:{type:Object,required:!0},allowHtml:{type:Boolean,required:!1,default:!1},keys:{type:Array,required:!1}},created:function(){this.normalize(this.fragment)},computed:{nativeTypes:function(){var a="date number masterdata javascript text literal".split(" ");this.allowHtml&&(a.push("link"),a.push("html"),a.push("checkbox"));return a},types:function(){var a=
[];nabu.utils.arrays.merge(a,this.nativeTypes);nabu.utils.arrays.merge(a,nabu.page.providers("page-format").map(function(b){return b.name}));a.sort();return a},skipCompile:function(){var a=this;if("literal"==this.fragment.format)return!0;var b=nabu.page.providers("page-format").filter(function(c){return c.name==a.fragment.format})[0];return b&&b.skipCompile}},methods:{isProvided:function(a){return 0>this.nativeTypes.indexOf(a)},getConfiguration:function(a){var b=nabu.page.providers("page-format").filter(function(c){return c.name==
a})[0];return b?b.configure:null},normalize:function(a){a.dateFormat||Vue.set(a,"dateFormat",null);a.tag||Vue.set(a,"tag",null);a.html||Vue.set(a,"html",null);a.javascript||Vue.set(a,"javascript",null);a.amountOfDecimals||Vue.set(a,"amountOfDecimals",null)}}});
Vue.component("page-formatted",{template:"\x3ccomponent :is\x3d'tag' v-content.parameterized\x3d\"{value:formatted,plain:isPlain, sanitize: !skipSanitize, compile: (mustCompile || fragment.compile) \x26\x26 !skipCompile, allowDataAttributes: allowDataAttributes, allowLinkIds: allowLinkIds }\"/\x3e",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},value:{required:!1},fragment:{type:Object,required:!0},state:{required:!1,default:function(){return{}}},updater:{required:!1,type:Function},
allowDataAttributes:{required:!1,default:!1},allowLinkIds:{required:!1,default:!1}},computed:{nativeTypes:function(){var a=["date","number","masterdata","javascript","literal"];a.push("link");a.push("html");a.push("checkbox");return a},tag:function(){return this.fragment.tag?this.fragment.tag:"span"},skipSanitize:function(){if("checkbox"==this.fragment.format||this.fragment.skipSanitize)return!0;var a=this,b=nabu.page.providers("page-format").filter(function(c){return c.name==a.fragment.format})[0];
return b&&b.skipSanitize},isHtml:function(){if(!this.fragment.format)return!1;if(0<=["link","html","checkbox"].indexOf(this.fragment.format))return!0;var a=this,b=nabu.page.providers("page-format").filter(function(c){return c.name==a.fragment.format})[0];return b&&b.html},skipCompile:function(){var a=this;if("literal"==this.fragment.format)return!0;var b=nabu.page.providers("page-format").filter(function(c){return c.name==a.fragment.format})[0];return b&&b.skipCompile},mustCompile:function(){if("checkbox"==
this.fragment.format)return!0;var a=this,b=nabu.page.providers("page-format").filter(function(c){return c.name==a.fragment.format})[0];return b&&b.mustCompile},isPlain:function(){var a=this;return this.fragment.format&&"text"!=this.fragment.format?0<=this.nativeTypes.indexOf(this.fragment.format)?!1:!nabu.page.providers("page-format").filter(function(b){return b.name==a.fragment.format})[0]:!0},formatted:function(){var a=this.value;if(a instanceof Array&&1==a.length)a=a[0];else if(a instanceof Array&&
0==a.length)return null;if("checkbox"==this.fragment.format)return this.fragment.inverse?"\x3cn-form-checkbox :value\x3d'!value' /\x3e":"\x3cn-form-checkbox :value\x3d'value' /\x3e";if(null==a||"undefined"==typeof a)return null;if(null==this.fragment.format||"text"==this.fragment.format)return this.fragment.maxLength&&this.value?(a=""+this.value,a.length>parseInt(this.fragment.maxLength)&&(a=a.substring(0,parseInt(this.fragment.maxLength))+"..."),a):this.value;if("literal"==this.fragment.format)return this.value.replace?
this.value.replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;"):null;if("html"==this.fragment.format)return this.fragment.html?this.fragment.html:this.value;if("link"==this.fragment.format){var b=this.fragment.label;b||=a.replace(/http[s]*:\/\/([^/]+).*/,"$1");b=this.$services.page.translate(this.$services.page.interpret(b,this));return"\x3ca target\x3d'_blank' class\x3d'is-button is-variant-link is-spacing-none' ref\x3d'noopener noreferrer nofollow' href\x3d'"+a+"'\x3e"+b+"\x3c/a\x3e"}if(0<=this.nativeTypes.indexOf(this.fragment.format))return a=
this.fragment?nabu.utils.objects.clone(this.fragment):{},a.state=this.state,a.$value=this.$value,this.$services.formatter.format(this.value,a,this.page,this.cell,this.state,this);var c=this;a=nabu.page.providers("page-format").filter(function(d){return d.name==c.fragment.format})[0];return a?a=a.format(this.value,this.fragment,this.page,this.cell,this.state,this,this.updater):this.value}}});
Vue.component("typography-core-configure",{template:"#typography-template-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},data:function(){return{icon:!0}},created:function(){this.cell.state.fragments||Vue.set(this.cell.state,"fragments",{})}});
Vue.service("typography",{methods:{getVariables:function(a){for(var b=[],c=0,d=["%","$","{"];null!=a&&0<=c;){c=a.indexOf("{",c);if(0>c)break;if(0<c&&0<=d.indexOf(a.charAt(c-1)))c++;else{var e=a.indexOf("}",c);if(0>e)break;c=a.substring(c,e+1);0>c.substring(1).indexOf("{")&&(c=c.substring(1,c.length-1),0>b.indexOf(c)&&b.push(c));c=e+1}}return b},replaceVariables:function(a,b,c,d,e){var g=this,k=Vue.component("page-formatted");this.getVariables(c).forEach(function(m){if(b.fragments&&b.fragments[m]&&
b.fragments[m].key){var p=b.fragments[m].placeholder;null!=p&&(p=g.$services.page.interpret(g.$services.page.translate(p),a));var q,t=function(y){d.then(function(B){null!=y&&(B.querySelectorAll("[variable\x3d'"+m+"']").forEach(function(F){F.classList.remove("is-placeholder");y||null==p?F.innerHTML=null==y?"":y:(F.classList.add("is-placeholder"),F.innerHTML=p)}),q=y)})},u=function(){d.then(function(y){if(w){var B=w.$el.innerHTML;B!=q&&(y.querySelectorAll("[variable\x3d'"+m+"']").forEach(function(F){F.classList.remove("is-placeholder");
B||null==p?F.innerHTML=null==B?"":B:(F.classList.add("is-placeholder"),F.innerHTML=p)}),q=B)}})};document.createElement("div");var w=new k({propsData:{page:a.page,cell:{state:b},value:e?g.$services.page.getValue(e,b.fragments[m].key):a.get(b.fragments[m].key),fragment:b.fragments[m],updater:u,allowDataAttributes:!0,allowLinkIds:!0},updated:u,ready:u,watch:{formatted:function(y){t(y)}},methods:{$value:a.$value}});w.$mount();(u=q=w.$el.innerHTML)||null==p||(u=p);c=b.fragments[m].synchronous?c.replace(new RegExp("{[s]*"+
m+"[s]*}","g"),w.$el.innerText):c.replace(new RegExp("{[s]*"+m+"[s]*}","g"),"\x3cspan class\x3d'is-variable "+(u!=q?"is-placeholder":"")+"' variable\x3d'"+m+"'\x3e"+(null==u?"":u)+"\x3c/span\x3e")}});return this.$services.page.translate(c)}}});
Vue.component("typography-variable-replacer",{template:"#typography-variable-replacer",props:{page:{type:Object,required:!0},container:{type:Object,required:!0},content:{type:String,required:!1},keys:{type:Array,required:!1}},created:function(){this.container.fragments||Vue.set(this.container,"fragments",{});var a=this;this.content&&this.$services.typography.getVariables(this.content).forEach(function(b){a.container.fragments[b]||Vue.set(a.container.fragments,b,{})})},methods:{getAllKeys:function(a){var b=
[];this.keys&&this.keys.length?nabu.utils.arrays.merge(b,this.keys):nabu.utils.arrays.merge(b,this.$services.page.getAllAvailableKeys(this.page,!0));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b}}});
Vue.component("typography-core",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},computed:{icon:function(){var a=this.cell.state.icon;a&&=this.$services.page.interpret(a,this);return a}},created:function(){this.elementPromise=this.$services.q.defer()},ready:function(){this.elementPromise.resolve(this.$el)},data:function(){return{timer:null}},methods:{getPrettyName:function(a){if(a.state&&
a.state.content)return a=a.state.content.trim(),"{"==a.substring(0,1)&&(a=a.substring(1)),"}"==a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),0>a.indexOf(" ")&&(a=this.$services.page.prettify(a)),a},getContentWithVariables:function(a){var b=this.$services.page.getPageInstance(this.page,this);return a?this.$services.typography.replaceVariables(b,this.cell.state,a,this.elementPromise):a},getVariableValue:function(a){console.log("getting value for",a)},getVariableFragment:function(a){return this.cell.state.fragments[a]},
highlight:function(a){var b=nabu.page.providers("page-format").filter(function(c){return"highlight"==c.name})[0];return b?b.format(a,this.cell.state.highlightFormat?"language-"+this.cell.state.highlightFormat:null):(b=nabu.page.providers("page-format").filter(function(c){return"code"==c.name})[0])?b.format(a,{codeFormat:this.cell.state.highlightFormat}):a},getChildComponents:function(){var a=[{title:"Typography",name:"typography",defaultVariant:"typography-"+this.tag,component:"typography"}];this.cell.state.tooltip&&
a.push({title:"Tooltip",name:"tooltip",defaultVariant:"tooltip-"+this.tag,component:"tooltip"});return a},configurator:function(){return"typography-core-configure"},update:function(){this.timer&&(clearTimeout(this.timer),this.timer=null);var a=this,b=a.$refs.editor.innerHTML;this.timer=setTimeout(function(){a.cell.state.content=nabu.utils.elements.sanitize(a.$refs.editor?a.$refs.editor.innerHTML:b)},100)}}});
Vue.view("typography-h1",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 1 header",name:"H1",category:"Typography",data:function(){return{tag:"h1",placeholder:"Heading 1"}}});Vue.view("typography-h2",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 2 header",name:"H2",category:"Typography",data:function(){return{tag:"h2",placeholder:"Heading 2"}}});
Vue.view("typography-h3",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 3 header",name:"H3",category:"Typography",data:function(){return{tag:"h3",placeholder:"Heading 3"}}});Vue.view("typography-h4",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 4 header",name:"H4",category:"Typography",data:function(){return{tag:"h4",placeholder:"Heading 4"}}});
Vue.view("typography-h5",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 5 header",name:"H5",category:"Typography",data:function(){return{tag:"h5",placeholder:"Heading 5"}}});Vue.view("typography-h6",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"heading",description:"A level 6 header",name:"H6",category:"Typography",data:function(){return{tag:"h6",placeholder:"Heading 6"}}});
Vue.view("typography-paragraph",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"paragraph",description:"A paragraph of text",name:"Paragraph",category:"Typography",data:function(){return{tag:"p",placeholder:"Paragraph"}}});Vue.view("typography-fragment",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"paragraph",description:"A short fragment of text",name:"Fragment",category:"Typography",data:function(){return{tag:"span",placeholder:"Fragment"}}});
Vue.component("typography-blockquote-configure",{template:"#typography-template-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},computed:{canHighlight:function(){return 0<nabu.page.providers("page-format").filter(function(a){return"highlight"==a.name}).length}},data:function(){return{highlightable:!0}}});
Vue.view("typography-blockquote",{template:"#typography-template",mixins:[Vue.component("typography-core")],icon:"quote-left",description:"A block quote",name:"Blockquote",category:"Typography",data:function(){return{tag:"blockquote",placeholder:"Blockquote",icon:!1,highlightable:!0}},methods:{configurator:function(){return"typography-blockquote-configure"}}});nabu||={};nabu.page||(nabu.page={});nabu.page.views||(nabu.page.views={});
nabu.page.views.PageActionsGenerator=function(a){return Vue.component(a,{template:"#"+a,props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},localState:{type:Object,required:!1},actions:{type:Array,required:!1},active:{type:String,required:!1},root:{type:Boolean,default:!0},childComponents:{type:Object,required:!1}},created:function(){this.normalize(this.cell.state);this.resolveActions()},data:function(){return{configuring:!1,
state:{},showing:[],lastAction:null,configuringAction:null,resolvedActions:[],subscriptions:[],running:[]}},beforeDestroy:function(){this.subscriptions.splice(0).map(function(b){b()})},computed:{isAutoCalculated:function(){return this.cell.state.autoActions&&!this.actions},autoCategories:function(){var b=[],c=!1;this.$services.page.pages.map(function(d){d.content.category?0>b.indexOf(d.content.category?d.content.category:null)&&b.push(d.content.category?d.content.category:null):c=!0});b.sort();c&&
b.unshift(null);return b},autoActions:function(){for(var b=this,c=function(g){g.bindings||(g.bindings={});g.actions||(g.actions=[]);g.activeRoutes||(g.activeRoutes=[]);return g},d=this.autoCategories.map(function(g){return c({label:g?g:"Misc",auto:!0,actions:b.getPagesFor(g).filter(function(k){return!!k.content.path}).map(function(k){return c({label:k.content.label?k.content.label:k.content.name,route:k.content.name,auto:!0})})})}),e=d.length-1;0<=e;e--)0==d[e].actions.length&&d.splice(e,1);nabu.utils.arrays.merge(d,
this.resolvedActions);return d}},ready:function(){var b=this;if(this.active||this.cell.state.defaultAction){var c=this.cell.state.actions.filter(function(e){return e.name==(b.active?b.active:b.cell.state.defaultAction)||e.label==(b.active?b.active:b.cell.state.defaultAction)})[0];c&&this.handle(c,!0)}b=this;var d=b.$services.page.getPageInstance(b.page,b);this.getAllActions().forEach(function(e){e.triggers&&e.triggers.forEach(function(g){b.subscriptions.push(d.subscribe(g,function(){(e.triggerIfHidden||
b.isVisible(e))&&b.handle(e,!0)}))})})},methods:{getActionComponents:function(b){var c=[{title:"Button",name:"action-entry-button",component:"button"},{title:"Button Wrapper",name:"action-entry-wrapper",component:"column"}];b.badge&&c.push({title:"Badge",name:"action-entry-badge",component:"badge"});return c},getAvailableVariants:function(b,c){var d=[];this.$services.page.getArisComponentHierarchy(b).forEach(function(e){null!=e.variants&&e.variants.forEach(function(g){0>d.indexOf(g.name)&&d.push(g.name)})});
null!=c&&(d=d.filter(function(e){return 0<=e.toLowerCase().indexOf(c.toLowerCase())}));d.sort();return d},getAvailableButtonVariants:function(b){return this.getAvailableVariants("button",b)},getAvailableBadgeVariants:function(b){return this.getAvailableVariants("badge",b)},getChildComponents:function(){return[{title:"Menu",name:"actions-menu",component:"menu"},{title:"Title",name:"actions-title",component:"h2"},{title:"Default button",name:"actions-button-default",component:"button"}]},getAdditionalClasses:function(){var b=
[];this.root?(b.push("is-menu"),nabu.utils.arrays.merge(b,this.getChildComponentClasses("actions-menu"))):b.push("is-row");return b},paste:function(){var b=this.$services.page.pasteItem("page-action");b&&this.getAllActions().push(b)},getPagesFor:function(b){return this.$services.page.pages.filter(function(c){return!b&&!c.content.category||c.content.category==b})},validatableItems:function(b){var c=[],d=document.getElementsByTagName("form");if(d)for(var e=0;e<d.length;e++){var g=d[e].getAttribute("id");
g&&c.push(g)}if(d=document.querySelectorAll("[component-group]"))for(e=0;e<d.length;e++)(g=d[e].getAttribute("component-group"))&&0>c.indexOf(g)&&c.push(g);b&&(c=c.filter(function(k){return 0<=k.toLowerCase().indexOf(b.toLowerCase())}));0>c.indexOf(b)&&c.unshift(b);return c},addStyle:function(b){b.styles||Vue.set(b,"styles",[]);b.styles.push({class:null,condition:null})},getEvents:function(b,c){var d=this;c||={};b||(b=this.cell.state.actions);b.forEach(function(e){if(e.event&&"$close"!=e.event)if(e.dynamic)e.operation&&
(c[e.event]=d.getOperationDefinition(e));else if("string"==typeof e.event&&(e.eventState||e.eventFixedState))c[e.event]={properties:{value:{type:"string"},sequence:{type:"integer"},length:{type:"integer"}}};else if(nabu.page.event.getName(e,"event")&&"$close"!=nabu.page.event.getName(e,"event")){var g=nabu.page.event.getType(e,"event");g.properties&&0==Object.keys(g.properties).length&&d.cell.on&&(g=d.cell.on);c[nabu.page.event.getName(e,"event")]=g}e.actions&&d.getEvents(e.actions,c);e.validationErrorEvent&&
(c[e.validationErrorEvent]={type:"array",items:{type:"object",properties:{code:{type:"string"},severity:{type:"string"},title:{type:"string"},priority:{type:"integer",format:"int64"},soft:{type:"boolean"}}}})});null!=nabu.page.event.getName(this.cell.state,"handledEvent")&&(b=nabu.page.event.getType(this.cell.state,"handledEvent"),b.properties&&0==Object.keys(b.properties).length&&this.cell.on&&(b=this.cell.on),c[nabu.page.event.getName(this.cell.state,"handledEvent")]=b);return c},resolveActions:function(){var b=
[],c=this;nabu.utils.arrays.merge(this.resolvedActions,this.actions?this.actions:this.cell.state.actions);var d=c.$services.page.getPageInstance(c.page,c);this.resolvedActions.forEach(function(e){if(e.dynamic&&e.operation){var g={};Object.keys(e.bindings).forEach(function(k){if(e.bindings[k]){var m=c.$services.page.getBindingValue(d,e.bindings[k]);null!=m&&"undefined"!=typeof m&&(g[k]=m)}});b.push(c.$services.swagger.execute(e.operation,g).then(function(k){var m=[];Object.keys(k).forEach(function(q){k[q]instanceof
Array&&(m=k[q])});m=m.map(function(q){var t=nabu.utils.objects.clone(e);t.dynamic=!1;t.content=q;t.label=c.$services.page.getValue(q,t.label);return t});var p=c.resolvedActions.indexOf(e);m.unshift(1);m.unshift(p);c.resolvedActions.splice.apply(c.resolvedActions,m);e.autotrigger&&2<m.length&&c.handle(m[2],!0)}))}});return this.$services.q.all(b)},getAllActions:function(){return this.actions?this.actions:this.cell.state.actions},configureChild:function(){this.configuring=!0},configurator:function(){return"page-actions-configure"},
normalize:function(b){b.class||Vue.set(b,"class",null);b.actions||Vue.set(b,"actions",[]);b.activeClass||Vue.set(b,"activeClass",null);b.disabledClass||Vue.set(b,"disabledClass",null);b.pastClass||Vue.set(b,"pastClass",null);b.defaultAction||Vue.set(b,"defaultAction",null);null==b.useButtons&&Vue.set(b,"useButtons",!0);b.actions.map(function(c){c.activeRoutes||Vue.set(c,"activeRoutes",[]);c.actions||Vue.set(c,"actions",[]);c.bindings||Vue.set(c,"bindings",{})})},hasActiveChild:function(b){var c=this.cell.state.activeClass?
this.cell.state.activeClass:"is-active";return 0<=this.getDynamicClasses(b).indexOf(c)},getDynamicWrapperClasses:function(b){var c=[];if(this.$services.page.useAris&&b.aris){var d=this.$services.page.calculateArisComponents(b.aris,null,this);d&&d["action-entry-wrapper"]&&d["action-entry-wrapper"].classes&&nabu.utils.arrays.merge(c,d["action-entry-wrapper"].classes)}b.auto&&c.push("is-automatic");return c},getDynamicClasses:function(b){var c=[];0<=this.running.indexOf(b)&&c.push("is-running");b.styles&&
nabu.utils.arrays.merge(c,this.$services.page.getDynamicClasses(b.styles,this.state,this));b.buttonClass&&c.push(b.buttonClass);var d=!1;if(this.$services.page.useAris&&b.aris){var e=this.$services.page.calculateArisComponents(b.aris,null,this);e&&e["action-entry-button"]&&e["action-entry-button"].classes&&0<e["action-entry-button"].classes.length&&(nabu.utils.arrays.merge(c,e["action-entry-button"].classes),d=!0)}d||nabu.utils.arrays.merge(c,this.getChildComponentClasses("actions-button-default"));
b.iconReverse&&c.push("is-direction-reverse");d=this.cell.state.activeClass?this.cell.state.activeClass:"is-active";if(this.lastAction==b)c.push(d);else if(this.$services.vue.route){var g=this;this.$services.vue.route==b.route?c.push(d):b.activeRoutes&&0<b.activeRoutes.filter(function(k){if(k&&(k==g.$services.vue.route||g.$services.vue.route.match("^"+k+"$")))return!0}).length&&c.push(d)}d=this.cell.state.disabledClass?this.cell.state.disabledClass:"is-disabled";this.isDisabled(b)&&c.push(d);d=this.cell.state.pastClass?
this.cell.state.pastClass:"is-past";this.lastAction&&(e=this.resolvedActions.indexOf(this.lastAction),this.resolvedActions.indexOf(b)<e&&c.push(d));return c},toggle:function(b){if(this.cell.state.clickBased&&this.$services.page.isCondition(this.cell.state.clickBased,{},this)){var c=this.showing.indexOf(b);0<=c?this.showing.splice(c,1):(this.cell.state.showOnlyOne&&this.showing.splice(0),this.showing.push(b))}},hide:function(b){this.cell.state.clickBased&&this.$services.page.isCondition(this.cell.state.clickBased,
{},this)||(b=this.showing.indexOf(b),0<=b&&this.showing.splice(b,1))},show:function(b){this.cell.state.clickBased&&this.$services.page.isCondition(this.cell.state.clickBased,{},this)||!(0>this.showing.indexOf(b))||(this.cell.state.showOnlyOne&&this.showing.splice(0),this.showing.push(b))},autoclose:function(){this.cell.state.leaveOpen||(this.showing.splice(0),this.root&&nabu.page.event.getName(this.cell.state,"handledEvent")&&this.$services.page.getPageInstance(this.page,this).emit(nabu.page.event.getName(this.cell.state,
"handledEvent"),nabu.page.event.getInstance(this.cell.state,"handledEvent",this.page,this)))},listRoutes:function(b,c){if(null!=b&&"\x3d"==b.substring(0,1))return[b];var d=this.$services.router.list().map(function(e){return e.alias});b&&(d=d.filter(function(e){return 0<=e.toLowerCase().indexOf(b.toLowerCase())}));d.sort();b&&c&&d.unshift(b);return d},addContent:function(){this.getAllActions().push({arbitrary:!0,name:null,class:null,content:{},label:"Content"+(this.getAllActions().length+1),activeRoutes:[]})},
addAction:function(b){this.getAllActions().push({dynamic:b,operation:null,label:"Action"+(this.getAllActions().length+1),route:null,event:null,eventState:null,eventFixedState:null,hasFixedState:!1,anchor:null,mask:!1,condition:null,disabled:null,bindings:{},actions:[],icons:null,activeRoutes:[],class:null,buttonClass:null})},isVisible:function(b){return this.edit||!b.condition||this.$services.page.isCondition(b.condition,this.state,this)},isDisabled:function(b){return 0<=this.running.indexOf(b)||
!!b.disabled&&this.$services.page.isCondition(b.disabled,this.state,this)},getActionHref:function(b){if(!this.cell.state.useButtons&&b.url)return this.$services.page.interpret(b.url,this);if(b.absolute&&b.route){var c=b.route;"\x3d"==c.charAt(0)&&(c=this.$services.page.interpret(c,this));var d={},e=this,g=e.$services.page.getPageInstance(this.page,this);Object.keys(b.bindings).map(function(k){if(null!=b.bindings[k]){var m=e.$services.page.getBindingValue(g,b.bindings[k],e);if(null==m){var p=b.bindings[k].split(".");
m=e.state;p.map(function(q){m&&=m[q]});m&&(d[k]=m)}null!=m&&(d[k]=m)}});c=this.$services.router.template(c,d);b.absolute&&(c=window.location.protocol+"//"+window.location.host+c);return c}return"javascript:void(0)"},validateTarget:function(b,c){var d=document.getElementById(b);c=[];if(d&&d.__vue__&&d.__vue__.validate)c.push(d);else if((b=document.body.querySelectorAll("[component-group\x3d'"+b+"']"))&&b.length)for(d=0;d<b.length;d++)c.push(b.item(d));var e=this;b=c.map(function(k){return e.validateSingle(k)}).filter(function(k){return null!=
k});d=null;b.length?d=this.$services.q.all(b):(d=this.$services.q.defer(),d.resolve());var g=c.filter(function(k){return!!k.__vue__.$parent.doIt}).map(function(k){return k.__vue__.$parent.doIt});g.length&&d.then(function(){g.forEach(function(k){k()})});return d},getValidationResults:function(b){var c=[];b.forEach(function(d){d.forEach(function(e){0>c.indexOf(e)&&c.push(e)})});return c},validateSingle:function(b){if(b&&b.__vue__&&b.__vue__.validate){var c=function(e){return e.filter(function(g){return null!=
g.severity&&"error"==g.severity.toLowerCase()})};b=b.__vue__.validate();var d=this.$services.q.defer();b.then?b.then(function(e){(e=c(e))&&e.length?d.reject(e):d.resolve([])}):(b=c(b),b.length?d.reject(b):d.resolve(b));return d}return null},hasEvent:function(b){return b.event&&"string"==typeof b.event?!0:!!nabu.page.event.getName(b,"event")},handle:function(b,c){b.name&&this.$services.analysis.push({pageName:this.page.content.name,pageCategory:this.page.content.category,category:"action",type:"action-trigger",
group:this.cell.state.analysisId?this.cell.state.analysisId:null,event:b.name});b.name&&this.$services.analysis&&this.$services.analysis.emit&&this.$services.analysis.emit("trigger-"+(this.cell.state.analysisId?this.cell.state.analysisId:"action"),b.name,{url:window.location},!0);if(b.validate&&!c){var d=this;this.validateTarget(b.validate).then(function(p){d.handle(b,!0)},function(p){p=d.getValidationResults(p);if(b.validationErrorScroll){var q=p.filter(function(t){return!!t.component})[0];q&&(q.scrollIntoView(),
q.focus())}b.validationErrorEvent&&(q=d.$services.page.getPageInstance(d.page,d),p=p.map(function(t){t=nabu.utils.objects.clone(t);delete t.component;return t}),q.emit(b.validationErrorEvent,{messages:p}))});return null}if(this.cell.state.useButtons||!b.route||!b.absolute)if(this.cell.state.useButtons||!b.url)if(c||!this.isDisabled(b)){if(b.route){c=b.route;"\x3d"==c.charAt(0)&&(c=this.$services.page.interpret(c,this));var e={};d=this;var g=d.$services.page.getPageInstance(this.page,this);Object.keys(b.bindings).map(function(p){if(null!=
b.bindings[p]){var q=d.$services.page.getBindingValue(g,b.bindings[p],d);if(null==q){var t=b.bindings[p].split(".");q=d.state;t.map(function(u){q&&=q[u]});q&&(e[p]=q)}null!=q&&(e[p]=q)}});"$blank"==b.anchor?window.open(d.$services.router.template(c,e)):"$window"==b.anchor?window.location=d.$services.router.template(c,e):this.$services.router.route(c,e,b.anchor,b.mask)}else if(b.url)c=this.$services.page.interpret(b.url,this),"$blank"==b.anchor?window.open(c):window.location=c;else if("$close"==b.event||
"$close"==nabu.page.event.getName(b,"event"))this.$emit("close");else if(b.event){this.unsetEvent(this.cell.state.actions);d=this;g=d.$services.page.getPageInstance(d.page,d);c=null;var k=!1,m=null;"string"==typeof b.event?(m=b.event,b.hasFixedState&&b.eventFixedState?(c={value:this.$services.page.interpret(b.eventFixedState,this)},k=!0):b.content?c=b.content:b.eventState&&(c={value:g.get(b.eventState)},k=!0)):b.event&&nabu.page.event.getName(b,"event")&&(m=nabu.page.event.getName(b,"event"),b.event.eventFields&&
b.event.eventFields.length?c=nabu.page.event.getInstance(b,"event",this.page,this):b.content?c=b.content:this.cell.on&&(c=g.get(this.cell.on)));k&&(c.sequence=this.resolvedActions.indexOf(b)+1,c.length=this.resolvedActions.length,c.actor=this.cell.id);null!=m&&(d.running.push(b),k=function(){d.running.splice(d.running.indexOf(b),1)},c=g.emit(m,c?c:{}),c.then?c.then(k,k):k());this.lastAction=b}b.close&&this.$emit("close");nabu.page.event.getName(this.cell.state,"handledEvent")&&!b.skipHandleEvent&&
(g=this.$services.page.getPageInstance(this.page,this))&&g.emit(nabu.page.event.getName(this.cell.state,"handledEvent"),nabu.page.event.getInstance(this.cell.state,"handledEvent",this.page,this))}},unsetEvent:function(b){var c=this,d=c.$services.page.getPageInstance(c.page,c);b.map(function(e){e.event&&d.reset("string"==typeof e.event?e.event:nabu.page.event.getName(e,"event"));e.actions&&c.unsetEvent(e.actions)})},configureAction:function(b){this.configuringAction=b;var c=this;Vue.nextTick(function(){var d=
"action_"+c.getAllActions().indexOf(b);c.$refs[d][0].configureChild()})},up:function(b){var c=this.getAllActions();b=c.indexOf(b);if(0<b){var d=c[b-1];c.splice(b-1,1,c[b]);c.splice(b,1,d)}},down:function(b){var c=this.getAllActions();b=c.indexOf(b);if(b<c.length-1){var d=c[b+1];c.splice(b+1,1,c[b]);c.splice(b,1,d)}},getActionOperations:function(b){var c=this;return this.$services.page.getOperations(function(d){var e="get"==d.method.toLowerCase()&&(!b||0<=d.id.toLowerCase().indexOf(b.toLowerCase()))&&
d.responses["200"];if(e&&null!=d.responses["200"]&&null!=d.responses["200"].schema){var g=c.$services.swagger.definition(d.responses["200"].schema.$ref);e=!1;g.properties&&Object.keys(g.properties).map(function(k){"array"==g.properties[k].type&&(e=!0)})}return e}).map(function(d){return d.id})},getInputParameters:function(b){var c={properties:{}},d=this;if((b=this.$services.swagger.operations[b.operation])&&b.parameters){var e=["limit","offset","orderBy","connectionId"];b.parameters.filter(function(g){return 0>
e.indexOf(g.name)}).map(function(g){c.properties[g.name]=d.$services.swagger.resolve(g)})}return c},getOperationDefinition:function(b){var c={};if((b=this.$services.swagger.operations[b.operation])&&b.responses["200"]){var d=this.$services.swagger.resolve(b.responses["200"].schema);d.properties&&Object.keys(d.properties).forEach(function(e){"array"==d.properties[e].type&&(e=d.properties[e].items,e.properties&&nabu.utils.objects.merge(c,e.properties))})}return{properties:c}},getOperationProperties:function(b){return this.$services.page.getSimpleKeysFor(this.getOperationDefinition(b))}}})};
nabu.page.views.PageActions=nabu.page.views.PageActionsGenerator("page-actions");nabu.page.views.PageActionsGenerator("page-actions-configure");
Vue.view("page-tag",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},name:"Tag",category:"Data",description:"A tag",icon:"link",created:function(){this.elementPromise=this.$services.q.defer()},ready:function(){this.elementPromise.resolve(this.$el)},data:function(){return{requiresPagePrefix:!1,running:!1}},computed:{icon:function(){var a=this.cell.state.icon;return a?
a:"times"},computedValue:function(){try{return this.$services.page.getPageInstance(this.page,this),this.cell.state.useComputed&&this.cell.state.computed?this.$services.page.eval(this.cell.state.computed,{},this):null}catch(a){return console.error("Could not calculate computed",a),null}}},methods:{getPrettyName:function(a){return this.$services.page.getPrettyNameForTypography(a)},isCellHidden:function(){return null==this.getValue()},reset:function(){if(!this.running){var a=this.getRawValue();if(this.cell.state.field)if(a instanceof
Array)a.splice(0);else{var b=this.$services.page.getPageInstance(this.page,this);b.set(this.cell.state.field,null);this.requiresPagePrefix&&b.set("page."+this.cell.state.field,null)}var c=this;b=function(){c.running=!1};this.running=!0;this.$services.triggerable.trigger(this.cell.state,"remove",{value:a},this).then(b,b)}},getEvents:function(){return this.$services.triggerable.getEvents(this.page,this.cell.state)},getRawValue:function(){var a=this.$services.page.getPageInstance(this.page,this);var b=
a.get(this.cell.state.field);null==b&&(b=a.get("page."+this.cell.state.field));return b},getValue:function(){var a=null;this.cell.state.useComputed&&(a=this.computedValue);if(this.cell.state.field){var b=this.$services.page.getPageInstance(this.page,this);b&&(a=b.getLabel(this.cell.state.field),null==a&&(a=b.getLabel("page."+this.cell.state.field),null!=a&&(this.requiresPagePrefix=!0)),null==a&&(a=b.get(this.cell.state.field)))}a instanceof Array&&!a.length&&(a=null);null!=a?this.$emit("show"):this.$emit("hide");
return a},getChildComponents:function(){return[{title:"Tag",name:"page-tag",component:"badge"}]},configurator:function(){return"page-tag-configure"},update:function(){this.timer&&(clearTimeout(this.timer),this.timer=null);var a=this;if(this.$refs.editor){var b=a.$refs.editor.innerHTML;this.timer=setTimeout(function(){a.cell.state.content=nabu.utils.elements.sanitize(a.$refs.editor?a.$refs.editor.innerHTML:b)},100)}}}});
Vue.component("page-tag-configure",{template:"#page-tag-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},methods:{getAllKeys:function(a){var b=[];nabu.utils.arrays.merge(b,this.$services.page.getAllAvailableKeys(this.page,!0));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b}}});
Vue.view("page-smart-check",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},computed:{component:function(){return this.cell.state.component?this.cell.state.component:"n-form-checkbox"},checked:function(){return this.$services.page.isCondition(this.cell.state.checkCondition,{},this)},disabled:function(){return this.cell.state.disabledCondition?this.$services.page.isCondition(this.cell.state.disabledCondition,
{},this):!1}},data:function(){return{running:!1}},methods:{configurator:function(){return"page-smart-check-configure"},toggle:function(){this.running=!0;var a=this,b=function(){a.running=!1};this.$services.triggerable.trigger(this.cell.state,this.checked?"clear":"check",null,this).then(b,b)}}});
Vue.component("page-smart-check-configure",{template:"#page-smart-check-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}}});nabu.page.provide("page-renumberer",{component:"page-button",renumber:function(a,b){null!=a.state.actionTarget&&null!=b[a.state.actionTarget]&&(a.state.actionTarget=b[a.state.actionTarget])}});
Vue.view("page-button",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},name:"Button",category:"Interactive",description:"A button to send out events, go to a different page,...",icon:"link",data:function(){return{timer:null,running:!1,activated:!1}},created:function(){this.elementPromise=this.$services.q.defer();this.cell.state.triggers&&this.cell.state.triggers.forEach(function(a){"click"==
a.trigger&&(a.trigger="activate")})},computed:{tagName:function(){var a=this.triggers;return a&&1==a.length&&1==a[0].actions.length&&"route"==a[0].actions[0].type?"a":"button"},tooltip:function(){if(this.cell.state.tooltip)return this.$services.page.interpret(this.$services.page.translate(this.cell.state.tooltip),this)},badge:function(){if(this.cell.state.badge)return this.$services.page.interpret(this.$services.page.translate(this.cell.state.badge),this)},active:function(){var a=this;if("route"==
this.activationType){if(this.cell.state.activeRoutes&&this.cell.state.activeRoutes.length)return 0<this.cell.state.activeRoutes.filter(function(c){return c.route==a.$services.vue.route?!c.condition||a.$services.page.isCondition(c.condition,a.$services.vue.parameters,a,function(d){var e=a.$services.page.getValue(a.$services.vue.parameters,d);null==e&&(e=a.$value(d));return e}):!1}).length;var b=[];nabu.utils.arrays.merge(b,this.$services.triggerable.getActiveRoutes(this.cell.state));nabu.utils.arrays.merge(b,
this.$services.triggerable.getActiveRoutes(this.cell));return 0<=b.indexOf(this.$services.vue.route)}if("condition"==this.activationType&&this.cell.state.active)return this.$services.page.isCondition(this.cell.state.active,null,this)},disabled:function(){return this.cell.state.disabled?this.$services.page.isCondition(this.cell.state.disabled,null,this,null,!0):!1},activationType:function(){var a=this.cell.state.activationType;this.cell.state.hasOwnProperty("activationType")||(a=this.cell.state.componentGroup?
"group":this.cell.state.active?"condition":"route");return a},triggers:function(){var a=[],b=this.cell;b.state.triggers&&nabu.utils.arrays.merge(a,b.state.triggers);b.triggers&&nabu.utils.arrays.merge(a,b.triggers);return a}},ready:function(){if(this.cell.state.activateByDefault){var a=this.$services.page.getPageInstance(this.page,this);null!=a.recordIndex&&0!=a.recordIndex||this.handle()}this.elementPromise.resolve(this.$el);this.cell.state.activeInitial&&this.$services.page.isCondition(this.cell.state.activeInitial,
null,this)&&this.handle()},methods:{getPrettyName:function(a){return this.$services.page.getPrettyNameForTypography(a)},getTriggers:function(){var a={activate:{}};this.cell.triggers&&0<=this.cell.triggers.map(function(b){return b.trigger}).indexOf("activate")&&(a.deactivate={});return a},getHref:function(){if("a"==this.tagName)return this.$services.triggerable.calculateUrl(this.triggers[0].actions[0],this,{})},guessButtonType:function(){var a=!1;this.triggers&&this.triggers.forEach(function(b){b.actions&&
b.actions.forEach(function(c){"action"==c.type&&"submit"==c.action&&(a=!0)})});return a?"submit":"button"},getContentWithVariables:function(a){var b=this.$services.page.getPageInstance(this.page,this);return a?this.$services.typography.replaceVariables(b,this.cell.state,a,this.elementPromise):a},getChildComponents:function(){var a=[{title:"Button",name:"page-button",component:"button"}];this.cell.state.badge&&a.push({title:"Badge",name:"page-button-badge",component:"badge"});this.cell.state.tooltip&&
a.push({title:"Tooltip",name:"page-button-tooltip",component:"tooltip"});return a},getEvents:function(){var a={};nabu.utils.objects.merge(a,this.$services.triggerable.getEvents(this.page,this.cell.state));if(this.cell.state.action&&this.cell.state.actionTarget&&this.cell.state.actionEvent){var b=this.$services.page.getPageInstance(this.page,this);b=this.$services.page.getActionOutput(b,this.cell.state.actionTarget,this.cell.state.action);a[this.cell.state.actionEvent]=b?{properties:b}:{}}return a},
hitSpace:function(a){},getTriggerObject:function(){var a=[];this.cell.state.triggers&&nabu.utils.arrays.merge(a,this.cell.state.triggers);this.cell.triggers&&nabu.utils.arrays.merge(a,this.cell.triggers);return{triggers:a}},handle:function(a,b){if(!this.edit||a&&a.shiftKey){this.cell.analysisId&&this.$services.analysis.push({event:"activate",category:"button",component:this.cell.analysisId?this.cell.analysisId:"button-"+this.cell.id,page:this.$services.page.getRootPage(this.$services.page.getPageInstance(this.page,
this)).page.content.name});var c=a&&(1==a.button||1==a.metaKey&&0==a.button);if("a"==this.tagName&&c)return!0;this.cell.state.componentGroup&&document.querySelectorAll("[component-group\x3d'"+this.cell.state.componentGroup+"']").forEach(function(e){e.__vue__&&e.__vue__.deactivate&&e.__vue__.deactivate()});this.running=!0;b=this.$services.triggerable.trigger(this.getTriggerObject(),"activate",null,this,{anchor:"a"!=this.tagName&&(b||a&&a.metaKey)?"$blank":null});this.cell.state.stopPropagation&&a&&
(a.stopPropagation(),a.preventDefault());var d=this;c=function(){d.running=!1;d.cell.state.emitClose&&d.$emit("close");d.cell.state.componentGroup&&(d.activated=!0)};b.then(c,c);return"a"==this.tagName?(a.preventDefault(),!1):b}a&&"a"==this.tagName&&a.preventDefault()},deactivate:function(){this.activated&&(this.$services.triggerable.untrigger(this.getTriggerObject(),"activate",this),this.$services.triggerable.trigger(this.getTriggerObject(),"deactivate",this),this.activated=!1)},configurator:function(){return"page-button-configure"},
update:function(){this.timer&&(clearTimeout(this.timer),this.timer=null);var a=this;if(this.$refs.editor){var b=a.$refs.editor.innerHTML;this.timer=setTimeout(function(){a.cell.state.content=nabu.utils.elements.sanitize(a.$refs.editor?a.$refs.editor.innerHTML:b)},100)}}}});
Vue.component("page-button-configure",{template:"#page-button-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.cell.state.bindings||Vue.set(this.cell.state,"bindings",{});this.cell.state.actionTarget||Vue.set(this.cell.state,"actionTarget",null);this.cell.state.activeRoutes||Vue.set(this.cell.state,"activeRoutes",[]);this.cell.state.hasOwnProperty("activationType")||
(this.cell.state.componentGroup?Vue.set(this.cell.state,"activationType","group"):this.cell.state.active?Vue.set(this.cell.state,"activationType","condition"):Vue.set(this.cell.state,"activationType","route"))},computed:{triggers:function(){var a={activate:{}};this.cell.state.triggers&&0<=this.cell.state.triggers.map(function(b){return b.trigger}).indexOf("activate")&&(a.deactivate={});return a}},watch:{"cell.state.activateByDefault":function(a){if(a){var b=this;document.querySelectorAll("[component-group\x3d'"+
this.cell.state.componentGroup+"']").forEach(function(c){c.__vue__&&c.__vue__.cell.id!=b.cell.id&&Vue.set(c.__vue__.cell.state,"activateByDefault",!1)})}}}});nabu.page.provide("page-renumberer",{component:"page-button-sort",renumber:function(a,b){null!=a.state.actionTarget&&null!=b[a.state.actionTarget]&&(a.state.actionTarget=b[a.state.actionTarget])}});
Vue.view("page-button-sort",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},name:"Sort button",category:"Interactive",description:"A button that can be used to sort for example a repeat",icon:"link",data:function(){return{timer:null,running:!1,component:null,currentDirection:null}},created:function(){this.elementPromise=this.$services.q.defer()},mounted:function(){this.getComponent()},
ready:function(){this.elementPromise.resolve(this.$el)},watch:{"component.state.order.by":function(){this.matchOrderBy()}},computed:{icon:function(){return"asc"==this.currentDirection?this.cell.state.iconAsc?this.cell.state.iconAsc:"sort-up":"desc"==this.currentDirection?this.cell.state.iconDesc?this.cell.state.iconDesc:"sort-down":this.cell.state.hideNoneIcon?null:this.cell.state.iconNone?this.cell.state.iconNone:"sort"},active:function(){var a=!1;this.cell.state.active&&(a=this.$services.page.isCondition(this.cell.state.active,
null,this));return a||0<=this.$services.triggerable.getActiveRoutes(this.cell.state).indexOf(this.$services.vue.route)},disabled:function(){return this.cell.state.disabled&&this.$services.page.isCondition(this.cell.state.disabled,null,this)}},methods:{getPrettyName:function(a){return this.$services.page.getPrettyNameForTypography(a)},getComponent:function(){if(this.cell.state.target){var a=this;this.$services.page.getPageInstance(this.page,this).getComponent(this.cell.state.target).then(function(b){Vue.set(a,
"component",b);a.matchOrderBy()})}},matchOrderBy:function(){if(this.component&&this.component.state&&this.component.state.order){var a=this.component.state.order.by;if(a&&this.cell.state.sortFields){var b=!0,c=!0;this.cell.state.sortFields.forEach(function(d){0>a.indexOf(d.name)&&0>a.indexOf(d.name+" asc")&&(b=!1);0>a.indexOf(d.name+" desc")&&(c=!1)});b&&c?console.log("Confusing order matching"):b?this.currentDirection="asc":c&&(this.currentDirection="desc")}}},getContentWithVariables:function(a){var b=
this.$services.page.getPageInstance(this.page,this);return a?this.$services.typography.replaceVariables(b,this.cell.state,a,this.elementPromise):a},getChildComponents:function(){return[{title:"Sort Button",name:"page-button-sort",component:"button"}]},getEvents:function(){var a={};nabu.utils.objects.merge(a,this.$services.triggerable.getEvents(this.page,this.cell.state));if(nabu.page.event.getName(this.cell.state,"clickEvent")&&"$close"!=nabu.page.event.getName(this.cell.state,"clickEvent")){var b=
nabu.page.event.getType(this.cell.state,"clickEvent");a[nabu.page.event.getName(this.cell.state,"clickEvent")]=b}this.cell.state.action&&this.cell.state.actionTarget&&this.cell.state.actionEvent&&(b=this.$services.page.getPageInstance(this.page,this),b=this.$services.page.getActionOutput(b,this.cell.state.actionTarget,this.cell.state.action),a[this.cell.state.actionEvent]=b?{properties:b}:{});return a},handle:function(a){null==this.currentDirection?this.currentDirection=this.cell.state.reverse?"desc":
"asc":"asc"==this.currentDirection?this.currentDirection=this.cell.state.reverse?null:"desc":"desc"==this.currentDirection&&(this.currentDirection=this.cell.state.reverse?"asc":null);var b=this;this.cell.state.sortFields&&this.component&&(a=this.cell.state.sortFields.map(function(c){return c.name+" "+(b.currentDirection?b.currentDirection:"none")}),this.component.runAction("order-by",{by:a,append:!0}))},configurator:function(){return"page-button-sort-configure"},update:function(){this.timer&&(clearTimeout(this.timer),
this.timer=null);var a=this;if(this.$refs.editor){var b=a.$refs.editor.innerHTML;this.timer=setTimeout(function(){a.cell.state.content=nabu.utils.elements.sanitize(a.$refs.editor?a.$refs.editor.innerHTML:b)},100)}}}});
Vue.component("page-button-sort-configure",{template:"#page-button-sort-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.cell.state.sortFields||Vue.set(this.cell.state,"sortFields",[])},data:function(){return{component:null,fields:[]}},mounted:function(){this.findTarget()},methods:{findTarget:function(){var a=this;this.fields.splice(0);
this.cell.state.target?this.$services.page.getPageInstance(this.page,this).getComponent(this.cell.state.target).then(function(b){a.fields.splice(0);Vue.set(a,"component",b);b.runAction("list-available").then(function(c){c.available&&nabu.utils.arrays.merge(a.fields,c.available)})}):Vue.set(a,"component",null)},getAvailableFields:function(a){return this.fields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})}},watch:{"cell.state.target":function(){this.findTarget()}}});
Vue.view("page-badge",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}},name:"Badge",category:"Typography",description:"A badge",icon:"link",created:function(){this.elementPromise=this.$services.q.defer()},ready:function(){this.elementPromise.resolve(this.$el)},computed:{tooltip:function(){if(this.cell.state.tooltip)return this.$services.page.interpret(this.$services.page.translate(this.cell.state.tooltip),
this)}},methods:{getContentWithVariables:function(a){var b=this.$services.page.getPageInstance(this.page,this);return a?this.$services.typography.replaceVariables(b,this.cell.state,a,this.elementPromise):a},getChildComponents:function(){return[{title:"Badge",name:"page-badge",component:"badge"}]},configurator:function(){return"page-badge-configure"},update:function(){this.timer&&(clearTimeout(this.timer),this.timer=null);var a=this;if(this.$refs.editor){var b=a.$refs.editor.innerHTML;this.timer=setTimeout(function(){a.cell.state.content=
nabu.utils.elements.sanitize(a.$refs.editor?a.$refs.editor.innerHTML:b)},100)}}}});Vue.component("page-badge-configure",{template:"#page-badge-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0}}});
Vue.service("basicNotifier",{created:function(){nabu.page.provide("page-notifier",this)},data:function(){return{priority:-1,root:null,component:"basic-notification",defaultDuration:5E3}},methods:{push:function(a){var b=new (Vue.component(this.component))({propsData:a}),c=this.getRoot();this.$render({target:c,content:b,append:!0});null==a.duration&&(a.duration=this.defaultDuration);0<a.duration&&setTimeout(function(){b.close()},a.duration)},getRoot:function(){null==this.root&&(this.root=document.createElement("div"),
this.root.setAttribute("class","global-notifications"),document.body.appendChild(this.root));return this.root}}});
Vue.component("basic-notification",{props:{name:{type:String},event:{type:String},title:{type:String},message:{type:String},icon:{type:String},severity:{type:String},closeable:{type:Boolean},actions:{type:Array},data:{type:Object}},template:"\x3cdiv class\x3d'is-alert has-button-close is-spacing-large is-spacing-horizontal-right-xlarge' :class\x3d'\"is-color-\" + (severity ? severity : \"info\")'\x3e\t\t\x3cicon v-if\x3d'icon' :name\x3d'icon'/\x3e\t\t\x3cdiv class\x3d'is-text'\x3e\t\t\t\x3ch4 class\x3d'is-h4' v-if\x3d'title' v-content.sanitize.compile\x3d'title'/\x3e\t\t\t\x3cp class\x3d'is-p' v-if\x3d'message' v-content.sanitize.compile\x3d'message'/\x3e\t\t\t\x3cbutton class\x3d'is-button is-variant-close is-size-small' @click\x3d'close' v-if\x3d'closeable'\x3e\x3cicon name\x3d'times'/\x3e\x3c/button\x3e\t\t\x3c/div\x3e\x3c/div\x3e",methods:{close:function(){this.$el.parentNode.removeChild(this.$el)}}});
nabu||={};nabu.page||(nabu.page={});nabu.page.skeletons||(nabu.page.skeletons={});nabu.page.skeletons.Email=Vue.extend({template:"#page-skeleton-email"});nabu.page.provide("page-renumberer",{component:"page-paging",renumber:function(a,b){null!=a.state.target&&null!=b[a.state.target]&&(a.state.target=b[a.state.target])}});
Vue.view("page-paging",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},childComponents:{type:Object,required:!1}},name:"Paging",category:"Data",icon:"sort-numeric-down",description:"Allow you to page through a data set",data:function(){return{paging:{},component:null}},mounted:function(){var a=this,b=this.$services.page.getPageInstance(this.page,this);this.cell.state.target&&b.getComponent(this.cell.state.target).then(function(c){a.component=
c;Vue.set(a,"paging",c.getRuntimeState().paging)})},methods:{getChildComponents:function(){return[{title:"Menu",name:"paging-menu",description:"The menu that contains the paging buttons",component:"menu"},{title:"Button",name:"paging-button",description:"The button used for paging",component:"button"}]},load:function(a){return this.component?this.component.runAction("jump-page",{page:a}):this.$services.q.reject()},configurator:function(){return"page-paging-configure"}}});
Vue.component("page-paging-configure",{template:"#page-paging-configure",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},childComponents:{type:Object,required:!1}}});nabu.page.provide("page-renumberer",{component:"page-paging-next",renumber:function(a,b){null!=a.state.target&&null!=b[a.state.target]&&(a.state.target=b[a.state.target])}});
Vue.view("page-paging-next",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},childComponents:{type:Object,required:!1}},name:"Paging Without Count",category:"Data",icon:"sort-numeric-down",description:"Allow you to page through a data set without a total count",data:function(){return{paging:{},component:null,loading:!1}},computed:{pageNumber:function(){return this.paging&&this.paging.current?this.paging.current:
0}},mounted:function(){var a=this,b=this.$services.page.getPageInstance(this.page,this);this.cell.state.target&&b.getComponent(this.cell.state.target).then(function(c){a.component=c;Vue.set(a,"paging",c.getRuntimeState().paging)})},methods:{getChildComponents:function(){return[{title:"Menu",name:"paging-menu",description:"The menu that contains the paging buttons",component:"menu"},{title:"Button",name:"paging-button",description:"The button used for paging",component:"button"},{title:"Form Field",
name:"paging-page-number",description:"The form field where you can manipulate the page number",component:"form-text"}]},load:function(a){if(this.component){var b=this;this.loading=!0;var c=function(d){console.log("loading done",d,b.paging);b.loading=!1};console.log("jumping to page",a);return this.component.runAction("jump-page",{page:a}).then(c,c)}return this.$services.q.reject()},configurator:function(){return"page-paging-next-configure"}},watch:{"paging.page":function(a){console.log("updated to",
a);this.pageNumber=a&&a.current?a.current:0}}});Vue.component("page-paging-next-configure",{template:"#page-paging-next-configure",props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},edit:{type:Boolean,required:!0},childComponents:{type:Object,required:!1}}});
Vue.component("page-field-fragment-image-configure",{template:"#page-field-fragment-image-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},keys:{type:Array,required:!0}},methods:{getOperations:function(a){return this.$services.page.getOperations(function(b){return!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase())?!0:!1})},getOperationParameters:function(a){return this.$services.page.getSwaggerParametersAsKeys(a)},getAvailableParameters:function(){var a=
this.$services.page.getAvailableParameters(this.page,null,!0);if(this.keys.length){var b={};this.keys.forEach(function(c){b[c]={type:"string"}});a.record={properties:b}}return a}},created:function(){this.fragment.fixedHref||Vue.set(this.fragment,"fixedHref",!1);this.fragment.imageHref||Vue.set(this.fragment,"imageHref",null);this.fragment.imageTitle||Vue.set(this.fragment,"imageTitle",null);this.fragment.imageHeight||Vue.set(this.fragment,"imageHeight",null);this.fragment.imageSize||Vue.set(this.fragment,
"imageSize","cover");this.fragment.bindings||Vue.set(this.fragment,"bindings",{})}});
Vue.component("page-field-fragment-image",{template:"\x3cdiv class\x3d'image' :style\x3d\"{'background-image': 'url(' + href + ')', height: fragment.imageHeight ? fragment.imageHeight : 'inherit', 'background-size': fragment.imageSize, 'background-repeat': 'no-repeat', 'background-position': 'center' }\"\x3e\x3c/div\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}},computed:{href:function(){var a=null;if(this.fragment.operationParameter){if(this.fragment.operation){var b=
{},c=this,d=this.$services.page.getPageInstance(this.page,this);Object.keys(this.fragment.bindings).forEach(function(e){c.fragment.bindings[e]&&(0==c.fragment.bindings[e].indexOf("record.")?b[e]=c.$services.page.getValue(c.data,c.fragment.bindings[e].substring(7)):b[e]=c.$services.page.getBindingValue(d,c.fragment.bindings[e]))});return this.$services.swagger.parameters(this.fragment.operation,b).url}}else this.fragment.fixedHref?a=this.fragment.imageHref:this.fragment.imageHref&&(a=this.$services.page.getValue(this.data,
this.fragment.imageHref)),a&&this.fragment.dataUrl?a=URL.createObjectURL(a):a&&"http://"!=a.substring(0,7)&&"https://"!=a.substring(0,8)&&"/"!=a.substring(0,1)&&(a="/"+a);return a}}});
Vue.component("page-field-fragment-text-configure",{template:"\x3cn-form-section\x3e\t\t\x3cn-form-switch label\x3d'Multiline' v-model\x3d'fragment.multiline'/\x3e\t\t\x3cn-form-switch label\x3d'Compile' v-model\x3d'fragment.compile'/\x3e\t\t\x3cn-form-combo label\x3d'Type' v-model\x3d'fragment.tag' :items\x3d\"['span', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'div']\"/\x3e\t\t\x3cn-form-switch label\x3d'Html' v-model\x3d'fragment.html'/\x3e\t\t\x3cn-form-text label\x3d'Text' v-if\x3d'!fragment.html' :type\x3d\"fragment.multiline ? 'area' : 'text'\" v-model\x3d'fragment.content' :timeout\x3d'600'/\x3e\t\t\x3cn-form-ace label\x3d'Text' mode\x3d'html' v-else :type\x3d\"fragment.multiline ? 'area' : 'text'\" v-model\x3d'fragment.content' :timeout\x3d'600'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0}},created:function(){this.fragment.multiline||Vue.set(this.fragment,"multiline",!1);this.fragment.content||Vue.set(this.fragment,"content",null);this.fragment.tag||Vue.set(this.fragment,"tag",null)}});
Vue.component("page-field-fragment-text",{template:"\x3ccomponent :is\x3d'tag' v-content.parameterized\x3d'{value:$services.page.translate($services.page.interpret(fragment.content, $self)), compile:fragment.compile, plain:!fragment.html}'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}},computed:{tag:function(){return this.fragment.tag?this.fragment.tag:"span"}}});
Vue.component("page-field-fragment-data-configure",{template:"\x3cpage-formatted-configure :fragment\x3d'fragment' :allow-html\x3d'true' :cell\x3d'cell' :page\x3d'page' :keys\x3d'keys'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},keys:{type:Array,required:!1}}});
Vue.component("page-field-fragment-data",{template:"\x3cpage-formatted :value\x3d'value' :fragment\x3d'fragment' :cell\x3d'cell' :page\x3d'page' :state\x3d'$window.nabu.utils.objects.clone(data)'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}},computed:{value:function(){return!this.fragment.key||0!=this.fragment.key.indexOf("page.")&&0!=this.fragment.key.indexOf("parent.")?this.fragment.key?this.$services.page.getValue(this.data,
this.fragment.key):null:this.$services.page.getPageInstance(this.page,this).get(this.fragment.key)}}});
Vue.component("page-field-fragment-javascript-configure",{template:"\x3cn-form-section\x3e\t\t\x3cn-ace mode\x3d'javascript' v-model\x3d'fragment.content'/\x3e\t\t\x3cn-form-combo label\x3d'Type' v-model\x3d'fragment.tag' :items\x3d\"['span', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'div']\"/\x3e\t\t\x3cn-form-switch v-model\x3d'fragment.html' label\x3d'Allow html'/\x3e\t\t\x3cn-form-switch v-model\x3d'fragment.compile' label\x3d'Compile'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,required:!0},
page:{type:Object,required:!0},fragment:{type:Object,required:!0}},created:function(){this.fragment.content||Vue.set(this.fragment,"content",null);this.fragment.tag||Vue.set(this.fragment,"tag",null)}});
Vue.component("page-field-fragment-javascript",{template:"\x3ccomponent :is\x3d'tag' v-content.parameterized\x3d'{value:value,plain:!fragment.html,compile:!!fragment.compile}'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}},computed:{value:function(){return this.$services.page.eval(this.fragment.content,this.data,this)},tag:function(){return this.fragment.tag?this.fragment.tag:"span"}}});
Vue.component("page-field-fragment-richtext-configure",{template:"\x3cn-form-section\x3e\x3cn-form-richtext v-model\x3d'fragment.content'/\x3e\t\t\x3cn-form-switch label\x3d'Compile' v-model\x3d'fragment.compile'/\x3e\t\x3c/n-form-section\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0}},created:function(){this.fragment.content||Vue.set(this.fragment,"content",null)}});
Vue.component("page-field-fragment-richtext",{template:"\x3cdiv v-content.parameterized\x3d'{value:$services.page.translate(fragment.content), sanitize:true, compile: fragment.compile }'\x3e\x3c/div\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}}});
Vue.component("page-field-fragment-form-configure",{template:"\x3cn-form-section\x3e\x3cpage-form-configure-single :field\x3d'fragment.form' :possible-fields\x3d'keys'\t\t:allow-label\x3d'false'\t\t:allow-description\x3d'false'\t\t:page\x3d'page'\t\t:cell\x3d'cell'/\x3e\x3cn-form-text v-model\x3d'fragment.disabled' label\x3d'Disabled If'/\x3e\x3cn-form-text v-model\x3d'fragment.componentGroup' label\x3d'Component Group' :timeout\x3d'600'/\x3e     \x3cn-form-text v-model\x3d'fragment.messageMode' label\x3d'Message Mode (the literal component or a number)' :timeout\x3d'600'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},keys:{type:Array,required:!0}},created:function(){this.fragment.form||Vue.set(this.fragment,"form",{});this.fragment.disabled||Vue.set(this.fragment,"disabled",null)}});
Vue.component("page-field-fragment-form",{template:"\x3cpage-form-field :key\x3d\"fragment.form.name + '_value'\" :field\x3d'fragment.form'\t\t:value\x3d'formValue(fragment)'\t\t:parent-value\x3d'data'\t\t@input\x3d'function(newValue) { updateForm(fragment, newValue) }'\t\t:label\x3d'false'\t\t:page\x3d'page'\t\t:cell\x3d'cell'\t\t:mode\x3d'fragment.mode'\t\t:component-group\x3d\"fragment.componentGroup ? fragment.componentGroup : 'form'\"\t\t:is-disabled\x3d'!!fragment.disabled \x26\x26 $services.page.isCondition(fragment.disabled, {record:data}, $self)'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},fragment:{type:Object,required:!0},data:{type:Object,required:!0}},methods:{formValue:function(a){if(a.form.name)return this.data[a.form.name]},updateForm:function(a,b){Vue.set(this.data,a.form.name,b);this.$emit("updated",a.form.name)}}});
Vue.component("page-renderer-slider",{template:"#page-renderer-slider",props:{group:{type:String,required:!1,default:"slider-default"},tag:{type:String,required:!1}},data:function(){return{active:0}},ready:function(){this.show()},methods:{show:function(a){for(var b=-1,c=!1,d=null,e=0;e<this.$slots.default.length;e++){var g=this.$slots.default[e];null!=g.tag&&(b++,d=b,b==a?(c=!0,this.active=b,g.elm.classList.add("is-active")):g.elm.classList.remove("is-active"))}c||(this.active=0>a?d:0,a!=this.active&&
this.show(this.active))},beforeEnter:function(a){console.log("element is",a);a.style.opacity=0},previous:function(){this.show(this.active-1)},next:function(){this.show(this.active+1)}}});
Vue.component("enumeration-provider",{props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},data:function(){return{provider:null}},created:function(){"provider"==this.field.provider&&(this.provider=this.getProvider())},computed:{operationBinding:function(){var a={},b=this;if(this.field.enumerationOperationBinding){var c=b.$services.page.getPageInstance(b.page,b);Object.keys(this.field.enumerationOperationBinding).map(function(d){if(null!=b.field.enumerationOperationBinding[d]){for(var e=
a,g=d.split("."),k=0;k<g.length-1;k++)e[g[k]]||(e[g[k]]={}),e=e[g[k]];0==b.field.enumerationOperationBinding[d].indexOf("record.")?e[g[g.length-1]]=b.$services.page.getValue(b.parentValue,b.field.enumerationOperationBinding[d].substring(7)):e[g[g.length-1]]=b.$services.page.getBindingValue(c,b.field.enumerationOperationBinding[d],b)}})}return a}},methods:{getProvider:function(){if(this.field.enumerationProvider){var a=this;return nabu.page.providers("page-enumerate").filter(function(b){return b.name==
a.field.enumerationProvider})[0]}return null},enumerationFilter:function(a){return this.enumerationFilterAny(a,!1)},enumerationFilterAny:function(a,b){if("operation"==this.field.provider){if(!this.field.enumerationOperation)return[];var c={};nabu.utils.objects.merge(c,this.operationBinding);!b&&this.field.enumerationOperationQuery?c[this.field.enumerationOperationQuery]=a:b&&this.field.enumerationOperationResolve&&(c[this.field.enumerationOperationResolve]=a);var d=this;b=d.$services.page.getPageInstance(d.page,
d);c.$serviceContext||(c.$serviceContext=b.getServiceContext());return this.$services.swagger.execute(this.field.enumerationOperation,c,function(g){var k=null;if(g){var m=!1;Object.keys(g).map(function(p){g[p]instanceof Array&&0==m&&(k=g[p],d.field.selectFirstIfEmpty&&null==d.value&&k&&0<k.length&&d.$emit("input",d.enumerationExtracter(k[0])),m=!0)})}return k?k:[]})}if("array"==this.field.provider){if(this.field.enumerationArray&&(d=this,b=d.$services.page.getPageInstance(d.page,d),b=b.get(this.field.enumerationArray),
c=[],b&&b.length&&nabu.utils.arrays.merge(c,b),this.field.filter&&(c=c.filter(function(g){return d.$services.page.isCondition(d.field.filter,g,d)})),c&&c.length)){if(1==this.field.addEmptyState&&null!=this.field.emptyState){b={};this.field.enumerationFieldValue&&(b[this.field.enumerationFieldValue]=null,b.emptyState=!0);var e=c.filter(function(g){return 1==g.emptyState});null!=e&&0==e.length&&c.push(b)}return a?c.filter(function(g){if(g==a)return!0;if(null!=d.field.enumerationArrayLabel){var k=g[d.field.enumerationArrayLabel];
if(k&&k.toLowerCase&&0<=k.toLowerCase().indexOf(a.toLowerCase()))return!0}if(null!=d.field.enumerationFieldValue&&(k=g[d.field.enumerationFieldValue])&&k.toLowerCase&&0<=k.toLowerCase().indexOf(a.toLowerCase()))return!0}):c}}else if("provider"==this.field.provider){if(c=this.provider)return d=this,c=c.enumerate(),this.field.filter&&c&&(c=c.filter(function(g){return d.$services.page.isCondition(d.field.filter,g,d)})),a&&(c=c.filter(function(g){return 0<=d.enumerationFormatter(g).toLowerCase().indexOf(a.toLowerCase())})),
c}else if("fixed"==this.field.provider)return d=this,c=this.field.enumerations.map(function(g){if("string"==typeof g)return""+d.$services.page.translate(g&&0==g.indexOf("\x3d")?d.$services.page.interpret(g,d):g);g=nabu.utils.objects.clone(g);g.value=""+d.$services.page.translate(g&&g.value&&0==g.value.indexOf("\x3d")?d.$services.page.interpret(g.value,d):g.value);return g}).filter(function(g){return"string"==typeof g?!a||0<=g.toLowerCase().indexOf(a.toLowerCase()):!a||0<=g.value.toLowerCase().indexOf((""+
a).toLowerCase())}),this.field.allowCustom&&0>c.indexOf(a)&&c.unshift(a),c;return[]},getFixedMatch:function(a){var b=this;return this.field.enumerations.filter(function(c){return null!=c.key?b.$services.page.interpret(c.key)==a:null!=c.value?b.$services.page.interpret(c.value)==a:b.$services.page.interpret(c)==a})},enumerationResolver:function(a){return"operation"==this.field.provider&&this.field.enumerationOperationResolve&&this.field.enumerationFieldValue?this.enumerationFilterAny(a,!0):"array"==
this.field.provider||"provider"==this.field.provider?this.enumerationFilterAny():"fixed"==this.field.provider?this.getFixedMatch(a):a},enumerationFormatter:function(a){if("fixed"==this.field.provider){if("string"==typeof a)return a;if(a)return a.value?this.$services.page.interpret(this.$services.page.translate(a.value,this),this):a.key}else{if(null==a)return null;if(this.field.enumerationFieldLabelComplex){var b=this.$services.page.getPageInstance(this.page,this);return this.field.complexLabel?this.$services.typography.replaceVariables(b,
this.field,this.field.complexLabel,this.$services.q.reject(),a):this.field.complexLabel}return this.field.enumerationFormatter?this.field.enumerationFormatter(a):this.field.enumerationFieldLabel?a[this.field.enumerationFieldLabel]:a}},enumerationPrettyFormatter:function(a){if(null==a)return null;if(a&&1==a.emptyState&&1==this.field.addEmptyState&&this.field.emptyState)return this.$services.page.interpret(this.$services.page.translate(this.field.emptyState),this);if(this.field.enumerationFieldPrettyLabelComplex){var b=
this.$services.page.getPageInstance(this.page,this);return this.field.complexPrettyLabel?this.$services.typography.replaceVariables(b,this.field,this.field.complexPrettyLabel,this.$services.q.reject(),a):this.field.complexPrettyLabel}return this.field.enumerationFieldPrettyLabel?a[this.field.enumerationFieldPrettyLabel]:this.enumerationFormatter(a)},enumerationExtracter:function(a){if("fixed"==this.field.provider){if("string"==typeof a)return a;if(a)return a.key?this.$services.page.interpret(a.key,
this):a.value}else return null==a?null:this.field.enumerationFieldValue?a[this.field.enumerationFieldValue]:a},validate:function(a){return this.$refs.form?this.$refs.form.validate(a):!0}}});
Vue.component("enumeration-provider-configure",{template:"#enumeration-provider-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.enumerationOperationBinding||Vue.set(this.field,"enumerationOperationBinding",{});null==this.field.enumerations&&Vue.set(this.field,"enumerations",[])},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)},providerValueOptions:function(){if(null!=
this.field.enumerationProvider){var a=this;nabu.page.providers("page-enumerate").map(function(c){return c.name});var b=nabu.page.providers("page-enumerate").filter(function(c){return c.name==a.field.enumerationProvider})[0];if(b&&b.values)return b.values}return null},providerLabelOptions:function(){if(null!=this.field.enumerationProvider){var a=this;nabu.page.providers("page-enumerate").map(function(c){return c.name});var b=nabu.page.providers("page-enumerate").filter(function(c){return c.name==a.field.enumerationProvider})[0];
if(b&&b.labels)return b.labels}return null}},methods:{addEnumeration:function(){this.field.complex?this.field.enumerations.push({value:null,key:null}):this.field.enumerations.push("")},getEnumerationArrays:function(a){return this.$services.page.getAllArrays(this.page,this.cell.id).filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},getEnumerationServices:function(a){var b=this;return this.$services.page.getOperations(function(c){var d="get"==c.method.toLowerCase()&&(!a||0<=
c.id.toLowerCase().indexOf(a.toLowerCase()))&&c.responses["200"];if(d&&(c=c.responses["200"]?c.responses["200"].schema:null)){var e=b.$services.swagger.definition(c.$ref);d=!1;e.properties&&Object.keys(e.properties).map(function(g){"array"==e.properties[g].type&&(d=!0)})}return d}).map(function(c){return c.id})},getEnumerationFields:function(a,b){var c=[];if("operation"==this.field.provider){if(this.$services.swagger.operations[a]){var d=this.$services.swagger.resolve(this.$services.swagger.operations[a].responses["200"]);
Object.keys(d.schema.properties).map(function(p){"array"==d.schema.properties[p].type&&nabu.utils.arrays.merge(c,Object.keys(d.schema.properties[p].items.properties))})}}else if("array"==this.field.provider){a={};var e=null,g=null,k=null;if(0==this.field.enumerationArray.indexOf("parent.")){var m=this;g=this.field.enumerationArray.substring(7);k=this.$services.page.pages.filter(function(p){return p.content.name==m.page.content.pageParent})[0];null!=k&&(e=this.$services.page.getAllAvailableParameters(k));
k=g.substring(g.indexOf(".")+1);g=g.substring(0,g.indexOf("."))}else e=this.$services.page.getAllAvailableParameters(this.page,this.cell),g=this.field.enumerationArray.substring(0,this.field.enumerationArray.indexOf(".")),k=this.field.enumerationArray.substring(this.field.enumerationArray.indexOf(".")+1);e[g]&&(k=this.$services.page.getChildDefinition(e[g],k),console.log("variable",e,g,k),k&&nabu.utils.objects.merge(a,k.items.properties));nabu.utils.arrays.merge(c,this.$services.page.getSimpleKeysFor({properties:a}))}else"provider"==
this.field.provider&&nabu.utils.arrays.merge(c,this.providerLabelOptions);b&&(c=c.filter(function(p){return 0<=p.toLowerCase().indexOf(b.toLowerCase())}));return c},getEnumerationParameters:function(a,b){a=(a=this.$services.swagger.operations[a].parameters)?a.map(function(c){return c.name}):[];null!=b&&(a=a.filter(function(c){return 0<=c.toLowerCase().indexOf(b.toLowerCase())}));return a},getMappableEnumerationParameters:function(a){var b={properties:{}};this.$services.swagger.operations[a.enumerationOperation]&&
(Object.keys(this.$services.page.getInputBindings(this.$services.swagger.operations[a.enumerationOperation])).map(function(c){c!=a.enumerationOperationQuery&&(b.properties[c]={type:"string"})}),b.properties.$serviceContext={type:"string"});return b},hasMappableEnumerationParameters:function(a){return 0<Object.keys(this.getMappableEnumerationParameters(a).properties).length},searchPossible:function(a){return this.possibleFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},
getEnumerationProviders:function(a){var b=nabu.page.providers("page-enumerate").map(function(c){return c.name});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b}}});Vue.component("page-form-combo-configure",{template:"#page-form-combo-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-combo",{mixins:[Vue.component("enumeration-provider")],template:"#page-form-combo",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},parentValue:{type:Object,required:!1},childComponents:{required:!1}},
watch:{operationBinding:{deep:!0,handler:function(a){this.$refs.combo&&this.$refs.combo.$refs.combo&&this.$refs.combo.$refs.combo.markDirty()}}},methods:{configurator:function(){return"page-form-combo-configure"},getChildComponents:function(){return{title:"Form Combo",name:"page-form-combo",component:"form-combo"}},validate:function(a){if(this.$refs.combo)return this.$refs.combo.validate(a)}}});
window.addEventListener("load",function(){application.bootstrap(function(a){a.router.register({alias:"page-form-combo",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-combo";c.configurationComponent="page-form-combo-configure";c.subTabs=["data"];return new nabu.page.views.FormComponent({propsData:c})},form:"combo",category:"Form",name:"Combo box",description:"A combo box that allows the user to choose one or more values",icon:"page/core/images/enumeration.png"})})});
Vue.component("page-form-checkbox-list-configure",{template:"#page-form-checkbox-list-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-checkbox-list",{mixins:[Vue.component("enumeration-provider")],template:"#page-form-checkbox-list",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},parentValue:{type:Object,
required:!1},childComponents:{required:!1}},watch:{operationBinding:{deep:!0,handler:function(a){this.$refs.checkbox-list&&this.$refs.checkbox-list.$refs.checkbox-list&&this.$refs.checkbox-list.$refs.checkbox-list.markDirty()}}},methods:{configurator:function(){return"page-form-checkbox-list-configure"},getChildComponents:function(){return{title:"Form checkbox-list",name:"page-form-checkbox-list",component:"form-checkbox-list"}},validate:function(a){if(this.$refs["checkbox-list"])return this.$refs["checkbox-list"].validate(a)}}});
window.addEventListener("load",function(){application.bootstrap(function(a){a.router.register({alias:"page-form-checkbox-list",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-checkbox-list";c.configurationComponent="page-form-checkbox-list-configure";c.subTabs=["data"];return new nabu.page.views.FormComponent({propsData:c})},form:"checkbox-list",category:"Form",name:"checkbox-list",description:"A checkbox-list that allows the user to choose one or more values",
icon:"page/core/images/enumeration.png"})})});Vue.component("page-form-radio-configure",{template:"#page-form-radio-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-radio",{mixins:[Vue.component("enumeration-provider")],template:"#page-form-radio",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},parentValue:{type:Object,required:!1},childComponents:{required:!1}},
watch:{operationBinding:{deep:!0,handler:function(a){this.$refs.radio&&this.$refs.radio.$refs.radio&&this.$refs.radio.$refs.radio.markDirty()}}},methods:{disabler:function(a){return this.field.disableEntryCondition?this.$services.page.isCondition(this.field.disableEntryCondition,a,this,null,!1):!1},configurator:function(){return"page-form-radio-configure"},getChildComponents:function(){return{title:"Form radio",name:"page-form-radio",component:"form-radio-list"}},validate:function(a){if(this.$refs.radio)return this.$refs.radio.validate(a)}}});
window.addEventListener("load",function(){application.bootstrap(function(a){a.router.register({alias:"page-form-radio",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-radio";c.configurationComponent="page-form-radio-configure";c.subTabs=["data"];return new nabu.page.views.FormComponent({propsData:c})},form:"radio",category:"Form",name:"Radio box",description:"A radio box that allows the user to choose one or more values",icon:"page/core/images/enumeration.png"})})});
Vue.component("page-form-list-input-predefined-configure",{template:"#page-form-list-input-predefined-configure",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},schema:{type:Object,required:!1}},computed:{operation:function(){return this.field.fieldProviderOperation?this.$services.swagger.operations[this.field.fieldProviderOperation]:null},definition:function(){var a={};if(this.operation&&this.operation.responses["200"]){var b=this.$services.swagger.resolve(this.operation.responses["200"].schema);
b.properties&&Object.keys(b.properties).map(function(c){"array"==b.properties[c].type&&(c=b.properties[c].items,c.properties&&nabu.utils.objects.merge(a,c.properties))})}return a},availableFields:function(){return this.$services.page.getSimpleKeysFor({properties:this.definition})},availableResultFields:function(){var a=this.schema;a.items&&(a=a.items);return Object.keys(a.properties)}},created:function(){this.field.fieldOperationBinding||Vue.set(this.field,"fieldOperationBinding",{})},methods:{listOperations:function(a){var b=
this;return this.$services.page.getOperations(function(c){var d="get"==c.method.toLowerCase()&&(!a||0<=c.id.toLowerCase().indexOf(a.toLowerCase()))&&c.responses["200"];if(d&&(c=c.responses["200"]?c.responses["200"].schema:null)){var e=b.$services.swagger.definition(c.$ref);d=!1;e.properties&&Object.keys(e.properties).map(function(g){"array"==e.properties[g].type&&(d=!0)})}return d}).map(function(c){return c.id})},getMappableParameters:function(a){var b={properties:{}};Object.keys(this.$services.page.getInputBindings(this.$services.swagger.operations[a.fieldProviderOperation])).map(function(c){b.properties[c]=
{type:"string"}});return b},hasMappableParameters:function(a){return 0<Object.keys(this.getMappableParameters(a).properties).length}}});
Vue.component("page-form-list-input-predefined",{template:"#page-form-list-input-predefined",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1}},data:function(){return{fields:[]}},created:function(){var a=this;if(this.field.fieldProviderOperation){var b={};if(this.field.fieldOperationBinding){a=this;var c=a.$services.page.getPageInstance(a.page,
a);Object.keys(this.field.fieldOperationBinding).map(function(d){for(var e=b,g=d.split("."),k=0;k<g.length-1;k++)e[g[k]]||(e[g[k]]={}),e=e[g[k]];e[g[g.length-1]]=a.$services.page.getBindingValue(c,a.field.fieldOperationBinding[d],a)})}this.$services.swagger.execute(this.field.fieldProviderOperation,b).then(function(d){d&&Object.keys(d).map(function(e){d[e]instanceof Array&&(nabu.utils.arrays.merge(a.fields,d[e].map(function(g){var k=a.field.typeField?g[a.field.typeField]:null,m=a.field.nameField?
g[a.field.nameField]:null,p=1,q=a.field.labelField?g[a.field.labelField]:null,t=null;if(a.field.valueField)t=g[a.field.valueField];else if(a.value){var u=a.$services.page.getValue(a.value,a.field.name);console.log("value is",a.value,JSON.stringify(a.value,null,2),a.field.name,u,a.value[a.field.name.trim()]);if(u){var w=a.field.resultKeyField;null==w&&(w="key");if(u=u.filter(function(B){return B[w]==m})[0])t=a.field.resultValueField,null==t&&(t="value"),t=u[t]}}u=a.field.optionalField?g[a.field.optionalField]:
!0;g=a.field.placeholderField?g[a.field.placeholderField]:null;var y={type:null==k?"string":k,name:null==m?"unnamed"+p++:m,label:null==q?null==m?"Unnamed":m:q,value:t,optional:u,placeholder:g};console.log("calculated placeholder",g);null!=t&&(a.value[y.name]=t);Object.keys(d[e]).map(function(B){B!=a.field.typeField&&B!=a.field.nameField&&B!=a.field.labelField&&B!=a.field.valueField&&(y[B]=d[e][B])});return y})),a.fields.forEach(function(g){a.updateField(g,g.value)}))})})}},methods:{validate:function(a){return this.$refs.form.validate(a)},
updateField:function(a,b){null==this.value[this.field.name]&&Vue.set(this.value,this.field.name,[]);var c=this.field.resultKeyField;null==c&&(c="key");var d=this.field.resultValueField;null==d&&(d="value");var e=this.value[this.field.name].filter(function(g){return g[c]==a.name})[0];null==e?(e={},e[c]=a.name,e[d]=b,this.value[this.field.name].push(e)):e[d]=b}}});
Vue.component("page-form-list-input-dynamic-configure",{template:"\x3cdiv\x3e\x3cn-form-text v-model\x3d'field.buttonAddClass' placeholder\x3d'primary' label\x3d'Button Add Class'/\x3e\x3cn-form-text v-if\x3d'false' v-model\x3d'field.buttonRemoveClass' placeholder\x3d'secondary' label\x3d'Button Remove Class'/\x3e\x3c/div\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-list-input-dynamic",{template:"\x3cn-form-section ref\x3d'form' class\x3d'dynamic-input'\x3e\t\t\x3cdiv class\x3d'dynamic-input-contents' v-if\x3d'currentValue'\x3e\t\t\t\x3cdiv v-for\x3d'i in Object.keys(currentValue)' class\x3d'dynamic-input-iteration'\x3e\t\t\t\t\x3ctemplate v-if\x3d'isSimpleList()'\x3e\t\t\t\t\t\x3cpage-form-field :key\x3d\"field.name + '_value' + i\" :field\x3d'getSimpleField()'\t\t\t\t\t\tv-model\x3d'currentValue[i]'\t\t\t\t\t\t:schema\x3d'getSchemaFor()'\t\t\t\t\t\t@input\x3d\"$emit('changed')\"\t\t\t\t\t\t:timeout\x3d'timeout'\t\t\t\t\t\t:page\x3d'page'\t\t\t\t\t\t:cell\x3d'cell'/\x3e\t\t\t\t\x3c/template\x3e\t\t\t\t\x3ctemplate v-else\x3e\t\t\t\t\t\x3cdiv v-for\x3d'key in getChildren()' \t\t\t\t\t\t\tv-if\x3d\"getField(field.name + '.' + key)\" \x3e\t\t\t\t\t\t\x3ccomponent v-if\x3d\"getProvidedListComponent(field.name + '.' + key) !\x3d null\"\t\t\t\t\t\t\t:is\x3d\"getProvidedListComponent(field.name + '.' + key)\"\t\t\t\t\t\t\t:value\x3d'currentValue[i]'\t\t\t\t\t\t\t:page\x3d'page'\t\t\t\t\t\t\t:cell\x3d'cell'\t\t\t\t\t\t\t:edit\x3d'edit'\t\t\t\t\t\t\t:name\x3d'key'\t\t\t\t\t\t\t:field\x3d\"getField(field.name + '.' + key)\"\t\t\t\t\t\t\t@changed\x3d\"$emit('changed')\"\t\t\t\t\t\t\t:timeout\x3d'cell.state.immediate ? 600 : 0'\t\t\t\t\t\t\t:schema\x3d\"getSchemaFor(key)\"\t\t\t\t\t\t\t:class\x3d\"getField(field.name + '.' + key).group\"/\x3e\t\t\t\t\t\t\x3cpage-form-field v-else :key\x3d\"field.name + '_value' + i + '_' + key\" :field\x3d\"getField(field.name + '.' + key)\"\t\t\t\t\t\t\t:schema\x3d\"getSchemaFor(key)\" v-model\x3d'currentValue[i][key]'\t\t\t\t\t\t\t@input\x3d\"$emit('changed')\"\t\t\t\t\t\t\t:timeout\x3d'timeout'\t\t\t\t\t\t\t:page\x3d'page'\t\t\t\t\t\t\t:cell\x3d'cell'\t\t\t\t\t\t\t:class\x3d\"getField(field.name + '.' + key).group\"/\x3e\t\t\t\t\t\x3c/div\x3e\t\t\t\t\x3c/template\x3e\x3cspan class\x3d'fa fa-times' @click\x3d'currentValue.splice(i, 1)'\x3e\x3c/span\x3e\t\t\x3cbutton v-if\x3d'false' :class\x3d\"field.buttonRemoveClass ? field.buttonRemoveClass : 'secondary'\" @click\x3d'currentValue.splice(i, 1)'\x3e%{Remove} {{field.label ? $services.page.translate(field.label) : field.name}}\x3c/button\x3e\t\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'dynamic-input-actions'\x3e\t\t\x3cbutton :class\x3d\"field.buttonAddClass ? field.buttonAddClass : 'primary'\" @click\x3d'addInstanceOfField'\x3e%{Add} {{field.label ? $services.page.translate(field.label) : field.name}}\x3c/button\x3e\x3c/div\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},edit:{type:Boolean,required:!1},name:{type:String,required:!1}},computed:{currentValue:function(){for(var a=this.name?this.name:this.field.name,b=a;a;){if(this.value[a])return a!=b?this.$services.page.getValue(this.value[a],b.substring(a.length+1)):this.value[a];var c=a.lastIndexOf(".");
if(0<c)a=a.substring(0,c);else break}return null}},methods:{validate:function(a){return this.$refs.form.validate(a)},getSimpleField:function(){var a=nabu.utils.objects.clone(this.field);a.type="text";return a},addInstanceOfField:function(){var a=this.field,b=this.name?this.name:a.name;a=this.currentValue;a||(Vue.set(this.value,b,[]),a=this.value[b]);b=this.schema;b.items&&(b=b.items);var c=null;b.properties&&(c={},Object.keys(b.properties).map(function(d){c[d]=null}));a.push(c)},getChildren:function(){var a=
this.schema;a.items&&(a=a.items);return Object.keys(a.properties)},getProvidedListComponent:function(a){a=this.getField(a);if(!a)return null;var b=a.type;return b?(a=nabu.page.providers("page-form-list-input").filter(function(c){return c.name==b})[0])?a.component:null:null},isSimpleList:function(){return!this.schema.items.properties},getSchemaFor:function(a){return a?(this.schema.items.properties[a].required=this.schema.items.required&&0<=this.schema.items.required.indexOf(a),this.schema.items.properties[a]):
this.schema.items},getField:function(a){for(var b=0;b<this.cell.state.pages.length;b++){var c=this.cell.state.pages[b].fields.filter(function(d){return d.name==a})[0];if(c)return c}}}});
Vue.component("page-form-input-checkbox-configure",{template:"\x3cdiv\x3e\x3cn-form-switch v-model\x3d'field.mustCheck' label\x3d'Must Check'/\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content'/\x3e\t\x3cn-form-switch v-model\x3d'field.invert' label\x3d'Invert Boolean'/\x3e\t\x3cn-form-text v-model\x3d'field.infoIcon' label\x3d'Info Icon'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' :to\x3d'[\"item\"]'/\x3e\x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.bindings||Vue.set(this.field,"bindings",{})},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}}});
Vue.component("page-form-input-checkbox",{template:"\x3cn-form-checkbox ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:schema\x3d'schema'\t\t:class\x3d\"getChildComponentClasses('page-form-checkbox')\"\t\t:info-icon\x3d'field.infoIcon'\t\t:info\x3d'field.info ? $services.page.interpret($services.page.translate(field.info), $self) : null'\t\t:required\x3d'required'\t\t:must-check\x3d'field.mustCheck'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:item\x3d'getItem()'\t\t:value\x3d'value'\t\t:timeout\x3d'timeout'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:invert\x3d'!!field.invert'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},required:{type:Boolean,required:!1},readOnly:{type:Boolean,required:!1},childComponents:{required:!1}},methods:{getChildComponents:function(){return{title:"Form Checkbox",name:"page-form-checkbox",component:"form-checkbox"}},validate:function(a){return this.$refs.form.validate(a)},
getItem:function(){if(this.field.bindings&&this.field.bindings.item){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.item,this)}}}});
Vue.component("page-form-input-enumeration-configure",{template:"\x3cn-form-section\x3e \t\x3cn-form-switch v-model\x3d'field.showRadioView' label\x3d'Show radio visualisation'/\x3e \t\x3cn-form-switch v-model\x3d'field.complex' label\x3d'Complex Values' v-if\x3d'!field.allowCustom'/\x3e \t\x3cn-form-switch v-model\x3d'field.icon' v-if\x3d'field.showRadioView' label\x3d'Icon (instead of radio)'/\x3e \t\x3cn-form-switch v-model\x3d'field.iconAlt' v-if\x3d'field.showRadioView \x26\x26 field.icon' label\x3d'Icon (when not selected)'/\x3e \t\x3cn-form-switch v-if\x3d'!field.showRadioView' v-model\x3d'field.forceValue' label\x3d'Force Any Value' /\x3e\t\t\x3cn-form-switch v-if\x3d'!field.complex' v-model\x3d'field.allowCustom' label\x3d'Allow Custom Values'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.showRadioView' v-model\x3d'field.mustChoose' label\x3d'Must choose' :items\x3d\"[true,false]\" /\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content'/\x3e\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content'/\x3e\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after'/\x3e\t\x3cn-form-text v-model\x3d'field.suffix' label\x3d'Suffix' v-if\x3d'!field.suffixIcon'/\x3e\t\x3cn-form-text v-model\x3d'field.suffixIcon' label\x3d'Suffix Icon' v-if\x3d'!field.suffix'/\x3e\t\t\x3cdiv class\x3d'is-row is-align-end'\x3e\x3cbutton class\x3d'is-button is-size-xsmall is-variant-primary-outline' @click\x3d'addEnumeration'\x3e\x3cicon name\x3d'plus'/\x3e\x3cspan class\x3d'text'\x3eEnumeration\x3c/span\x3e\x3c/button\x3e\x3c/div\x3e\t\t\x3cdiv v-if\x3d'!field.complex' class\x3d'is-column is-spacing-gap-small'\x3e\x3cn-form-section class\x3d'has-button-close' v-for\x3d'i in Object.keys(field.enumerations)' :key\x3d\"field.name + 'enumeration_' + i\"\x3e\t\t\t\x3cn-form-text v-model\x3d'field.enumerations[i]'/\x3e\t\t\t\x3cbutton class\x3d'is-button is-variant-close is-size-small' @click\x3d'field.enumerations.splice(i, 1)'\x3e\x3cicon name\x3d'times'/\x3e\x3c/button\x3e\t\t\x3c/n-form-section\x3e\x3c/div\x3e\t\t\x3cdiv v-else class\x3d'is-column is-spacing-gap-small'\x3e\x3cn-form-section class\x3d'is-column is-spacing-medium is-spacing-vertical-top-large is-color-body has-button-close' v-for\x3d'i in Object.keys(field.enumerations)' :key\x3d\"field.name + 'enumeration_' + i\"\x3e\t\t\t\x3cn-form-text v-model\x3d'field.enumerations[i].key' placeholder\x3d'Value' :timeout\x3d'600'/\x3e\t\t\t\x3cn-form-text v-model\x3d'field.enumerations[i].value' placeholder\x3d'Label' :timeout\x3d'600'/\x3e\t\t\t\x3cbutton class\x3d'is-button is-variant-close is-size-small' @click\x3d'field.enumerations.splice(i, 1)'\x3e\x3cicon name\x3d'times'/\x3e\x3c/button\x3e\t\t\x3c/n-form-section\x3e\t\x3c/div\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.enumerations||Vue.set(this.field,"enumerations",[])},methods:{addEnumeration:function(){this.field.complex?this.field.enumerations.push({value:null,key:null}):this.field.enumerations.push("")}},watch:{"field.complex":function(a){a?Vue.set(this.field,"enumerations",this.field.enumerations.splice(0).map(function(b){return"string"==typeof b?{key:b,value:null}:b})):Vue.set(this.field,"enumerations",
this.field.enumerations.splice(0).map(function(b){return"string"!=typeof b?b.key:b}))}}});
Vue.component("page-form-input-enumeration",{template:"\x3cdiv\x3e\x3cn-form-radio v-if\x3d'field.showRadioView' :items\x3d'field.enumerations' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:formatter\x3d'formatter'\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:icon\x3d'field.icon'\t\t:icon-alt\x3d'field.iconAlt'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:info\x3d'field.info ? $services.page.translate(field.info) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:schema\x3d'schema'\t\tv-bubble:label\t\t:required\x3d'required'\t\t:must-choose\x3d'field.mustChoose ? $services.page.interpret(field.mustChoose, $self) : null'\t\t:extracter\x3d'extracter'\t\t:disabled\x3d'disabled'/\x3e\x3cn-form-combo v-else :filter\x3d'enumerate' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:nillable\x3d'!field.forceValue'\t\t:placeholder\x3d'placeholder'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:formatter\x3d'formatter'\t\t:label\x3d'label'\t\t:value\x3d'value'\t\tv-bubble:label\t\tv-bubble:blur\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:info\x3d'field.info ? $services.page.translate(field.info) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:schema\x3d'schema'\t\t:required\x3d'required'\t\t:extracter\x3d'extracter'\t\t:disabled\x3d'disabled'/\x3e \x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},required:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},methods:{getChildComponents:function(){return[{title:"Form combo",name:"form-component",component:"form-combo"}]},validate:function(a){return this.$refs.form.validate(a)},
formatter:function(a){if("string"==typeof a)return a;if(a)return a.value?this.$services.page.interpret(this.$services.page.translate(a.value,this),this):a.key},extracter:function(a){if("string"==typeof a)return a;if(a)return a.key?this.$services.page.interpret(a.key,this):a.value},enumerate:function(a){var b=this,c=this.field.enumerations.map(function(d){if("string"==typeof d)return""+(d&&0==d.indexOf("\x3d")?b.$services.page.interpret(d,b):d);d=nabu.utils.objects.clone(d);d.value=""+(d&&d.value&&
0==d.value.indexOf("\x3d")?b.$services.page.interpret(d.value,b):d.value);return d}).filter(function(d){return"string"==typeof d?!a||0<=d.toLowerCase().indexOf(a.toLowerCase()):!a||0<=d.value.toLowerCase().indexOf(a.toLowerCase())});this.field.allowCustom&&0>c.indexOf(a)&&c.unshift(a);return c}}});
Vue.component("page-form-input-enumeration-array-configure",{template:"\x3cn-form-section class\x3d'enumeration'\x3e \t\x3cn-form-switch v-model\x3d'field.disableTyping' label\x3d'Disable typing'/\x3e \t\x3cn-form-switch v-model\x3d'field.showRadioView' v-if\x3d'!field.showCheckboxView' label\x3d'Show radio visualisation'/\x3e \t\x3cn-form-switch v-model\x3d'field.showCheckboxView' v-if\x3d'!field.showRadioView \x26\x26 supportsMultiple' label\x3d'Show checkbox visualisation (allows multiselect)'/\x3e \t\x3cn-form-switch v-model\x3d'field.addEmptyState' label\x3d'Add empty state'/\x3e\t\t\x3cn-form-text v-model\x3d'field.emptyValue' label\x3d'Empty text'/\x3e \t\x3cn-form-text v-if\x3d'!!field.addEmptyState' v-model\x3d'field.emptyState' label\x3d'Empty state text'/\x3e\t\t\x3cn-form-text v-if\x3d'field.showRadioView' v-model\x3d'field.mustChoose' label\x3d'Must choose' placeholder\x3d'\x3dtrue' allow-typing\x3d'true' /\x3e\t\t\x3cn-form-combo v-model\x3d'field.enumerationArray'\t\t\tlabel\x3d'Enumeration Array'\t\t\t:filter\x3d'getEnumerationArrays'/\x3e \t\x3cn-form-ace v-if\x3d'field.enumerationArray' label\x3d'Filter' v-model\x3d'field.filter'/\x3e\t\t\x3cn-form-switch v-model\x3d'field.enumerationArrayLabelComplex' label\x3d'Complex Enumeration Label'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationArray \x26\x26 !field.enumerationArrayLabelComplex' v-model\x3d'field.enumerationArrayLabel' label\x3d'Enumeration Label'\t\t\t:filter\x3d'function() { return getEnumerationFields(field.enumerationArray) }'/\x3e\t\t\x3cn-form-switch v-model\x3d'field.enumerationArrayPrettyLabelComplex' label\x3d'Complex Pretty Enumeration Label'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationArray \x26\x26 !field.enumerationArrayPrettyLabelComplex' v-model\x3d'field.enumerationArrayPrettyLabel' label\x3d'Pretty enumeration Label'\t\t\t:filter\x3d'function() { return getEnumerationFields(field.enumerationArray) }'/\x3e\t\t\x3cn-form-text v-model\x3d'field.complexPrettyLabel' label\x3d'The complex pretty label' v-if\x3d'field.enumerationArrayPrettyLabelComplex'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationArray' v-model\x3d'field.enumerationArrayValue' label\x3d'Enumeration Value'\t\t\t:filter\x3d'function() { return getEnumerationFields(field.enumerationArray) }' info\x3d'If nothing is selected, the entire document becomes the value'/\x3e\t\t\x3cn-form-text v-model\x3d'field.complexLabel' label\x3d'The complex text label' v-if\x3d'field.enumerationArrayLabelComplex'/\x3e\t\t\x3ctypography-variable-replacer v-if\x3d'field.enumerationArrayLabelComplex \x26\x26 field.complexLabel' :content\x3d'field.complexLabel' :page\x3d'page' :container\x3d'field' :keys\x3d'getEnumerationFields(field.enumerationArray)' /\x3e\t\t\x3ctypography-variable-replacer v-if\x3d'field.enumerationArrayPrettyLabelComplex \x26\x26 field.complexPrettyLabel' :content\x3d'field.complexPrettyLabel' :page\x3d'page' :container\x3d'field' :keys\x3d'getEnumerationFields(field.enumerationArray)' /\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationArray' :filter\x3d'function() { return getEnumerationFields(field.enumerationArray) }' v-model\x3d'field.enumerationCachingKey' label\x3d'Enumeration Caching Key'/\x3e\t\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' :to\x3d'[\"validator\"]'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.normalize(this.field)},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)},supportsMultiple:function(){if(this.cell.state.name){var a=this.$services.page.getPageParameters(this.page),b=this.cell.state.name;0==b.indexOf("page.")&&(b=b.substring(5));return(a=this.$services.page.getChildDefinition(a,b))?"array"==a.type:!1}return!1}},methods:{normalize:function(a){a.bindings||
Vue.set(a,"bindings",{})},enumerationFilter:function(a){var b=nabu.page.providers("page-enumerate").map(function(c){return c.name});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b},getEnumerationArrays:function(a){return this.$services.page.getAllArrays(this.page,this.cell.id).filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},getEnumerationFields:function(a){a={};var b=null,c=null,d=null;if(0==this.field.enumerationArray.indexOf("parent.")){var e=
this;c=this.field.enumerationArray.substring(7);d=this.$services.page.pages.filter(function(g){return g.content.name==e.page.content.pageParent})[0];null!=d&&(b=this.$services.page.getAllAvailableParameters(d));d=c.substring(c.indexOf(".")+1);c=c.substring(0,c.indexOf("."))}else b=this.$services.page.getAllAvailableParameters(this.page,this.cell),c=this.field.enumerationArray.substring(0,this.field.enumerationArray.indexOf(".")),d=this.field.enumerationArray.substring(this.field.enumerationArray.indexOf(".")+
1);b[c]&&(b=this.$services.page.getChildDefinition(b[c],d))&&nabu.utils.objects.merge(a,b.items.properties);return this.$services.page.getSimpleKeysFor({properties:a})}}});
Vue.component("page-form-input-enumeration-array",{template:" \x3cn-form-checkbox-list v-if\x3d'field.showCheckboxView' :items\x3d'enumerationFilterAny(null)' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\tv-bubble:input\t\t:formatter\x3d'enumerationFormatter'\t\t:label\x3d'label'\t\t:value\x3d'value'\t\tv-bubble:label\t\t:schema\x3d'schema'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:descriptionType\x3d'field.descriptionType'\t\t:descriptionIcon\x3d'field.descriptionIcon'\t\t:required\x3d'required'\t\t:extracter\x3d'enumerationExtracter'\t\t:disabled\x3d'disabled'/\x3e\x3cn-form-radio v-else-if\x3d'field.showRadioView'\t\t:items\x3d'enumerationFilterAny(null)'\t\tref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\tv-bubble:input\t\t:label\x3d'label ? $services.page.interpret(label, $self) : null'\t\t:value\x3d'value'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:schema\x3d'schema'\t\tv-bubble:label\t\t:required\x3d'required'\t\t:must-choose\x3d'field.mustChoose ? $services.page.interpret(field.mustChoose, $self) : null'\t\t:formatter\x3d'enumerationFormatter'\t\t:extracter\x3d'enumerationExtracter'\t\t:disabled\x3d'disabled'/\x3e\x3cn-form-combo ref\x3d'form' v-else\t\t:filter\x3d'enumerationFilter'\t\t:pretty-formatter\x3d'enumerationPrettyFormatter'\t\t:formatter\x3d'enumerationFormatter' \t:extracter\x3d'enumerationExtracter'\t\t:edit\x3d'!readOnly'\t\t:required\x3d'required'\t\t:placeholder\x3d'placeholder'\t\tv-bubble:input\t\tv-bubble:label\t\t:timeout\x3d'600'\t\t:empty-value\x3d'field.emptyValue'\t\t:label\x3d'label ? $services.page.interpret(label, $self) : null'\t\t:value\x3d'value'\t\t:allow-typing\x3d'!field.disableTyping'\t\t:validator\x3d'getValidator()'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:schema\x3d'schema'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},required:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},data:function(){return{provider:null}},methods:{getChildComponents:function(){return[{title:"Form combo",name:"form-component",component:"form-combo"}]},enumerationFilter:function(a){return this.enumerationFilterAny(a)},
enumerationFilterAny:function(a){if(this.field.enumerationArray){var b=this,c=b.$services.page.getPageInstance(b.page,b).get(this.field.enumerationArray),d=[];c&&c.length&&nabu.utils.arrays.merge(d,c);this.field.filter&&(d=d.filter(function(g){return b.$services.page.isCondition(b.field.filter,g,b)}));if(d&&d.length){if(1==this.field.addEmptyState&&null!=this.field.emptyState){c={};this.field.enumerationArrayValue&&(c[this.field.enumerationArrayValue]=null,c.emptyState=!0);var e=d.filter(function(g){return 1==
g.emptyState});null!=e&&0==e.length&&d.push(c)}return a?d.filter(function(g){if(null!=b.field.enumerationArrayLabel){var k=g[b.field.enumerationArrayLabel];if(k&&k.toLowerCase&&0<=k.toLowerCase().indexOf(a.toLowerCase()))return!0}if(null!=b.field.enumerationArrayValue&&(k=g[b.field.enumerationArrayValue])&&k.toLowerCase&&0<=k.toLowerCase().indexOf(a.toLowerCase()))return!0}):d}}return[]},enumerationPrettyFormatter:function(a){if(null==a)return null;if(a&&1==a.emptyState&&1==this.field.addEmptyState&&
this.field.emptyState)return this.$services.page.interpret(this.$services.page.translate(this.field.emptyState),this);if(this.field.enumerationArrayPrettyLabelComplex){var b=this.$services.page.getPageInstance(this.page,this);return this.field.complexPrettyLabel?this.$services.typography.replaceVariables(b,this.field,this.field.complexPrettyLabel,this.$services.q.reject(),a):this.field.complexPrettyLabel}return this.field.enumerationArrayPrettyLabel?a[this.field.enumerationArrayPrettyLabel]:this.enumerationFormatter(a)},
enumerationFormatter:function(a){if(null==a)return null;if(a&&1==a.emptyState&&1==this.field.addEmptyState&&this.field.emptyState)return this.$services.page.interpret(this.$services.page.translate(this.field.emptyState),this);if(this.field.enumerationArrayLabelComplex){var b=this.$services.page.getPageInstance(this.page,this);return this.field.complexLabel?this.$services.typography.replaceVariables(b,this.field,this.field.complexLabel,this.$services.q.reject(),a):this.field.complexLabel}if(this.field.enumerationArrayLabelComplex){b=
this.$services.page.getPageInstance(this.page,this);var c="enumerate."+this.field.enumerationOperation+"."+a[this.field.enumerationOperationValue];this.field.enumerationCachingKey&&(c+="."+a[this.field.enumerationCachingKey]);c=c.replace(/\./g,"_");if(null!=b.retrieve(c))return b.retrieve(c);var d=this;b.store(c,"");setTimeout(function(){var e=nabu.utils.objects.deepClone({page:d.page,cell:{state:d.field},edit:!1,data:a,label:!1,fieldsName:"enumerationFields"}),g=function(){var m=d.field.enumerationArrayLabelComplex?
k.$el.innerHTML:k.$el.innerHTML.replace(/<[^>]+>/g,"");b.retrieve(c)!=m&&b.store(c,m)},k=new nabu.page.views.PageFields({propsData:e,updated:g,ready:g});k.$mount()},1);return b.retrieve(c)}return this.field.enumerationFormatter?this.field.enumerationFormatter(a):this.field.enumerationArrayLabel?a[this.field.enumerationArrayLabel]:a},enumerationExtracter:function(a){return null==a?null:this.field.enumerationArrayValue?a[this.field.enumerationArrayValue]:a},validate:function(a){return this.$refs.form.validate(a)},
getValidator:function(){if(this.field.bindings&&this.field.bindings.validator){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.validator,this)}}}});
Vue.component("page-form-input-enumeration-operation-configure",{template:"\x3cn-form-section class\x3d'enumeration'\x3e\t\t\x3cn-form-combo v-model\x3d'field.enumerationOperation'\t\t\tlabel\x3d'Enumeration Operation'\t\t\t:filter\x3d'getEnumerationServices'/\x3e\t\t\x3cn-page-mapper v-if\x3d'field.enumerationOperation \x26\x26 hasMappableEnumerationParameters(field)'\t\t\tv-model\x3d'field.enumerationOperationBinding'\t\t\t:from\x3d'availableParameters'\t\t\t:to\x3d'getMappableEnumerationParameters(field)'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationOperation' :filter\x3d'function() { return getEnumerationFields(field.enumerationOperation) }' v-model\x3d'field.enumerationCachingKey' label\x3d'Enumeration Caching Key'/\x3e\t\t\x3cn-form-switch v-model\x3d'field.enumerationOperationLabelComplex' label\x3d'Complex Enumeration Label'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationOperation \x26\x26 !field.enumerationOperationLabelComplex' v-model\x3d'field.enumerationOperationLabel' label\x3d'Enumeration Label'\t\t\t:filter\x3d'function() { return getEnumerationFields(field.enumerationOperation) }'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationOperation' v-model\x3d'field.enumerationOperationValue' label\x3d'Enumeration Value'\t\t\t:filter\x3d'function() { return getEnumerationFields(field.enumerationOperation) }' info\x3d'If nothing is selected, the entire document becomes the value'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationOperation' v-model\x3d'field.enumerationOperationQuery' label\x3d'Enumeration Query'\t\t\t:filter\x3d'function() { return getEnumerationParameters(field.enumerationOperation) }'/\x3e\t\t\x3cn-form-combo v-if\x3d'field.enumerationOperation \x26\x26 field.enumerationOperationValue' :filter\x3d'function() { return getEnumerationParameters(field.enumerationOperation) }' v-model\x3d'field.enumerationOperationResolve' label\x3d'Resolve Field'/\x3e\t\t\x3cn-form-text v-model\x3d'field.complexLabel' label\x3d'The complex text label' v-if\x3d'field.enumerationOperation \x26\x26 field.enumerationOperationLabelComplex'/\x3e\t\t\x3ctypography-variable-replacer v-if\x3d'field.enumerationOperation \x26\x26 field.enumerationOperationLabelComplex \x26\x26 field.complexLabel' :content\x3d'field.complexLabel' :page\x3d'page' :container\x3d'field' :keys\x3d'getEnumerationFields(field.enumerationOperation)' /\x3e\t\t\x3cn-form-text v-if\x3d\"field.visualisation !\x3d 'radio'\" v-model\x3d'field.emptyValue' label\x3d'Empty Value Text'/\x3e\t\t\x3cn-form-text v-if\x3d\"field.visualisation !\x3d 'radio'\" v-model\x3d'field.calculatingValue' label\x3d'Calculating Value Text' info\x3d'The text to show while the result is being calculated'/\x3e\t\t\x3cn-form-text v-if\x3d\"field.visualisation !\x3d 'radio'\" v-model\x3d'field.resetValue' label\x3d'Reset Value Text' info\x3d'The text to show to reset the current value'/\x3e\t\t\x3cn-form-text v-if\x3d\"field.visualisation \x3d\x3d 'combo'\" v-model\x3d'field.selectAllValue' label\x3d'Select all value' info\x3d'The text to show to select all values or deselectt all'/\x3e\t\t\x3cn-form-switch v-if\x3d\"field.visualisation \x3d\x3d 'combo'\" v-model\x3d'field.useCheckbox' label\x3d'Add checkboxes'/\x3e\t\t\x3cn-form-switch v-if\x3d\"field.visualisation \x3d\x3d 'combo'\" v-model\x3d'field.showTags' label\x3d'Show tags'/\x3e\t\t\x3cn-form-text v-if\x3d\"field.visualisation \x3d\x3d 'combo'\" v-model\x3d'field.maxAmountOfTags' label\x3d'Max amount of tags visible' placeholder\x3d'3' after\x3d'Set to 0 to show all tags'/\x3e\t\t\x3cn-form-switch v-if\x3d\"field.visualisation \x3d\x3d 'combo'\" v-model\x3d'field.showAmount' label\x3d'Show amount'/\x3e \t\x3cn-form-switch :invert\x3d'true' v-if\x3d\"field.visualisation !\x3d 'radio'\" v-model\x3d'field.allowTyping' label\x3d'Disable typing' after\x3d'Can the user type to search?'/\x3e \t\x3cn-form-switch v-model\x3d'field.readOnly' label\x3d'Read only' after\x3d'Read only mode means the form element is replaced with a readable version'/\x3e \t\x3cn-form-switch v-if\x3d'field.showRadioView' v-model\x3d'field.showRadioView' label\x3d'Show radio visualisation'/\x3e \t\x3cn-form-switch v-model\x3d'field.selectFirstIfEmpty' label\x3d'Select the first value if none has been selected yet'/\x3e\t\t\x3cn-form-text v-if\x3d'field.showRadioView' v-model\x3d'field.mustChoose' label\x3d'Must choose' allow-typing\x3d'true' /\x3e\t\t\x3cn-form-combo :items\x3d\"['combo', 'combo-with-labels', 'radio']\" label\x3d'Visualisation' v-model\x3d'field.visualisation'/\x3e\t\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content'/\x3e\t\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content'/\x3e\t\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before'/\x3e\t\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content'/\x3e\t\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after'/\x3e\t\t\x3cn-form-text v-model\x3d'field.suffix' label\x3d'Suffix' v-if\x3d'!field.suffixIcon'/\x3e\t\t\x3cn-form-text v-model\x3d'field.suffixIcon' label\x3d'Suffix Icon' v-if\x3d'!field.suffix'/\x3e\t\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' v-if\x3d'false' :to\x3d'[\"validator\"]'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},possibleFields:{type:Array,required:!1,default:function(){return[]}}},created:function(){this.field.enumerationProvider||Vue.set(this.field,"enumerationProvider",null);this.field.showRadioView?(this.field.visualisation="radio",delete this.field.showRadioView):this.field.hasOwnProperty("visualisation")||(this.field.visualisation="combo-with-labels");this.normalize(this.field)},computed:{availableParameters:function(){var a=
this.$services.page.getAvailableParameters(this.page,this.cell,!0);0<this.possibleFields.length&&(a.record={properties:{}},this.possibleFields.forEach(function(b){a.record.properties[b]={type:"string"}}));return a}},methods:{searchPossible:function(a){return this.possibleFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})},enumerationFilter:function(a){var b=nabu.page.providers("page-enumerate").map(function(c){return c.name});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));
b.sort();return b},normalize:function(a){a.enumerationOperation||Vue.set(a,"enumerationOperation",null);a.enumerationOperationLabel||Vue.set(a,"enumerationOperationLabel",null);a.enumerationOperationValue||Vue.set(a,"enumerationOperationValue",null);a.enumerationOperationQuery||Vue.set(a,"enumerationOperationQuery",null);a.enumerationOperationBinding||Vue.set(a,"enumerationOperationBinding",{})},getEnumerationServices:function(a){var b=this;return this.$services.page.getOperations(function(c){var d=
"get"==c.method.toLowerCase()&&(!a||0<=c.id.toLowerCase().indexOf(a.toLowerCase()))&&c.responses["200"];if(d&&(c=c.responses["200"]?c.responses["200"].schema:null)){var e=b.$services.swagger.definition(c.$ref);d=!1;e.properties&&Object.keys(e.properties).map(function(g){"array"==e.properties[g].type&&(d=!0)})}return d}).map(function(c){return c.id})},getEnumerationFields:function(a){var b=[];if(this.$services.swagger.operations[a]){var c=this.$services.swagger.resolve(this.$services.swagger.operations[a].responses["200"]);
Object.keys(c.schema.properties).map(function(d){"array"==c.schema.properties[d].type&&nabu.utils.arrays.merge(b,Object.keys(c.schema.properties[d].items.properties))})}return b},getEnumerationParameters:function(a){return(a=this.$services.swagger.operations[a].parameters)?a.map(function(b){return b.name}):[]},getMappableEnumerationParameters:function(a){var b={properties:{}};this.$services.swagger.operations[a.enumerationOperation]&&(Object.keys(this.$services.page.getInputBindings(this.$services.swagger.operations[a.enumerationOperation])).map(function(c){c!=
a.enumerationOperationQuery&&(b.properties[c]={type:"string"})}),b.properties.$serviceContext={type:"string"});return b},hasMappableEnumerationParameters:function(a){return 0<Object.keys(this.getMappableEnumerationParameters(a).properties).length}}});
Vue.component("page-form-input-enumeration-operation",{template:"\x3cn-form-radio v-if\x3d\"field.showRadioView || field.visualisation \x3d\x3d 'radio'\"\t\t:items\x3d'resolvedItems'\t\tref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label ? $services.page.interpret(label, $self) : null'\t\t:value\x3d'value'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:schema\x3d'schema'\t\tv-bubble:label\t\t:required\x3d'required'\t\t:must-choose\x3d'field.mustChoose ? $services.page.interpret(field.mustChoose, $self) : null'\t\t:formatter\x3d'enumerationFormatter'\t\t:extracter\x3d'enumerationExtracter'\t\t:disabled\x3d'disabled'/\x3e\x3cn-form-combo v-else ref\x3d'form' :filter\x3d'enumerationFilter' :formatter\x3d'enumerationFormatter' :extracter\x3d'enumerationExtracter' :resolver\x3d'enumerationResolver'\t\t:combo-type\x3d\"field.visualisation \x3d\x3d 'combo' ? 'n-input-combo2' : 'n-input-combo'\"\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t@input\x3d\"function(newValue, label, rawValue, selectedLabel) { $emit('input', newValue, label, rawValue, selectedLabel) }\"\t\tv-bubble:label\t\t:timeout\x3d'600'\t\tv-bubble:blur\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:required\x3d'required'\t\t:allow-typing\x3d'field.allowTyping'\t\t:empty-value\x3d'field.emptyValue ? $services.page.translate($services.page.interpret(field.emptyValue)) : null'\t\t:calculating-value\x3d'field.calculatingValue ? $services.page.translate($services.page.interpret(field.calculatingValue)) : null'\t\t:reset-value\x3d'field.resetValue ? $services.page.translate($services.page.interpret(field.resetValue)) : null'\t\t:info\x3d'field.info ? $services.page.translate(field.info) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:validator\x3d'getValidator()'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:schema\x3d'schema'\t\t:disabled\x3d'disabled'\t\t:select-all-value\x3d'field.selectAllValue ? $services.page.translate($services.page.interpret(field.selectAllValue)) : null'\t\t:use-checkbox\x3d'field.useCheckbox'\t\t:show-tags\x3d'field.showTags'\t\t:show-amount\x3d'field.showAmount'\t\t:max-amount-of-tags\x3d'field.maxAmountOfTags'\t\t/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},parentValue:{type:Object,required:!1}},data:function(){return{provider:null,resolvedItems:[]}},created:function(){0==Object.keys(this.field).length&&Vue.set(this.field,"visualisation",
"combo");if(this.field.showRadioView){var a=this;this.enumerationFilterAny(null,!1).then(function(b){nabu.utils.arrays.merge(a.resolvedItems,b)})}},methods:{getChildComponents:function(){return[{title:"Form combo",name:"form-component",component:"form-combo"}]},enumerationFilter:function(a){return this.enumerationFilterAny(a,!1)},enumerationFilterAny:function(a,b){if(!this.field.enumerationOperation)return[];var c={limit:20};!b&&this.field.enumerationOperationQuery?c[this.field.enumerationOperationQuery]=
a:b&&this.field.enumerationOperationResolve&&(c[this.field.enumerationOperationResolve]=a);var d=this,e=d.$services.page.getPageInstance(d.page,d);this.field.enumerationOperationBinding&&Object.keys(this.field.enumerationOperationBinding).map(function(g){if(null!=d.field.enumerationOperationBinding[g]){for(var k=c,m=g.split("."),p=0;p<m.length-1;p++)k[m[p]]||(k[m[p]]={}),k=k[m[p]];0==d.field.enumerationOperationBinding[g].indexOf("record.")?k[m[m.length-1]]=d.$services.page.getValue(d.parentValue,
d.field.enumerationOperationBinding[g].substring(7)):k[m[m.length-1]]=d.$services.page.getBindingValue(e,d.field.enumerationOperationBinding[g],d)}});c.$serviceContext||(c.$serviceContext=e.getServiceContext());return this.$services.swagger.execute(this.field.enumerationOperation,c,function(g){var k=null;g&&Object.keys(g).map(function(m){g[m]instanceof Array&&(k=g[m],d.field.selectFirstIfEmpty&&null==d.value&&k&&0<k.length&&d.$emit("input",d.enumerationExtracter(k[0])))});return k?k:[]})},enumerationResolver:function(a){return this.field.enumerationOperationResolve&&
this.field.enumerationOperationValue?this.enumerationFilterAny(a,!0):a},enumerationFormatter:function(a){if(null==a)return null;if(this.field.enumerationOperationLabelComplex){var b=this.$services.page.getPageInstance(this.page,this);return this.field.complexLabel?this.$services.typography.replaceVariables(b,this.field,this.field.complexLabel,this.$services.q.reject(),a):this.field.complexLabel}return this.field.enumerationFormatter?this.field.enumerationFormatter(a):this.field.enumerationOperationLabel?
a[this.field.enumerationOperationLabel]:a},enumerationExtracter:function(a){return null==a?null:this.field.enumerationOperationValue?a[this.field.enumerationOperationValue]:a},validate:function(a){return this.$refs.form.validate(a)},getValidator:function(){if(this.field.bindings&&this.field.bindings.validator){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.validator,this)}}}});
Vue.component("page-form-input-page-configure",{template:"\x3cdiv/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-input-page",{template:"\x3cn-form-page ref\x3d'form' :timeout\x3d'timeout' :value\x3d'value' @input\x3d\"function(value) { $emit('input', value) }\" :schema\x3d'schema'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-slider-configure",{template:"\x3cn-form-section\x3e\t\x3cn-form-text v-model\x3d'field.minimum' label\x3d'Minimum' :required\x3d'true' type\x3d'number'/\x3e\t\x3cn-form-text v-model\x3d'field.maximum' label\x3d'Maximum' :required\x3d'true' type\x3d'number'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.textType||Vue.set(this.field,"textType",null)}});
Vue.component("page-form-input-slider",{template:"\x3cn-form-text type\x3d'range' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:minimum\x3d'field.minimum ? parseInt(field.minimum) : 0'\t\t:maximum\x3d'field.maximum ? parseInt(field.maximum) : 100'\t\t:schema\x3d'schema'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:timeout\x3d'timeout'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},
field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1}},computed:{textType:function(){return this.field.textType?this.field.textType:"text"}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-enumeration-provider-configure",{template:"\x3cn-form-section\x3e\x3cn-form-combo v-model\x3d'field.enumerationProvider' :filter\x3d'enumerationFilter' label\x3d'Enumeration Provider'/\x3e \t\x3cn-form-switch v-model\x3d'field.showRadioView' v-if\x3d'!field.showCheckboxView' label\x3d'Show radio visualisation'/\x3e \t\x3cn-form-switch v-model\x3d'field.showCheckboxView' v-if\x3d'!field.showRadioView \x26\x26 supportsMultiple' label\x3d'Show checkbox visualisation (allows multiselect)'/\x3e\t\t\x3cn-form-text v-if\x3d'!field.showRadioView' v-model\x3d'field.emptyValue' label\x3d'Empty Value Text'/\x3e\t\t\x3cn-form-text v-if\x3d'!field.showRadioView' v-model\x3d'field.resetValue' label\x3d'Reset Value Text' info\x3d'The text to show to reset the current value'/\x3e \t\x3cn-form-switch v-if\x3d'!field.showRadioView' v-model\x3d'field.readOnly' label\x3d'Read only' /\x3e\t\x3cn-form-combo v-if\x3d'valueOptions' :items\x3d'valueOptions' v-model\x3d'field.enumerationProviderValue' label\x3d'Value Field'/\x3e\t\x3cn-form-combo v-if\x3d'labelOptions' :items\x3d'labelOptions' v-model\x3d'field.enumerationProviderLabel' label\x3d'Label Field'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.enumerationProvider||Vue.set(this.field,"enumerationProvider",null)},computed:{supportsMultiple:function(){if(this.cell.state.name){var a=this.$services.page.getPageParameters(this.page),b=this.cell.state.name;0==b.indexOf("page.")&&(b=b.substring(5));return(a=this.$services.page.getChildDefinition(a,b))?"array"==a.type:!1}return!1},valueOptions:function(){if(null!=this.field.enumerationProvider){var a=
this;nabu.page.providers("page-enumerate").map(function(c){return c.name});var b=nabu.page.providers("page-enumerate").filter(function(c){return c.name==a.field.enumerationProvider})[0];if(b&&b.values)return b.values}return null},labelOptions:function(){if(null!=this.field.enumerationProvider){var a=this;nabu.page.providers("page-enumerate").map(function(c){return c.name});var b=nabu.page.providers("page-enumerate").filter(function(c){return c.name==a.field.enumerationProvider})[0];if(b&&b.labels)return b.labels}return null}},
methods:{enumerationFilter:function(a){var b=nabu.page.providers("page-enumerate").map(function(c){return c.name});a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));b.sort();return b}}});
Vue.component("page-form-input-enumeration-provider",{template:"\x3cdiv\x3e \x3cn-form-checkbox-list v-if\x3d'field.showCheckboxView' :items\x3d'enumerationFilter()' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\tv-bubble:input\t\t:formatter\x3d'enumerationFormatter'\t\t:label\x3d'label'\t\t:value\x3d'value'\t\tv-bubble:label\t\t:schema\x3d'schema'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:descriptionType\x3d'field.descriptionType'\t\t:descriptionIcon\x3d'field.descriptionIcon'\t\t:required\x3d'required'\t\t:extracter\x3d'enumerationExtracter'\t\t:disabled\x3d'disabled'/\x3e\t\x3cn-form-radio v-else-if\x3d'field.showRadioView' :items\x3d'enumerationFilter()' ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\tv-bubble:input\t\t:formatter\x3d'enumerationFormatter'\t\t:label\x3d'label'\t\t:name\x3d'name'\t\t:value\x3d'value'\t\tv-bubble:label\t\t:schema\x3d'schema'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:descriptionType\x3d'field.descriptionType'\t\t:descriptionIcon\x3d'field.descriptionIcon'\t\t:required\x3d'required'\t\t:extracter\x3d'enumerationExtracter'\t\t:disabled\x3d'disabled'/\x3e \x3cn-form-combo v-else ref\x3d'form' :filter\x3d'enumerationFilter' :formatter\x3d'enumerationFormatter' :extracter\x3d'enumerationExtracter'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t:required\x3d'required'\t\tv-bubble:label\t\tv-bubble:blur\t\tv-bubble:input\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:description\x3d'field.description'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:schema\x3d'schema'\t\t:allow-typing\x3d'!field.readOnly'\t\t:empty-value\x3d'field.emptyValue ? $services.page.translate($services.page.interpret(field.emptyValue)) : null'\t\t:calculating-value\x3d'field.calculatingValue ? $services.page.translate($services.page.interpret(field.calculatingValue)) : null'\t\t:reset-value\x3d'field.resetValue ? $services.page.translate($services.page.interpret(field.resetValue)) : null'\t\t:disabled\x3d'disabled'/\x3e\x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},name:{type:String,required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},required:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},data:function(){return{provider:null}},created:function(){this.provider=this.getProvider()},methods:{getChildComponents:function(){return[{title:"Form combo",
name:"form-component",component:"form-combo"}]},getProvider:function(){if(this.field.enumerationProvider){var a=this;return nabu.page.providers("page-enumerate").filter(function(b){return b.name==a.field.enumerationProvider})[0]}return null},enumerationFilter:function(a){var b=this.provider;if(b){b=b.enumerate();var c=this;a&&(b=b.filter(function(d){return 0<=c.enumerationFormatter(d).toLowerCase().indexOf(a.toLowerCase())}));return b}return[]},enumerationFormatter:function(a){var b=this.provider;
return a&&this.field.enumerationProviderLabel?a[this.field.enumerationProviderLabel]:a&&b&&b.label?a[b.label]:a},enumerationExtracter:function(a){var b=this.provider;return a&&this.field.enumerationProviderValue?a[this.field.enumerationProviderValue]:a&&b&&b.value?a[b.value]:a},validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-validate-custom-configure",{template:"\x3cdiv\x3e\x3ccustom-validator-edit :page\x3d'page' :cell\x3d'cellClone'/\x3e\x3cdiv\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},computed:{cellClone:function(){var a=nabu.utils.objects.clone(this.cell);a.state=this.field;return a}}});
Vue.component("page-form-input-validate-custom",{template:"\x3cdiv\x3e\x3ccustom-validator :cell\x3d'cellClone' :page\x3d'page' /\x3e\x3c/div\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},computed:{cellClone:function(){var a=nabu.utils.objects.clone(this.cell);a.state=this.field;return a}}});
Vue.component("page-form-input-text-configure",{template:"\x3cdiv\x3e\x3ch2 class\x3d'section-title'\x3eText field\x3c/h2\x3e\x3cdiv class\x3d'is-column is-spacing-medium'\x3e\x3cn-form-combo v-model\x3d'field.textType' label\x3d'Text Type' :items\x3d\"['text', 'area', 'range', 'number', 'color', 'email', 'tel', 'password', 'url', 'time', 'date', 'datetime-local', 'month', 'week']\"/\x3e\t\x3cn-form-switch v-model\x3d'field.trim' label\x3d'Trim value' /\x3e\t\x3cn-form-text v-model\x3d'field.regexLabel' label\x3d'Regex Label' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.regex' label\x3d'Regex' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.minLength' label\x3d'Min Length' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.maxLength' label\x3d'Max Length' :timeout\x3d'600'/\x3e\t\x3cn-form-switch v-model\x3d'field.showLength' label\x3d'Show Length' v-if\x3d'field.maxLength'/\x3e\t\x3cn-form-switch v-model\x3d'field.showCustomSpinner' label\x3d'Use custom spinners' v-if\x3d\"field.textType \x3d\x3d 'number'\"/\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.prefix' label\x3d'Prefix' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.prefixIcon' label\x3d'Prefix Icon' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffix' label\x3d'Suffix' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffixIcon' label\x3d'Suffix Icon' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.minimum' label\x3d'Minimum' v-if\x3d\"field.textType \x3d\x3d 'range' || field.textType \x3d\x3d 'number'\" :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.maximum' label\x3d'Maximum' v-if\x3d\"field.textType \x3d\x3d 'range' || field.textType \x3d\x3d 'number'\" :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.step' label\x3d'Step' v-if\x3d\"field.textType \x3d\x3d 'range' || field.textType \x3d\x3d 'number'\" :timeout\x3d'600'/\x3e\t\x3cn-form-ace v-model\x3d'field.formatter' label\x3d'Formatter' :timeout\x3d'600' after\x3d'You can format the value that exists in the page for display (and edit) purposes for the user'/\x3e\t\x3cn-form-ace v-model\x3d'field.parser' label\x3d'Parser' :timeout\x3d'600' after\x3d'You can parse the user-inputted value into something else to be stored in the page'/\x3e\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' :to\x3d'[\"validator\"]'/\x3e\x3c/div\x3e\x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.textType||Vue.set(this.field,"textType",null);this.field.bindings||Vue.set(this.field,"bindings",{})},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}}});
Vue.component("page-form-input-text",{template:"\x3cn-form-text :type\x3d'textType' ref\x3d'form'\t\t:trim\x3d'field.trim'\t\t:class\x3d\"{'has-suffix-icon': !!field.suffixIcon, 'has-suffix': !!field.suffix }\"\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'$services.page.interpret($services.page.translate(placeholder), $self)'\t\t:max-length\x3d'field.maxLength ? field.maxLength : null'\t\t:min-length\x3d'field.minLength ? field.minLength : null'\t\t:schema\x3d'schema'\t\t:pattern-comment\x3d'field.regexLabel ? $services.page.translate(field.regexLabel) : null'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:pattern\x3d'field.regex'\t\tv-bubble:blur\t\t:required\x3d'required'\t\t:validator\x3d'getValidator()'\t\t:info\x3d'field.info ? $services.page.interpret($services.page.translate(field.info), $self) : null'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:prefix\x3d'field.prefix ? $services.page.translate(field.prefix) : field.prefix'\t\t:suffix\x3d'field.suffix ? $services.page.translate(field.suffix) : field.suffix'\t\t:prefix-icon\x3d'field.prefixIcon'\t\t:suffix-icon\x3d'field.suffixIcon'\t\t:minimum\x3d'field.minimum ? parseFloat($services.page.interpret(field.minimum, $self)) : null'\t\t:maximum\x3d'field.maximum ? parseFloat($services.page.interpret(field.maximum, $self)) : null'\t\t:step\x3d'field.step ? parseFloat($services.page.interpret(field.step, $self)) : null'\t\t:name\x3d'field.name'\t\t:timeout\x3d'timeout'\t\tv-show\x3d'!hidden'\t\t:show-custom-spinner\x3d'field.showCustomSpinner'\t\t:formatter\x3d'getFormatter()'\t\t:parser\x3d'getParser()'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},codes:{required:!1},hidden:{type:Boolean,required:!1,default:!1}},computed:{allCodes:function(){var a=[];this.field.codes&&nabu.utils.arrays.merge(a,this.field.codes);this.codes&&
nabu.utils.arrays.merge(a,this.codes);var b={},c=this;a.forEach(function(d){b[d.code]=c.$services.page.translate(d.title)});return b},textType:function(){return this.field.textType?this.field.textType:"text"}},methods:{getFormatter:function(){if(!this.field.formatter)return null;var a=this;return function(b){return a.$services.page.eval(a.field.formatter,b,a)}},getParser:function(){if(!this.field.parser)return null;var a=this;return function(b){return a.$services.page.eval(a.field.parser,b,a)}},validate:function(a){return this.$refs.form.validate(a)},
getValidator:function(){if(this.field.bindings&&this.field.bindings.validator){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.validator,this)}}}});
Vue.component("page-form-input-hidden",{template:"\x3cpage-form-input-text :cell\x3d'cell' :page\x3d'page' :field\x3d'field' :value\x3d'value' :label\x3d'label' :timeout\x3d'timeout' :disabled\x3d'disabled' :schema\x3d'schema' :read-only\x3d'readOnly' :placeholder\x3d'placeholder' :codes\x3d'codes' :hidden\x3d'true'/\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,
required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},codes:{required:!1}}});
Vue.component("page-form-input-ace-configure",{template:"\x3cn-form-section\x3e\x3cn-form-combo v-model\x3d'field.textType' label\x3d'Text Type' :items\x3d\"['text', 'area', 'range', 'number', 'color', 'email', 'password']\"/\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.prefix' label\x3d'Prefix' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.prefixIcon' label\x3d'Prefix Icon' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffix' label\x3d'Suffix' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffixIcon' label\x3d'Suffix Icon' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.mode' label\x3d'Mode' :timeout\x3d'600'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.textType||Vue.set(this.field,"textType",null);this.field.bindings||Vue.set(this.field,"bindings",{})},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}}});
Vue.component("page-form-input-ace",{template:"\x3cn-form-ace :mode\x3d'field.mode' ref\x3d'form'\t\t:class\x3d\"{'has-suffix-icon': !!field.suffixIcon, 'has-suffix': !!field.suffix }\"\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'$services.page.interpret($services.page.translate(placeholder), $self)'\t\t:schema\x3d'schema'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\tv-bubble:blur\t\t:required\x3d'required'\t\t:info\x3d'field.info ? $services.page.interpret($services.page.translate(field.info), $self) : null'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:prefix\x3d'field.prefix ? $services.page.translate(field.prefix) : field.prefix'\t\t:suffix\x3d'field.suffix ? $services.page.translate(field.suffix) : field.suffix'\t\t:prefix-icon\x3d'field.prefixIcon'\t\t:suffix-icon\x3d'field.suffixIcon'\t\t:name\x3d'field.name'\t\t:timeout\x3d'timeout'\t\tv-show\x3d'!hidden'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1},required:{type:Boolean,required:!1},codes:{required:!1},hidden:{type:Boolean,required:!1,default:!1}},computed:{allCodes:function(){var a=[];this.field.codes&&nabu.utils.arrays.merge(a,this.field.codes);this.codes&&
nabu.utils.arrays.merge(a,this.codes);var b={},c=this;a.forEach(function(d){b[d.code]=c.$services.page.translate(d.title)});return b},textType:function(){return this.field.textType?this.field.textType:"text"}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-password-configure",{template:"\x3cn-form-section\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content'/\x3e\t\x3cn-form-text v-model\x3d'field.repeatLabel' label\x3d'Label for password repeat'/\x3e\t\x3cn-form-text v-model\x3d'field.repeatPlaceholder' label\x3d'Placeholder for password repeat'/\x3e\t\x3cn-form-text v-model\x3d'field.regex' label\x3d'Security Regex'/\x3e\t\x3cn-form-text v-model\x3d'field.regexLabel' label\x3d'Regex Label' placholder\x3d'%{validation::The password should be at least 8 characters long and contain one capital, one lowercase letter and a number}'/\x3e\t\x3cn-form-text v-model\x3d'field.forgotLabel' label\x3d'Forgot Password Label'/\x3e\t\x3cn-form-combo v-model\x3d'field.forgotRoute' :filter\x3d'$services.page.filterRoutes' label\x3d'Forgot Password Route'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-input-password",{template:"\x3cn-form-section ref\x3d'form'\x3e\x3cn-form-text type\x3d'password'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t:schema\x3d'schema'\t\t:pattern-comment\x3d'$services.page.translate(regexLabel)'\t\t:pattern\x3d'field.regex'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:info\x3d'field.info ? $services.page.translate(field.info) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:timeout\x3d'timeout'\t\tname\x3d'new-password'\t\tautocomplete\x3d'new-password'\t\t:disabled\x3d'disabled'/\x3e\t\x3cn-form-text type\x3d'password' v-if\x3d'field.repeatLabel \x26\x26 !readOnly'\t\t:placeholder\x3d'field.repeatPlaceholder ? $services.page.translate(field.repeatPlaceholder) : placeholder'\t\t:required\x3d'true'\t\t:label\x3d'$services.page.translate(field.repeatLabel)'\t\tv-model\x3d'repeat'\t\t:info\x3d'field.info ? $services.page.translate(field.info) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:timeout\x3d'timeout'\t\t:validator\x3d'validatePassword'\t\tname\x3d'confirm-password'\t\tautocomplete\x3d'new-password'\t\t:disabled\x3d'disabled'/\x3e\t\x3ca class\x3d'forgot-password-link' v-route\x3d'{alias:field.forgotRoute}' v-if\x3d'field.forgotRoute \x26\x26 !readOnly'\x3e{{ field.forgotLabel ? $services.page.translate(field.forgotLabel) : '%{default::Forgot your password?}' }}\x3c/a\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},computed:{regexLabel:function(){return null!=this.field.regexLabel&&""!=this.field.regexLabel?this.$services.page.interpret(this.field.regexLabel,this):null}},created:function(){console.log("regex is",this.field.regex)},
data:function(){return{repeat:null}},methods:{validate:function(a){return this.$refs.form.validate(a)},validatePassword:function(a){var b=[];this.value!=a&&b.push({soft:!0,code:"same",severity:"error",title:"%{validation::The two passwords don't match}"});return b}}});
Vue.component("page-form-input-file-configure",{template:"\x3cdiv class\x3d'input-file-configure'\x3e\t\t\x3ch2 class\x3d'section-title'\x3eFile upload\x3c/h2\x3e\t\t\x3cdiv class\x3d'is-column is-spacing-medium'\x3e\x3cn-form-text label\x3d'Label drop' v-model\x3d'field.dropLabel' :timeout\x3d'600'/\x3e\x3cn-form-text label\x3d'Label browse' v-model\x3d'field.browseLabel' :timeout\x3d'600'/\x3e\x3cn-form-text label\x3d'Icon browse' v-model\x3d'field.browseIcon' :timeout\x3d'600'/\x3e\x3cn-form-text label\x3d'Max file size (bytes)' v-model\x3d'field.maxFileSize' :timeout\x3d'600'/\x3e\x3cn-form-switch label\x3d'Show selected files' v-model\x3d'field.visualizeFileNames'/\x3e\x3cn-form-text v-if\x3d'field.visualizeFileNames' label\x3d'Delete icon' v-model\x3d'field.deleteIcon' :timeout\x3d'600'/\x3e\t\x3cn-form-section v-for\x3d'i in Object.keys(field.fileTypes)' class\x3d'list-row'\x3e\t\t\x3cn-form-text v-model\x3d'field.fileTypes[i]' label\x3d'File Type' placeholder\x3d'image/*' :timeout\x3d'600'/\x3e\t\t\x3cspan @click\x3d'field.fileTypes.splice(i)' class\x3d'fa fa-times'\x3e\x3c/span\x3e\x3c/n-form-section\x3e\t\t\x3cdiv class\x3d'is-row is-align-end'\x3e\t\t\t\x3cbutton class\x3d'is-button is-variant-primary-outline is-size-xsmall' @click\x3d\"field.fileTypes ? field.fileTypes.push(null) : $window.Vue.set(field, 'fileTypes', [null])\"\x3e\x3cspan class\x3d'fa fa-plus'\x3e\x3c/span\x3eFiletype\x3c/button\x3e\t\t\x3c/div\x3e\x3cn-form-combo v-if\x3d\"field.name \x26\x26 field.name !\x3d 'body'\" v-model\x3d'field.contentType' label\x3d'Field to store content type' :items\x3d'possibleFields'/\x3e\x3cn-form-combo v-if\x3d\"field.name \x26\x26 field.name !\x3d 'body'\" v-model\x3d'field.fileName' label\x3d'Field to store file name' :items\x3d'possibleFields'/\x3e\x3c/div\x3e\x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},possibleFields:{type:Array,required:!1,default:function(){return[]}}},created:function(){this.field.fileTypes||Vue.set(this.field,"fileTypes",[])}});
Vue.component("page-form-input-file",{template:"\x3cn-form-file :types\x3d'field.fileTypes' ref\x3d'form' :amount\x3d'1'\t\t:edit\x3d'!readOnly'\t\t:schema\x3d'schema'\t\t@change\x3d'changed'\t\t:label\x3d'label'\t\t:value\x3d'files'\t\t:name\x3d'field.name' \t:drop-label\x3d'field.dropLabel ? $services.page.translate(field.dropLabel) : null' \t:browse-label\x3d'field.browseLabel ? $services.page.translate(field.browseLabel) : null' \t:browse-icon\x3d'field.browseIcon' \t:visualize-file-names\x3d'field.visualizeFileNames' \t:delete-icon\x3d'field.deleteIcon'\t\t:button-class\x3d\"getChildComponentClasses('file-upload-button')\"\t\t:info\x3d'field.info ? $services.page.interpret($services.page.translate(field.info), $self) : null'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:prefix\x3d'field.prefix ? $services.page.translate(field.prefix) : field.prefix'\t\t:file-name-class\x3d\"getChildComponentClasses('file-upload-name')\"\t\t:file-name-container-class\x3d\"getChildComponentClasses('file-upload-name-container')\"\t\t:file-name-row-class\x3d\"getChildComponentClasses('file-upload-name-row')\"\t\t:file-name-delete-class\x3d\"getChildComponentClasses('file-upload-name-delete')\"\t\t:timeout\x3d'timeout'\t\t:max-file-size\x3d'field.maxFileSize ? parseInt(field.maxFileSize) : null'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},childComponents:{required:!1}},data:function(){return{files:[]}},created:function(){this.value instanceof File&&this.files.push(this.value);console.log("child components",this.childComponents)},computed:{textType:function(){return this.field.textType?
this.field.textType:"text"}},methods:{getChildComponents:function(){return[{title:"Upload button",name:"file-upload-button",component:"button"},{title:"File Name List",name:"file-upload-name-container",component:"column"},{title:"File Name Container",name:"file-upload-name-row",component:"row"},{title:"File Name",name:"file-upload-name",component:"content"},{title:"File Name Delete Button",name:"file-upload-delete-button",component:"button"}]},changed:function(a){a=a&&a.length?a[0]:null;if(this.field.contentType){var b=
this.$services.page.getPageInstance(this.page,this);b.set(this.field.contentType,a?a.type:null)}this.field.fileName&&(b=this.$services.page.getPageInstance(this.page,this),b.set(this.field.fileName,a?a.name:null));this.$emit("input",a)},validate:function(a){a=[];nabu.utils.vue.form.mandatory(this)&&1>files.length&&a.push({soft:!0,severity:"error",code:"required",title:"%{validation:The value is required}",priority:0,values:{actual:!1,expected:!0},context:[]});return a}}});
Vue.component("page-form-input-static-image-configure",{template:"\x3cn-form-section\x3e\x3cn-form-text v-model\x3d'field.imagePath' label\x3d'Image Path'/\x3e\x3cn-form-text v-model\x3d'field.webApplicationId' label\x3d'Web Application Id'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.imagePath||Vue.set(this.field,"imagePath","images")}});
Vue.component("page-form-input-static-image",{template:"\x3cdiv class\x3d'page-form-input-static-image n-form-component'\x3e\x3clabel class\x3d'n-form-label' v-if\x3d'label'\x3e{{label}}\x3c/label\x3e\x3cdiv class\x3d'image-content'\x3e\x3cimg v-if\x3d'value' :src\x3d\"(field.webApplicationId ? '' : '/') + value\"/\x3e\x3cn-input-file v-if\x3d'!readOnly' v-model\x3d'files' @change\x3d'upload' :types\x3d\"['image']\"/\x3e\x3c/div\x3e\x3c/div\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,
required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1}},data:function(){return{files:[]}},methods:{upload:function(){var a=this;this.$services.swagger.execute("nabu.web.page.core.rest.resource.create",{webApplicationId:this.$services.page.interpret(this.field.webApplicationId,this),path:this.$services.page.interpret(this.field.imagePath,
this),body:this.files[0]}).then(function(b){a.files.splice(0,a.files.length);a.$emit("input",this.field.webApplicationId?b.path:b.relativePath)})}}});
Vue.component("page-form-input-richtext-configure",{template:"\x3cn-form-section\x3e\x3cn-form-switch v-model\x3d'field.cleanStyle' label\x3d'Clean style on paste'/\x3e\x3cn-form-switch v-model\x3d'field.supportLinkType' label\x3d'Support Link Types'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-input-richtext",{template:"\x3cn-form-richtext :disabled\x3d'disabled' :support-link-type\x3d'field.supportLinkType' :label\x3d'label' :timeout\x3d'timeout' :edit\x3d'!readOnly' ref\x3d'form' :value\x3d'value' @input\x3d\"function(value) { $emit('input', value) }\" :schema\x3d'schema' :clean-style\x3d'field.cleanStyle' :placeholder\x3d'cell.state.placeholder'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:translator\x3d'$services.page.translate'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-switch-configure",{template:"\x3cdiv\x3e\t\x3cn-form-switch v-model\x3d'field.invert' label\x3d'Invert Boolean'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.beforeIcon' label\x3d'Before Icon' v-if\x3d'field.before \x26\x26 false' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.afterIcon' label\x3d'After Icon' v-if\x3d'field.after \x26\x26 false' :timeout\x3d'600'/\x3e\x3c/div\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}}});
Vue.component("page-form-input-switch",{template:"\x3cn-form-switch ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:required\x3d'required'\t\t:schema\x3d'schema'\t\t:class\x3d\"getChildComponentClasses('page-form-switch')\"\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:before\x3d'field.before ? $services.page.interpret($services.page.translate(field.before), $self) : null'\t\t:after\x3d'field.after ? $services.page.interpret($services.page.translate(field.after), $self) : null'\t\t:timeout\x3d'timeout'\t\t:invert\x3d'!!field.invert'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},required:{type:Boolean,required:!1},readOnly:{type:Boolean,required:!1},childComponents:{required:!1}},methods:{getChildComponents:function(){return{title:"Form Switch",name:"page-form-switch",component:"form-switch"}},validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-date-configure",{template:"\x3cdiv\x3e\x3ch2 class\x3d'section-title'\x3eDate field\x3c/h2\x3e\x3cdiv class\x3d'is-column is-spacing-medium'\x3e\t\x3cn-form-switch v-model\x3d'field.yearsDropdown' label\x3d'Show years in dropdown'/\x3e\t\x3cn-form-switch v-model\x3d'field.includeHours' label\x3d'Include hours?'/\x3e\t\x3cn-form-switch v-model\x3d'field.includeMinutes' label\x3d'Include minutes?' v-if\x3d'field.includeHours'/\x3e\t\x3cn-form-switch v-model\x3d'field.includeSeconds' label\x3d'Include seconds?' v-if\x3d'field.includeHours \x26\x26 field.includeMinutes'/\x3e\t\x3cn-form-switch v-model\x3d'field.localTime' label\x3d'Use local time' v-if\x3d'field.includeHours'/\x3e\t\x3cn-form-switch v-model\x3d'field.isTimestamp' label\x3d'Is a timestamp in milliseconds?' v-if\x3d'!field.isSecondsTimestamp'/\x3e\t\x3cn-form-switch v-model\x3d'field.isSecondsTimestamp' label\x3d'Is a timestamp in seconds?' v-if\x3d'!field.isTimestamp'/\x3e\t\x3cn-form-text v-model\x3d'field.regexLabel' label\x3d'Regex label'/\x3e\t\x3cn-form-text v-model\x3d'field.dateFormat' label\x3d'Date Format'/\x3e\t\x3cn-form-text v-model\x3d'field.info' label\x3d'Info Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.before' label\x3d'Before Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.after' label\x3d'After Content' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffix' label\x3d'Suffix' v-if\x3d'!field.suffixIcon' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.suffixIcon' label\x3d'Suffix Icon' v-if\x3d'!field.suffix' :timeout\x3d'600'/\x3e\t\x3cn-form-ace v-model\x3d'field.allowFunction' label\x3d'Allow function' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.yearsFrom' label\x3d'List years from (e.g. -18)' :timeout\x3d'600'/\x3e\t\x3cn-form-text v-model\x3d'field.yearsTo' label\x3d'List years until (e.g. 18)' :timeout\x3d'600'/\x3e\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' :to\x3d'field.dateFormat ? [\"allow\", \"default\"] : [\"allow\", \"default\",\"formatter\",\"parser\"]'/\x3e\x3c/div\x3e\x3c/div\x3e",
props:{cell:{type:Object,required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.bindings||Vue.set(this.field,"bindings",{})},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}}});
Vue.component("page-form-input-date",{template:"\x3cn-form-date ref\x3d'form'\t\t:placeholder\x3d'placeholder'\t\t:edit\x3d'!readOnly'\t\t:schema\x3d'schema'\t\tv-bubble:label\t\tv-bubble:input\t\t:local-time\x3d'field.localTime'\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:default\x3d'getDefault()'\t\t:timeout\x3d'timeout'\t\tv-bubble:blur\t\t:allow\x3d'getAllow()'\t\t:info\x3d'field.info ? $services.page.interpret($services.page.translate(field.info), $self) : null'\t\t:before\x3d'field.before ? $services.page.translate(field.before) : null'\t\t:after\x3d'field.after ? $services.page.translate(field.after) : null'\t\t:suffix\x3d'field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'\t\t:years-dropdown\x3d'field.yearsDropdown'\t\t:include-hours\x3d'field.includeHours'\t\t:pattern-comment\x3d'$services.page.translate(field.regexLabel)'\t\t:include-minutes\x3d'field.includeHours \x26\x26 field.includeMinutes'\t\t:include-seconds\x3d'field.includeHours \x26\x26 field.includeMinutes \x26\x26 field.includeSeconds'\t\t:years-from\x3d'parseInteger(field.yearsFrom)'\t\t:years-to\x3d'parseInteger(field.yearsTo)'\t\t:timestamp\x3d'field.isTimestamp'\t\t:seconds-timestamp\x3d'field.isSecondsTimestamp'\t\t:required\x3d'required'\t\t:formatter\x3d'getFormatter()'\t\t:parser\x3d'getParser()'\t\t:translator\x3d'$services.page.translate'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},required:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},methods:{parseInteger:function(a){var b=null;null!=a&&(b=this.$services.page.interpret(a));if(null!=b)return parseInt(b)},getDefault:function(){if(this.field.bindings&&this.field.bindings.default){var a=
this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.default,this)}},getAllow:function(){if(this.field.allowFunction)return this.$services.page.eval(this.field.allowFunction,{},this,null,!0);if(this.field.bindings&&this.field.bindings.allow){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.allow,this)}},getParser:function(){if(this.field.dateFormat){var a=this;
return function(c){if(c instanceof Date)return c;if(c){var d=a.field.dateFormat.split(/\b/g);c=c.split(/\b/g);if(d.length!=c.length)return null;for(var e=1,g=0,k=(new Date).getFullYear(),m=0,p=0,q=0,t=0,u=0;u<c.length;u++)d[u].match(/^[d]+$/)?e=parseInt(c[u]):d[u].match(/^[M]+$/)?g=parseInt(c[u])-1:d[u].match(/^[y]+$/)?(k=parseInt(c[u]),2==d[u].length&&(k+=(new Date).getFullYear()-(new Date).getFullYear()%100)):d[u].match(/^[H]+$/)?m=parseInt(c[u]):d[u].match(/^[m]+$/)?p=parseInt(c[u]):d[u].match(/^[s]+$/)?
q=parseInt(c[u]):d[u].match(/^[S]+$/)&&(t=parseInt(c[u]));return new Date(k,g,e,m,p,q,t)}return null}}if(this.field.bindings&&this.field.bindings.parser){var b=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(b,this.field.bindings.parser,this)}},getFormatter:function(){if(this.field.dateFormat){var a=this;return function(c){return c?a.$services.formatter.date(c,a.field.dateFormat):null}}if(this.field.bindings&&this.field.bindings.formatter){var b=this.$services.page.getPageInstance(this.page,
this);return this.$services.page.getBindingValue(b,this.field.bindings.formatter,this)}},validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-date-picker-configure",{template:"\x3cn-form-section\x3e\t\x3cn-form-text v-model\x3d'field.minimumOffset' label\x3d'Minimum Offset' info\x3d'In days, the closest point in time that should be supported (can be negative)'/\x3e\t\x3cn-form-text v-model\x3d'field.maximumOffset' label\x3d'Maximum Offset' info\x3d'In days, the furthest point in time that should be supported (can be negative)'/\x3e\t\x3cn-form-text v-model\x3d'field.description' label\x3d'Description'/\x3e\t\x3cn-form-switch v-model\x3d'field.allowPartial' label\x3d'Allow partial values' info\x3d'Allow partial values to be set (e.g. only year). If enabled, auto format is enabled as well.'/\x3e\t\x3cn-form-switch v-model\x3d'field.autoFormat' v-if\x3d'!field.allowPartial' label\x3d'Auto format' info\x3d'The format is deduced from the requested fields, being gYear, gYearMonth or date'/\x3e\t\x3cn-form-switch v-model\x3d'field.hideMonth' label\x3d'Show month' :invert\x3d'true' info\x3d'Show the month'/\x3e\t\x3cn-form-switch v-model\x3d'field.hideDay' label\x3d'Show day' v-if\x3d'!field.hideMonth' :invert\x3d'true' info\x3d'Show the day'/\x3e\t\x3cn-form-text v-model\x3d'field.placeholderYear' label\x3d'Place holder year'/\x3e\t\x3cn-form-text v-model\x3d'field.placeholderMonth' v-if\x3d'!field.hideMonth' label\x3d'Place holder month'/\x3e\t\x3cn-form-text v-model\x3d'field.placeholderDay' v-if\x3d'!field.hideDay \x26\x26 !field.hideMonth' label\x3d'Place holder day'/\x3e\t\x3cn-page-mapper v-model\x3d'field.bindings' :from\x3d'availableParameters' :to\x3d'[\"allow\", \"default\", \"notBefore\", \"notAfter\"]'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0}},created:function(){this.field.bindings||Vue.set(this.field,"bindings",{})},computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell,!0)}}});
Vue.component("page-form-input-date-picker",{template:"\x3cn-form-date-picker ref\x3d'form'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:placeholder\x3d'placeholder'\t\t:edit\x3d'!readOnly'\t\t:schema\x3d'schema'\t\t:fields\x3d'fields'\t\t:allow-partial\x3d'field.allowPartial'\t\t:auto-format\x3d'field.autoFormat || field.allowPartial'\t\t:placeholder-year\x3d'field.placeholderYear ? $services.page.translate(field.placeholderYear) : null'\t\t:placeholder-month\x3d'field.placeholderMonth ? $services.page.translate(field.placeholderMonth) : null'\t\t:placeholder-day\x3d'field.placeholderDay ? $services.page.translate(field.placeholderDay) : null'\t\t:not-before\x3d'getNotBefore()'\t\t:not-after\x3d'getNotAfter()'\t\tv-bubble:label\t\t:minimum-offset\x3d'field.minimumOffset'\t\t:maximum-offset\x3d'field.maximumOffset'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'field.label ? $services.page.translate(field.label) : null'\t\t:value\x3d'value'\t\t:default\x3d'getDefault()'\t\t:required\x3d'required'\t\t:timeout\x3d'timeout'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:allow\x3d'getAllow()'\t\tv-bubble:blur\t\t:include-hours\x3d'field.includeHours'\t\t:pattern-comment\x3d'$services.page.translate(field.regexLabel)'\t\t:include-minutes\x3d'field.includeHours \x26\x26 field.includeMinutes'\t\t:include-seconds\x3d'field.includeHours \x26\x26 field.includeMinutes \x26\x26 field.includeSeconds'\t\t:timestamp\x3d'field.isTimestamp'\t\t:seconds-timestamp\x3d'field.isSecondsTimestamp'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},required:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},computed:{fields:function(){var a=["year"];this.field.hideMonth||a.push("month");this.field.hideDay||a.push("day");return a}},methods:{getDefault:function(){if(this.field.bindings&&
this.field.bindings.default){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.default,this)}},getAllow:function(){if(this.field.bindings&&this.field.bindings.allow){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.allow,this)}},getNotBefore:function(){if(this.field.bindings&&this.field.bindings.notBefore){var a=this.$services.page.getPageInstance(this.page,
this);return this.$services.page.getBindingValue(a,this.field.bindings.notBefore,this)}},getNotAfter:function(){if(this.field.bindings&&this.field.bindings.getNotAfter){var a=this.$services.page.getPageInstance(this.page,this);return this.$services.page.getBindingValue(a,this.field.bindings.getNotAfter,this)}},validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-location-configure",{template:"\x3cn-form-section\x3e\t\x3cn-form-text v-model\x3d'field.countryRestriction' label\x3d'Country limitation (two letter code, comma separated)'/\x3e\t\x3cn-form-combo v-model\x3d'field.latitude' label\x3d'Latitude Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.longitude' label\x3d'Longitude Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.country' label\x3d'Country Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.countryCode' label\x3d'Country Code Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.region' label\x3d'Region Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.province' label\x3d'Province Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.city' label\x3d'City Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.postCode' label\x3d'Post Code Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.street' label\x3d'Street Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-switch v-model\x3d'field.streetIncludeNumber' label\x3d'Include Street Number' v-if\x3d'field.street \x26\x26 !field.streetNumber'/\x3e\t\x3cn-form-combo v-model\x3d'field.streetNumber' label\x3d'Street Number Field' :filter\x3d'getKeys' v-if\x3d'!field.streetIncludeNumber'/\x3e\t\x3cn-form-combo v-model\x3d'field.formatted' label\x3d'Fully Formatted Address Field' :filter\x3d'getKeys'/\x3e \x3cn-form-switch v-model\x3d'field.allowVague' label\x3d'Allow Vague Addresses'/\x3e \x3cn-form-switch v-model\x3d'field.required' label\x3d'Required'/\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},possibleFields:{type:Array,required:!1,default:function(){return[]}}},created:function(){this.field.textType||Vue.set(this.field,"textType",null)},methods:{getKeys:function(a){return this.possibleFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})}}});
Vue.component("page-form-input-location",{template:"\x3cn-form-location ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t:schema\x3d'schema'\t\tv-bubble:label\t\t:required\x3d'field.required'\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:name\x3d'field.name'\t\t:timeout\x3d'timeout'     :latitude\x3d'field.latitude'     :longitude\x3d'field.longitude'     :country\x3d'field.country'     :country-code\x3d'field.countryCode'     :province\x3d'field.province'     :region\x3d'field.region'     :city\x3d'field.city'     :post-code\x3d'field.postCode'     :street\x3d'field.street'     :street-include-number\x3d'field.streetIncludeNumber'     :street-number\x3d'field.streetNumber'     :formatted\x3d'field.formatted'\t\t:country-restriction\x3d'field.countryRestriction'     :allow-vague\x3d'field.allowVague'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schema:{type:Object,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-form-input-address-configure",{template:"\x3cn-form-section\x3e\t\x3cn-form-text v-model\x3d'field.countryRestriction' label\x3d'Country limitation (two letter code, comma separated)'/\x3e\t\x3cn-form-combo v-model\x3d'field.latitude' label\x3d'Latitude Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.longitude' label\x3d'Longitude Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.country' label\x3d'Country Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.countryCode' label\x3d'Country Code Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.city' label\x3d'City Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.postCode' label\x3d'Post Code Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.street' label\x3d'Street Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.additional' label\x3d'Additional Field' :filter\x3d'getKeys'/\x3e\t\x3cn-form-combo v-model\x3d'field.streetNumber' label\x3d'Street Number Field' :filter\x3d'getKeys' v-if\x3d'!field.streetIncludeNumber'/\x3e\t\x3cn-form-text v-model\x3d'field.countryLabel' label\x3d'Country Label' /\x3e\t\x3cn-form-text v-model\x3d'field.cityLabel' label\x3d'City Label' /\x3e\t\x3cn-form-text v-model\x3d'field.postCodeLabel' label\x3d'Postcode Label' /\x3e\t\x3cn-form-text v-model\x3d'field.streetLabel' label\x3d'Street Label' /\x3e\t\x3cn-form-text v-model\x3d'field.streetNumberLabel' label\x3d'Street Number Label' /\x3e\t\x3cn-form-text v-model\x3d'field.additionalLabel' label\x3d'Additional Label' /\x3e\x3c/n-form-section\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},possibleFields:{type:Array,required:!1,default:function(){return[]}}},created:function(){this.field.textType||Vue.set(this.field,"textType",null)},methods:{getKeys:function(a){return this.possibleFields.filter(function(b){return!a||0<=b.toLowerCase().indexOf(a.toLowerCase())})}}});
Vue.component("page-form-input-address",{template:"\x3cn-form-address ref\x3d'form'\t\t:edit\x3d'!readOnly'\t\t:placeholder\x3d'placeholder'\t\t:schema-resolver\x3d'schemaResolver'\t\tv-bubble:label\t\tv-bubble:changed\t\t@input\x3d\"function(newValue) { $emit('input', newValue) }\"\t\t:label\x3d'label'\t\t:value\x3d'value'\t\t:description\x3d'field.description ? $services.page.translate(field.description) : null'\t\t:description-type\x3d'field.descriptionType'\t\t:description-icon\x3d'field.descriptionIcon'\t\t:name\x3d'field.name'\t\t:timeout\x3d'timeout ? timeout : 400'     :latitude\x3d'field.latitude'     :longitude\x3d'field.longitude'     :country\x3d'field.country'     :country-code\x3d'field.countryCode'     :city\x3d'field.city'     :post-code\x3d'field.postCode'     :street\x3d'field.street'     :street-number\x3d'field.streetNumber'     :additional\x3d'field.additional'     :country-label\x3d'$services.page.translate(field.countryLabel)'     :city-label\x3d'$services.page.translate(field.cityLabel)'     :post-code-label\x3d'$services.page.translate(field.postCodeLabel)'     :street-label\x3d'$services.page.translate(field.streetLabel)'     :street-number-label\x3d'$services.page.translate(field.streetNumberLabel)'     :additional-label\x3d'$services.page.translate(field.additionalLabel)'\t\t:country-restriction\x3d'field.countryRestriction'\t\t:disabled\x3d'disabled'/\x3e",props:{cell:{type:Object,
required:!0},page:{type:Object,required:!0},field:{type:Object,required:!0},value:{required:!0},label:{type:String,required:!1},timeout:{required:!1},disabled:{type:Boolean,required:!1},schemaResolver:{type:Function,required:!1},readOnly:{type:Boolean,required:!1},placeholder:{type:String,required:!1}},methods:{validate:function(a){return this.$refs.form.validate(a)}}});
Vue.component("page-format-resolver",{props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},fragment:{type:Object,required:!0},keys:{type:Array,required:!1}},created:function(){this.fragment.resolveOperationBinding||Vue.set(this.fragment,"resolveOperationBinding",{})},template:"\x3cn-form-section class\x3d'enumeration'\x3e\t\t\x3cn-form-combo v-model\x3d'fragment.resolveOperation'\t\t\tlabel\x3d'Resolve Operation'\t\t\t:filter\x3d'getEnumerationServices'/\x3e\t\t\x3cn-form-switch v-model\x3d'fragment.resolveOperationLabelComplex' label\x3d'Complex Enumeration Label'/\x3e\t\t\x3cn-form-combo v-if\x3d'fragment.resolveOperation \x26\x26 !fragment.resolveOperationLabelComplex' v-model\x3d'fragment.resolveOperationLabel' label\x3d'Result Label Field'\t\t\t:filter\x3d'function() { return getEnumerationFields(fragment.resolveOperation) }'/\x3e\t\t\x3cn-form-combo v-if\x3d'fragment.resolveOperation' v-model\x3d'fragment.resolveOperationId' label\x3d'Result Id Field'\t\t\t:filter\x3d'function() { return getEnumerationFields(fragment.resolveOperation) }'/\x3e\t\t\x3cn-form-combo v-if\x3d'fragment.resolveOperation' v-model\x3d'fragment.resolveOperationIds' label\x3d'Input Ids Field'\t\t\t:filter\x3d'function() { return getEnumerationParameters(fragment.resolveOperation) }'/\x3e\t\t\x3cn-form-text v-model\x3d'fragment.complexLabel' label\x3d'The complex text label' v-if\x3d'fragment.resolveOperation \x26\x26 fragment.resolveOperationLabelComplex'/\x3e\t\t\x3ctypography-variable-replacer v-if\x3d'fragment.resolveOperation \x26\x26 fragment.resolveOperationLabelComplex \x26\x26 fragment.complexLabel' :content\x3d'fragment.complexLabel' :page\x3d'page' :container\x3d'fragment' :keys\x3d'getEnumerationFields(fragment.resolveOperation)' /\x3e\t\t\x3cn-page-mapper v-if\x3d'fragment.resolveOperation \x26\x26 hasMappableEnumerationParameters(fragment)'\t\t\tv-model\x3d'fragment.resolveOperationBinding'\t\t\t:from\x3d'availableParameters'\t\t\t:to\x3d'getMappableEnumerationParameters(fragment)'/\x3e\x3c/n-form-section\x3e",
computed:{availableParameters:function(){return this.$services.page.getAvailableParameters(this.page,this.cell)}},methods:{getEnumerationServices:function(a){var b=this;return this.$services.page.getOperations(function(c){var d="get"==c.method.toLowerCase()&&(!a||0<=c.id.toLowerCase().indexOf(a.toLowerCase()))&&c.responses["200"];if(d&&(c=c.responses["200"]?c.responses["200"].schema:null)){var e=b.$services.swagger.definition(c.$ref);d=!1;e.properties&&Object.keys(e.properties).map(function(g){"array"==
e.properties[g].type&&(d=!0)})}return d}).map(function(c){return c.id})},getEnumerationFields:function(a){var b=[];if(this.$services.swagger.operations[a]){var c=this.$services.swagger.resolve(this.$services.swagger.operations[a].responses["200"]);Object.keys(c.schema.properties).map(function(d){"array"==c.schema.properties[d].type&&nabu.utils.arrays.merge(b,Object.keys(c.schema.properties[d].items.properties))})}return b},getEnumerationParameters:function(a){return(a=this.$services.swagger.operations[a].parameters)?
a.map(function(b){return b.name}):[]},getMappableEnumerationParameters:function(a){var b={properties:{}};Object.keys(this.$services.page.getInputBindings(this.$services.swagger.operations[a.resolveOperation])).map(function(c){c!=a.resolveOperationIds&&(b.properties[c]={type:"string"})});return b},hasMappableEnumerationParameters:function(a){return 0<Object.keys(this.getMappableEnumerationParameters(a).properties).length}}});
Vue.view("default-login",{priority:-50,alias:"login",url:"/login",props:{route:{type:String,required:!1,default:"home"},url:{type:String,required:!1}},data:function(){return{username:null,password:null,remember:!0,working:!1,valid:!1,messages:[]}},methods:{login:function(){if(this.validate(!0)){this.messages.splice(0,this.messages.length);this.working=!0;var a=this;return this.$services.user.login(this.username,this.password,this.remember).then(function(b){b&&b.challengeType?a.$services.router.route("login-challenge",
b):a.url?window.location.href=a.url:a.$services.router.route(a.route);a.working=!1},function(b){a.messages.push({title:a.$services.page.translate("%{default::Login failed}"),severity:"error"});a.working=!1})}},validate:function(a){return this.valid=0==this.$refs.form.validate(!a).length}}});
Vue.view("default-challenge",{priority:-50,alias:"login-challenge",url:"/login/challenge",props:{route:{type:String,required:!1,default:"home"},url:{type:String,required:!1},challengeType:{type:String,required:!1},token:{type:String,required:!0},remember:{type:Boolean,required:!1,default:!0}},data:function(){return{challenge:null,working:!1,valid:!1,messages:[]}},methods:{login:function(){if(this.validate(!0)){this.messages.splice(0,this.messages.length);this.working=!0;var a=this;return this.$services.user.login(this.token,
this.challenge,this.remember,this.challengeType).then(function(b){b&&b.challengeType?a.$services.router.route("login-challenge",b):a.url?window.location.href=a.url:a.$services.router.route(a.route);a.working=!1},function(b){a.messages.push({title:a.$services.page.translate("%{default::Login failed}"),severity:"error"});a.working=!1})}},validate:function(a){return this.valid=0==this.$refs.form.validate(!a).length}}});
Vue.view("default-error",{priority:-50,alias:"error",url:"/error",props:{icon:{type:String,default:"times"},title:{type:String,default:"%{default::A problem has occurred!}"},message:{type:String,default:"%{default::Sorry, your action could not be completed.}"},recover:{type:String,default:"%{default::Return to the\x26nbsp;\x3ca class\x3d'is-color-link' v-route:home\x3ehome page\x3c/a\x3e.}"},errorId:{type:String}}});
Vue.view("default-unknown",{priority:-50,alias:"unknown",url:"/unknown",props:{message:{type:String,default:"%{default::Sorry, the page you were looking for could not be found.}"},recover:{type:String,default:"%{default::Return to the\x26nbsp;\x3ca class\x3d'is-color-link' v-route:home\x3ehome page\x3c/a\x3e.}"}}});
Vue.component("html-fragment",{functional:!0,props:{html:{type:String,required:!0}},render:function(a,b){return(new Vue({beforeCreate:function(){this.$createElement=a},template:"\x3cdiv\x3e"+b.props.html+"\x3c/div\x3e"})).$mount()._vnode.children}});
window.addEventListener("load",function(){application.bootstrap(function(a){a.router.register({alias:"pages",enter:function(b){return new nabu.page.views.Pages({propsData:b})},url:"/pages"});a.router.register({alias:"home",enter:function(b){var c=a.router.router.findRoute(application&&application.configuration?application.configuration.root:"/");if(c&&c.route&&"home"!=c.route.alias)setTimeout(function(){console.log("routing to",c);a.router.route(c.route.alias)},1);else return new nabu.page.views.Pages({propsData:b})},
priority:-5,url:"/"});a.router.register({alias:"page-code",enter:function(b){return new nabu.page.views.Code({propsData:b})}});a.router.register({alias:"impersonate",priority:-10,url:"/impersonate",query:["userId"],enter:function(b){b.userId&&a.user.impersonate(b.userId).then(function(){a.router.route("home")},function(){a.router.route("error",{message:"Failed to impersonate"})})}});a.router.register({alias:"page-fields",enter:function(b){return new nabu.page.views.PageFields({propsData:b})},category:"Content",
name:"Fields",description:"Display a number of fields.",icon:"page/core/images/page-fields.svg"});a.router.register({alias:"page-fields-table",enter:function(b){return new nabu.page.views.PageFieldsTable({propsData:b})}});a.router.register({alias:"page-actions",enter:function(b){return new nabu.page.views.PageActions({propsData:b})},icon:"page/core/images/buttons.svg",description:"Actions is a generic combination of buttons to form a menu, tabs,...",name:"Actions",category:"Interactive",query:["active"]});
a.router.register({alias:"page-form",enter:function(b){return new (Vue.component("page-form"))({propsData:b})},accept:function(b,c){return!1},initialize:function(b,c,d,e,g,k){e.state.operation=c;d.updateOperation(a.swagger.operations[c]);d.generateForm();var m=a.page.guessNameFromOperation(c),p=c.replace(/\.[^.]+$/,""),q=function(u){for(var w=0;w<u.length;w++)if(u[w].cells)for(var y=0;y<u[w].cells.length;y++){var B=u[w].cells[y];if(B.alias&&0==B.alias.indexOf("data-")&&B.state.operation&&0==B.state.operation.indexOf(p)||
B.rows&&(B=q(B.rows),null!=B))return B}return null};b=k.page;if(b.content.rows){var t=q(b.content.rows);null!=t&&nabu.utils.vue.confirm({message:"Do you want to add this form to the existing data cell?"}).then(function(){null!=m&&(m=m.substring(0,1).toUpperCase()+m.substring(1));e.target="prompt";var u=a.swagger.operations[c];t.state.actions||Vue.set(t.state,"actions",[]);if("post"==u.method.toLowerCase())null!=m&&(e.state.title="%{Create "+m+"}"),e.state.event="created"+(m?m:""),e.state.ok="Create",
e.on="create"+(m?m:""),e.hideMode="event",t.state.actions.push({name:"create"+(m?m:""),global:!0,label:"%{Create}",type:"button",class:"primary"}),t.state.refreshOn||Vue.set(t.state,"refreshOn",[]),t.state.refreshOn.push("created"+(m?m:""));else if("put"==u.method.toLowerCase()||"patch"==u.method.toLowerCase())null!=m&&(e.state.title="%{Update "+m+"}"),e.state.synchronize=!0,e.state.event="updated"+(m?m:""),e.state.ok="Update",e.on="update"+(m?m:""),e.hideMode="event",t.state.actions.push({name:"update"+
(m?m:""),global:!1,icon:"fa-pencil-alt",type:"button",class:"inline"}),k.resetEvents(),setTimeout(function(){d.autoMapFrom=e.on;d.automap()},300)})}}});a.router.register({alias:"page-youtube",enter:function(b){return new nabu.page.views.Youtube({propsData:b})}});a.router.register({alias:"page-skeleton-email",enter:function(b){return new nabu.page.skeletons.Email({propsData:b})}});a.router.register({alias:"page-form-text",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-text";
c.configurationComponent="page-form-input-text-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"text",category:"Form",name:"Text",description:"An input field for plain text",icon:"page/core/images/form-text.svg"});a.router.register({alias:"page-form-ace",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-ace";c.configurationComponent="page-form-input-ace-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"ace",category:"Form",
name:"Ace",description:"An ace editor",icon:"page/core/images/form-text.svg"});a.router.register({alias:"page-form-hidden",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-hidden";c.configurationComponent="page-form-input-text-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"hidden",category:"Form",name:"Hidden",description:"An input field with hidden content",icon:"page/core/images/form-text.svg"});a.router.register({alias:"page-form-checkbox",
enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-checkbox";c.configurationComponent="page-form-input-checkbox-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"checkbox",category:"Form",name:"Checkbox",description:"A checkbox that allows you to toggle boolean values",icon:"page/core/images/form-checkbox.svg"});a.router.register({alias:"page-form-enumeration-operation",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent=
"page-form-input-enumeration-operation";c.configurationComponent="page-form-input-enumeration-operation-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"enumerationOperation",category:"Form",name:"Enumeration (Operation)",description:"An enumeration based on an operation",icon:"page/core/images/enumeration.png"});a.router.register({alias:"page-form-enumeration-array",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-enumeration-array";
c.configurationComponent="page-form-input-enumeration-array-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"enumerationArray",category:"Form",name:"Enumeration (Array)",description:"An enumeration based on an array",icon:"page/core/images/enumeration.png"});a.router.register({alias:"page-form-enumeration-provider",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-enumeration-provider";c.configurationComponent="page-form-input-enumeration-provider-configure";
return new nabu.page.views.FormComponent({propsData:c})},form:"enumerationProvider",category:"Form",name:"Enumeration (Provider)",description:"An enumeration based on a data provider",icon:"page/core/images/enumeration.png"});a.router.register({alias:"page-form-enumeration",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-enumeration";c.configurationComponent="page-form-input-enumeration-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"enumeration",
category:"Form",name:"Enumeration (Basic)",description:"An enumeration based on fixed values",icon:"page/core/images/enumeration.png"});a.router.register({alias:"page-form-date",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-date";c.configurationComponent="page-form-input-date-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"date",category:"Form",name:"Date",description:"A date component with a calendar dropdown",icon:"page/core/images/form-date.svg"});
a.router.register({alias:"page-form-switch",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-switch";c.configurationComponent="page-form-input-switch-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"switch",category:"Form",name:"Switch",description:"The switch component is a variant on the checkbox to toggle booleans",icon:"page/core/images/form-switch.svg"});a.router.register({alias:"page-form-password",enter:function(b){var c={};
nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-password";c.configurationComponent="page-form-input-password-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"password",category:"Form",name:"Password",description:"The password component allows for entering the same password twice to verify it",icon:"page/core/images/form-password.svg"});a.router.register({alias:"page-form-richtext",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-richtext";
c.configurationComponent="page-form-input-richtext-configure";return new nabu.page.views.FormComponent({propsData:c})},form:"richtext",category:"Form",name:"Rich Text",description:"This input component allows you to capture rich text from the user",icon:"modules/richtext/logo.svg"});a.router.register({alias:"page-form-file",enter:function(b){var c={};nabu.utils.objects.merge(c,b);c.formComponent="page-form-input-file";c.configurationComponent="page-form-input-file-configure";return new nabu.page.views.FormComponent({propsData:c})},
form:"file",category:"Form",name:"File",description:"Upload a file to a REST service with a stream as input",icon:"file"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-data",configure:"page-field-fragment-data-configure",name:"data",namespace:"nabu.page"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-text",configure:"page-field-fragment-text-configure",name:"text",namespace:"nabu.page"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-image",
configure:"page-field-fragment-image-configure",name:"image",namespace:"nabu.page"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-richtext",configure:"page-field-fragment-richtext-configure",name:"richtext",namespace:"nabu.page"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-javascript",configure:"page-field-fragment-javascript-configure",name:"javascript",namespace:"nabu.page"});nabu.page.provide("page-field-fragment",{component:"page-field-fragment-form",
configure:"page-field-fragment-form-configure",name:"form",editable:!0,namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-richtext",configure:"page-form-input-richtext-configure",name:"richtext",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-page",configure:"page-form-input-page-configure",name:"page",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-text",configure:"page-form-input-text-configure",
name:"text",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-hidden",configure:"page-form-input-text-configure",name:"hidden",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-password",configure:"page-form-input-password-configure",name:"password",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-slider",configure:"page-form-input-slider-configure",name:"slider",namespace:"nabu.page"});
nabu.page.provide("page-form-input",{component:"page-form-input-date",configure:"page-form-input-date-configure",name:"date",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-date-picker",configure:"page-form-input-date-picker-configure",name:"date-picker",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-switch",configure:"page-form-input-switch-configure",name:"switch",namespace:"nabu.page"});nabu.page.provide("page-form-input",
{component:"page-form-input-checkbox",configure:"page-form-input-checkbox-configure",name:"checkbox",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-enumeration",configure:"page-form-input-enumeration-configure",name:"enumeration",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-enumeration-provider",configure:"page-form-input-enumeration-provider-configure",name:"enumeration-provider",namespace:"nabu.page"});nabu.page.provide("page-form-input",
{component:"page-form-input-enumeration-operation",configure:"page-form-input-enumeration-operation-configure",name:"enumeration-operation",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-enumeration-array",configure:"page-form-input-enumeration-array-configure",name:"enumeration-array",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-static-image",configure:"page-form-input-static-image-configure",name:"static-image",
namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-file",configure:"page-form-input-file-configure",name:"file",namespace:"nabu.page"});nabu.page.provide("page-form-input",{component:"page-form-input-location",configure:"page-form-input-location-configure",name:"location",namespace:"google",multipleFields:!0});nabu.page.provide("page-form-input",{component:"page-form-input-address",configure:"page-form-input-address-configure",name:"address",namespace:"google",
multipleFields:!0});nabu.page.provide("page-form-input",{component:"page-form-input-validate-custom",configure:"page-form-input-validate-custom-configure",name:"validate",namespace:"nabu.page",multipleFields:!0});nabu.page.provide("page-form-list-input",{component:"page-form-list-input-dynamic",configure:"page-form-list-input-dynamic-configure",name:"dynamic",namespace:"nabu.page"});nabu.page.provide("page-form-list-input",{component:"page-form-list-input-predefined",configure:"page-form-list-input-predefined-configure",
name:"predefined",namespace:"nabu.page"});nabu.page.provide("page-generator",{name:"Table Button",description:"Add as a delete button to an existing table",icon:"th",accept:function(b,c){return"operation"==b&&a.swagger.operations[c]&&a.swagger.operations[c].method&&"delete"==a.swagger.operations[c].method.toLowerCase()},initialize:function(b,c,d,e,g){var k=a.swagger.operations[c],m=a.page.guessNameFromOperation(c),p=m;null!=m&&(m=m.substring(0,1).toUpperCase()+m.substring(1));b=d.page;var q=c.replace(/\.[^.]+$/,
""),t=function(y){for(var B=0;B<y.length;B++){var F=y[B];if("repeat"==F.renderer&&F.repeat&&F.repeat.operation&&0==F.repeat.operation.indexOf(q))return[F];if(F.rows){var C=t(F.rows);if(null!=C)return C.push(F),C}else if(F.cells&&(C=t(F.cells),null!=C))return C.push(F),C}return null};b=t(b.content.rows);if(null!=b&&2<=b.length&&"table"==b[1].renderer&&0>["header","footer"].indexOf(b[0].rendererSlot)){var u=b[1],w=b[0];nabu.utils.vue.confirm({message:"Do you want to add a delete button to the existing table?"}).then(function(){var y=
w.cells.filter(function(C){return C.name&&"local actions"==C.name.toLowerCase()})[0];y||(y=g(w),y.name="Local actions",u.rows.filter(function(C){return"header"==C.rendererSlot}).forEach(function(C){g(C).name="Local actions header"}),application.services.page.normalizeAris(d.page,y,"cell",[{name:"table-column"}]),y.aris.components["table-column"].options.push("border_none"),y.aris.components["table-column"].modifiers.push("small"));var B=null;0==y.rows.length?(B=e(y),application.services.page.normalizeAris(d.page,
B,"row"),B.aris.components["page-row"].options.push("gap_small"),B.aris.components["page-row"].options.push("wrap_none")):B=y.rows[0];y=g(B);y.name="Delete"+(m?" "+m:"");application.services.page.normalizeAris(d.page,y,"cell");application.services.page.normalizeAris(d.page,y,"cell",[{name:"page-button"}]);y.aris.components["page-button"].variant="ghost";y.aris.components["page-button"].modifiers.push("danger");p&&(y.analysisId="delete-"+p);y.alias="page-button";B=k.parameters?k.parameters.filter(function(C){return 0<=
C.name.toLowerCase().indexOf("id")}).map(function(C){return C.name})[0]:null;var F={};B&&(F[B]=w.runtimeAlias+".record.id");y.state={content:null,icon:"times"};y.triggers=[{trigger:"activate",actions:[{type:"confirmation",confirmation:"%{Are you sure you want to delete this entry?}"},{type:"operation",operation:c,bindings:F},{type:"action",action:"refresh",actionTarget:w.id,bindings:{}}]}]})}}});nabu.page.provide("page-generator",{name:"Table",description:"Generate a table",icon:"th",accept:function(b,
c){return"operation"==b&&0<application.services.page.getArrayOperations().filter(function(d){return d.id==c}).length},initialize:function(b,c,d,e,g){var k=nabu.page.providers("page-generator").filter(function(w){return"table"==w.name.toLowerCase()})[0],m=function(w){if("table"==w.renderer)return w;if(w.cells)return w.cells.filter(function(y){return!!m(y)})[0];if(w.rows)return w.rows.filter(function(y){return!!m(y)})[0]},p=application.services.page.templates.filter(function(w){w=JSON.parse(w.content);
return!!m(w.content)}),q=a.page.guessNameFromOperation(c);null!=q&&(q=q.substring(0,1).toUpperCase()+q.substring(1));var t=function(w){var y=e(),B=null;"row"==w.type?(B=y,application.services.page.normalizeAris(d.page,y,"row"),y.name="Cards",y.aris.components["page-row"].variant="cards",y=g(y),y.name="Card",application.services.page.normalizeAris(d.page,y,"cell"),y.aris.components["page-column"].variant="card",y.aris.components["page-column"].options.push("fill_normal"),B=e(y)):B=g(y);var F=JSON.parse(w.content).content;
application.services.page.renumber(d.page,F);Object.keys(F).forEach(function(K){Vue.set(B,K,F[K])});var C=null,A=null,O=null,H=null,ca=null,P=function(K){K.name&&"table title"==K.name.toLowerCase()&&(C=K);K.name&&"table filters"==K.name.toLowerCase()&&(H=K);K.name&&"table tags"==K.name.toLowerCase()&&(ca=K);"repeat"==K.renderer&&0>["header","footer"].indexOf(K.rendererSlot)&&(O=K);"header"==K.rendererSlot&&(A=K);K.cells?K.cells.forEach(P):K.rows&&K.rows.forEach(P)};P(B);B.name=q+" Table";C&&(C.state.content=
"%{"+q+"}");var M="repeat"+q;w=null;O?(O.repeat.operation=c,O.repeat.loadingPlaceholder="%{Loading...}",O.repeat.emptyPlaceholder="%{No data available}",O.repeat.selectable=!0,O.repeat.enableParameterWatching=!0,O.runtimeAlias=M,O.name="Table Body "+q,w=k.generateFields(b,c,d,B,O,A,e,g)):w=application.services.q.resolve({});w.then(function(K){K.repeatName&&(M=K.repeatName,O.runtimeAlias=K.repeatName);K=a.swagger.operations[c];var Q=["limit","offset","orderBy","id","$serviceContext"];K["x-temporary-secret"]&&
Q.push(K["x-temporary-secret"]);K["x-temporary-id"]&&Q.push(K["x-temporary-id"]);if(H&&K){var Z=H.cells?H:e(H);K.parameters&&(nabu.page.providers("page-generator").filter(function(S){return"form"==S.name.toLowerCase()})[0].generateFields("operation",c,d,M+".filter",Z,e,g,Q,600),Z.cells.forEach(function(S){S.state.placeholder="%{Q}"==S.state.label?"%{Search}":S.state.label;S.state.label=null;"page-form-text"==S.alias&&(S.state.suffixIcon="search")}))}if(ca){Z=ca.cells?ca:e(ca);var aa=Z.cells.filter(function(S){return"page-tag"==
S.alias});aa.forEach(function(S){Z.cells.splice(Z.cells.indexOf(S),1)});K.parameters&&K.parameters.forEach(function(S){if(0>Q.indexOf(S.name)){var la=g(Z);la.alias="page-tag";la.state.field=M+".filter."+S.name;la.state.content="q"==S.name?"%{Search}":"%{"+S.name.substring(0,1).toUpperCase()+S.name.substring(1).replace(/([A-Z]+)/g," $1")+"}";0==aa.length?(application.services.page.normalizeAris(d.page,la,"cell"),application.services.page.normalizeAris(d.page,la,"cell",[{name:"page-tag"}]),S=la.aris.components["page-tag"].options,
la.aris.components["page-tag"].variant="primary-dark-outline",S.push("direction_reverse"),S.push("decoration_emphasis")):la.aris=aa[0].aris}})}})};if(0==p.length)nabu.utils.vue.confirm({message:"There are no applicable table templates available, add at least one to generate a table"});else if(1==p.length)t(p[0]);else{var u=Vue.component("page-components-selector");nabu.utils.vue.prompt(function(){return new u({propsData:{components:p}})}).then(function(w){t(w)})}},generateFields:function(b,c,d,e,
g,k,m,p){var q=null;if("operation"==b)q=application.services.page.getSwaggerOperationOutputDefinition(c),b=application.services.page.getArrays(q),q=(b=application.services.page.getChildDefinition(q,b[0]))&&b.items&&b.items?b.items:{};else if("array"==b)throw"Not implemented page parameter resolving yet";var t=null==k?[]:k.cells.filter(function(B){return"page-button-sort"==B.alias});t.forEach(function(B){k.cells.splice(k.cells.indexOf(B),1)});var u=application.services.page.getSimpleKeysFor(q),w={fields:[],
repeatName:null},y=application.services.q.defer();(new nabu.utils.vue.prompt(function(){return new (Vue.component("data-field-picker"))({propsData:{value:w,fields:u}})})).then(function(){var B=w.repeatName?w.repeatName:g.runtimeAlias;w.fields.forEach(function(F){if("id"!=F){var C=F.replace(/^.*\.([^.]+)$/,"$1"),A=p(g),O=application.services.page.getChildDefinition(q,F);A.alias="typography-fragment";A.state.content="{"+C+"}";Vue.set(A.state,"fragments",{});Vue.set(A.state.fragments,C,{key:null,format:null});
A.state.fragments[C].key=B+".record."+F;application.services.page.normalizeAris(d.page,A,"cell");A.aris.components["table-column"].modifiers.push("empty");A.aris.components["table-column"].conditions.empty='$value("'+B+".record."+F+'") \x3d\x3d null';O&&("integer"==O.type?A.state.fragments[C].format="number":"boolean"==O.type?A.state.fragments[C].format="checkbox":O.format&&0<=O.format.indexOf("date")?A.state.fragments[C].format="date":"uuid"==O.format&&(A.state.fragments[C].format="resolve",(F=nabu.page.providers("page-generator").filter(function(H){return"form"==
H.name.toLowerCase()})[0].guessListServiceForField(C))?(A.state.fragments[C].resolveOperation=F,A.state.fragments[C].resolveOperationId="id",A.state.fragments[C].resolveOperationLabel="name"):(A.state.fragments[C].resolveOperation="nabu.cms.core.rest.masterdata.entry.resolve",A.state.fragments[C].resolveOperationId="id",A.state.fragments[C].resolveOperationLabel="label",A.state.fragments[C].resolveOperationIds="entryId")));A=p(k);A.alias="page-button-sort";A.state.content="%{"+application.services.page.prettify(C)+
"}";A.state.sortFields=[{name:C}];A.state.target=g.id;0==t.length?(application.services.page.normalizeAris(d.page,A,"cell"),application.services.page.normalizeAris(d.page,A,"cell",[{name:"page-button-sort"}]),A.aris.components["page-button-sort"].options.push("direction_reverse"),A.aris.components["page-button-sort"].variant="ghost"):A.aris=t[0].aris}});y.resolve(w)},function(){y.resolve(w)});return y}});nabu.page.provide("page-generator",{name:"Form",description:"Generates a form that calls this operation",
icon:"page/core/images/form.svg",accept:function(b,c){if("operation"==b)return b=a.swagger.operations[c],"put"==b.method.toLowerCase()||"post"==b.method.toLowerCase()||"patch"==b.method.toLowerCase()},automap:function(b,c,d){c=application.services.page.getAllAvailableParameters(c.page,c);c=application.services.page.getChildDefinition({properties:c},d);var e=null;if("operation"==b.form.formType)e=application.services.page.getSwaggerOperationInputDefinition(b.form.operation);else{if("array"==b.form.formType)throw"Not implemented page parameter resolving yet";
"function"==b.form.formType&&(e=application.services.page.getFunctionInput(b.form.function))}var g=application.services.page.getSimpleKeysFor(c);c=application.services.page.getSimpleKeysFor(e);b.rendererBindings||Vue.set(b,"rendererBindings",{});var k=!1;0<c.filter(function(m){return 0==m.indexOf("body.")}).length&&(g.indexOf(d+".record"),0<g.filter(function(m){return 0==m.indexOf("record.")}).length&&(k=!0,b.rendererBindings.body=d+".record"));c.forEach(function(m){var p=k&&0==m.indexOf("body.");
if(null==b.rendererBindings[m]&&!p){var q=m.replace(/^.*\.([^.]+)$/,"$1");(p=g.filter(function(t){return t.length>q.length&&t.indexOf("."+q)==t.length-q.length-1})[0])&&Vue.set(b.rendererBindings,m,d+"."+p)}})},guessListServiceForField:function(b){b=b.replace(/^.*\.([^.]+)$/,"$1");b=b.replace(/^([^.]+)Id$/,"$1");return Object.keys(application.services.swagger.operations).filter(function(c){return 0<=c.indexOf("."+b+".")&&c.indexOf(".list")==c.length-5})[0]},generateFields:function(b,c,d,e,g,k,m,p,
q){g.cells||(g=k(g));var t=null;if("operation"==b)t=application.services.page.getSwaggerOperationInputDefinition(c);else{if("array"==b)throw"Not implemented page parameter resolving yet";"function"==b&&(t=application.services.page.getFunctionInput(c))}var u=nabu.page.providers("page-generator").filter(function(w){return"form"==w.name.toLowerCase()})[0];application.services.page.getSimpleKeysFor(t).forEach(function(w){if(!p||0>p.indexOf(w)){var y=m(g),B=application.services.page.getChildDefinition(t,
w);y.alias="page-form-text";if(B)if("integer"==B.type)y.state.textType="number";else if("boolean"==B.type)y.alias="page-form-switch";else if(B.format&&0<=B.format.indexOf("date"))y.alias="page-form-date";else if("uuid"==B.format){if(y.alias="page-form-enumeration-operation",B=u.guessListServiceForField(w))y.state.enumerationOperation=B,y.state.enumerationOperationValue="id",y.state.enumerationOperationLabel="name"}else 0<=w.toLowerCase().indexOf("password")&&(y.alias="page-form-password");y.state.name=
e+"."+w;w=application.services.page.prettify(w.replace(/^.*\.([^.]+)$/,"$1"));y.state.label="%{"+w+"}";q&&(y.state.timeout=q)}})},generate:function(b,c,d,e,g,k){var m=nabu.page.providers("page-generator").filter(function(P){return"form"==P.name.toLowerCase()})[0],p=a.swagger.operations[c],q=a.page.guessNameFromOperation(c),t=q;null!=q&&(q=q.substring(0,1).toUpperCase()+q.substring(1));var u=null,w=null,y=null,B=function(P){P.name&&("form title"==P.name.toLowerCase()?u=P:"submit button"==P.name.toLowerCase()?
w=P:"cancel button"!=P.name.toLowerCase()&&"close button"!=P.name.toLowerCase()&&"form fields"==P.name.toLowerCase()&&(y=P));P.cells?P.cells.forEach(B):P.rows&&P.rows.forEach(B)};B(e);e.renderer="form";e.form={formType:"operation",operation:c};var F=q?q:"";"post"==p.method.toLowerCase()?(e.runtimeAlias="formCreate"+F,F="Create "+F,w&&(w.state.content="%{Create}"),t&&(e.analysisId="create-"+t)):"delete"==p.method.toLowerCase()?(e.runtimeAlias="formDelete"+F,F="Delete "+F,w&&(w.state.content="%{Remove}"),
t&&(e.analysisId="delete-"+t)):(e.runtimeAlias="formUpdate"+F,F="Update "+F,w&&(w.state.content="%{Update}"),t&&(e.analysisId="update-"+t));null==e.name&&(e.name=F+"Form");null!=u&&(u.state.content="%{"+F+"}");m.generateFields(b,c,d,e.runtimeAlias,y,g,k,["id","$serviceContext"]);w&&(w.triggers||(w.triggers=[]),0==w.triggers.length&&w.triggers.push({trigger:"activate",closeEvent:!0,actions:[]}),b=w.triggers[0],(t=b.actions.filter(function(P){return"submit"==P.action})[0])?t.actionTarget=e.id:b.actions.push({type:"action",
actionTarget:e.id,action:"submit",bindings:{}}),b.closeEvent=!0);var C=c.replace(/\.[^.]+$/,""),A=function(P){for(var M=0;M<P.length;M++){var K=P[M];if("repeat"==K.renderer&&K.repeat&&K.repeat.operation&&0==K.repeat.operation.indexOf(C))return[K];if(K.rows){var Q=A(K.rows);if(null!=Q)return Q.push(K),Q}else if(K.cells&&(Q=A(K.cells),null!=Q))return Q.push(K),Q}return null},O=d.page;if(O.content.rows&&(c=A(O.content.rows),null!=c&&2<=c.length&&"table"==c[1].renderer&&0>["header","footer"].indexOf(c[0].rendererSlot))){var H=
c[1],ca=c[0];nabu.utils.vue.confirm({message:"Do you want to add this form to the existing table?"}).then(function(){var P=null,M=null;if("post"==p.method.toLowerCase()){var K=application.services.page.getTemplateRoot(O,H,!0),Q=function(Z){var aa=null;Z.name&&"global actions"==Z.name.toLowerCase()?aa=Z:Z.cells?Z.cells.forEach(function(S){aa||=Q(S)}):Z.rows&&Z.rows.forEach(function(S){aa||=Q(S)});return aa};M=Q(K);console.log("finding global actions",K,M);M||=g(H);P="create"+(q?q:"");M=k(M);M.name=
"Create"+(q?" "+q:"");application.services.page.normalizeAris(d.page,M,"cell",[{name:"page-button"}]);M.aris.components["page-button"].variant="primary"}else if("put"==p.method.toLowerCase()||"patch"==p.method.toLowerCase())M=ca.cells.filter(function(Z){return Z.name&&"local actions"==Z.name.toLowerCase()})[0],M||(M=k(ca),M.name="Local actions",H.rows.filter(function(Z){return"header"==Z.rendererSlot}).forEach(function(Z){Z=k(Z);Z.name="Local actions header";Z.alias="typography-fragment"}),application.services.page.normalizeAris(d.page,
M,"cell",[{name:"table-column"}]),M.aris.components["table-column"].variant="local-actions"),K=null,0==M.rows.length?(K=g(M),application.services.page.normalizeAris(d.page,K,"row")):K=M.rows[0],M=k(K),P="update"+(q?q:""),M.name="Update"+(q?" "+q:""),application.services.page.normalizeAris(d.page,M,"cell"),application.services.page.normalizeAris(d.page,M,"cell",[{name:"page-button"}]),M.aris.components["page-button"].variant="ghost",e.form.synchronize=!0,0>H.aris.components.table.modifiers.indexOf("has-local-actions")&&
H.aris.components.table.modifiers.push("has-local-actions"),y&&setTimeout(function(){m.automap(e,d,P)},300);w&&"post"==p.method.toLowerCase()&&w.triggers[0].actions.push({type:"action",action:"refresh",actionTarget:ca.id,bindings:{}});P&&(e.on=P,e.state||(e.state={}),e.state.hideMode="event",e.target="prompt",d.resetEvents());M&&(M.alias="page-button",M.state={content:"post"==p.method.toLowerCase()?"%{Create}":null,icon:"post"==p.method.toLowerCase()?"plus":"pencil-alt"},M.triggers=[{trigger:"activate",
actions:[{type:"event",event:{name:P,eventFields:[]}}]}],"put"!=p.method.toLowerCase()&&"patch"!=p.method.toLowerCase()||M.triggers[0].actions[0].event.eventFields.push({name:"record",stateValue:ca.runtimeAlias+".record"}))})}},initialize:function(b,c,d,e,g){var k=nabu.page.providers("page-generator").filter(function(t){return"form"==t.name.toLowerCase()})[0],m=application.services.page.templates.filter(function(t){t=JSON.parse(t.content);return"page-cell"==t.type&&"form"==t.content.renderer}),p=
function(t){var u=e(),w=g(u),y=JSON.parse(t.content).content;application.services.page.renumber(d.page,y);Object.keys(y).forEach(function(B){Vue.set(w,B,y[B])});k.generate(b,c,d,w,e,g)};if(0==m.length)nabu.utils.vue.confirm({message:"There are no applicable form templates available, add at least one to generate a form"});else if(1==m.length)p(m[0]);else{var q=Vue.component("page-components-selector");nabu.utils.vue.prompt(function(){return new q({propsData:{components:m}})}).then(function(t){p(t)})}}});
nabu.page.provide("page-type",{name:"email",pageTag:"e-root",rowTag:"e-row",cellTag:"e-columns"});nabu.page.provide("page-function",{id:"page.setAcceptedCookies",async:!1,implementation:function(b,c,d,e,g){var k=b.cookieObject,m=[];k instanceof Array?nabu.utils.arrays.merge(m,k):k&&Object.keys(k).forEach(function(p){k[p]&&m.push(p)});c.page.acceptCookies(m)},inputs:[{name:"cookieObject",required:!0}]});nabu.page.provide("page-icon",{name:"Font Awesome",html:function(b,c){return"\x3cspan class\x3d'icon fa "+
b+(c?" "+c:"")+(0!=b.indexOf("fa")?" fa-"+b:"")+"'\x3e\x3c/span\x3e"},priority:-1,allowOther:!0,icons:[]});nabu.page.provide("page-format",{html:!0,name:"markdown",namespace:"nabu",skipCompile:!1,skipSanitize:!1,format:function(b,c,d,e,g,k){if(nabu.formatters&&nabu.formatters.markdown){nabu.formatters.markdown.syntaxProviders.form=function(p,q){return"\x3cn-form-text v-model\x3d'value' label\x3d'"+p+"'/\x3e\x3cdiv\x3etest\x3c/div\x3e"};b=nabu.formatters.markdown.parse(b);var m=nabu.formatters.markdown.asHtml(b,
{tagUrl:"http://google.com?q\x3d",variables:{right:"left"}});0<Object.keys(m.promises).length&&Vue.nextTick(function(){nabu.formatters.markdown.replacePromises(m.promises)});return"\x3carticle class\x3d'is-article'\x3e"+m.content+"\x3c/article\x3e"}return b}});nabu.page.provide("page-format",{html:!0,name:"icon",namespace:"nabu",skipCompile:!1,skipSanitize:!1,format:function(b,c,d,e,g,k){return b?"\x3cicon name\x3d'"+b+"'/\x3e":null}});nabu.page.provide("page-format",{html:!0,name:"code",namespace:"nabu",
skipCompile:!1,skipSanitize:!1,format:function(b,c,d,e,g,k){if(nabu.formatters&&nabu.formatters.markdown){c=c.codeFormat?c.codeFormat:"";nabu.formatters.markdown.syntaxProviders.form=function(p,q){return"\x3cn-form-text v-model\x3d'value' label\x3d'"+p+"'/\x3e\x3cdiv\x3etest\x3c/div\x3e"};b=nabu.formatters.markdown.parse("```"+c+"\n"+b+"\n```");var m=nabu.formatters.markdown.asHtml(b,{tagUrl:"http://google.com?q\x3d",variables:{right:"left"}});0<Object.keys(m.promises).length&&Vue.nextTick(function(){nabu.formatters.markdown.replacePromises(m.promises)});
return"\x3carticle class\x3d'is-article'\x3e"+m.content+"\x3c/article\x3e"}return b},configure:"page-format-code-configure"});Vue.component("page-format-code-configure",{props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},fragment:{type:Object,required:!0}},template:"\x3cdiv\x3e\x3cn-form-combo v-model\x3d'fragment.codeFormat' label\x3d'Code format' :items\x3d\"['xml', 'json', 'css', 'sql', 'glue', 'java', 'javascript', 'python']\"/\x3e\x3c/div\x3e"});nabu.page.provide("page-format",
{format:function(b,c,d,e,g,k){var m={},p=a.page.getPageInstance(d,this);c&&c.resolveOperationBinding&&(m={},Object.keys(c.resolveOperationBinding).map(function(q){if(c.resolveOperationBinding[q])if(0==c.resolveOperationBinding[q].indexOf("record."))m[q]=g?a.page.getValue(g,c.resolveOperationBinding[q].substring(7)):null;else{var t=a.page.getBindingValue(p,c.resolveOperationBinding[q]);m[q]=t}}));m.$serviceContext||(m.$serviceContext=p.getServiceContext());return(b=a.pageResolver.resolve(c.resolveOperation,
c.resolveOperationIds,c.resolveOperationId,b,m))&&c.resolveOperationLabelComplex?c.complexLabel?a.typography.replaceVariables(p,c,c.complexLabel,a.q.reject(),b):c.complexLabel:b&&c.resolveOperationLabel?b[c.resolveOperationLabel]:b},skipCompile:!0,html:!0,configure:"page-format-resolver",name:"resolve",namespace:"nabu.page"});nabu.page.provide("page-format",{format:function(b){try{return(new nabu.page.views.Page({propsData:{embedded:!0,page:{name:"dynamic-page-"+application.services.page.counter++,
content:application.services.page.normalize(b?JSON.parse(b):{})}}})).$mount().$el}catch(c){return null}},html:!0,skipCompile:!0,name:"page",namespace:"nabu.page"});nabu.page.provide("page-format",{format:function(b){return"\x3ca ref\x3d'noopener noreferrer nofollow' href\x3d'tel:"+b+"'\x3e"+b+"\x3c/a\x3e"},html:!0,skipCompile:!0,name:"phone",namespace:"nabu.page"});nabu.page.provide("page-format",{format:function(b){return"\x3ca ref\x3d'noopener noreferrer nofollow' href\x3d'mailto:"+b+"'\x3e"+b+
"\x3c/a\x3e"},html:!0,skipCompile:!0,name:"email",namespace:"nabu.page"});Vue.component("page-percentage-slider-configurator",{props:{page:{type:Object,required:!0},cell:{type:Object,required:!0},fragment:{type:Object,required:!0}},template:"\x3cdiv\x3e\x3cn-form-switch v-model\x3d'fragment.percentageReverse' label\x3d'Reverse percentage'/\x3e\x3cn-form-switch v-model\x3d'fragment.percentageSmallRange' label\x3d'Is [0-1] range' /\x3e\x3cn-form-text v-model\x3d'fragment.round' label\x3d'Round Number'/\x3e\x3c/div\x3e"});
nabu.page.provide("page-format",{format:function(b,c,d,e){c&&c.percentageSmallRange&&b&&(b*=100);c&&c.percentageReverse&&null!=b&&(b=100-b);c&&c.round&&null!=b&&(b=parseFloat(a.formatter.number(b,parseInt(c.round))));0>b&&(b=0);100<b&&(b=100);return"\x3cinput disabled\x3d'true' type\x3d'range' value\x3d'"+b+"' minimum\x3d'0' step\x3d'1' maximum\x3d'100' :value\x3d'"+b+"'/\x3e"},html:!0,skipCompile:!1,name:"percentage-slider",configure:"page-percentage-slider-configurator",namespace:"nabu.page"});
return a.$register({page:nabu.page.services.Page,pageResolver:nabu.page.services.PageResolver,resizer:nabu.page.services.Resizer,formatter:nabu.page.services.Formatter})})});let DragDropTouch;
(function(a){let b=function(){function d(){this._dropEffect="move";this._effectAllowed="all";this._data={}}Object.defineProperty(d.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"types",{get:function(){return Object.keys(this._data)},
enumerable:!0,configurable:!0});d.prototype.clearData=function(e){null!==e?delete this._data[e.toLowerCase()]:this._data={}};d.prototype.getData=function(e){e=e.toLowerCase();let g=this._data[e];"text"===e&&null==g&&(g=this._data["text/plain"]);return g||""};d.prototype.setData=function(e,g){this._data[e.toLowerCase()]=g};d.prototype.setDragImage=function(e,g,k){let m=c._instance;m._imgCustom=e;m._imgOffset={x:g,y:k}};return d}();a.DataTransfer=b;let c=function(){function d(){this._lastClick=0;if(d._instance)throw"DragDropTouch instance already created.";
let e=!1;document.addEventListener("test",function(){},{get passive(){return e=!0}});if(navigator.maxTouchPoints){let g=document,k=this._touchstart.bind(this),m=this._touchmove.bind(this),p=this._touchend.bind(this),q=e?{passive:!1,capture:!1}:!1;g.addEventListener("touchstart",k,q);g.addEventListener("touchmove",m,q);g.addEventListener("touchend",p);g.addEventListener("touchcancel",p)}}d.getInstance=function(){return d._instance};d.prototype._touchstart=function(e){let g=this;if(this._shouldHandle(e)){this._reset();
let k=this._closestDraggable(e.target);!k||this._dispatchEvent(e,"mousemove",e.target)||this._dispatchEvent(e,"mousedown",e.target)||(this._dragSource=k,this._ptDown=this._getPoint(e),this._lastTouch=e,setTimeout(function(){g._dragSource===k&&null===g._img&&g._dispatchEvent(e,"contextmenu",k)&&g._reset()},d._CTXMENU),d._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout(function(){g._isDragEnabled=!0;g._touchmove(e)},d._PRESSHOLDAWAIT)))}};d.prototype._touchmove=function(e){if(this._shouldCancelPressHoldMove(e))this._reset();
else if(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e)){let g=this._getTarget(e);if(this._dispatchEvent(e,"mousemove",g))this._lastTouch=e,e.preventDefault();else{if(this._dragSource&&!this._img&&this._shouldStartDragging(e)){if(this._dispatchEvent(this._lastTouch,"dragstart",this._dragSource)){this._dragSource=null;return}this._createImage(e);this._dispatchEvent(e,"dragenter",g)}this._img&&(this._lastTouch=e,e.preventDefault(),this._dispatchEvent(e,"drag",this._dragSource),g!==this._lastTarget&&
(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",g),this._lastTarget=g),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",g))}}};d.prototype._touchend=function(e){this._shouldHandle(e)&&(this._dispatchEvent(this._lastTouch,"mouseup",e.target)?e.preventDefault():(this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(0>e.type.indexOf("cancel")&&
this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())))};d.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&2>e.touches.length};d.prototype._shouldHandleMove=function(e){return!d._ISPRESSHOLDMODE&&this._shouldHandle(e)};d.prototype._shouldHandlePressHoldMove=function(e){return d._ISPRESSHOLDMODE&&this._isDragEnabled&&e&&e.touches&&e.touches.length};d.prototype._shouldCancelPressHoldMove=
function(e){return d._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(e)>d._PRESSHOLDMARGIN};d.prototype._shouldStartDragging=function(e){e=this._getDelta(e);return e>d._THRESHOLD||d._ISPRESSHOLDMODE&&e>=d._PRESSHOLDTHRESHOLD};d.prototype._reset=function(){this._destroyImage();this._ptDown=this._lastTarget=this._lastTouch=this._dragSource=null;this._isDropZone=this._isDragEnabled=!1;this._dataTransfer=new b;clearInterval(this._pressHoldInterval)};d.prototype._getPoint=function(e,g){e&&e.touches&&
(e=e.touches[0]);return{x:g?e.pageX:e.clientX,y:g?e.pageY:e.clientY}};d.prototype._getDelta=function(e){if(d._ISPRESSHOLDMODE&&!this._ptDown)return 0;e=this._getPoint(e);return Math.abs(e.x-this._ptDown.x)+Math.abs(e.y-this._ptDown.y)};d.prototype._getTarget=function(e){e=this._getPoint(e);for(e=document.elementFromPoint(e.x,e.y);e&&"none"==getComputedStyle(e).pointerEvents;)e=e.parentElement;return e};d.prototype._createImage=function(e){this._img&&this._destroyImage();var g=this._imgCustom||this._dragSource;
this._img=g.cloneNode(!0);this._copyStyle(g,this._img);this._img.style.top=this._img.style.left="-9999px";if(!this._imgCustom){g=g.getBoundingClientRect();let k=this._getPoint(e);this._imgOffset={x:k.x-g.left,y:k.y-g.top};this._img.style.opacity=d._OPACITY.toString()}this._moveImage(e);document.body.appendChild(this._img)};d.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img);this._imgCustom=this._img=null};d.prototype._moveImage=function(e){let g=
this;requestAnimationFrame(function(){if(g._img){let k=g._getPoint(e,!0),m=g._img.style;m.position="absolute";m.pointerEvents="none";m.zIndex="999999";m.left=Math.round(k.x-g._imgOffset.x)+"px";m.top=Math.round(k.y-g._imgOffset.y)+"px"}})};d.prototype._copyProps=function(e,g,k){for(let m=0;m<k.length;m++){let p=k[m];e[p]=g[p]}};d.prototype._copyStyle=function(e,g){d._rmvAtts.forEach(function(m){g.removeAttribute(m)});e instanceof HTMLCanvasElement&&(g.width=e.width,g.height=e.height,g.getContext("2d").drawImage(e,
0,0));var k=getComputedStyle(e);for(let m=0;m<k.length;m++){let p=k[m];0>p.indexOf("transition")&&(g.style[p]=k[p])}g.style.pointerEvents="none";for(k=0;k<e.children.length;k++)this._copyStyle(e.children[k],g.children[k])};d.prototype._setOffsetAndLayerProps=function(e,g){let k=void 0;void 0===e.offsetX&&(k=g.getBoundingClientRect(),e.offsetX=e.clientX-k.x,e.offsetY=e.clientY-k.y);void 0===e.layerX&&(k=k||g.getBoundingClientRect(),e.layerX=e.pageX-k.left,e.layerY=e.pageY-k.top)};d.prototype._dispatchEvent=
function(e,g,k){if(e&&k){g=new Event(g,{bubbles:!0,cancelable:!0});let m=e.touches?e.touches[0]:e;g.button=0;g.which=g.buttons=1;this._copyProps(g,e,d._kbdProps);this._copyProps(g,m,d._ptProps);this._setOffsetAndLayerProps(g,k);g.dataTransfer=this._dataTransfer;k.dispatchEvent(g);return g.defaultPrevented}return!1};d.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.draggable)return e;return null};return d}();c._instance=new c;c._THRESHOLD=5;c._OPACITY=.5;c._DBLCLICK=500;c._CTXMENU=
900;c._ISPRESSHOLDMODE=!1;c._PRESSHOLDAWAIT=400;c._PRESSHOLDMARGIN=25;c._PRESSHOLDTHRESHOLD=0;c._rmvAtts=["id","class","style","draggable"];c._kbdProps=["altKey","ctrlKey","metaKey","shiftKey"];c._ptProps="pageX pageY clientX clientY screenX screenY offsetX offsetY".split(" ");a.DragDropTouch=c})(DragDropTouch||={});
(function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define(b):(a="undefined"!==typeof globalThis?globalThis:a||self,a.Frag=b())})(this,function(){function a(){return 0<this.childNodes.length}function b(){var K;(K=this.frag[0]).before.apply(K,arguments)}function c(){var K=this.frag;K.splice(0,K.length).forEach(function(Q){Q.remove()})}function d(K){if("frag"in this){var Q=this.frag.indexOf(K);if(-1<Q){Q=this.frag.splice(Q,
1)[0];if(0===this.frag.length){var Z=this[k];Q.before(Z);u(Z,this);this.frag.unshift(Z)}K.remove()}}else-1<F(this).indexOf(K)&&K.remove();return K}function e(K,Q){var Z=this,aa=K.frag||[K];aa.every(function(pa){return pa[m]===Z})&&aa.forEach(function(pa){pa!==Q&&Z.removeChild(pa)});if("frag"in this){var S=this.frag;if(Q){var la=S.indexOf(Q);-1<la&&(S.splice.apply(S,[la,0].concat(aa)),Q.before.apply(Q,aa))}else la=S[S.length-1],S.push.apply(S,aa),la.after.apply(la,aa);ca(this)}else Q?this.childNodes.includes(Q)&&
Q.before.apply(Q,aa):this.append.apply(this,aa);aa.forEach(function(pa){u(pa,Z)});y(aa[aa.length-1]);return K}function g(K){if(K[m]===this&&K.parentElement)return K;var Q=this.frag;Q[Q.length-1].after(K);u(K,this);ca(this);Q.push(K);return K}var k=Symbol(),m=Symbol(),p=Symbol(),q=Symbol(),t={get:function(){return this[m]||this.parentElement},configurable:!0},u=function(K,Q){m in K||(K[m]=Q,Object.defineProperty(K,"parentNode",t))},w={get:function(){var K=this.parentNode.childNodes,Q=K.indexOf(this);
return-1<Q?K[Q+1]||null:null}},y=function(K){p in K||(K[p]=!0,Object.defineProperty(K,"nextSibling",w))},B,F=function(K){B||(B=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes").get);var Q=B.apply(K),Z=Array.from(Q).map(function(aa){for(;aa.parentNode!==K;){var S=aa.parentNode;S&&(aa=S)}return aa});return Z.filter(function(aa,S){return aa!==Z[S-1]})},C={get:function(){return this.frag||F(this)}},A={get:function(){return this.childNodes[0]||null}},O=function(K){q in K||(K[q]=!0,Object.defineProperties(K,
{childNodes:C,firstChild:A}),K.hasChildNodes=a)},H=function Z(Q){var aa;return(aa=Array.prototype).concat.apply(aa,Q.map(function(S){return"frag"in S?Z(S.frag):S}))},ca=function(Q){var Z=Q[k];Q.frag[0]===Z&&(Q.frag.shift(),Z.remove())},P={set:function(Q){var Z=this;this.frag[0]!==this[k]&&this.frag.slice().forEach(function(S){return Z.removeChild(S)});if(Q){var aa=document.createElement("div");aa.innerHTML=Q;Array.from(aa.childNodes).forEach(function(S){Z.appendChild(S)})}},get:function(){return""}},
M={inserted:function(Q){var Z=Q.parentNode,aa=Q.nextSibling,S=Q.previousSibling,la=Array.from(Q.childNodes),pa=document.createComment("");0===la.length&&la.push(pa);Q.frag=la;Q[k]=pa;pa=document.createDocumentFragment();pa.append.apply(pa,H(la));Q.replaceWith(pa);la.forEach(function(ya){u(ya,Q);y(ya)});O(Q);Object.assign(Q,{remove:c,appendChild:g,insertBefore:e,removeChild:d,before:b});Object.defineProperty(Q,"innerHTML",P);Z&&(Object.assign(Z,{removeChild:d,insertBefore:e}),u(Q,Z),O(Z));aa&&y(Q);
S&&y(S)},unbind:function(Q){Q.remove()}};M.Fragment={name:"Fragment",directives:{frag:M},render:function(Q){return Q("div",{directives:[{name:"frag"}]},this.$slots["default"])}};return M});Vue.directive("fragment",Frag);
nabu.page.provide("page-renderer",{title:"Form",name:"form",type:["row","cell"],component:"renderer-form",configuration:"renderer-form-configure",getTriggers:function(a,b,c){return{update:{type:"object"}}},getState:function(a,b,c,d){if(a.form){if(a.form.array&&"array"==a.form.formType){b=a.form.array;0==b.indexOf("page.")&&(b=b.substring(5));var e=(c=d.page.getChildDefinition({properties:c},b))&&c.items&&c.items?c.items:{}}else e=a.form.operation&&"operation"==a.form.formType?application.services.page.getSwaggerOperationInputDefinition(a.form.operation):
"function"==a.form.formType&&a.form.function?d.page.getFunctionInput(a.form.function):{};e.properties||(e.properties={});e.properties.readOnly={type:"boolean"};a.form.fields&&a.form.fields.forEach(function(g){var k=g.type?d.swagger.resolve(g.type):null;e.properties[g.name]=k?{type:"object",properties:k.properties}:{type:g.type?g.type:"string"}});a.form.translatable&&(e.properties.language={type:"string"},e.properties.translations={type:"array",items:{properties:{language:{type:"string"},name:{type:"string"},
translation:{type:"string"}}}});return e}return{}},getEvents:function(a){var b={};if(a.form){var c=a.form.operation;c&&(a.form.submitEvent&&(b[a.form.submitEvent]=application.services.page.getSwaggerOperationInputDefinition(c)),a.form.successEvent&&(b[a.form.successEvent]=application.services.page.getSwaggerOperationOutputDefinition(c)))}return b},getChildComponents:function(a){return[{title:"Form",name:"form",component:"form"},{title:"Form Container",name:"form-container",component:"form-section"}]},
getActions:function(a){var b=[];b.push({title:"Validate",name:"validate"});if(a&&a.form&&(a.form.operation||a.form.function||a.form.fields&&0<a.form.fields.length)){var c=null;a.form.operation&&"operation"==a.form.formType&&(c=application.services.page.getSwaggerOperationOutputDefinition(a.form.operation));b.push({title:"Submit",name:"submit",input:{skipValidate:{type:"boolean"}},output:c,errors:["submit","validate"]})}b.push({title:"Toggle Readonly",name:"toggle-readonly"});a&&a.form&&a.form.translatable&&
b.push({title:"Switch Language",name:"switch-language",input:{language:{type:"string"}}});return b}});
Vue.component("renderer-form",{template:"#renderer-form",mixins:[nabu.page.mixins.renderer],props:{page:{type:Object,required:!0},target:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},edit:{type:Boolean,required:!1}},created:function(){Vue.set(this.state,"readOnly",this.target.form&&this.target.form.readOnly);this.target.form&&this.target.form.translatable&&(Vue.set(this.state,"language",null),Vue.set(this.state,"translations",[]));this.mergeParameters();
this.mode=this.target.form&&this.target.form.noInlineErrors?null:"component";this.target.form&&"operation"==this.target.form.formType&&null==this.state.body&&Vue.set(this.state,"body",{})},mounted:function(){if(this.target.form&&this.target.form.triggerEvent){var a=this.$services.page.getPageInstance(this.page,this),b=this;this.subscriptions.push(a.subscribe(this.target.form.triggerEvent,function(){b.target.form.submitEvent&&a.emit(b.target.form.submitEvent,b.state)}))}},data:function(){return{messages:[],
state:{},subscriptions:[],mode:null}},methods:{mergeParameters:function(){var a=this;if(this.parameters){if(this.target.form.enableParameterWatching){var b=JSON.stringify(this.parameters);if(null!=this.lastParameters&&b==this.lastParameters)return;this.lastParameters=b}Object.keys(this.parameters).forEach(function(c){a.target.form.bindingByReference?Vue.set(a.state,c,a.parameters[c]):Vue.set(a.state,c,a.$services.page.smartClone(a.parameters[c]))})}},getRuntimeState:function(){return this.state},
update:function(){this.$services.triggerable.trigger(this.target,"update",{},this);this.target.form.submitOnChange&&this.submit()},submit:function(){var a=this;this.messages.splice(0);var b=function(g){a.error="Form submission failed";g&&g.responseText&&(g=JSON.parse(g.responseText));if(g){g.code||(g.code=g.type);g.code||(g.code="HTTP-"+(null!=g.status?g.status:500));try{a.target.form.errorEvent&&a.$services.page.getPageInstance(a.page,a).emit(a.target.form.errorEvent,g);var k=(a.target.form.codes?
a.target.form.codes:[]).filter(function(p){return p.code==g.code})[0],m=k?a.$services.page.translate(k.title):a.$services.page.translateErrorCode(g.code,g.title?g.title:g.message);a.error=m;a.messages.push({type:"request",severity:"error",title:m,code:g.code})}catch(p){a.messages.push({type:"request",severity:"error",title:a.$services.page.translateErrorCode(g.status?"HTTP-"+g.status:"HTTP-500")})}}else a.messages.push({type:"request",severity:"error",title:a.$services.page.translateErrorCode("HTTP-500")});
a.doingIt=!1;stop(a.error)},c=null;c="operation"==this.target.form.formType?this.target.form.operation:"array"==this.target.form.formType?this.target.form.array:"function"==this.target.form.formType?this.target.form.function:this.page.content.name;a.$services.analysis.push({event:"submit",category:"form",component:a.target.analysisId?a.target.analysisId:"form-"+a.target.id,context:c,page:a.$services.page.getRootPage(a.$services.page.getPageInstance(a.page,a)).page.content.name,data:{formType:this.target.form.formType}});
if(this.target.form.operation&&"operation"==this.target.form.formType)try{var d=nabu.utils.objects.clone(this.state);if(!d.$serviceContext){var e=this.$services.page.getPageInstance(this.page,this);d.$serviceContext=e.getServiceContext()}return this.$services.swagger.execute(this.target.form.operation,d).then(function(g){a.target.form.synchronize&&a.$services.page.applyRendererParameters(a.$services.page.getPageInstance(a.page,a),a.target,a.state)},b)}catch(g){return console.error("Can not submit form",
g),a.$services.q.reject(g)}else if(this.target.form.array&&"array"==this.target.form.formType)e=this.$services.page.getPageInstance(this.page,this),b=e.get(this.target.form.array),null==b&&(e.set(this.target.form.array,[]),b=e.get(this.target.form.array)),b.push(this.state),a.target.form.synchronize&&a.$services.page.applyRendererParameters(a.$services.page.getPageInstance(a.page,a),a.target,a.state);else{if(this.target.form.function&&"function"==this.target.form.formType){e=this.$services.page.getRunnableFunction(this.target.form.function);
if(!e)throw"Could not find function: "+this.target.form.function;c=this.$services.q.defer();this.$services.page.runFunction(e,this.state,this,c);a.target.form.synchronize&&c.then(function(g){a.$services.page.applyRendererParameters(a.$services.page.getPageInstance(a.page,a),a.target,a.state)});c.then(function(){},b);return c}this.target.form.fields&&this.target.form.fields.length&&"page"==this.target.form.formType&&this.$services.page.applyRendererParameters(this.$services.page.getPageInstance(this.page,
this),this.target,this.state)}},runAction:function(a,b){var c=this;if("submit"==a){var d=this.$services.q.defer();a=null;a=b&&b.skipValidate?this.$services.q.resolve():this.runAction("validate");a.then(function(){var m=c.submit();m&&m.then?m.then(d,function(p){d.reject({errorType:"submit",error:p})}):d.resolve()},function(m){c.$services.triggerable.trigger(c.target,"validate:error",{},c);d.reject({errorType:"validate",error:m})});return d}if("validate"==a){a=this.target.form.componentGroup?this.target.form.componentGroup:
"form";var e=[],g=[],k=c.target.form.codes?c.target.form.codes:[];this.$el.querySelectorAll("[component-group\x3d'"+a+"']").forEach(function(m){for(var p=m.__vue__.validate(),q=null,t=m.__vue__;t&&!q&&(q=t.codes,t=t.$parent,t&&t.$el==m););q||=[];var u=[];nabu.utils.arrays.merge(u,k);nabu.utils.arrays.merge(u,q);u=u.map(function(B){B=JSON.parse(JSON.stringify(B));B.title=c.$services.page.translate(c.$services.page.interpret(B.title,c));return B});var w=function(B){B.forEach(function(F){F.title=c.$services.page.translate(F.title)})};
if(p&&p.then){var y=c.$services.q.defer();e.push(y);p.then(function(B){nabu.utils.vue.form.rewriteCodes(B,u);nabu.utils.arrays.merge(g,B);w(B);y.resolve(B)},y)}else p instanceof Array&&(nabu.utils.vue.form.rewriteCodes(p,u),nabu.utils.arrays.merge(g,p),w(g))});d=this.$services.q.defer();this.$services.q.all(e).then(function(){0==g.length?d.resolve():d.reject({errorType:"validate",messages:g})},d);return d}"toggle-readonly"==a?(a=this.target.form.componentGroup?this.target.form.componentGroup:"form",
this.$el.querySelectorAll("[component-group\x3d'"+a+"']").forEach(function(m){for(m=m.__vue__;m;)if(0<=Object.keys(m).indexOf("editable")){m.editable=!m.editable;break}else m=m.$parent}),this.state.readOnly=!this.state.readOnly):"switch-language"==a&&(a=this.target.form.componentGroup?this.target.form.componentGroup:"form",this.state.language=b?b.language:null,this.$el.querySelectorAll("[component-group\x3d'"+a+"']").forEach(function(m){for(m=m.__vue__;m;)if(0<=Object.keys(m).indexOf("language")){m.language=
c.state.language;break}else m=m.$parent}))}},watch:{parameters:{deep:!0,handler:function(){this.target.form.enableParameterWatching&&this.mergeParameters()}}}});
Vue.component("renderer-form-configure",{template:"#renderer-form-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0}},created:function(){this.target.form||Vue.set(this.target,"form",{});this.target.form.bindings||Vue.set(this.target.form,"bindings",{});this.target.form.fields||Vue.set(this.target.form,"fields",[])},computed:{definition:function(){}},methods:{getOperations:function(a){return this.$services.page.getOperations(function(b){return("put"==b.method.toLowerCase()||
"post"==b.method.toLowerCase()||"delete"==b.method.toLowerCase()||"patch"==b.method.toLowerCase())&&(!a||0<=b.id.toLowerCase().indexOf(a.toLowerCase()))})},getParameterTypes:function(a){var b=["string","boolean","number","integer"];nabu.utils.arrays.merge(b,Object.keys(this.$services.swagger.swagger.definitions));a&&(b=b.filter(function(c){return 0<=c.toLowerCase().indexOf(a.toLowerCase())}));return b}}});
nabu.page.provide("page-renderer",{title:"Collapsible",name:"collapsible",type:["row","cell"],component:"page-collapsible",configuration:"page-collapsible-configure",getEvents:function(a){return{}},getChildComponents:function(a){return[{title:"Collapsible Container",name:"collapsible",component:"collapsible"},{title:"Title",name:"typography",component:"content"}]}});
Vue.component("page-collapsible",{props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},target:{type:Object,required:!0},edit:{type:Boolean,required:!0}},template:"#page-collapsible",data:function(){return{show:!1,loading:!1,toggleable:!0}},computed:{iconOpen:function(){return this.target.collapsible&&this.target.collapsible.iconOpen?this.target.collapsible.iconOpen:"chevron-up"},iconClosed:function(){return this.target.collapsible&&this.target.collapsible.iconClosed?
this.target.collapsible.iconClosed:"chevron-down"}},created:function(){this.target.collapsible.startOpen&&(this.show=!0)},methods:{toggle:function(a){var b=this,c=function(){b.target.collapsible.closeSiblings&&b.$parent.$children.forEach(function(d){d.toggle&&d.$el.classList.contains("is-collapsible")&&d.show&&d.toggle()})};this.toggleable&&(this.show?(this.show=!1,this.$emit("hide",this)):this.load?(this.loading=!0,b=this,this.load().then(function(){c();b.show=!0;b.loading=!1;b.$emit("show",b)},
function(){b.show=!1;b.loading=!1;b.$emit("hide",b)})):(c(),this.show=!0,this.$emit("show",this)),this.target.collapsible.stopPropagation&&a&&(a.stopPropagation(),a.preventDefault()))},checkPrevent:function(a){this.target.collapsible.stopPropagation&&a&&(a.stopPropagation(),a.preventDefault())}}});
Vue.component("page-collapsible-configure",{template:"#page-collapsible-configure",props:{page:{type:Object,required:!0},parameters:{type:Object,required:!1},childComponents:{type:Object,required:!1},target:{type:Object,required:!0},edit:{type:Boolean,required:!0}},created:function(){this.target.collapsible||Vue.set(this.target,"collapsible",{})}});
nabu.page.provide("page-renderer",{title:"Menu",name:"menu",type:["row","cell"],component:"renderer-menu",configuration:"renderer-menu-configure",getEvents:function(a){var b={};if(a.state&&null!=nabu.page.event.getName(a.state,"handledEvent")){var c=nabu.page.event.getType(a.state,"handledEvent");b[nabu.page.event.getName(a.state,"handledEvent")]=c}return b},getTriggers:function(a,b,c){b={};a&&a.state&&a.state.collapsible&&(b.collapse={type:"object"},b.expand={type:"object"});return b},getChildComponents:function(a){return[{title:"Menu",
name:"renderer-menu",component:"menu"}]},getState:function(a,b,c,d){b={};a&&a.state&&a.state.collapsible&&(b.collapsed={type:"boolean"});return{properties:b}},getActions:function(a,b,c){b=[];a&&a.state&&a.state.collapsible&&b.push({title:"Toggle Collapse",name:"toggle-collapse",input:{collapsed:{type:"boolean"}},output:{}});return b},getSlots:function(a){return["collapsed","expanded"]}});
Vue.component("renderer-menu",{template:"#renderer-menu",mixins:[nabu.page.mixins.renderer],data:function(){return{created:!1,state:{collapsed:null}}},props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1},childComponents:{type:Object,required:!1}},created:function(){this.resetToInitialCollapse();this.created=!0},methods:{getPotentialStates:function(){return["collapsed"]},getCurrentStates:function(){var a=[];this.state.collapsed&&!this.edit&&a.push("collapsed");
this.$parent&&nabu.utils.arrays.merge(a,this.$parent.getCurrentStates());return a},autoclose:function(){this.target&&this.target.state&&this.target.state.collapsible&&this.resetToInitialCollapse()},expand:function(){this.target&&this.target.state&&this.target.state.collapsible&&this.target.state.expandOnHover&&!this.edit&&(this.state.collapsed=!1)},collapse:function(){this.target&&this.target.state&&this.target.state.collapsible&&this.target.state.expandOnHover&&!this.edit&&this.resetToInitialCollapse()},
runAction:function(a,b){"toggle-collapse"==a&&((a=b&&null!=b.collapsed?b.collapsed:!this.state.collapsed)&&!this.getInitialCollapse()?localStorage.setItem(this.page.content.name+"-menu-"+this.target.id+"-collapsed",a):localStorage.removeItem(this.page.content.name+"-menu-"+this.target.id+"-collapsed"),a?this.resetToInitialCollapse():this.state.collapsed=a)},getInitialCollapse:function(){return this.target.state.initialCollapsed?this.$services.page.isCondition(this.target.state.initialCollapsed,{},
this):this.$services.page.device("\x3c\x3d","tablet")},resetToInitialCollapse:function(){if(this.target&&this.target.state&&this.target.state.collapsible){var a=localStorage.getItem(this.page.content.name+"-menu-"+this.target.id+"-collapsed");a=null==a?this.getInitialCollapse():!0===a||"true"===a;this.state.collapsed=1==a?1:0}},getRuntimeState:function(){return this.state},handle:function(){this.target&&this.target.state&&this.target.state.collapsible&&this.resetToInitialCollapse();if(nabu.page.event.getName(this.target.state,
"handledEvent")){var a=this.$services.page.getPageInstance(this.page,this);a&&a.emit(nabu.page.event.getName(this.target.state,"handledEvent"),nabu.page.event.getInstance(this.target.state,"handledEvent",this.page,this))}}},watch:{"state.collapsed":function(a){this.created&&(a?(this.$services.triggerable.untrigger(this.target,"expand",{},this),this.$services.triggerable.trigger(this.target,"collapse",{},this)):(this.$services.triggerable.untrigger(this.target,"collapse",{},this),this.$services.triggerable.trigger(this.target,
"expand",{},this)))}}});Vue.component("renderer-menu-configure",{template:"#renderer-menu-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1}},created:function(){this.target.state||Vue.set(this.target,"state",{})}});
nabu.page.provide("page-renderer",{title:"Repeat",name:"repeat",type:["row","cell"],component:"renderer-repeat",configuration:"renderer-repeat-configure",getTriggers:function(a,b,c){var d={},e=null;b&&a&&a.runtimeAlias&&a.repeat&&a.repeat.selectable&&(e=c.page.getAllAvailableParameters(b.page),e[a.runtimeAlias]&&e[a.runtimeAlias].properties.record?(d.select={items:{type:"array",items:{type:"object",properties:e[a.runtimeAlias].properties.record.properties}}},d.deselect={}):console.error("Could not get trigger because we could not find the definition for: "+
a.runtimeAlias));b&&a&&a.runtimeAlias&&a.repeat&&(e=c.page.getAllAvailableParameters(b.page),e[a.runtimeAlias]&&e[a.runtimeAlias].properties.record&&(d.update={type:"object",properties:e[a.runtimeAlias].properties.record.properties}));e&&(d.load={type:"array",items:{properties:e[a.runtimeAlias].properties.record.properties}});return d},getState:function(a,b,c,d){var e={};if(a.repeat){e.recordIndex={type:"int64"};if("operation"!=a.repeat.type&&null!=a.repeat.type||!a.repeat.operation)if("array"!=a.repeat.type&&
null!=a.repeat.type||!a.repeat.array)nabu.page.providers("page-repeat").forEach(function(t){t.name==a.repeat.type&&(e.record={properties:t.getDefinition(a)},e.records={type:"array",items:e.record})});else{b={};var g=a.repeat.array;(m=d.page.getChildDefinition({properties:c},g))||0!=g.indexOf("page.")||(m=d.page.getChildDefinition({properties:c},g.substring(5)));m&&m.items&&m.items.properties&&nabu.utils.objects.merge(b,m.items.properties);e.record={properties:b};e.records={type:"array",items:{properties:b}}}else if((c=
d.swagger.operations[a.repeat.operation])&&c.responses&&c.responses["200"]&&c.responses["200"].schema){var k={},m=d.swagger.resolve(c.responses["200"].schema);b=d.page.getArrays(m);0<b.length&&(b=d.page.getChildDefinition(m,b[0]))&&b.items&&b.items.properties&&nabu.utils.objects.merge(k,b.items.properties);m.properties&&Object.keys(m.properties).map(function(t){"array"==m.properties[t].type&&(t=m.properties[t].items,t.properties&&nabu.utils.objects.merge(k,t.properties))});e.record={properties:k};
e.records={type:"array",items:{type:"object",properties:e.record.properties}};a.repeat.raw&&(e.raw=m);var p={};(c=c.parameters)&&c.forEach(function(t){"record"!=t.name&&(p[t.name]=t)});e.filter={properties:p}}e.record&&a.repeat.selectable&&(e.selected={type:"array",items:{type:"object",properties:e.record.properties}});e.records&&a.repeat.arrayFilter&&(e.allRecords=e.records);if(a.repeat.localVariables&&a.repeat.localVariables.length){var q={};a.repeat.localVariables.forEach(function(t){if(t.name){var u=
null;if(t.template){var w=d.page.eval(t.template);w&&(u=d.page.getSchemaFromObject(w))}else u=t.definition?d.swagger.resolve(t.definition):{type:"string"};u&&(q[t.name]=t.isArray?{type:"array",items:u}:u)}});e.local={properties:q}}}return{properties:e}},getSlots:function(a){var b=["empty","loading","appendLoading"];a.repeat&&a.repeat.customSlots&&a.repeat.customSlots.length&&nabu.utils.arrays.merge(b,a.repeat.customSlots.map(function(c){return c.name}));return b},getChildComponents:function(a){return[{title:"Repeat Content",
name:"repeat-content",component:a.rows?"row":"column"},{title:"Repeat Message",name:"repeat-message",component:a.rows?"row":"column"},{title:"Repeat Empty Message",name:"repeat-empty",component:a.rows?"row":"column"},{title:"Repeat Loading Message",name:"repeat-loading",component:a.rows?"row":"column"}]},getActions:function(a,b,c){var d=[];if(a.repeat&&a.repeat.operation){var e={title:"Refresh",name:"refresh",input:{},output:{}},g=nabu.page.providers("page-renderer").filter(function(k){return"repeat"==
k.name})[0];g&&0<=g.getSpecifications(a).indexOf("pageable")&&(e.input.retainOffset={type:"boolean"});d.push(e)}else a.repeat&&(e=nabu.page.providers("page-repeat").filter(function(k){return k.name==a.repeat.type})[0])&&e.getActions&&nabu.utils.arrays.merge(e.getActions(a,b,c));b&&a&&a.runtimeAlias&&a.repeat&&a.repeat.selectable&&(b=c.page.getAllAvailableParameters(b.page),b[a.runtimeAlias]&&b[a.runtimeAlias].properties.record?(e={title:"Select",name:"select",input:{items:{type:"array",items:{type:"object",
properties:b[a.runtimeAlias].properties.record.properties}},append:{type:"boolean"}},output:{}},d.push(e)):console.error("Could not add select action because the definition could not be found for: "+a.runtimeAlias));a.repeat&&a.repeat.customSlots&&a.repeat.customSlots.length&&(e={title:"Toggle Slot",name:"toggle-slot",input:{slot:{type:"string"},index:{type:"int64"},show:{type:"boolean"}},output:{}},d.push(e));return d},getSpecifications:function(a){var b=[];if(a.repeat&&("operation"==a.repeat.type||
null==a.repeat.type)&&a.repeat.operation){var c=application.services.swagger.operations[a.repeat.operation];c&&(c=c.parameters.map(function(d){return d.name}),0<=c.indexOf("limit")&&0<=c.indexOf("offset")&&(b.push("pageable"),b.push("browseable")),0<=c.indexOf("orderBy")&&b.push("orderable"))}else a.repeat&&(c=nabu.page.providers("page-repeat").filter(function(d){return d.name==a.repeat.type})[0])&&c.getSpecifications&&nabu.utils.arrays.merge(c.getSpecifications(a));return b}});
var $$rendererInstanceCounter=0;
Vue.component("renderer-repeat",{template:"#renderer-repeat",mixins:[nabu.page.mixins.renderer],props:{page:{type:Object,required:!0},target:{type:Object,required:!0},parameters:{type:Object,required:!1},edit:{type:Boolean,required:!1},childComponents:{type:Object,required:!1}},data:function(){return{loadPromise:null,destroyed:!1,repeatTimer:null,created:!1,loadCounter:0,instanceCounter:$$rendererInstanceCounter++,loading:!1,appendLoading:!1,fragmentPage:null,fragmentPages:{},position:0,lastParameters:null,
lastFilter:null,activatedSlots:{},state:{raw:{},selected:[],order:{by:[]},filter:{},records:[],allRecords:[],paging:{current:0,total:0,pageSize:0,rowOffset:0,totalRowCount:0}}}},created:function(){var a=this;this.target.repeat&&this.target.repeat.defaultOrderBy&&nabu.utils.arrays.merge(this.state.order.by,this.target.repeat.defaultOrderBy.map(function(b){return b.name+" "+(b.direction?b.direction:"asc")+(b.nulls?" "+b.nulls:"")}));this.mergeParameters();this.target.repeat&&this.target.repeat.customSlots&&
this.target.repeat.customSlots.length&&this.target.repeat.customSlots.forEach(function(b){Vue.set(a.activatedSlots,b.name,[])});this.loadPages();this.watchArray();this.lastFilter=JSON.stringify(this.normalizeParametersForComparison(this.state.filter));this.target.repeat&&this.target.repeat.waitForPageLoad||this.loadData();this.target.repeat&&this.target.repeat.localVariables&&this.target.repeat.localVariables.forEach(function(b){Vue.set(a.state.local,b.name,null)})},mounted:function(){},computed:{alias:function(){return"fragment-renderer-repeat-"+
this.instanceCounter},operationParameters:function(){var a={},b=this.$services.page.getPageInstance(this.page,this),c=this;this.target.repeat&&this.target.repeat.bindings&&Object.keys(this.target.repeat.bindings).map(function(d){if(c.target.repeat.bindings[d]){var e=c.$services.page.getBindingValue(b,c.target.repeat.bindings[d],c);null!=e&&"undefined"!=typeof e&&(a[d]=e)}});return a}},watch:{"$services.page.stable":function(a){if(a&&!this.created&&this.target.repeat&&this.target.repeat.waitForPageLoad){var b=
this;Vue.nextTick(function(){b.lastFilter=JSON.stringify(b.normalizeParametersForComparison(b.state.filter));b.created=!0;b.loadData()})}},"$services.page.editing":function(a){!a&&!this.created&&this.target.repeat&&this.target.repeat.waitForPageLoad&&(this.created=!0,this.loadData())},parameters:{deep:!0,handler:function(a,b){a=JSON.stringify(this.normalizeParametersForComparison(a));this.lastParameters!=a&&this.created&&this.target.repeat.enableParameterWatching&&(this.mergeParameters(),this.loadData());
this.lastParameters=a}},operationParameters:function(){this.loadData()},"state.filter":{deep:!0,handler:function(a){this.created&&(a=JSON.stringify(this.normalizeParametersForComparison(a)),this.lastFilter!=a&&this.loadData(),this.lastFilter=a)}},"state.order.by":function(){this.created&&this.loadData()}},beforeDestroy:function(){this.destroyed=!0;this.unloadPages();this.repeatTimer&&clearTimeout(this.repeatTimer)},methods:{repeatSetter:function(a,b,c,d,e){e||!a.fragmentParent||this.target.runtimeAlias&&
(b==this.target.runtimeAlias||"page."+b==this.target.runtimeAlias||0==b.indexOf(this.target.runtimeAlias+".")||0==b.indexOf("page."+this.target.runtimeAlias+"."))?a.internalSet(b,c,d):(a.internalSet(b,c,d),a.fragmentParent.set(b,c,d))},collapseAllSlots:function(){var a=this;Object.keys(this.activatedSlots).forEach(function(b){a.activatedSlots[b].splice(0)})},getAdditionalSlots:function(a){var b=[],c=this;Object.keys(this.activatedSlots).forEach(function(d){0<=c.activatedSlots[d].indexOf(a)&&b.push(d)});
return b},normalizeParametersForComparison:function(a){a=JSON.parse(JSON.stringify(a));var b=function(c){Object.keys(c).forEach(function(d){var e=c[d];null==e?delete c[d]:e instanceof Array&&0==e.length?delete c[d]:""===e?delete c[d]:"object"==typeof e&&b(e)})};b(a);return a},update:function(a,b,c,d){return this.$services.triggerable.trigger(this.target,"update",a,this)},mergeParameters:function(){var a=this,b=this.created=!1;Object.keys(this.target.rendererBindings).forEach(function(c){if(a.target.rendererBindings[c]){var d=
a.$services.page.getValue(a.state,c),e=a.$services.page.getValue(a.parameters,c);d!=e&&(a.$services.page.setValue(a.state,c,e),b=!0)}});return b},getOrderByFields:function(){var a=[];if(this.target.repeat&&this.target.repeat.operation){var b=this.$services.swagger.operation(this.target.repeat.operation);if(b&&b.parameters&&b.parameters.filter(function(d){return"orderBy"==d.name})[0]&&b.responses["200"]&&b.responses["200"].schema){b=this.$services.swagger.resolve(b.responses["200"].schema);var c=this.$services.page.getArrays(b);
0<c.length&&(b=this.$services.page.getChildDefinition(b,c[0]))&&b.items&&b.items.properties&&nabu.utils.arrays.merge(a,Object.keys(b.items.properties))}}return a},getCounter:function(){return this.$services.page.pageCounter++},getPageType:function(){var a=this,b=null,c=this.$services.page.getTargetPath(this.getRootPage().page.content,this.target.id);c.reverse();this.parameters.pageType?b=this.parameters.pageType:c.forEach(function(d){if(d.renderer&&!b){var e=a.$services.page.getRenderer(d.renderer);
e&&e.getPageType&&(b=e.getPageType(d))}});null==b&&this.page.content.pageType&&(b=this.page.content.pageType+"-child");return{pageType:b,path:c}},getRootPage:function(){for(var a=this.$services.page.getPageInstance(this.page,this);a.fragmentParent;)a=a.fragmentParent;return a},getCellClasses:function(){var a=null,b=this.getPageType();if(b.pageType){var c=nabu.page.providers("page-type").filter(function(d){return d.name==b.pageType})[0];c&&this.target.rows&&c.cellComponent instanceof Function?a=c.cellComponent(this.target,
b.path,this.page):c&&this.target.rows&&c.cellComponent&&(a=c.cellComponent)}a||="page-column";c=["is-"+a];nabu.utils.arrays.merge(c,this.getChildComponentClasses(a));return c},getComponentClassesForEdit:function(){var a=[];"div"==this.getComponent()&&(this.target.cells?(a.push("page-row"),a.push("is-page-row")):(a.push("page-column"),a.push("is-page-column")));return a},getComponentClassesForMessage:function(){var a=[];"div"==this.getMessageComponent()&&(this.target.cells?(a.push("page-row"),a.push("is-page-row")):
(a.push("page-column"),a.push("is-page-column")));return a},getComponent:function(){var a=this.getPageType(),b=null;if(a.pageType){var c=nabu.page.providers("page-type").filter(function(d){return d.name==a.pageType})[0];c&&this.target.rows&&c.cellTag instanceof Function?b=c.cellTag(null,this.target,null,this.edit,a.path,this.page):c&&this.target.rows&&c.cellTag?b=c.cellTag:c&&this.target.cells&&c.rowTag instanceof Function?b=c.rowTag(this.target,null,this.edit,a.path,this.page):c&&this.target.cells&&
c.rowTag&&(b=c.rowTag)}return b?b:"div"},getMessageComponent:function(){var a=this.getPageType();if(a.pageType){var b=nabu.page.providers("page-type").filter(function(c){return c.name==a.pageType})[0];if(b&&b.messageTag instanceof Function)return b.messageTag(this.target);if(b&&b.messageTag)return b.messageTag;if(b&&this.target.rows&&b.cellTag instanceof Function)return b.cellTag(null,this.target);if(b&&this.target.rows&&b.cellTag)return b.cellTag;if(b&&this.target.cells&&b.rowTag instanceof Function)return b.rowTag(this.target);
if(b&&this.target.cells&&b.rowTag)return b.rowTag}return"div"},onDragStart:function(a,b){this.$services.page.setDragData(a,"data-"+(this.target.repeat.dragName?this.target.repeat.dragName:"default"),JSON.stringify(b))},watchArray:function(){if(this.target.repeat&&this.target.repeat.array){var a=this,b=this.$services.page.getPageInstance(this.page,this);if(0==this.target.repeat.array.indexOf("parent.")){var c=this.$services.page.pages.filter(function(k){return k.content.name==a.page.content.pageParent})[0];
null!=c&&(b=this.$services.page.getPageInstance(c,b))}var d=this.target.repeat.array;0==d.indexOf("parent.")&&(d=d.substring(7));c=b.get(d);if(null==c)var e=b.$watch("variables",function(k){null!=b.get(d)&&(a.loadData(),e(),a.watchArray())},{deep:!0});else{var g=JSON.stringify(c);0==d.indexOf("page.")&&(d=d.substring(5));e=b.$watch("variables."+d,function(k){JSON.stringify(b.get(d))!=g&&(a.loadData(),e(),a.watchArray())},{deep:!0})}}},getKey:function(a){return a&&a.id?a.id:a&&"string"==typeof a?a:
a&&a.hasOwnProperty("$position")?a.$position:this.state.records.indexOf(a)},handleClick:function(a,b){this.target.repeat&&this.target.repeat.selectable&&!this.target.repeat.disableMouseSelection&&this.runAction("select",{items:[b],append:a.ctrlKey||a.metaKey||this.target.repeat.alwaysMultiselect})},runAction:function(a,b){var c=this;if("jump-page"==a)return this.loadData(b.page);if("previous-page"==a)this.state.paging.current&&this.loadData(this.state.paging.current-1);else if("next-page"==a){if(this.state.paging.current<
this.state.paging.total-1)return this.loadData(this.state.paging.current+1)}else{if("refresh"==a)return this.loadData(b&&b.retainOffset?this.state.paging.current:0);if("list-available"==a)return this.$services.q.resolve({available:this.getOrderByFields()});if("order-by"==a)b.append||this.state.order.by.splice(0),b.by&&(b.by.map(function(g){return g.replace(/[\s]+.*$/,"")}).forEach(function(g){c.state.order.by.filter(function(k){return k==g||0==k.indexOf(g+" ")}).forEach(function(k){c.state.order.by.splice(c.state.order.by.indexOf(k),
1)})}),this.state.order.by.unshift.apply(this.state.order.by,b.by.filter(function(g){return 0>g.indexOf(" none")})));else if("select"==a){if(this.target.repeat&&this.target.repeat.selectable){b.append&&this.target.repeat.multiSelectable||this.state.selected.splice(0);b.items&&b.items.forEach(function(g){0>c.state.selected.indexOf(g)?c.state.selected.push(g):b.append&&1==b.items.length&&c.state.selected.splice(c.state.selected.indexOf(g),1)});if(this.state.selected.length)return this.$services.triggerable.trigger(this.target,
"select",this.state.selected,this);this.unselectAll();return this.$services.q.resolve()}}else if("toggle-slot"==a){a=this.target.repeat.customSlots.filter(function(g){return g.name==b.slot})[0];if(!a||null==b.index)return this.$services.q.reject();var d=parseInt(b.index),e=this.activatedSlots[a.name].indexOf(d);(null==b.show?0>e:b.show)?0>e&&(a.singleOpen&&this.activatedSlots[a.name].splice(0),this.activatedSlots[a.name].push(d)):0<=e&&this.activatedSlots[a.name].splice(e,1);return this.$services.q.resolve()}}return this.$services.q.reject()},
unselectAll:function(){this.state.selected.splice(0);this.$services.triggerable.untrigger(this.target,"select",this);this.$services.triggerable.trigger(this.target,"deselect",this)},getRuntimeState:function(){return this.state},getPageInstance:function(){return this.$services.page.getPageInstance(this.page,this)},getParameters:function(a){var b={};this.$services.page.getPageInstance(this.page,this);this.target.runtimeAlias&&(b[this.target.runtimeAlias]={filter:this.state.filter,record:a,recordIndex:this.state.records.indexOf(a),
records:this.state.records,allRecords:this.state.allRecords});return b},getVariables:function(){return this.$services.page.getPageInstance(this.page,this).variables},unloadPages:function(){this.unloadPage();var a=this;this.target.repeat&&this.target.repeat.customSlots&&this.target.repeat.customSlots.length&&this.target.repeat.customSlots.forEach(function(b){a.unloadPage(b.name)})},unloadPage:function(a){this.$services.router.unregister(this.alias+(a?"-"+a:""))},beforeMount:function(a){this.mapVariables(a)},
mapVariables:function(a){var b=this.$services.page.getPageInstance(this.page,this),c=this;Object.keys(b.variables).forEach(function(d){d!=c.target.runtimeAlias&&(a.set?a.variables[d]!=b.variables[d]&&a.set(d,b.variables[d]):a[d]!=b.variables[d]&&Vue.set(a,d,b.variables[d]))})},mounted:function(a){var b=this.$services.page.getPageInstance(this.page,this);a.$on("hook:beforeDestroy",function(){console.debug("Destroying repeated fragmented page")});a.subscribe("$any",function(e,g){"$load"!=e&&b.emit(e,
g)});var c=this,d=b.$watch("variables",function(){a&&c.mapVariables(a)},{deep:!0});a.$on("hook:beforeDestroy",function(){d()});this.target.repeat.localVariables&&this.target.runtimeAlias&&this.target.repeat.localVariables.forEach(function(e){e.defaultValue&&e.name&&c.$services.page.setValue(a.variables,c.target.runtimeAlias+".local."+e.name,c.$services.page.eval(e.defaultValue,a.variables,a))})},uniquify:function(){var a=this;this.state.records.forEach(function(b){b.hasOwnProperty("$position")&&b.$position>=
a.position&&(a.position=b.$position+1)});this.state.records.forEach(function(b){b.hasOwnProperty("$position")||"string"==typeof b||b instanceof String||(b.$position=a.position++)})},lazyLoad:function(a){if(null==this.lazyPromise&&this.state.paging&&this.target.repeat.scrollLoad&&null!=this.state.paging.current){var b=this.state.paging.current+1;if(null!=this.state.paging.total&&0!=this.state.paging.total&&this.state.paging.current>=this.state.paging.total-1)return!1;if(this.state.records.indexOf(a)>=
Math.floor(.9*this.state.records.length)){this.lazyPromise=this.loadData(b,!0);var c=this;this.lazyPromise.then(function(){c.lazyPromise=null},function(){c.lazyPromise=null})}}},loadData:function(a,b){this.loadCounter++;var c=this;this.collapseAllSlots();c.repeatTimer&&(clearTimeout(c.repeatTimer),c.repeatTimer=null);0<this.state.selected.length&&this.unselectAll();this.loadPromise&&this.loadPromise.abort&&this.loadPromise.abort();this.loadPromise=null;if(this.target.repeat&&("operation"==this.target.repeat.type||
null==this.target.repeat.type)&&this.target.repeat.operation){var d={};nabu.utils.objects.merge(d,this.operationParameters);this.state.filter&&Object.keys(this.state.filter).forEach(function(k){"record"!=k&&(d[k]=c.state.filter[k])});this.state.order.by.length&&(d.orderBy=this.state.order.by);null!=a&&(null==d.limit&&(d.limit=10),d.offset=d.limit*a);d.$serviceContext=this.state.$serviceContext?this.state.$serviceContext:this.$services.page.getPageInstance(this.page,this).getServiceContext();b?this.appendLoading=
!0:(this.loading=!0,c.state.records.splice(0),c.state.allRecords.splice(0));this.loadPromise=this.$services.swagger.execute(this.target.repeat.operation,d).then(function(k){Object.keys(c.state.raw).forEach(function(t){Vue.set(c.state.raw,t,null)});b||(c.state.records.splice(0),c.state.allRecords.splice(0));if(k){Object.keys(k).forEach(function(t){Vue.set(c.state.raw,t,k[t])});var m=Object.keys(c.$services.data.getArrayOutputField(c.target.repeat.operation))[0];(function(t){var u=t[m];null==u&&(u=
[]);u.forEach(function(w,y){w&&(w.$position=c.position++)});nabu.utils.arrays.merge(c.state.allRecords,u);c.target.repeat.arrayFilter?nabu.utils.arrays.merge(c.state.records,u.filter(function(w){return c.$services.page.isCondition(c.target.repeat.arrayFilter,w,c,function(y,B){return"records"==y?u:"record"==y?w:c.$value(y,B)})})):nabu.utils.arrays.merge(c.state.records,u)})(k);var p=!1,q=function(t){Object.keys(t).forEach(function(u){"object"!==typeof t[u]||null==t[u]||p||(null!=t[u].current&&null!=
t[u].total&&(nabu.utils.objects.merge(c.state.paging,t[u]),p=!0),p||q(t[u]))})};q(k)}c.uniquify();c.loading=!1;c.appendLoading=!1;c.created=!0;c.target.repeat.refreshInterval&&!c.destroyed&&(c.repeatTimer=setTimeout(function(){c.loadData(a)},c.target.repeat.refreshInterval))},function(k){c.loading=!1;c.appendLoading=!1;c.created=!0})}else if(this.target.repeat&&("array"==this.target.repeat.type||null==this.target.repeat.type)&&this.target.repeat.array){b||(this.state.records.splice(0),this.state.allRecords.splice(0));
var e=this.$services.page.getPageInstance(this.page,this).get(this.target.repeat.array);e&&(nabu.utils.arrays.merge(this.state.allRecords,e),this.target.repeat.arrayFilter&&(e=e.filter(function(k){return c.$services.page.isCondition(c.target.repeat.arrayFilter,k,c,function(m,p){return"records"==m?e:"record"==m?k:c.$value(m,p)})})),nabu.utils.arrays.merge(this.state.records,e));c.uniquify();c.created=!0;this.loadPromise=this.$services.q.resolve(e)}else{var g=nabu.page.providers("page-repeat").filter(function(k){return k.name==
c.target.repeat.type})[0];g&&g.loadData&&(this.loadPromise=g.loadData(c.target,c.state,a,b))}this.loadPromise&&this.loadPromise.then&&this.loadPromise.then(function(){return c.$services.triggerable.trigger(c.target,"load",c.state.records,c)});return this.loadPromise},loadPages:function(){this.loadPage();var a=this;this.target.repeat&&this.target.repeat.customSlots&&this.target.repeat.customSlots.length&&this.target.repeat.customSlots.forEach(function(b){a.loadPage(b.name)})},loadPage:function(a){var b=
this.$services.page.getPageInstance(this.page,this);this.unloadPage(a);if(this.target.runtimeAlias){var c={rows:[],counter:1,variables:[],query:[],actions:[],"class":null,initial:!1,menuX:0,menuY:0,states:[],category:"Other Category",slow:!1,name:this.alias+(a?"-"+a:""),parameters:[],readOnly:!0,pageType:this.getPageType().pageType,optimizeRows:!1};c.parameters.push({name:this.target.runtimeAlias,type:"string",format:null,default:null,global:!1,listeners:[]});var d=function(m){return!a&&!m.rendererSlot||
a==m.rendererSlot};if(this.target.rows)nabu.utils.arrays.merge(c.rows,this.target.rows.filter(d)),c.repeatType="cell";else if(this.target.cells){c.repeatType="row";var e={id:this.target.id,state:{},cells:[],class:null,customId:null,instances:{},condition:null,direction:null,align:null,on:null,collapsed:!1,name:null,rendererSlot:this.target.rendererSlot,styleVariables:this.target.styleVariables};e.triggers=this.target.triggers;nabu.utils.arrays.merge(e.cells,this.target.cells.filter(d));c.rows.push(e)}var g=
{name:c.name,content:c};a?this.fragmentPages[a]=g:this.fragmentPage=g;var k=this;this.$services.router.register({alias:g.name,enter:function(m,p){var q=function(w){Object.keys(b.variables).forEach(function(y){y!=k.target.runtimeAlias&&(w.set?w.variables[y]!=b.variables[y]&&w.set(y,b.variables[y]):w[y]!=b.variables[y]&&Vue.set(w,y,b.variables[y]))})},t=null,u=b.$watch("variables",function(){t&&q(t)},{deep:!0});return t=new nabu.page.views.Page({template:"n-page-optimized",propsData:{page:g,parameters:m,
stopRerender:m?m.stopRerender:!1,pageInstanceId:k.$services.page.pageCounter++,masked:p},beforeDestroy:function(){u()},beforeMount:function(){q(this)}})},isPage:!1,initial:!1,properties:g.content.properties?g.content.properties:[]})}}}});
Vue.component("renderer-repeat-configure",{template:"#renderer-repeat-configure",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1},childComponents:{type:Object,required:!1}},created:function(){this.target.repeat||Vue.set(this.target,"repeat",{});this.target.repeat.bindings||Vue.set(this.target.repeat,"bindings",{});this.target.repeat.defaultOrderBy||Vue.set(this.target.repeat,"defaultOrderBy",[]);this.target.repeat.type||(this.target.repeat.operation?
Vue.set(this.target.repeat,"type","operation"):this.target.repeat.array&&Vue.set(this.target.repeat,"type","array"));this.target.repeat.customSlots||Vue.set(this.target.repeat,"customSlots",[]);this.target.repeat.localVariables||Vue.set(this.target.repeat,"localVariables",[])},computed:{operationParameters:function(){var a=[];if(this.target.repeat&&this.target.repeat.operation&&this.$services.swagger.operations[this.target.repeat.operation]){var b=this.$services.swagger.operations[this.target.repeat.operation].parameters;
b&&nabu.utils.arrays.merge(a,b.map(function(c){return c.name}))}return a}},methods:{getRepeatTypes:function(a){var b=[];b.push({name:"operation",title:"The return value of a REST call"});b.push({name:"array",title:"The values available in an array"});nabu.utils.arrays.merge(b,nabu.page.providers("page-repeat"));a&&(b=b.filter(function(c){return c.name&&0<=c.name.toLowerCase().indexOf(a.toLowerCase())||c.title&&0<=c.title.toLowerCase().indexOf(a.toLowerCase())}));return b},getRepeatConfigurator:function(){var a=
this;if(this.target.repeat.type&&"operation"!=this.target.repeat.type&&"array"!=this.target.repeat.type){var b=nabu.page.providers("page-repeat").filter(function(c){return c.name==a.target.repeat.type})[0];return b?b.configurator:null}},getOrderByFields:function(a){var b=[];if(this.target.repeat&&this.target.repeat.operation){var c=this.$services.swagger.operation(this.target.repeat.operation);if(c&&c.parameters&&c.parameters.filter(function(e){return"orderBy"==e.name})[0]&&c.responses["200"]&&c.responses["200"].schema){c=
this.$services.swagger.resolve(c.responses["200"].schema);var d=this.$services.page.getArrays(c);0<d.length&&(c=this.$services.page.getChildDefinition(c,d[0]))&&c.items&&c.items.properties&&nabu.utils.arrays.merge(b,Object.keys(c.items.properties))}}return b.filter(function(e){return!a||0<=e.toLowerCase().indexOf(a.toLowerCase())})}}});
nabu.page.provide("page-type",{name:"table-page",rowTag:function(a,b,c,d,e){if("body"==a.rendererSlot)return"tbody";if(3<=d.length&&"body"==d[2].rendererSlot)return"renderer-table-body-cell";b=2<=d.length&&"table"==d[1].renderer;return(b|=1==d.length)?"cell"==e.content.repeatType&&a.repeat?"th":"tr":null},cellTag:function(a,b,c,d,e,g){if("cell"==g.content.repeatType&&b.repeat)return null;if(2<=e.length&&"body"==e[1].rendererSlot)return"tr";a=3<=e.length&&"table"==e[2].renderer;return(a|=2==e.length)&&
2<=e.length&&"header"==e[1].rendererSlot?"renderer-table-header-cell":a?"renderer-table-body-cell":null},repeatTag:function(a){return"tbody"},cellComponent:function(a,b,c){if("cell"==c.content.repeatType&&a.repeat)return null;if(2<=b.length&&"body"==b[1].rendererSlot)return"table-row";a=3<=b.length&&"table"==b[2].renderer;return(a|=2==b.length)?"table-column":null},rowComponent:function(a,b,c){a=2<=b.length&&"table"==b[1].renderer;return(a|=1==b.length)&&"cell"==c.content.repeatType||3<=b.length&&
"body"==b[2].rendererSlot?"table-column":a?"table-row":null},repeatComponent:function(a){return"table-body"},messageTag:function(a){return"renderer-table-message"}});nabu.page.provide("page-type",{name:"table-page-child",rowTag:function(a,b,c,d){},rowComponent:function(a,b){}});
nabu.page.provide("page-renderer",{title:"Table",name:"table",type:["cell"],component:"renderer-table",configuration:"renderer-table-configure",cssComponent:"table",getChildComponents:function(a){return[{title:"Table",name:"table",component:"table"}]},getPageType:function(a){return"table-page"},getSlots:function(a){return["header","body","footer"]},getChildConfig:function(a,b,c){if(b.rows||b.cells&&3<=c.length&&"body"==c[2].rendererSlot)return"renderer-table-cell-configure"}});
Vue.component("renderer-table",{template:"#renderer-table",props:{page:{type:Object,required:!0},target:{type:Object,required:!0},edit:{type:Boolean,required:!1},childComponents:{type:Object,required:!1}},methods:{hasDefaultElements:function(){var a=this.target.rows?this.target.rows:this.target.cells;return a&&0<a.filter(function(b){return!b.rendererSlot}).length}}});Vue.component("renderer-table-configure",{template:"#renderer-table-configure"});
Vue.component("renderer-table-cell-configure",{template:"#renderer-table-cell-configure",props:{cell:{type:Object},row:{type:Object},page:{type:Object}},data:function(){return{target:null}},created:function(){this.cell?this.target=this.cell:this.row&&(this.target=this.row);this.target&&!this.target.table&&Vue.set(this.target,"table",{})}});Vue.component("renderer-table-message",{template:"#renderer-table-message",props:{target:{type:Object},page:{type:Object}}});
Vue.component("renderer-table-body-cell",{template:"#renderer-table-body-cell",props:{target:{type:Object},page:{type:Object}},data:function(){return{elementPromise:null}},created:function(){this.elementPromise=this.$services.q.defer()},ready:function(){this.elementPromise.resolve(this.$el)},computed:{colspan:function(){return this.target&&this.target.table?this.target.table.colspan:null},label:function(){if(this.target&&this.target.table&&this.target.table.embeddedLabel)return this.$services.page.interpret(this.$services.page.translate(this.target.table.embeddedLabel),
this);var a=this.$services.page.getPageInstance(this.page,this),b=a;a=this.$services.page.getRootPage(a);var c=this.$services.page.getTargetPath(a.page.content,this.target.id);if(2<=c.length){a=c[c.length-3];if(!a.rows)return null;if(a=a.rows.filter(function(k){return"header"==k.rendererSlot})[0]){for(var d=c[c.length-2],e=d.cells.indexOf(c[c.length-1]),g=c=0;g<=e;g++)d.cells[g].table&&d.cells[g].table.colspan?c+=parseInt(d.cells[g].table.colspan):c++;d=0;e=null;for(g=0;g<a.cells.length;g++)if(a.cells[g].table&&
a.cells[g].table.colspan?d+=parseInt(a.cells[g].table.colspan):d++,d<=c)e=a.cells[g];else break;if(e&&e.state.content)return this.$services.typography.replaceVariables(b,e.state,e.state.content,this.elementPromise)}}return null}}});Vue.component("renderer-table-header-cell",{template:"#renderer-table-header-cell",props:{target:{type:Object},page:{type:Object}},computed:{colspan:function(){return this.target&&this.target.table?this.target.table.colspan:null}}});
Vue.component("data-field-picker",{template:"#data-field-picker",props:{value:{type:Array,required:!0},fields:{type:Array,required:!0}},data:function(){return{result:[]}},computed:{allChecked:function(){return 0==this.result.filter(function(a){return!a.checked}).length}},created:function(){nabu.utils.arrays.merge(this.result,this.fields.map(function(a){return{name:a,checked:!0}}));console.log("fields are",this.result)},methods:{checkAll:function(){this.result.forEach(function(a){a.checked=!0})},uncheckAll:function(){this.result.forEach(function(a){a.checked=
!1})},upAll:function(a){var b=this.result.indexOf(a);0<b&&(this.result.splice(b,1),this.result.unshift(a))},up:function(a){var b=this.result.indexOf(a);0<b&&(this.result.splice(b,1),this.result.splice(b-1,0,a))},down:function(a){var b=this.result.indexOf(a);b<this.result.length-1&&(this.result.splice(b,1),this.result.splice(b+1,0,a))},downAll:function(a){var b=this.result.indexOf(a);b<this.result.length-1&&(this.result.splice(b,1),this.result.splice(this.result.length-1,0,a))}},watch:{result:{deep:!0,
handler:function(){this.value.fields.splice(0);nabu.utils.arrays.merge(this.value.fields,this.result.filter(function(a){return a.checked}).map(function(a){return a.name}))}}}});
nabu.page.provide("page-specification",{name:"pageable",state:{paging:{properties:{current:{type:"int64"},total:{type:"int64"},pageSize:{type:"int64"},rowOffset:{type:"int64"},totalRowCount:{type:"int64"}}}},actions:[{title:"Jump to page",name:"jump-page",input:{page:{type:"int64"}},output:{current:{type:"int64"},total:{type:"int64"},pageSize:{type:"int64"},rowOffset:{type:"int64"},totalRowCount:{type:"int64"}}},{title:"Get Paging",name:"get-paging",input:{},output:{current:{type:"int64"},total:{type:"int64"},
pageSize:{type:"int64"},rowOffset:{type:"int64"},totalRowCount:{type:"int64"}}}]});nabu.page.provide("page-specification",{name:"browseable",actions:[{title:"Next Page",name:"next-page",input:{append:{type:"boolean"}},output:{hasMore:{type:"boolean"}}},{title:"Previous Page",name:"previous-page",input:{},output:{hasMore:{type:"boolean"}}}]});
nabu.page.provide("page-specification",{name:"orderable",state:{order:{properties:{by:{type:"array",items:{type:"string"}}}}},actions:[{title:"Order By",name:"order-by",input:{by:{type:"array",items:{type:"string"}},append:{type:"boolean"}}},{title:"List available fields",name:"list-available",output:{available:{type:"array",items:{type:"string"}}}}]});if(!application)var application={};
application.configuration={scheme:{http:"http",ws:"ws"},url:"unavailable",host:"unavailable",root:"unavailable",cookiePath:"unavailable",mobile:0<=navigator.userAgent.toLowerCase().indexOf("mobi"),development:!1,applicationLanguage:"unavailable",requestEnrichers:[],interpretValues:!0,alwaysLogIn:!1};if("unavailable"==application.configuration.root){var base=document.head.querySelector("base");application.configuration.root=base?base.getAttribute("href"):"/"}application.views={};
application.components={};application.definitions={};application.loaders=[];application.bootstrap=function(a){application.services?a(application.services):application.loaders.push(a)};
application.initialize=function(){application.services=new nabu.services.ServiceManager({mixin:function(a){Vue.mixin({computed:{$configuration:function(){return application.configuration},$services:function(){return a},$views:function(){return application.views},$application:function(){return application}}})},q:nabu.services.Q,cookies:nabu.services.Cookies,swagger:application.definitions.Swagger,loader:function(a){this.$initialize=function(){return function(b,c){nabu.utils.elements.clear(b);var d=
document.createElement("span");d.setAttribute("class","n-icon n-icon-spinner fa spinner"+(c?" "+c:""));d.setAttribute("style","display: block; text-align: center");b.appendChild(d);return d}}},router:function(a){this.$initialize=function(){return new nabu.services.VueRouter({useParents:!0,useProps:!0,useHash:!1,unknown:function(b,c,d){return a.router.get("notFound")},authorizer:function(b,c,d){b=null;if("login"==c.alias)return!0;for(var e=c;e;)if(e.roles&&(b=null==b?e.roles:b.filter(function(k){return 0<=
e.roles.indexOf(k)})),e.parent)e=a.router.get(e.parent);else break;if(b&&1<=b.length&&a.user){if(0>b.indexOf("$guest")&&!a.user.loggedIn)return a.vue.attemptedRoute.alias=c.alias,a.vue.attemptedRoute.parameters=d,localStorage.setItem("redirect-to",window.location.toString()),{alias:"login",mask:!0};if(a.user.hasRole){var g=!1;for(d=0;d<b.length;d++)if(a.user.hasRole(b[d])){g=!0;break}if(!g)return{alias:"home"}}else if(0>b.indexOf("$user")&&a.user.loggedIn)return{alias:"home"}}if(c.actions&&1<=c.actions.length&&
a.user&&a.user.hasAction){b=!1;for(d=0;d<c.actions.length;d++)if(a.user.hasAction(c.actions[d])){b=!0;break}if(!b)return{alias:a.user.loggedIn?"home":"login"}}},chosen:function(b,c,d){b&&(c.slow||null!=d&&d.slow)&&nabu.utils.vue.render({target:b,content:"\x3cdiv class\x3d'page-loader-inline-container'\x3e\x3cdiv class\x3d'page-loader'\x3e\x3c/div\x3e\x3c/div\x3e"})},enter:function(b,c,d,e,g){!g&&c.url&&(a.vue.previousRoute=a.vue.lastRoute,a.vue.route=c.alias,a.vue.parameters=d,a.page.chosenRoute=
c.alias,a.vue.lastRoute=c,window.scrollTo(0,0))}})}},vue:function(){this.$initialize=function(){return new Vue({el:"body",data:function(){return{route:null,parameters:null,lastRoute:null,attemptedRoute:{}}},methods:{updateUrlParameter:function(a,b){if(null!=this.lastRoute){var c=this.lastRoute.parameters?nabu.utils.objects.clone(this.lastRoute.parameters):{};c[a]=b;(a=this.$services.router.router.template(this.lastRoute.alias,c))&&this.$services.router.router.updateUrl(this.lastRoute.alias,a,c,this.lastRoute.query)}}}})}},
routes:application.routes,loaders:function(a){this.$initialize=function(){for(var b=[],c=0;c<application.loaders.length;c++){var d=application.loaders[c](a);d&&d.then&&b.push(d)}return a.q.all(b)}}});return application.services.$initialize()};application||={};application.routes=function(a){};application||={};application.definitions||(application.definitions={});
application.definitions.Swagger=function(a){var b=(application&&application.configuration?application.configuration.root:"/")+"swagger.json";this.$initialize=function(){var c=a.q.defer(),d=new nabu.services.SwaggerClient({remember:function(){if(a.user&&a.user.remember)return a.user.remember().then(function(){},function(){application.configuration.alwaysLogIn&&setTimeout(function(){a.router.route("login")},1)});var e=a.q.defer();e.reject();return e},parseError:!0});c.stage(d);nabu.utils.ajax({cache:!0,
url:b,bearer:null!=a.user?a.user.bearer:null}).then(function(e){d.loadDefinition(e.responseText);d.$clear=function(){return nabu.utils.ajax({url:b,bearer:null!=a.user?a.user.bearer:null}).then(function(g){d.loadDefinition(g.responseText)})};c.resolve(d)},function(e){c.reject(e)});return c}};
window.addEventListener("load",function(){application.bootstrap(function(a){nabu&&nabu.page&&nabu.page.provide&&(nabu.page.provide("page-function",{id:"cms.login",async:!0,implementation:function(b,c,d,e,g){c.user.login(b.username,b.password,b.remember,b.type,!0).then(e,g)},inputs:[{name:"username",required:!0,type:"string"},{name:"password",required:!0,type:"string"},{name:"remember",type:"boolean"},{name:"type",type:"string"}],outputs:[{name:"challengeType",required:!1,type:"string"},{name:"token",
required:!1,type:"string"}]}),nabu.page.provide("page-function",{id:"cms.logout",async:!0,implementation:function(b,c,d,e,g){d=c.user.logout();if(b.route){var k=function(){setTimeout(function(){c.router.route(b.route)},1)};1==b.routeImmediately||"true"==b.routeImmediately?k():d.then(k,k)}d.then(e,g)},inputs:[{name:"route",required:!1,type:"string"},{name:"routeImmediately",required:!1,type:"string"}]}),nabu.page.provide("page-function",{id:"cms.changeLanguage",async:!1,implementation:function(b,c,
d){c.language.current=b.language},inputs:[{name:"language",required:!0,type:"string"}]}),nabu.page.provide("page-function",{id:"cms.revoke",async:!0,inputs:[{name:"deviceId",required:!1,type:"array",items:{type:"string"}}]}))})});
Vue.service("user",{services:["q","swagger"],data:function(){return{id:null,language:null,roles:["$guest"],allowedPermissions:[],disallowedPermissions:[],permissions:[],contextualRoles:{},application:"moduleWeb.site.application",remembering:!1,canTimer:null,permissionsToCheck:[],permissionsBeingChecked:[],permissionCheckPromise:null,batchWaiting:!1,permissionBeingCheckedPromise:null,bearer:null,ltpStorage:{}}},computed:{loggedIn:function(){return null!=this.bearer},normalizedPermissions:function(){return this.permissions.map(function(a){a=
a.split(":");1==a.length?a=["default","$global",a[0]]:2==a.length&&(a=["default",a[0],a[1]]);return a})}},activate:function(a){this.remember().then(function(){a()},function(){a()})},methods:{downloadUrl:function(a,b,c){var d=this.$services.q.defer(),e=this,g=this.$services.swagger.operations[a];if(g){var k=null;g["x-temporary-id"]&&g["x-temporary-secret"]?c?this.ltp(a).then(function(m){if(m.authenticationId){var p={};nabu.utils.objects.merge(p,b);p[g["x-temporary-id"]]=m.authenticationId;p[g["x-temporary-secret"]]=
m.secret;d.resolve(e.$services.swagger.parameters(a,p).url)}else d.reject()}):(g["x-temporary-correlation-id"]&&(k=b[g["x-temporary-correlation-id"]]),this.$services.swagger.execute("nabu.cms.core.v2.security.web.otp",{serviceId:a,correlationId:k}).then(function(m){if(m.authenticationId){var p={};nabu.utils.objects.merge(p,b);p[g["x-temporary-id"]]=m.authenticationId;p[g["x-temporary-secret"]]=m.secret;d.resolve(e.$services.swagger.parameters(a,p).url)}else d.reject()},d)):d.resolve(e.$services.swagger.parameters(a,
b).url)}else d.reject();return d},loadCan:function(a){var b=this;nabu.utils.arrays.merge(b.permissionsToCheck,a);b.canTimer&&(clearTimeout(b.canTimer),b.canTimer=null);return b.permissionsToCheck.length?(b.permissionCheckPromise||(b.permissionCheckPromise=this.$services.q.defer()),a=function(){b.canTimer=setTimeout(function(){b.batchWaiting=!1;b.permissionBeingCheckedPromise=b.permissionCheckPromise;b.permissionCheckPromise=null;nabu.utils.arrays.merge(b.permissionsBeingChecked,b.permissionsToCheck.splice(0));
b.permissionsBeingChecked.length?b.$services.swagger.execute("nabu.cms.core.v2.security.shared.can",{body:{permissions:b.permissionsBeingChecked}}).then(function(c){b.permissionsBeingChecked.splice(0);c.allowed&&nabu.utils.arrays.merge(b.allowedPermissions,c.allowed);c.disallowed&&nabu.utils.arrays.merge(b.disallowedPermissions,c.disallowed);b.permissionBeingCheckedPromise.resolve(c);b.permissionBeingCheckedPromise=null},function(c){b.permissionsBeingChecked.splice(0);b.permissionBeingCheckedPromise.reject(c);
b.permissionBeingCheckedPromise=null}):(b.permissionBeingCheckedPromise.resolve(),b.permissionBeingCheckedPromise=null)},50)},b.permissionBeingCheckedPromise?b.batchWaiting||(b.permissionBeingCheckedPromise.then(a,a),b.batchWaiting=!0):a(),this.permissionCheckPromise):this.$services.q.resolve()},cant:function(a,b,c){var d=this.$services.q.defer();this.can(a,b,c).then(function(e){d.reject(e)},function(e){d.resolve(e)});return d},can:function(a,b,c,d){var e=this,g=function(y,B){null==y&&(y="default");
null==B&&(B="default");return y==B};"string"==typeof a&&(a={name:a,context:b,serviceContext:c});if(null!=a){a instanceof Array||(a=[a]);var k=function(y){return(y.name?y.name:"no-name")+"::"+(y.context?y.context:"no-context")+"::"+(y.serviceContext?y.serviceContext:"default")};if(1<a.length){var m={};a.forEach(function(y){var B=k(y);m[B]=y});a=Object.values(m)}if(a.length){var p=[],q=[];this.disallowedPermissions.forEach(function(y){for(var B=0;B<a.length;B++){var F=a[B];if(g(y.serviceContext,F.serviceContext)&&
y.name==F.name&&y.context==F.context){q.push(F);a.splice(B,1);break}}});if(q.length)return this.$services.q.reject(q);a.length&&this.allowedPermissions.forEach(function(y){for(var B=0;B<a.length;B++){var F=a[B];if(g(y.serviceContext,F.serviceContext)&&y.name==F.name&&y.context==F.context){p.push(F);a.splice(B,1);break}}});if(!a.length)return this.$services.q.resolve(p);if(!d){if(this.permissionCheckPromise){var t=this.permissionsToCheck.map(function(y){return k(y)});if(a.filter(function(y){return 0<=
t.indexOf(k(y))}).length){var u=this.$services.q.defer();this.permissionCheckPromise.then(function(){e.can(a).then(u,u)},u);return u}}if(this.permissionBeingCheckedPromise){var w=this.permissionsBeingChecked.map(function(y){return k(y)});if(a.filter(function(y){return 0<=w.indexOf(k(y))}).length)return u=this.$services.q.defer(),this.permissionBeingCheckedPromise.then(function(){e.can(a).then(u,u)},u),u}u=this.$services.q.defer();this.loadCan(a).then(function(){e.can(a,null,null,!0).then(u,u)},u);
return u}}}return this.$services.q.reject()},ltp:function(a){var b=this.$services.q.defer(),c=new Date;if(this.ltpStorage[a]&&nabu.utils.dates.addDuration("PT12H",this.ltpStorage[a].requested).getTime()>=c.getTime())return this.ltpStorage[a].promise.then(b),b;var d=this;this.ltpStorage[a]={requested:c,promise:this.$services.swagger.execute("nabu.cms.core.v2.security.web.ltp",{serviceId:a,duration:"P1D"}).then(function(e){e&&e.authenticationId?(d.ltpStorage[a].authorization=e,b.resolve(e)):b.reject()},
b)};return b},addContextualRoles:function(a,b){this.contextualRoles[a]||Vue.set(this.contextualRoles,a,[]);var c=this;b instanceof Array||(b=[b]);b.forEach(function(d){0>c.contextualRoles[a].indexOf(d)&&c.contextualRoles[a].push(d)})},impersonate:function(a){var b=this.$services.q.defer(),c=this;this.$services.swagger.execute("nabu.cms.core.v2.security.web.impersonate",{userId:a}).then(function(d){d?(c.bearer=null,c.$services.swagger.bearer=null,c.roles.splice(0),c.permissions.splice(0),d&&(c.bearer=
d.token,c.$services.swagger.bearer=d.token,c.language=d.language,d.roles&&nabu.utils.arrays.merge(c.roles,d.roles),d.permissions&&nabu.utils.arrays.merge(c.permissions,d.permissions)),c.$services.$clear().then(function(){b.resolve(d)},b)):b.reject()},b);return b},revoke:function(a){var b={};a&&(b.deviceId=a instanceof Array?a:[a]);return this.$services.swagger.execute("nabu.cms.core.v2.security.web.revoke",b)},login:function(a,b,c,d,e){var g=this,k=this.$services.q.defer();this.loggedIn&&(g.$services.swagger.bearer=
null);this.$services.swagger.execute("nabu.cms.core.v2.security.web.login",{body:{authenticationId:a,secret:b,type:d?d:"password"},remember:c?c:!1,$$skipRemember:!0}).then(function(m){if(m&&m.challengeType)k.resolve(m);else if(g.bearer=null,g.$services.swagger.bearer=null,g.roles.splice(0),g.permissions.splice(0),m&&(g.bearer=m.token,g.$services.swagger.bearer=m.token,g.language=m.language,m.roles&&nabu.utils.arrays.merge(g.roles,m.roles),m.permissions&&nabu.utils.arrays.merge(g.permissions,m.permissions)),
g.$services.$clear().then(function(){k.resolve(m)},k),e){var p=localStorage.getItem("redirect-to");if(p){localStorage.removeItem("redirect-to");var q=!1;if(g.$services.router&&g.$services.router.router&&g.$services.router.router.findRoute){var t=null;t=new URL(p);(t=g.$services.router.router.useHash?g.$services.router.router.findRoute(t.hash&&1<t.hash.length?t.hash.substring(1):"/"):g.$services.router.router.findRoute(g.$services.router.router.localizeUrl(t.pathname?t.pathname+t.search:"/")))&&t.route&&
t.route.alias&&g.$services.router.router.useParents&&(q=!0,g.$services.router.router.route(t.route.alias,t.parameters))}q||(window.location=p)}else g.$services.router.route("home")}},function(m){g.loggedIn&&(g.$services.swagger.bearer=g.bearer,g.logout());k.reject(m)});return k},logout:function(){var a=this,b=this.$services.q.defer();this.$services.swagger.execute("nabu.cms.core.v2.security.web.logout",{$$skipRemember:!0}).then(function(c){a.bearer=null;a.roles.splice(0);a.permissions.splice(0);a.allowedPermissions.splice(0);
a.disallowedPermissions.splice(0);c&&c.roles&&nabu.utils.arrays.merge(a.roles,c.roles);c&&c.permissions&&nabu.utils.arrays.merge(a.permissions,c.permissions);a.$services.swagger.bearer=null;a.language=null;a.$services.$clear().then(function(){b.resolve()},b)},b);return b},remember:function(){var a=this,b=null!=a.bearer,c=this.$services.q.defer();this.remembering?c.reject():(this.remembering=!0,this.$services.swagger.execute("nabu.cms.core.v2.security.web.remember",{$$skipRemember:!0}).then(function(d){d?
(a.bearer=d.token,a.$services.swagger.bearer=d.token,a.language=d.language,a.roles.splice(0),a.permissions.splice(0),d.roles&&nabu.utils.arrays.merge(a.roles,d.roles),d.permissions&&nabu.utils.arrays.merge(a.permissions,d.permissions),d.token?b?(c.resolve(d),a.remembering=!1):a.$services.$clear().then(function(){c.resolve(d);a.remembering=!1},c):(c.reject(d),a.remembering=!1)):(c.reject(d),a.remembering=!1)},function(d){c.reject(d);a.remembering=!1}));return c},hasContextualRole:function(a){if(this.contextualRoles[a])for(var b=
1;b<arguments.length;b++)if(0<=this.contextualRoles[a].indexOf(arguments[b]))return!0;return!1},hasRole:function(a,b){if(!a)return!0;if("$user"==a)return!!this.loggedIn;if("$guest"==a)return!this.loggedIn;"this"==b&&(b=this.application);return 0<=this.roles.indexOf((b?b+":":"")+a)},hasPermission:function(a,b,c){"this"==b&&(b=this.application);return 0<this.normalizedPermissions.filter(function(d){return(!c||d[0]==c)&&(!b||d[1]==b)&&d[2]==a}).length},hasPermissionInContext:function(a,b){"this"!=a&&
a||(a=this.application);return 0<this.normalizedPermissions.filter(function(c){return c[1]==a&&(!b||c[0]==b)}).length},hasPermissionInServiceContext:function(a){a||="default";return 0<this.normalizedPermissions.filter(function(b){return b[0]==a}).length},hasPotentialRole:function(a,b){return this.hasRole(a,b)},hasAction:function(a,b){return this.hasPermission(a,b)},hasPotentialAction:function(a,b){return this.hasPermission(a,b)}}});
Vue.view("cms-login",{priority:-100,alias:"login",url:"/login",props:{route:{type:String,required:!1,default:"home"},url:{type:String,required:!1}},data:function(){return{username:null,password:null,remember:!0,working:!1,valid:!1,messages:[]}},methods:{login:function(){if(this.validate(!0)){this.messages.splice(0,this.messages.length);this.working=!0;var a=this;return this.$services.user.login(this.username,this.password,this.remember).then(function(b){a.url?window.location.href=a.url:a.$services.router.route(a.route);
a.working=!1},function(b){a.messages.push({title:"Login failed",severity:"error"});a.working=!1})}},validate:function(a){return this.valid=0==this.$refs.form.validate(!a).length}}});
Vue.service("Language",{services:["user","cookies"],optionalServices:["environment"],data:function(){return{cookieValue:null}},computed:{available:function(){var a=this,b=[];if(this.$services.environment){var c=this.$services.environment.get("languages");c&&(c=c.entries);c&&(0<b.length&&(c=c.filter(function(d){return!b.filter(function(e){return e.name==d.name})[0]})),c.forEach(function(d){a.$services.translator&&(d.label=a.$services.translator.translationFor("language",d.name))}),nabu.utils.arrays.merge(b,
c))}return b},names:function(){return this.available.map(function(a){return a.name})},current:{get:function(){var a=null;if(this.$services.user.language&&0<=this.names.indexOf(this.$services.user.language))a=this.names[this.names.indexOf(this.$services.user.language)],this.cookieValue!=a&&(this.$services.cookies.set("language",a,a?365:-1),this.cookieValue=a?a:null);else if(this.cookieValue&&0<=this.names.indexOf(this.cookieValue))a=this.cookieValue;else for(var b=(navigator.language||navigator.userLanguage).split(/[\s]*;[\s]*/),
c=0;c<b.length;c++)if(0<=this.names.indexOf(b[c])){a=b[c];break}else if(0<=this.names.indexOf(b[c].replace(/-.*/,""))){a=this.names.indexOf(b[c].replace(/-.*/,""));break}for(c=0;c<this.available.length;c++)if(this.available[c].name==a)return this.available[c];return null},set:function(a){"string"==typeof a&&(a=this.available.filter(function(c){return c.name==a})[0]);if(null==a||0<=this.available.indexOf(a)&&a.name!=this.$services.user.language)if(console.log("Switching language switch from '"+this.$services.user.language+
"' to '"+(a?a.name:"none")+"'"),this.$services.user.language=a?a.name:null,this.$services.cookies.set("language",a?a.name:"none",a&&a.name?365:-1),this.cookieValue=a?a.name:null,this.$services.user.loggedIn){var b=this;this.$services.swagger.execute("nabu.cms.core.rest.user.updateLanguage",{userId:this.$services.user.id,languageId:a?a.id:null}).then(function(){b.$services.user.language=a?a.name:null;window.location.reload(!0)})}else window.location.reload(!0)}}},activate:function(a){this.cookieValue=
this.$services.cookies.get("language");a()}});
Vue.service("masterdata",{optionalServices:["translator","environment"],data:function(){return{masterdata:{idsToResolve:[],timer:null,resolved:{}}}},activate:function(a){var b=this;nabu.page&&nabu.page.provide&&(nabu.page.provide("page-enumerate",{name:"masterdata-categories",enumerate:function(){return b.categories},label:"name",value:"id"}),this.preloaded.map(function(c){nabu.page.provide("page-enumerate",{name:"masterdata-category-"+c.name,enumerate:function(){return c.entries},label:"name",value:"id",
values:["id","name"],labels:["name","title","icon"]})}));a()},computed:{preloaded:function(){var a=[];if(this.$services.environment&&this.$services.environment.settings&&this.$services.environment.settings.data&&this.$services.environment.settings.data.masterdata&&this.$services.environment.settings.data.masterdata.categories){nabu.utils.arrays.merge(a,this.$services.environment.settings.data.masterdata.categories);var b=this;a.forEach(function(c){c.entries&&c.entries.forEach(b.labelize)})}return a},
categories:function(){var a=[];this.preloaded.forEach(function(b){a.filter(function(c){return c.name==b.name})[0]||a.push({id:b.id,name:b.name})});return a}},methods:{labelize:function(a){if(!a.label){var b=a.name.substring(0,1).toUpperCase()+a.name.substring(1).replace(/([A-Z]+)/g," $1").trim();a.label=this.$services.translator?this.$services.translator.translationFor(a.id,"name",b):b}},list:function(a,b){for(var c=0;c<this.preloaded.length;c++)if(this.preloaded[c].name==a||this.preloaded[c].id==
a)return null==this.preloaded[c].entries?[]:this.preloaded[c].entries.filter(function(d){return!b||0<=d.name.toLowerCase().indexOf(b.toLowerCase())});return null},category:function(a){for(var b=0;b<this.categories.length;b++)if(this.categories[b].name==a||this.categories[b].id==a)return this.categories[b];return null},entry:function(a,b){if(b)for(c=0;c<this.preloaded.length;c++){if((this.preloaded[c].name==a||this.preloaded[c].id==a)&&this.preloaded[c].entries)for(d=0;d<this.preloaded[c].entries.length;d++)if(this.preloaded[c].entries[d].name==
b||this.preloaded[c].entries[d].id==b)return this.preloaded[c].entries[d]}else for(var c=0;c<this.preloaded.length;c++)if(this.preloaded[c].entries)for(var d=0;d<this.preloaded[c].entries.length;d++)if(this.preloaded[c].entries[d].id==a)return this.preloaded[c].entries[d];return null},resolve:function(a,b,c){null==b&&(b="title");if(!a||!a.match(/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}|[0-9a-fA-F]{32}/))return a;var d=this;if(this.masterdata.resolved[a])return this.masterdata.resolved[a][b]?
this.masterdata.resolved[a][b]:this.masterdata.resolved[a].name;var e=null;if(this.preloaded)for(var g=0;g<this.preloaded.length;g++)if(this.preloaded[g].entries){for(var k=0;k<this.preloaded[g].entries.length;k++)if(this.preloaded[g].entries[k].id==a){e=this.preloaded[g].entries[k];break}if(null!=e)break}g=function(){var m=d.masterdata.idsToResolve.splice(0,d.masterdata.idsToResolve.length);m&&m.length&&(d.masterdata.timer=null,d.$services.swagger.execute("nabu.cms.core.v2.masterdata.rest.resolve",
{id:m,$serviceContext:c}).then(function(p){if(p.results&&p.results.length){p.results.forEach(d.labelize);for(var q=0;q<p.results.length;q++)null==p.results[q].title&&(p.results[q].title=p.results[q].label?p.results[q].label:p.results[q].name),nabu.utils.objects.merge(d.masterdata.resolved[p.results[q].id],p.results[q])}}))};if(null!=e)return e[b]?e[b]:e.name;0>this.masterdata.idsToResolve.indexOf(a)&&(this.masterdata.idsToResolve.push(a),Vue.set(this.masterdata.resolved,a,{id:"",title:"",label:"",
name:""}),null!=this.masterdata.timer&&(clearTimeout(this.masterdata.timer),this.masterdata.timer=null),this.masterdata.timer=setTimeout(g,25));return this.masterdata.resolved[a][b]}}});
Vue.service("translator",{services:["swagger","environment"],data:function(){return{translations:[]}},activate:function(a){this.loadTranslations().then(a,a)},switchLanguage:function(a){console.log("Switching language");var b=[];this.translations.forEach(function(c){0>b.indexOf(c.context)&&b.push(c.context)});this.loadTranslations(b)},methods:{loadTranslations:function(a,b){var c=this;return this.$services.swagger.execute("nabu.cms.core.v2.translation.list",{context:a}).then(function(d){b&&c.translations.splice(0);
d&&d.translations&&nabu.utils.arrays.merge(c.translations,d.translations)})},translationFor:function(a,b,c){var d=(a?a+"::":"")+b;return(a=this.translations.filter(function(e){return e.name==d})[0])&&a.translation?a.translation:c?c:b},translate:function(a,b){if(a&&a.indexOf)for(;0<=a.indexOf("%{");){for(var c=a.indexOf("%{"),d=1,e=-1,g=c+2;g<a.length;g++)if("{"==a.charAt(g))d++;else if("}"==a.charAt(g)&&(d--,0==d)){e=g;break}if(0>e)break;var k=a.substring(c+2,e);d=(d=this.translations.filter(function(m){return m.name==
k})[0])?d.translation:null;!d&&b&&(d=b);d||(d=k.split("::"),d=1==d.length?d[0]:d[1]);a=a.substring(0,c)+d+a.substring(e+1)}return a}}});nabu.page.provide("page-settings",{name:"oauth2",title:"OAuth2",route:"page-settings-oauth2",icon:"at"});
Vue.service("oauth2",{methods:{silentLogin:function(a){var b=this.$services.q.defer(),c=function(d){var e=document.createElement("iframe");e.style.display="none";e.src=d;e.onload=function(){console.log("Iframe loaded",e.src,e)};document.body.appendChild(e)};this.$services.swagger.execute("nabu.cms.oauth2.client.web.rest.provider.getSilentRedirectUri").then(function(d){d&&d.uri?c(a):b.resolve()},b);return b}}});Vue.view("page-settings-oauth2",{});
Vue.service("testIdentifier",{services:["page","swagger"],data:function(){return{inspecting:!1,deep:!1,lastElement:null}},activate:function(a){this.$services.page.testable&&this.registerListeners();a()},methods:{registerListeners:function(){var a=this;document.addEventListener("keydown",function(b){b.key&&"i"==b.key.toLowerCase()&&b.altKey&&(console.log("toggline inspection"),a.inspecting=!a.inspecting)});document.addEventListener("mouseover",function(b){a.inspecting&&a.inspect(b.target,b.x,b.y)})},
calculateIdentifier:function(a){if(a.hasAttribute("id"))return"#"+a.getAttribute("id");if(a.hasAttribute("name"))return'[name\x3d"'+a.getAttribute("name")+'"]';for(var b=1,c=a.previousElementSibling;c;)c.tagName==a.tagName&&b++,c=c.previousElementSibling;b=a.tagName.toLowerCase()+":nth-child("+b+")";a.parentNode&&(b=this.calculateIdentifier(a.parentNode)+" \x3e "+b);return b},inspect:function(a,b,c){if(a!=this.lastElement){this.lastElement=a;var d=document.getElementById("element-inspector");if(d){if(d.contains(a))return null;
d.parentNode.removeChild(d)}d=document.createElement("div");d.setAttribute("id","element-inspector");for(var e=["button","a","input","textarea"];a;){if(a.tagName&&0<=e.indexOf(a.tagName.toLowerCase())||this.deep){var g=document.createElement("div");g.setAttribute("class","element-inspection");d.appendChild(g);var k=document.createElement("span");k.setAttribute("class","element-tag");k.innerHTML=a.tagName.toLowerCase();g.appendChild(k);k=document.createElement("span");k.setAttribute("class","element-identifier");
k.innerHTML=this.calculateIdentifier(a);g.appendChild(k)}a=a.parentNode}d.childNodes.length&&(d.setAttribute("style","left:"+b+"px;top:"+(c+1)+"px"),document.body.appendChild(d))}}}});
Vue.view("blog-toc",{props:{content:{type:String},childComponents:{type:Object,required:!1}},computed:{headers:function(){var a=nabu.formatters.markdown.parse(this.content).filter(function(b){return b.type.match(/^h[0-9]+$/)?(b.depth=parseInt(b.type.replace(/h([0-9]+)/,"$1")),!0):!1});console.log("headers are",a);return a}},methods:{getChildComponents:function(){return[{title:"Button (h1)",name:"toc-button-1",component:"button"},{title:"Button (h2)",name:"toc-button-2",component:"button"},{title:"Button (h3)",
name:"toc-button-3",component:"button"},{title:"Button (h4)",name:"toc-button-4",component:"button"},{title:"Button (h5)",name:"toc-button-5",component:"button"},{title:"Button (h6)",name:"toc-button-6",component:"button"}]},jumpTo:function(a){console.log("jumping to",a);document.getElementById(a.linkId).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}}});
window.addEventListener("load",function(){var a=null,b=!1,c=!1,d=crypto&&crypto.randomUUID?crypto.randomUUID():(new Date).toISOString().replace(/[:.-]+/g,""),e=[],g=new nabu.utils.promise;application.configuration.requestEnrichers||(application.configuration.requestEnrichers=[]);application.configuration.requestEnrichers.push(function(p){p.headers["Session-Id"]=d});var k=function(){var p="https:"==window.location.protocol?"wss":"ws";p=p+"://"+window.location.hostname;if("https:"==window.location.protocol&&
443!=window.location.port||"http:"==window.location.protocol&&80!=window.location.port)p+=":"+window.location.port;p=p+"/t/w/e/"+d;a=new WebSocket(p,"analysis");a.authenticatedBearer=null;a.onopen=function(q){b=!0;0<e.length&&e.splice(0).forEach(function(t){a.send(JSON.stringify(t))});g.resolve()};a.onclose=function(q){console.log("closing!");b=!1;c||setTimeout(k,2E3)};a.onmessage=function(q){console.log("Received message",q.data)}},m=function(){b&&a.send(JSON.stringify({timestamp:(new Date).toISOString()}));
setTimeout(m,15E3)};m();nabu.page.provide("page-analysis",{name:"webEvent",start:k,stop:function(){c=!0;null!=a&&a.close()},push:function(p){console.log("event is",p);var q=application&&application.services&&application.services.user?application.services.user.bearer:null;q&&a&&b&&a.authenticatedBearer!=q?(a.authenticatedBearer=q,a.send(JSON.stringify({token:q}))):!q&&a.authenticatedBearer&&(a.authenticatedBearer=null,a.close());b?(p=nabu.utils.objects.clone(p),null!=p.content&&(p.content=JSON.stringify(p.content)),
null!=p.data&&(p.data=JSON.stringify(p.data,null,2)),a.send(JSON.stringify(p))):e.push(p)},reauthenticate:function(){null!=a&&a.close()}})});
Vue.view("attachment-uploader",{props:{attachments:{type:Array,default:function(){return["marker"]}},attachmentGroup:{type:String},nodeId:{type:String,required:!0},edit:{type:Boolean,required:!1},childComponents:{type:Object,required:!1}},data:function(){return{uploading:!1,managed:!1,files:[]}},created:function(){1==this.attachments.length&&"marker"==this.attachments[0]&&(this.attachments.splice(0),this.managed=!0);console.log("Attachments are "+(this.managed?"managed":"not managed")+" by the component");
this.managed?this.load():this.enrichWithUrl()},methods:{getChildComponents:function(){var a=[{title:"Image Container",name:"attachment-uploader-container",component:"row"}];a.push({title:"Image",name:"attachment-uploader-image",component:"image"});return a},load:function(){var a=this;this.$services.swagger.execute("nabu.cms.attachment.rest.list",{nodeId:this.nodeId,group:this.attachmentGroup}).then(function(b){b.attachments&&nabu.utils.arrays.merge(a.attachments,b.attachments)})},upload:function(){var a=
this;this.uploading=!0;var b=this.files.splice(0).map(function(c){return a.$services.swagger.execute("nabu.cms.attachment.rest.internal.create",{nodeId:a.nodeId,body:c,group:a.attachmentGroup}).then(function(d){console.log("attachment is",d);d&&a.attachments.push(d)})});this.$services.q.all(b).then(function(){a.uploading=!1},function(){a.uploading=!1})},enrichWithUrl:function(){var a=this;a.attachments.forEach(function(b){b.$url||a.$services.user.downloadUrl("nabu.cms.attachment.rest.internal.get",
{nodeId:a.nodeId,attachmentId:b.id},!0).then(function(c){Vue.set(b,"$url",c)})})},deleteAttachment:function(a){var b=this;this.$services.swagger.execute("nabu.cms.attachment.rest.delete",{nodeId:this.nodeId,attachmentId:a.id}).then(function(){b.attachments.splice(b.attachments.indexOf(a),1);b.uploading=!1},function(){b.uploading=!1})}},watch:{attachments:{deep:!0,handler:function(){this.enrichWithUrl()}}}});application||={};application.configuration||(application.configuration={});
Vue.service("environment",{services:["swagger","user"],data:function(){return{settings:{data:{}}}},activate:function(a){var b=this;this.$services.swagger.execute("nabu.web.core.rest.environment").then(function(c){if(c){var d=c.scheme?c.scheme:window.location.protocol.replace(":",""),e=c.host?c.host:window.location.host,g=c.root?c.root:"/";application.configuration.scheme={http:d,ws:"https"==d?"wss":"ws"};application.configuration.url=d+"://"+e;application.configuration.host=e;application.configuration.root=
g;application.configuration.cookiePath=c.cookiePath?c.cookiePath:g;c.development&&(application.configuration.development=!0);c.languagePattern&&b.applyPattern(c.languagePattern);Object.keys(c).forEach(function(k){"data"!=k&&Vue.set(b.settings,k,c[k])});!c.currentLanguage&&c.availableLanguages&&c.availableLanguages.length&&Vue.set(b.settings,"currentLanguage",c.availableLanguages[0]);b.settings.currentLanguage&&b.applyLanguage(b.settings.currentLanguage.name);c.data&&c.data.forEach(function(k){Vue.set(b.settings.data,
k.type,k.content)})}a()},function(c){console.log("Could not load environment information",c);a()})},watch:{"settings.currentLanguage.name":function(a){this.applyLanguage(a)},"settings.languagePattern":function(a){this.applyPattern(a)}},methods:{applyLanguage:function(a){application.configuration.applicationLanguage=a;this.$services.swagger.language=a;if(Intl&&a)try{new Intl.Locale(a),document.documentElement.setAttribute("lang",a)}catch(b){}},get:function(a){return this.settings.data[a]},applyPattern:function(a){var b=
this;this.$services.router.router.urlRewriter={incoming:function(c){if(!a)return c;if("/"==a.substring(0,1)){var d=parseInt(a.substring(1));c=c.replace(/^[/]+/,"").split("/");d<c.length&&c.splice(d,1);return"/"+c.join("/")}return c},outgoing:function(c){if(!a)return c;var d=parseInt(a.substring(1));c=c?c.replace(/^[/]+/,"").split("/"):[];d<c.length?c.splice(d,0,b.settings.currentLanguage.name):c.push(b.settings.currentLanguage.name);return"/"+c.join("/")}}}}});
window.addEventListener("load",function(){navigator.userAgent.match(/Nabu-Renderer/)||document.documentElement.setAttribute("data-useragent",navigator.userAgent);var a=document.createElement("span");a.setAttribute("class","n-icon n-icon-spinner");a.setAttribute("style","position: static");var b=document.getElementById("body");b||(b=document.body);b.appendChild(a);application.initialize().then(function(c){(c=c.router.routeInitial())&&c.then&&navigator.userAgent.match(/Nabu-Renderer/)&&c.then(function(){})})});
clearTemplates=function(){setTimeout(function(){for(var a=document.head.getElementsByTagName("script"),b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])},1)};