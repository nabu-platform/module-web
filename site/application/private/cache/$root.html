<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
	<head profile="http://www.w3.org/2005/10/profile">
		<script>
		</script>
		<style>
.page-loader-container {
	background-color: #ffffff;
	width: 100vw;
	height: 100vh;
	display: flex;
	align-items: center;
	justify-content: center;
}
.page-loader-inline-container {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
}
.page-loader {
	border: 12px solid #f3f3f3;
	border-top: 12px solid #3498db;
	border-radius: 50%;
	width: 80px;
	height: 80px;
	animation: spin 2s linear infinite;
}

@keyframes spin {
	0% { transform: rotate(0deg); }
	100% { transform: rotate(360deg); }
}		</style>
<title>Loading...</title>		<meta property="og:title" content="Nabu Modules"/>
		<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta name="referrer" content="strict-origin-when-cross-origin">
		<base href="/"/>
		<script src="/resources/javascript/application?version=48d19af6d213f58faecc834a2081c667&build=20250822101600104&language=nl"></script>
		<link rel="stylesheet" type="text/css" href="/resources/css/application?version=48d19af6d213f58faecc834a2081c667&build=20250822101600104&language=nl">
		
<script type='x/templates' id="n-confirm">
	<div class="is-confirm">
		<h2 class="is-confirm-title is-h2" v-if="title" v-html="title"></h2>
		<div class="is-confirm-content">
			<div v-if="type" class="is-confirm-icon"><icon :name="getIcon()"/></div>
			<div class="is-confirm-message" v-html="message"></div>
		</div>
		<div class="is-confirm-buttons">
			<button class="is-confirm-button-cancel" v-if="rejectable" @click="$reject()" v-html="cancel ? cancel : translate('Cancel')"></button>
			<button class="is-confirm-button-ok" @click="resolve()" v-focus v-html="ok ? ok : translate('Ok')"></button>
		</div>
	</div>
</script>
<script type='x/templates' id="n-input-date">
	<div class="n-input-date">
		<table :class="yearsDropdown ? 'table dropdown' : 'table'" cellspacing="0" cellpadding="0">
			<thead class="caption">
				<tr class="year">
					<th colspan="7">
						<div class="is-row is-align-space-between">
							<div class="buttons-previous">
								<button v-if="!yearsDropdown" class="is-button is-size-small is-variant-ghost" @click="canIncrementMonth(-12) ? date = incrementMonth(-12) : null" :disabled="!canIncrementMonth(-12)"><icon name="chevron-circle-left"/></button>
								<button class="is-button is-size-small is-variant-ghost" @click="canIncrementMonth(-1) ? date = incrementMonth(-1) : null" :disabled="!canIncrementMonth(-1)"><icon name="chevron-left"/></button>
							</div>
							<span class="month">{{ months[date.getMonth()] }} {{ !yearsDropdown ? date.getFullYear() : '' }}</span>
							<div class="buttons-next">
								<button class="is-button is-size-small is-variant-ghost" @click="canIncrementMonth(1) ? date = incrementMonth(1) : null" :disabled="!canIncrementMonth(1)"><icon name="chevron-right"/></button>
								<button v-if="!yearsDropdown" class="is-button is-size-small is-variant-ghost" @click="canIncrementMonth(12) ? date = incrementMonth(12) : null" :disabled="!canIncrementMonth(12)"><icon name="chevron-circle-right"/></button>
							</div>
						</div>
					</th>
				</tr>
				<tr v-if="yearsDropdown" class="year-selection">
					<th colspan="7">
						<n-form-combo 
							:allow-typing="false"
							:value="year" 
							@input="selectYear"
							:items="years"/>
					</th>
				</tr>
				<tr class="days">
					<th v-for="day in days">{{day}}</th>
				</tr>
			</thead>
			<tbody>
				<tr v-for="week in weeks">
					<td v-for="day in week" :class="{'is-today': day.value != null && isToday(day.value), 'is-active': day.value != null && isSelected(day.value), 'is-available': day.value != null && isAvailable(day.value), 'is-unavailable': day.value != null && !isAvailable(day.value)}">
						<button auto-close-date-picker v-if="day.label" class="is-button is-size-small is-variant-ghost" @click="select(day.value)" :disabled="day.value != null && !isAvailable(day.value)"><span class="is-text">{{ day.label }}</span></button>
					</td>
				</tr>
			</tbody>
		</table>
		<div v-if="includeHours || includeMinutes || includeSeconds" class="time">
			<n-form-text type="number"
				v-model="hours"
				v-if="includeHours"
				:timeout="600"
				@input="select(date)"/>
			<n-form-text type="number"
				v-model="minutes"
				v-if="includeMinutes"
				:timeout="600"
				@input="select(date)"/>
			<n-form-text type="number"
				v-model="seconds"
				v-if="includeSeconds"
				:timeout="600"
				@input="select(date)"/>
		</div>
		<div class="n-input-date-legend" v-if="allow">
			<span class="n-input-date-available">{{$services.translator.translate("Available Dates")}}</span>
			<span class="n-input-date-selected">{{$services.translator.translate("Selected Date")}}</span>
		</div>
	</div>
</script>
<script type='x/templates' id="n-input-file">
	<div class="is-input-file" @paste="pasteFiles($event)" @drop="selectFiles($event)" @mouseout="dragging = false" :class="{ 'drag-drop': hasDropSupport(), 'drag-over': dragging }" @dragenter="dragging = true" @dragover="dragOver" @dragleave="dragging = false" :disabled="disabled">
		<slot :browse="browse" :remove="removeFile">
			<button type="button" class="is-button" :disabled="disabled" @click="browse()" :class="buttonClass"><icon v-if="browseIcon || !browseLabel" :name="browseIcon ? browseIcon : 'plus'"/><span class="is-text" v-if="browseLabel" v-html="browseLabel"></span></button>
			<div class="is-column" v-if="value.length && visualizeFileNames" :class="fileNameContainerClass"><div class="is-row has-button-close" :class="fileNameRowClass" v-for="file in value"><span class="is-text is-content" :class="fileNameClass">{{file.name ? file.name : 'unnamed'}}</span><button class="is-button is-variant-close is-size-xsmall" :class="fileNameDeleteClass" :disabled="disabled" @click="removeFile(file)"><icon :name="deleteIcon"/></button></div></div>
		</slot>
		<input ref="input" type="file" @change="selectFiles($event)" :accept="types" :capture="capture" :multiple="!amount || amount > 1" v-show="false" />
	</div>
</script>
<script type='x/templates' id="n-input-combo">
	<div class="n-component n-input-combo" :class="{ 'n-input-combo-no-labels': !labels, 'is-show-values': showValues }">
		<div class="n-input-combo-label-container" v-auto-close="function() { showLabels = false }" v-if="labels">
			<div class="n-component-label n-input-combo-label" v-if="label" @click="showLabels = !showLabels">
				<slot name="label" :label="label"><span>{{ typeof(label) == "string" ? label : label.title }}</span><icon name="chevron-down"/></slot>
			</div>
			
			<ul class="n-input-combo-dropdown n-input-combo-dropdown-labels" v-if="labels.length > 1 && showLabels">
				<li v-for="single in labels" class="n-input-combo-dropdown-label" :class="{ 'is-active': single == label }" @click="selectLabel(single)" auto-close>
					<slot name="label-dropdown" :label="single"><span>{{ typeof(single) == "string" ? single : single.title }}</span></slot>
				</li>
			</ul>
		</div>
		<div class="n-input-combo-input-container" v-auto-close="function(inside) { showValues = false; if (!inside) { focusOut() } }">
		
			<input @focus="focusOn" :autocomplete="autocomplete" @input="updateContent($event.target.value)" class="n-input-combo-input field" type="text" :placeholder="label && label.placeholder ? label.placeholder : placeholder" 
				@blur="stillFocused = false"
				@keypress.enter="validateEnter"
				@keydown.tab="validateTab"
				@keyup.esc="doEscape"
				@keydown.up="moveUp"
				@keydown.down="moveDown"
				@keyup="$emit('keyup', $event)"
				@keydown="$emit('keydown', $event)"
				@keypress="validateKey"
				:name="name"
				:value="content"
				:readonly="!allowTyping"
				:disabled="disabled"
			/><slot name="input-after" :toggle="function() { showValues = !showValues }"><icon name="chevron-down" @click="showValues = !showValues"/></slot
			
			><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-if="showValues && values && values.length">
				<li v-if="resetValue && value != null" class="n-input-combo-dropdown-value n-input-combo-dropdown-reset-value" :auto-close="autoclose" @click="updateValue(null)">
					<span v-content="resetValue"></span>
				</li>
				<li v-for="potential in values" class="n-input-combo-dropdown-value" :class="{ 'is-active': extracter ? extracter(potential) == value : potential == value, 'is-pondering': potential == keyValue }" @click="updateValue(potential)" :auto-close="autoclose">
					<slot name="value" :value="potential"><span v-html="prettyFormatter ? prettyFormatter(potential) : (formatter ? formatter(potential) : potential)"></span></slot>
				</li>
			</ul
			><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-else-if="showValues && filtering && calculatingValue">
				<li class="n-input-combo-dropdown-value n-input-combo-dropdown-calculating-value" :auto-close="autoclose">
					<span v-content="calculatingValue"></span>
				</li>
			</ul
			><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-else-if="showValues && emptyValue && !filtering">
				<li class="n-input-combo-dropdown-value n-input-combo-dropdown-empty-value" :auto-close="autoclose">
					<span v-content="emptyValue"></span>
				</li>
			</ul>
		</div>
		<slot name="bottom"></slot>
	</div>
</script>

<script type='x/templates' id="n-input-combo2">
	<div class="n-input-combo2" v-auto-close.combo2="function() { showValues = false }" tabindex="-1" @keydown.tab="showValues=false">
		<div class="n-input-combo2-input-container" @click="click" :class="{'has-suffix': showAmount && rawValues.length}">
			<div class="n-input-combo-tag-container" v-if="showTags && multiple && rawValues.length">
				<div v-if="hiddenAmount" class="is-tag" :class="getChildComponentClasses('combo-tag')">
					<span class="is-text">
						<span class="is-text-value" v-content.sanitize="hiddenAmount"></span>
					</span>
				</div>
				<div v-for="single in visibleRawValues" class="is-tag" :class="getChildComponentClasses('combo-tag')">
					<img :src="deleteTagIcon.indexOf('http') == 0 ? deleteTagIcon : '/resources/' + deleteTagIcon" v-if="deleteTagIcon && deleteTagIcon.match(/^.*\.[^.]+$/)" class="is-icon" @click="deselect(single)"/>
					<icon :name="deleteTagIcon" v-else-if="deleteTagIcon" @click.native="deselect(single)"/>
					<span class="is-text">
						<span class="is-text-value" v-content.sanitize="getFormatted(single)"></span>
					</span>
				</div>
			</div>
			<template v-if="!searchInDropdown">
				<input
					data-1p-ignore
					data-lpignore="true"
					:readonly="!allowTyping"
					:disabled="disabled"
					ref="searchInput"
					v-model="search" 
					@keypress.enter="commitKeyValue"
					@keyup.esc="showValues = false"
					@keydown.up="moveUp"
					@keydown.down="moveDown"
					@keydown.tab="showValues = false"
					:placeholder="currentPlaceholder"
					@focus="focus"
					:after="showAmount ? rawValues.length : null" />
				<span class="is-suffix" v-if="showAmount && rawValues.length">{{rawValues.length}}</span>
			</template>
			<template v-else-if="rawValues.length">
				<span class="is-pretty-value" v-html="getPrettyFormatted(rawValues[0])" @click="focus"></span>
			</template>
			<template v-else-if="currentPlaceholder">
				<span class="is-pretty-value" v-content="currentPlaceholder" @click="focus"></span>
			</template>
			<template v-else>
				<span class="is-pretty-value" @click="focus"></span>
			</template>
		</div><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-if="showValues && (potentialValues.length || searchInDropdown)" ref="valueList">
			<li v-if="searchInDropdown" class="n-input-combo-dropdown-value n-input-combo-dropdown-select-all-value">
				<n-form-checkbox tabindex="-1" v-if="useCheckbox && multiple" :value="rawValues.length == potentialValues.length" @input="toggleAll"/>
				<input
					class="n-input-combo-dropdown-search"
					:readonly="!allowTyping"
					:disabled="disabled"
					ref="searchInput"
					v-model="search" 
					@keypress.enter="commitKeyValue"
					@keyup.esc="showValues = false"
					@keydown.up="moveUp"
					@keydown.down="moveDown"
					@keydown.tab="showValues = false"
					@focus="focus"
					:after="showAmount ? rawValues.length : null" />
			</li>
			<li v-if="multiple && selectAllValue" class="n-input-combo-dropdown-value n-input-combo-dropdown-select-all-value" :class="{'selected-all': rawValues.length == potentialValues.length, 'selected-partial': rawValues.length < potentialValues.length}" @click="toggleAll">
				<n-form-checkbox tabindex="-1" v-if="useCheckbox" :value="rawValues.length == potentialValues.length" @input="toggleAll"/>
				<span v-content="potentialValues.length == rawValues.length && resetValue ? resetValue : selectAllValue"></span>
			</li>
			<li v-if="!(multiple && selectAllValue) && resetValue && rawValues.length" class="n-input-combo-dropdown-value n-input-combo-dropdown-reset-value" :auto-close-combo2="autoclose" @click="deselect()">
				<n-form-checkbox tabindex="-1" v-if="useCheckbox" :value="rawValues.length == potentialValues.length" @input="deselect()"/>
				<span v-content="resetValue"></span>
			</li>
			<li v-for="potential in potentialValues" class="n-input-combo-dropdown-value" :class="{ 'is-active': rawValues.indexOf(potential) >= 0, 'is-pondering': potential == keyValue }" @click="toggle(potential)" :auto-close-combo2="!multiple">
				<n-form-checkbox tabindex="-1" v-if="useCheckbox" :value="rawValues.indexOf(potential) >= 0" @input="toggle(potential)"/>
				<slot name="value" :value="potential"><span v-html="getPrettyFormatted(potential)"></span></slot>
			</li>
		</ul
		><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-else-if="showValues && calculating && calculatingValue">
			<li class="n-input-combo-dropdown-value n-input-combo-dropdown-calculating-value" :auto-close-combo2="autoclose">
				<span v-content="calculatingValue"></span>
			</li>
		</ul
		><ul class="n-input-combo-dropdown n-input-combo-dropdown-values" v-else-if="showValues && emptyValue">
			<li class="n-input-combo-dropdown-value n-input-combo-dropdown-empty-value" :auto-close-combo2="autoclose">
				<span v-content="emptyValue"></span>
			</li>
		</ul>
	</div>
</script>
<script type='x/templates' id="n-form-date">
	<div class="is-form-date" v-auto-close.date-picker="function() { show = false }">
		<n-form-text class="n-form-date-input" 
			@focus="focus" 
			:pattern="pattern ? pattern : dynamicPattern" 
			:pattern-comment="patternComment"
			v-model="date" 
			:placeholder="placeholder"
			:label="label"
			:edit="edit"
			:required="required"
			:name="name"
			:schema="customizedSchema"
			:minLength="minLength"
			:maxLength="maxLength"
			type="text"
			:hide="hide"
			:disabled="disableTextInput || disabled"
			:validator="dateValidate"
			:unique="unique"
			:info="info"
			:before="before"
			:after="after"
			ref="text"
			:timeout="timeout">
			
			<icon class="is-suffix" slot="suffix" :name="show ? 'times' : 'calendar-alt'" :class="{'is-open': show, 'is-closed': !show }" @click.native="function() { edit && !disabled ? show = !show : show = false }" v-show="edit"/>
		</n-form-text>
		
		<n-input-date 
			:translator="translator"
			:formatter="formatter" 
			:parser="parser"
			:minimum="minimum"
			:maximum="maximum"
			:allow="allow"
			v-show="show" 
			v-model="date"
			:years-dropdown="yearsDropdown"
			:years-from="yearsFrom"
			:years-to="yearsTo"
			:includeHours="includeHours"
			:includeMinutes="includeMinutes"
			:includeSeconds="includeSeconds"
			:default="defaultValue"
			ref="dateInput"/>
		
		<n-messages :messages="messages" v-if="messages && messages.length"/>
	</div>
</script>
<script type='x/templates' id="n-form-date-picker">
	<div class="n-form-date-picker n-form-component" :class="[mandatory ? 'n-form-input-required' : 'n-form-input-optional', { 'n-form-hidden': hide },{ 'n-form-invalid': valid != null && !valid },{ 'n-form-valid': valid != null && valid }, type ? 'n-form-text-' + type : null ]" :optional="hide != null">
		<slot name="top"></slot>		
		<div class="n-form-label-wrapper">
			<slot name="label" :label="label" :mandatory="mandatory">
				<label class="n-form-label" :class="{ 'n-form-input-required': mandatory }" v-if="label">{{ label }}</label>
			</slot>
			<n-info class="n-form-component-description n-form-component-description-info" :icon="descriptionIcon" v-if="descriptionType == 'info'">{{ description }}</n-info>
		</div>		
		
		
		<div class="n-form-component-description n-form-component-description-before"  v-if="before || (descriptionType == 'before' && (descriptionIcon || description))">
			<span class="n-form-component-description-icon" :class="descriptionIcon" v-if="descriptionIcon"></span>
			<span class="n-form-component-description-label">{{ before ? before : description }}</span>
		</div>
		<n-form-section v-if="edit" class="n-form-date-picker-form">
			<n-form-combo :case-insensitive="true" :ref="field" :disabled="!editable(field)" v-for="field in fields" :filter="listField.bind(self, field)" :value="result[field]"
				:class="'date-picker-' + field"
				:placeholder="getPlaceholder(field)"
				@input="function(newValue) { updateField(field, newValue) }"
				:formatter="formatField.bind(self, field)"/>
		</n-form-section>
		<span v-else class="n-form-read">{{formattedDate}}</span>
		<slot name="bottom">
			<n-messages :messages="messages" v-if="edit && messages && messages.length"/>
		</slot>
		<div class="n-form-component-description n-form-component-description-after" v-if="after || (descriptionType == 'after' && (descriptionIcon || description))">
			<span class="n-form-component-description-icon" :class="descriptionIcon" v-if="descriptionIcon"></span>
			<span class="n-form-component-description-label">{{ after ? after : description }}</span>
		</div>		
	</div>
</script>
<script type='x/templates' id="n-form-file">
	<div class="is-form-file" :class="[{ 'is-required': mandatory, 'is-optional': !mandatory, 'is-hidden': hide, 'is-invalid': valid != null && !valid, 'is-valid': valid != null && valid, 'has-prefix': !!prefix || !!prefixIcon, 'has-suffix': !!suffix || !!suffixIcon, 'has-before': !!before, 'has-after': !!after, 'has-label': !!label, 'has-info': !!info } ]">
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="before" v-html="before"></div>
		<div class="is-content-wrapper" v-if="edit">
			<n-input-file :types='types' ref='form' :amount='1'
				:edit='edit'
				:schema='schema'
				v-bubble:change
				v-bubble:input
				:label='label'
				:value='value'
				:name='name'
				:drop-label='dropLabel'
				:button-class="buttonClass"
				:file-name-class="fileNameClass"
				:file-name-row-class="fileNameRowClass"
				:file-name-container-class="fileNameContainerClass"
				:file-name-delete-class="fileNameDeleteClass"
				:browse-label='browseLabel'
				:browse-icon='browseIcon'
				:visualize-file-names='visualizeFileNames'
				:deleteIcon='deleteIcon'
				:timeout='timeout'
				:max-file-size='maxFileSize ? parseInt(maxFileSize) : null'
				:disabled='disabled'>
				<slot :browse="browse" :remove="removeFile"/>
			</n-input-file>
		</div>
		<div class="is-read-only" v-else>
			<slot><span class="is-readable">Selected {{ files.length  }} files</span></slot>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>
	</div>
</script>

<script type='x/templates' id="n-form-combo">
	<div class="is-form-combo" :class="[mandatory ? 'is-required' : 'is-optional',{ 'is-invalid': valid != null && !valid },{ 'is-valid': valid != null && valid }]">
		
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>

		<div class="is-content-before" v-if="before" v-html="before"></div>
		
		<div class="is-content-wrapper" v-if="edit">
			<slot name="prefix"><div class="is-prefix" v-if="prefix || prefixIcon"><icon v-if="prefixIcon" :name="prefixIcon"/><span class="is-text" v-html="prefix" v-if="prefix"></span></div></slot>
			<component :is="comboType" v-show="edit" 
				:search-in-dropdown="searchInDropdown"
				:load-on-focus="loadOnFocus"
				:empty-value="emptyValue"
				:reset-value="resetValue"
				:calculating-value="calculatingValue"
				:case-insensitive="caseInsensitive"
				@label="function(newValue) { valueLabel = newValue }"
				:value="value" 
				:labels="labels" 
				:filter="filter" 
				:formatter="formatter" 
				:pretty-formatter="prettyFormatter"
				:class="{ 'n-form-valid': valid != null && valid, 'n-form-invalid': valid != null && !valid }"
				@input="updateValue"
				:items="items"
				:nillable="nillable"
				:timeout="timeout"
				:autoclose="autoclose"
				:placeholder="placeholder"
				:placeholder-selected="placeholderSelected"
				:disabled="disabled"
				:initial-label="initialLabel"
				:allow-typing="allowTyping"
				:extracter="extracter"
				:resolver="resolver"
				v-bubble:label
				@keyup="$emit('keyup', $event)"
				@keydown="$emit('keydown', $event)"
				:name="name"
				:autocomplete="autocomplete"
				:autoselect-single="autoselectSingle"
				:descriptionIcon="descriptionIcon"
				:description="description"
				:descriptionType="descriptionType"
				:allow-type-match="allowTypeMatch"
				:select-all-value="selectAllValue"
				:use-checkbox="useCheckbox"
				:show-tags="showTags"
				:show-amount="showAmount"
				:max-amount-of-tags="maxAmountOfTags"
				:delete-tag-icon="deleteTagIcon"
				ref="combo"/>
			<slot name="suffix"><div class="is-suffix" v-if="suffix || suffixIcon"><icon v-if="suffixIcon" :name="suffixIcon"/><span class="is-text" v-html="suffix"></span></div></slot>
		</div>
		<slot v-else class="is-read-only">
			<span class="is-readable">{{ valueLabel ? valueLabel : (!extracter && formatter && value ? formatter(value) : value) }}</span>
		</slot>

		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>	
		
	</div>
</script>
<script type='x/templates' id="n-form-section">
	<section class="is-form-section">
		<slot></slot>
	</section>
</script><script type='x/templates' id="n-form-richtext">
	<div class="is-form-richtext" v-auto-close="function() { focused = false }">
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="before" v-html="before"></div>
		<ul class="is-menu is-variant-toolbar" v-if="edit && showMenu">
			<li class="is-column" v-if="supportBlocks">
				<span class="is-button is-size-xsmall is-variant-primary"><icon name="th-large"/><span class="is-text">Block</span></span>
				<ul class="is-row">
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('p')"><icon name="paragraph"/><span class="is-text">Paragraph</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h1')"><icon name="heading"/><span class="is-text">H1</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h2')"><icon name="heading"/><span class="is-text">H2</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h3')"><icon name="heading"/><span class="is-text">H3</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h4')"><icon name="heading"/><span class="is-text">H4</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h5')"><icon name="heading"/><span class="is-text">H5</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="wrap('h6')"><icon name="heading"/><span class="is-text">H6</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="insertTable"><icon name="table"/><span class="is-text">Table</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="list"><icon name="list"/><span class="is-text">List</span></button></li>
				</ul>
			</li>
			<li class="is-column">
				<span class="is-button is-size-xsmall is-variant-primary"><icon name="align-justify"/><span class="is-text">Justify</span></span>
				<ul class="is-row">
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="justify('justifyCenter')"><icon name="align-center"/><span class="is-text">Center</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="justify('justifyLeft')"><icon name="align-left"/><span class="is-text">Left</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="justify('justifyRight')"><icon name="align-right"/><span class="is-text">Right</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="justify('justifyFull')"><icon name="align-justify"/><span class="is-text">Full</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="indent"><icon name="indent"/><span class="is-text">Indent</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="outdent"><icon name="outdent"/><span class="is-text">Outdent</span></button></li>
				</ul>
			</li>
			<li class="is-column">
				<span class="is-button is-size-xsmall is-variant-primary"><icon name="font"/><span class="is-text">Decoration</span></span>
				<ul class="is-row">
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="bold"><icon name="bold"/><span class="is-text">Bold</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="italic"><icon name="italic"/><span class="is-text">Italic</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="underline"><icon name="underline"/><span class="is-text">Line</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="clean"><icon name="eraser"/><span class="is-text">Plain</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="link"><icon name="link"/><span class="is-text">Link</span></button></li>
					<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="applyColor()"><icon name="paint-brush"/><span class="is-text">Paint</span></button></li>
					<li class="is-column is-height-min-2 is-align-stretch"><input type="color" v-model="color" class="is-content is-color-secondary is-width-max"></li>
				</ul>
			</li>
		</ul>
		<div class="is-content-wrapper">
			<div @keydown.tab="tab($event)" class="is-inline-editor" :placeholder="placeholder" v-html-basic="localValue" ref="editor" @paste="paste($event)" :contenteditable="edit && !disabled" @keyup="update" @blur="update" @input="update"></div>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>
	</div>
</script>

<script type='x/templates' id="n-form-checkbox">
	<div :class="[component, { 'is-hidden': hide, 'is-disabled': disabled, 'is-valid': valid != null && valid, 'is-invalid': valid != null && !valid, 'is-required': mandatory, 'is-optional': !mandatory, 'is-order-reverse': labelBefore }]" :optional="hide != null">
		<slot name="before" :content="before">
			<div class="is-content-before" v-if="before" v-html="before"></div>
		</slot>
		<div class="is-content-wrapper">
			<input ref="input" 
				:tabindex="tabindex"
				@click="toggleValue()" 
				type="checkbox" 
				v-checked="calculatedValue" 
				:disabled="!edit || disabled" 
				:value="calculatedValue"
				:name="name"
				v-if="!hide" 
				class="is-input"
			/><label  
				@click="toggleValue(); $event.stopPropagation()" 
				class="is-label" 
				><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<slot name="messages" :messages="messages">
			<n-messages :messages="messages" v-if="messages && messages.length"/>
		</slot>
		<slot name="after" :content="after">
			<div class="is-content-after" v-if="after" v-html="after"></div>
		</slot>
	</div>
</script>

<script type='x/templates' id="n-form-checkbox-list">
	<div class="is-form-checkbox-list" :class="[{ 'is-required': mandatory, 'is-optional': !mandatory, 'is-hidden': hide, 'is-invalid': valid != null && !valid, 'is-valid': valid != null && valid, 'has-prefix': !!prefix || !!prefixIcon, 'has-suffix': !!suffix || !!suffixIcon, 'has-before': !!before, 'has-after': !!after, 'has-label': !!label, 'has-info': !!info }, type ? 'is-form-text-' + type : null ]">
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="before" v-html="before"></div>
		<div class="is-content-wrapper" v-if="edit">
			<n-form-checkbox v-for="item in items"
				:mandatory="false"
				:value="isChecked(item)"
				@input="toggle(item)"
				:label="formatter ? formatter(item) : item"
				/>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>
	</div>
</script>

<script type='x/templates' id="n-form-checkbox-list-configure">
	<div/>
</script><script type='x/templates' id="n-form-text">
	<div class="is-form-text" :class="[{ 'is-required': mandatory, 'is-optional': !mandatory, 'is-hidden': hide, 'is-invalid': valid != null && !valid, 'is-valid': valid != null && valid, 'has-prefix': !!prefix || !!prefixIcon, 'has-suffix': !!suffix || !!suffixIcon, 'has-before': !!before, 'has-after': !!after, 'has-label': !!label, 'has-info': !!info }, type ? 'is-form-text-' + type : null ]">
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="before" v-html="before"></div>
		<div class="is-content-wrapper" v-if="edit">
			<slot name="prefix"><div class="is-prefix" v-if="prefix || prefixIcon"><icon v-if="prefixIcon" :name="prefixIcon"/><span class="is-text" v-html="prefix" v-if="prefix"></span></div></slot>
			<input 
				@change="triggerChange"
				@blur="blur($event.target.value)"
				@keyup="$emit('keyup', $event)"
				@keydown="$emit('keydown', $event)"
				@input="updateValue($event.target.value)"
				@keypress="checkKey($event)"
				@paste="pasteHandler"
				:placeholder="placeholder" 
				:type="type" 
				:disabled="disabled" 
				v-model="localValue"
				class="is-input"
				:min="minimum"
				:max="maximum"
				:step="step"
				v-if="type != 'area'" 
				:maxlength="maxLength"
				@focus="focus"
				ref="input"
				:name="name"
				:style="'width:'+rangeWidth+';left:'+rangeLeftOffset"
				v-bind="{'contentEditable': type == 'range' ? 'false' : null}"
				:autocomplete="autocomplete"
				/><textarea
					v-else
					@focus="$emit('focus')"
					@blur="$emit('blur')"
					@keyup="$emit('keyup')"
					@input="updateValue($event.target.value)" 
					@keydown.enter.ctrl="attemptSubmit"
					:rows="rows"
					:placeholder="placeholder" 
					:disabled="disabled" 
					v-model="localValue" 
					class="is-input" 
					ref="input"
					:name="name"
					:autocomplete="autocomplete"
				/><div class="is-number-spinner" v-if="type == 'number' && showCustomSpinner">
					<icon name="chevron-up" @click="increment"/>
					<icon name="chevron-down" @click="decrement"/>
				</div><slot name="suffix"><div class="is-suffix" v-if="suffix || suffixIcon"><icon v-if="suffixIcon" :name="suffixIcon"/><span class="is-text" v-html="suffix"></span></div></slot><span class="is-range-value"></span><span v-if="type == 'range' && showTooltip" class="is-tooltip" ref="tooltip">{{value}}</span>
		</div>
		<div class="is-read-only" v-else>
			<slot><span class="is-readable">{{ type == 'password' ? '*******' : localValue }}</span></slot>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>
	</div>
</script>

<script type='x/templates' id="n-form-switch">
	<n-form-checkbox ref="form" component="is-form-switch" :value="value" :label="label" :edit="edit" :item="item" @input="updateValue" :invert="invert" :after="after" :before="before" :info="info" :info-icon="infoIcon"/>
</script>
<script type='x/templates' id="n-form-radio">
	<div class="is-form-radio-list" :class="[{ 'is-required': mandatory, 'is-optional': !mandatory, 'is-hidden': hide, 'is-invalid': valid != null && !valid, 'is-valid': valid != null && valid, 'has-prefix': !!prefix, 'has-suffix': !!suffix, 'has-before': !!before, 'has-after': !!after, 'has-label': !!label, 'has-info': !!info }, type ? 'is-form-text-' + type : null ]">
		<div class="is-label-wrapper" v-if="label || info">
			<label class="is-label" v-if="label"><span class="is-label-content" v-html="label"></span><n-info :icon="infoIcon" v-if="info"><span v-html="info"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="before" v-html="before"></div>

		<div class="is-content-wrapper" v-if="edit">
			<div v-for="item in items" class="is-form-radio" :class="{ 'n-form-valid': valid != null && valid, 'n-form-invalid': valid != null && !valid }">
				<input ref="input" 
					type="radio" 
					:name="name"
					:disabled="!edit || isDisabled(item)"
					:value="extracter ? extracter(item) : item"
					v-checked="(!mustChoose || chosen) && value == (extracter ? extracter(item) : item)"
					@input="select(item)"
					v-if="!hide" 
					class="n-form-radio-input"
				/><slot name="label" :value="item" :select="function() { select(item) }"><label class="is-label" @click="select(item); $event.stopPropagation()" v-html="formatter ? formatter(item) : item"></label></slot>
			</div>
		</div>
		<div class="is-read-only" v-else>
			<slot><span class="is-readable">{{ type == 'password' ? '*******' : localValue }}</span></slot>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="after" v-html="after"></div>
	</div>
</script>
<script type='x/templates' id="n-form-location">
	<div class="n-form-location n-form-component">
		<n-form-combo :filter="searchPlace"
			:edit="edit"
			:required="mandatory"
			:placeholder='placeholder'
			ref="combo"
			:label="label"
			:value="place"
			:timeout="timeout"
			@input="update"
			:formatter="formatPlace"/>
	</div>
</script>
<script type='x/templates' id="n-form-address">
	<div class="n-form-address n-form-component">
	
		<div class="n-form-address-form" v-if="edit">
			<n-form-combo :filter="searchField.bind($self, 'country')" v-if="countryField" 
				:label="countryLabel"
				:value="value[countryField]"
				@input="updateCountry"
				:timeout="timeout"
				:allow-type-match="false"
				:schema="schemaResolver ? schemaResolver(country ? country : countryCode) : null"
				:name="country"
				:formatter="formatAutocomplete.bind($self, 'country')"
				class="country"
				ref="country"/>

			<n-form-combo :filter="searchField.bind($self, 'city')" v-if="city" 
				:disabled="countryField && !value[countryField]"
				:label="cityLabel"
				:value="value[city]"
				@input="updateCity"
				:timeout="timeout"
				:allow-type-match="false"
				:formatter="formatAutocomplete.bind($self, 'city')"
				:schema="schemaResolver ? schemaResolver(city) : null"
				:name="city"
				class="city"
				ref="city"/>
			
			<n-form-combo :filter="searchField.bind($self, 'postCode')" v-if="postCode" 
				:disabled="(countryField && !value[countryField]) || (city && !value[city])"
				:label="postCodeLabel"
				:value="value[postCode]"
				@input="updatePostCode"
				:timeout="timeout"
				:allow-type-match="false"
				:formatter="formatAutocomplete.bind($self, 'postCodeFull')"
				:schema="schemaResolver ? schemaResolver(postCode) : null"
				:name="postCode"
				class="postCode"
				ref="postCode"/>
				
			<n-form-text :disabled="true"
				v-else-if="postCode"
				:label="postCodeLabel"
				:value="value[postCode]"
				class="postCode"/>
			
			<n-form-combo :filter="searchField.bind($self, 'street')" v-if="street"
				:disabled="(countryField && !value[countryField]) || (city && !value[city]) || (postCode && !value[postCode])" 
				:label="streetLabel"
				:value="value[street]"
				@input="updateStreet"
				:timeout="timeout"
				:allow-type-match="false"
				:formatter="formatAutocomplete.bind($self, 'street')"
				:schema="schemaResolver ? schemaResolver(street) : null"
				:name="street"
				class="street"
				ref="street"/>
			
			<n-form-combo :filter="searchField.bind($self, 'streetNumber')" v-if="streetNumber && false"
				:disabled="(countryField && !value[countryField]) || (city && !value[city]) || (postCode && !value[postCode]) || (street && !value[street])"  
				:label="streetNumberLabel"
				:value="value[streetNumber]"
				@input="updateStreetNumber"
				:timeout="timeout"
				:allow-type-match="false"
				:formatter="formatAutocomplete.bind($self, 'streetNumber')"
				:schema="schemaResolver ? schemaResolver(streetNumber) : null"
				:name="streetNumber"
				class="streetNumber"
				ref="streetNumber"/>
				
			<n-form-text v-else-if="streetNumber"
				:disabled="(countryField && !value[countryField]) || (city && !value[city]) || (postCode && !value[postCode]) || (street && !value[street])"  
				:label="streetNumberLabel"
				:value="value[streetNumber]"
				@input="updateStreetNumber"
				:timeout="timeout"
				:allow-type-match="false"
				:schema="schemaResolver ? schemaResolver(streetNumber) : null"
				:name="streetNumber"
				class="streetNumber"
				ref="streetNumber"/>
				
			<n-form-text v-if="additional"
				:disabled="(countryField && !value[countryField]) || (city && !value[city]) || (postCode && !value[postCode]) || (street && !value[street])"  
				:label="additionalLabel"
				:value="value[additional]"
				@input="updateAdditional"
				:timeout="timeout"
				:allow-type-match="false"
				:schema="schemaResolver ? schemaResolver(additional) : null"
				:name="additional"
				class="additional"
				ref="additional"/>

		</div>
		<div v-else>
			<div class="n-form-label-wrapper">
				<label v-if="label" class="n-form-label" :class="{'n-form-input-required': anyRequired, 'n-form-input-optional': !anyRequired}">{{label}}</label>
			</div>
			<span class="n-form-read">{{ formattedAddress }}</span>
		</div>

	</div>
</script>

<script type='x/templates' id="n-form">
	<form v-on:submit.prevent class="is-form" :mode="mode">
		<slot name="header"></slot>
		<section class="is-form-section is-form-main-content" :class="contentClass">
			<slot></slot>
		</section>
		<slot name="footer"></slot>
	</form>
</script><script type='x/templates' id="n-form-table">
	<form v-on:submit.prevent class="n-form n-form-table" :schema="schema">
		<slot name="header"></slot>
		<header name="header" class="n-form-table-header" v-show="hasContent">
			<span class="n-form-label" v-for="label in labels" :class="{ 'n-form-hidden': label && label.component.hide }" :optional="label == null || label.component.hide != null">{{ label ? label.name : null }}</span>
		</header>
		<section class="n-form-table-content">
			<slot></slot>
		</section>
		<section class="n-form-table-no-content" v-if="!hasContent">
			<slot name="no-content"><span>No Content</span></slot>
		</section>
		<slot name="footer"></slot>
	</form>
</script><script type='x/templates' id="n-secret">
	<span @mouseover="show = true" @mouseout="show = false">{{ show ? content : secretContent }}</span> 
</script><script type='x/templates' id="n-wizard">
	<div class="n-wizard">
		<div class="navigation" ref="navigation">
			<slot name="left" :next="next" :previous="previous"></slot>
			<ol class="steps">
				<li :disabled="step.disabled" class="step" v-for="(step, index) in steps" :class="{ 'button': browse, active: step == current, inactive: step == current }">
					<slot name="step" :step="step">
						<span class="number" v-if="number">{{ index + 1 }}</span>
						<span class="title">{{ step.name }}</span>
					</slot>
				</li>
			</ol>
			<slot name="right" next="next" previous="previous"></slot>
		</div>
		<slot name="container" :next="next" :previous="previous" :hasNext="hasNext" :hasPrevious="hasPrevious" :step="current"><div class="container" ref="container"></div></slot>
		<slot name="bottom" :next="next" :previous="previous" :hasNext="hasNext" :hasPrevious="hasPrevious" :step="current"></slot>
	</div>
</script><script type='x/templates' id="n-collapsible">
	<div class="is-collapsible" :class="{ 'is-open': show }">
		<h3 class="is-title" @click="toggle()"><icon :name="show ? 'chevron-down' : 'chevron-right'"/><slot name="text"><span class="is-text"><span v-if="before" class="is-text-before" v-html="before"></span><span class="is-text-main" v-if="title" v-html="title"></span><span v-if="after" class="is-text-after" v-html="after"></span></span></slot><div class="is-title-buttons" @mouseover="toggleable=false" @mouseout="toggleable=true"><slot name="buttons"></slot></div></h3>
		<div class="n-icon-spinner spinner" v-if="loading"></div>
		<div class="is-collapsible-content" :class="contentClass" v-if="show">
			<slot></slot>
		</div>
	</div>
</script>
<script type='x/templates' id="n-menu-dropdown">
	<ul class="n-menu n-menu-dropdown" ref="root" v-auto-close="function() { showing.splice(0, showing.length) }">
		<li v-for="action in actions" v-if="!action.hidden" :class="{ 'has-children': action.actions }" @mouseover="show(action)" @mouseout="hide(action)">
			<a auto-close class="n-menu-action n-menu-entry" href="javascript:void(0)" @click="handle(action)" v-if="action.handler">{{ action.title }}</a>
			<span class="n-menu-entry" v-if="!action.handler">{{ action.title }}</span>
			<n-menu-dropdown v-if="action.actions" :actions="action.actions" v-show="showing.indexOf(action) >= 0"/>
		</li>
	</ul>
</script><script type='x/templates' id="n-button">
	<button :class="{'has-text': text, 'has-icon': icon, 'primary': !type }" :class="type">
		<span v-if="icon" :class="'n-icon-' + icon" class="n-icon"></span>
		<span v-if="text">{{ text }}</span>
	</button>
</script><script type='x/templates' id="n-windowing">
	<div class="n-windowing">
		<button class="n-windowing-first" @click="update(0)" :disabled="!page || page < 2 || loading"><span class="n-icon n-icon-angle-double-left"></span></button
		><button class="n-windowing-previous" @click="update(page - 1)" :disabled="!page || page < 1 || loading"><span class="n-icon n-icon-angle-left"></span></button
		><span class="n-windowing-number">{{ page }}</span
		><button class="n-windowing-next" @click="update(page + 1)" :disabled="!hasNext || loading"><span class="n-icon n-icon-angle-right"></span></button>
	</div>
</script>
<script type='x/templates' id="n-sidebar">
	<section class="is-sidebar" v-auto-close.sidebar="autoClose" :class="[position, position == 'right' ? 'is-position-right' : 'is-position-left']">
		<header>
			<slot name="header"></slot>
			<button class="is-button is-variant-close" @click="close(true)"><icon name="times"/></button>
		</header>
		<main><slot></slot></main>
		<footer></footer>
	</section>
</script>

<script type='x/templates' id="n-messages">
	<div class="is-messages">
		<div class="is-message" v-for="message in messages" :class="'is-severity-' + message.severity" :code="message.code" @mouseover="highlight(message)" @mouseout="unhighlight(message)">
			<slot message="message">
				<span class="title" v-html="message.title ? format(message.title, message.values, message.context) : message.code"></span>
				<span class="description" v-if="message.description" v-html="format(message.description, message.values, message.context)"></span>
			</slot>
		</div>
	</div>
</script><script type='x/templates' id="n-paging">
	<ul class="is-menu" v-show="total > 0 || showEmpty">
		<li class="is-column" v-if="arrows"><button :class="buttonClasses" class="is-button" @click="update(0)" :disabled="!page || loading"><span class="n-icon n-icon-angle-double-left"></span></button></li>
		<li class="is-column" v-if="arrows"><button :class="buttonClasses" class="is-button" @click="update(page - 1)" :disabled="!page || loading"><span class="n-icon n-icon-angle-left"></span></button></li>
		<li class="is-column" v-for="button in buttons"><button :class="[buttonClasses, {'is-active': button - 1 == page}]" class="is-button has-text" :disabled="loading" @click="button == null ? promptPage() : update(button - 1)">{{ button == null ? "..." : button }}</button></li>
		<li class="is-column" v-if="arrows"><button :class="buttonClasses" class="is-button" @click="update(page + 1)" :disabled="page >= total - 1 || loading"><span class="n-icon n-icon-angle-right"></span></button></li>
		<li class="is-column" v-if="arrows"><button :class="buttonClasses" class="is-button" @click="update(total - 1)" :disabled="page >= total - 1 || loading"><span class="n-icon n-icon-angle-double-right"></span></button></li>
	</ul>
</script>

<script type='x/templates' id="n-paging-prompt">
	<n-form :class="formClasses" ref="form">
		<n-form-section>
			<n-form-text v-focus v-model="page" type="number" pattern="^[0-9]+" label="Go To Page"/>
		</n-form-section>
		<footer class="is-row is-align-space-between">
			<button @click="$reject" class="is-button is-variant-link" type="button">Cancel</button>
			<button type="submit" class="is-button is-variant-primary" :disabled="!page" @click="$resolve(page)">Go</button>
		</footer>
	</n-form>
</script><script type='x/templates' id="n-info">
	<div class="is-info" v-auto-close="function() { showing = false }" @mouseover="showing = autoClose" @mouseout="showing = !autoClose" @click="showing = autoClose ? showing : !showing">
		<icon :name="icon"/>
		<div class="is-info-content-wrapper" v-show="showing"><slot></slot></div>
	</div>
</script>
<script type='x/templates' id="n-tags">
	<div class="n-tags">
		<div class="n-tag" v-for="tag in tags">
			<slot :tag="tag"><span class="n-tag-title">{{ format(tag) }}</span>
			</slot><slot name="remove" :tag="tag" v-if="removable"><span class="n-tag-remove n-icon n-icon-trash" @click="remove(tag)"></span></slot>
		</div>
	</div>
</script><script type='x/templates' id="n-form-image-uploader">
	<div class="is-form-image-uploader" ref="form" 
			:class="{'has-selected': selectedImage != null, 'has-no-selected': selectedImage == null, 'is-read-only': readOnly, 'is-valid': valid != null && valid, 'is-invalid': valid != null && !valid, 'is-optional': !field.minimum, 'is-mandatory': field.minimum != null && field.minimum > 1, 'is-form-image-uploader-singular': singular, 'is-form-image-uploader-multiple': !singular, 'is-form-image-uploader-mixed': field.allowNonImages }">
		<div class="is-label-wrapper" v-if="field.label || field.info">
			<label class="is-label" v-if="field.label"><span class="is-label-content" v-html="$services.page.translate(field.label)"></span><n-info :icon="field.infoIcon" v-if="field.info"><span v-html="$services.page.translate(field.info)"></span></n-info></label>
		</div>
		<div class="is-content-before" v-if="field.before" v-html="$services.page.translate(field.before)"></div>
		<div class="is-content-wrapper is-row is-image-container" :class="getChildComponentClasses('image-container')">
			<template v-if="!singular">
				<div v-for="(image, index) in value" class="is-column has-button-close" :class="getChildComponentClasses('image-entry-wrapper')">
					<img class="is-image" v-if="image[typeField].indexOf('image/') == 0" :src="image.$url" @click="selectedImage = image"
						:title="image[nameField]"
						:class="[getChildComponentClasses('image-entry'), {'is-selected': selectedImage == image }]"/>
					<img class="is-image" v-else-if="image[typeField].indexOf('image/') < 0" :src="getPlaceholder(image)" @click="selectedImage = image"
						:title="image[nameField]"
						:class="[getChildComponentClasses('image-entry'), {'is-selected': selectedImage == image }]"/>
					<h6 v-if="field.showFileNames" class="is-h6" :class="getChildComponentClasses('image-title')">{{image[nameField]}}</h6>
					<button type="button" class="is-button is-variant-close is-size-small is-color-danger" @click="remove(index)" v-if="!readOnly"><icon name="times"/></button>
				</div>
			</template>
			<div class="is-column has-button-close" v-else-if="value && value.$url" :class="getChildComponentClasses('image-entry-wrapper')">
				<img class="is-image" v-if="(field.binary && value && value.type && value.type.indexOf('image/') == 0) || (!field.binary && value[typeField].indexOf('image/') == 0)" :src="value.$url" :class="getChildComponentClasses('image-entry')" />
				<img class="is-image" v-else-if="(field.binary && value && value.type && value.type.indexOf('image/') < 0) || (!field.binary && value[typeField].indexOf('image/') < 0)" :src="getPlaceholder(value)" :class="getChildComponentClasses('image-entry')" />
				<h6 v-if="field.showFileNames" class="is-h6" :class="getChildComponentClasses('image-title')">{{value[nameField]}}</h6>
				<button type="button" class="is-button" :class="getChildComponentClasses('file-delete-button')" @click="remove()" v-if="!readOnly"><icon name="times"/></button>
			</div>
			<n-input-file :types='fileTypes' ref='form' :amount='remaining > 1 ? remaining : 1'
				v-if="!readOnly && (remaining == null || remaining > 0)"
				@change='changed'
				:value='files'
				:name='field.name'
				:capture="field.capture"
				:dropLabel='field.dropLabel ? $services.page.translate(field.dropLabel) : null'
				:browseLabel='field.browseLabel ? $services.page.translate(field.browseLabel) : null'
				:browseIcon='field.browseIcon'
				:deleteIcon='field.deleteIcon'
				:visualize-file-names="false"
				class="is-column"
				:class="getChildComponentClasses('file-input')"
				:button-class="getChildComponentClasses('file-input-button')"
				/>
		</div>
		<div v-if="readOnly && field.showLargeSelectedReadOnly" class="is-column" :class="getChildComponentClasses('image-hero-wrapper')">
			<img class="is-image" v-if="selectedImage && selectedImage[typeField].indexOf('image/') == 0" :src="selectedImage.$url" :class="getChildComponentClasses('image-hero')" />
			<img class="is-image" v-else-if="field.emptyImage" :src="field.emptyImage" :class="getChildComponentClasses('image-hero')"/>
			<div v-else-if="selectedImage" class="description">{{selectedImage[nameField]}}</div>
		</div>
		<div v-else-if="(field.binary && !value) || (!field.binary && singular && !value.$url) || (!singular && value.length == 0)" class="file-empty">
			<img class="is-image" v-if="field.emptyImage" :src="field.emptyImage"/>
			<div v-else-if="field.emptyText" class="no-data">{{$services.page.translate(field.emptyText)}}</div>
		</div>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="field.after" v-html="$services.page.translate(field.after)"></div>
	</div>
</script>

<script type='x/templates' id="n-form-image-uploader-configure">
	<div>
		<n-form-text placeholder="1024" v-model="field.maxResolution" label="Maximum pixel dimension" info="This defaults to 1024, if you want unlimited pictures, set to 0" :timeout="600"/>
		<n-form-text label='Label drop' v-model='field.dropLabel' :timeout="600"/>
		<n-form-text label='Label browse' v-model='field.browseLabel' :timeout="600"/>
		<n-form-text label='Icon browse' v-model='field.browseIcon' :timeout="600"/>
		<n-form-switch label="Upload as binary data" v-model="field.binary"/>
		<n-form-text label='Minimum amount' v-model='field.minimum' :timeout="600"/>
		<n-form-text label='Maximum amount' v-model='field.maximum' :timeout="600" v-if="!field.binary"/>
		<n-form-text v-if="!field.emptyText" label='Empty read-only placeholder image' v-model='field.emptyImage' info="The image to show in the main spot when in read-only mode if none has been selected" :timeout="600"/>
		<n-form-text v-if="!field.emptyImage" label='Empty read-only placeholder text' v-model='field.emptyText' info="The text to show in the main spot when in read-only mode if none has been selected" :timeout="600"/>
		<n-form-combo label='Capture mode' :items="['user','environment']" info="The capture attribute specifies that, optionally, a new file should be captured, and which device should be used to capture that new media of a type defined by the accept attribute." v-model="field.capture"/>		
		<n-form-switch label="Allow non-image files" v-model="field.allowNonImages"/>
		<n-form-switch label="Show large selected in read-only mode" v-model="field.showLargeSelectedReadOnly"/>
		<n-form-switch label="Show file names" v-model="field.showFileNames"/>
	</div>
</script> 
<script type='x/templates' id="page-triggerable-configure">
	<div class="is-column is-spacing-vertical-gap-medium">
		<div class="is-row is-align-end is-spacing-horizontal-right-medium">
			<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addTrigger"><icon name="plus"/><span class="is-title">Trigger</span></button>
		</div>
		<div class="is-accordion">
			<n-collapsible  class="is-highlight-left is-color-primary-light" :is-only-one-open="true" :title="'On ' + (trigger.trigger ? trigger.trigger : '?')" v-for="(trigger, triggerIndex) in target[name]" content-class="is-spacing-medium" :start-open="false && triggerIndex == 0">
				<ul slot="buttons" class="is-menu is-variant-toolbar is-align-end is-spacing-horizontal-right-medium">
					<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="target[name].splice(triggerIndex, 1)"><icon name="times"/></button></li>
				</ul>
				<n-form-combo v-model="trigger.trigger" v-if="getTriggerNames().length >= 2" :filter="getTriggerNames" label="Trigger On"/>
				
				<n-form-combo label="Only if error type is" v-model="trigger.triggerError" v-if="trigger.trigger && trigger.trigger.indexOf(':error') > 0" :filter="getTriggerErrorTypes.bind($self, trigger)"/>
				
				<n-form-ace mode="javascript" v-model="trigger.condition" label="Condition" after="You can configure an additional condition that must evaluate to true before the trigger is activated" v-if="!trigger.interval"/>
				<n-form-text v-if="false" v-model="trigger.confirmation" label="Confirmation message" after="You can prompt the user for additional confirmation before executing the trigger"/>
				<n-form-switch v-model="trigger.closeEvent" label="Send close event once done" after="We can emit a close once our trigger is done, closing any window it is in" v-if="allowClosing"/>
				<n-form-text v-model="trigger.errorTrigger" label="Error trigger name" after="You can choose to add another trigger if this one fails to perform actions at that point" :timeout="600" v-if="false" />
				
				<n-form-text v-model="trigger.timeout" label="Timeout" after="You can set this trigger to only run after a certain time has elapsed" suffix="ms" :timeout="600"/>
				<n-form-text v-model="trigger.interval" label="Interval" after="You can run this trigger repeatedly. This does not currently work well together with conditions." suffix="ms" :timeout="600" v-if="!trigger.condition"/>
				
				<div v-for="(action, actionIndex) in trigger.actions" class="is-column is-spacing-medium is-color-body">
					<div class="is-row is-align-end">
						<button class="is-button is-variant-ghost is-size-xsmall" @click="actionUp(trigger, action)"><icon name="chevron-up"/></button>
						<button class="is-button is-variant-ghost is-size-xsmall" @click="actionDown(trigger, action)"><icon name="chevron-down"/></button>
						<button class="is-button is-variant-ghost is-size-xsmall" @click="trigger.actions.splice(actionIndex, 1)"><icon name="times"/></button>
					</div>

					<h4 class="is-h4" v-if="action.type">{{actionTypes.filter(function(x) { return x.name == action.type })[0].title }}</h4>
					
					<n-form-text v-model="action.condition" label="Condition" after="You can configure an additional condition that must evaluate to true before this action is triggered. If not triggered, we continue to the next action."
						:timeout="600"/>
					
					<n-form-radio :items="actionTypes" label="Type of action" v-model="action.type"
						v-if="!action.type"
						:formatter="function(x) { return x.title }"
						:extracter="function(x) { return x.name }"/>
					
					<div v-if="action.type == 'route'" class="is-column is-spacing-gap-medium">
						<n-form-combo v-model="action.route" v-if="!action.url && !action.routeAsFormula" 
							:filter="$services.page.getPageRoutes" 
							:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }" 
							:extracter="function(x) { return x.alias }" 
							label="Route to another page in the application"
							key="button-route"/>
							
						<n-form-ace v-model="action.routeFormula" label="Route formula" v-if="!action.url && !action.route && action.routeAsFormula"/>
						<n-form-ace v-model="action.routeFormulateParameters" label="Route formula parameters" v-if="!action.url && !action.route && action.routeAsFormula"/>
						<n-form-switch v-model="action.routeAsFormula" label="Use formula for route" v-if="!action.url && !action.route"/>
							
						<n-page-mapper v-if="action.route && $services.router.get(action.route)" :to="$services.page.getRouteParameters($services.router.get(action.route))"
							:from="getAvailableParameters(trigger, action)" 
							:key="action.route + '-mapper'"
							v-model="action.bindings"/>
							
						<n-form-text v-model="action.url" label="Route to an external URL" v-if="!action.route && !action.routeFormula" :timeout="600"/>
					
						<n-form-combo v-model="action.anchor" v-show="action.url || action.route" label="Anchor" :filter="getAnchors"
							key="button-anchor"/>
						
						<div v-if="action.route" class="is-column is-spacing-vertical-gap-medium">
							<div class="is-row is-align-end">
								<button class="is-button is-variant-primary-outline is-size-xsmall has-tooltip" @click="action.activeRoutes.push({})">
									<icon name="plus"/>
									<span class="is-text">Active Route</span>
									<span class="is-tooltip is-position-left">The button will be visually marked when its route is active. You can add other routes when the button should be considered active as well.</span>
								</button>
							</div>
							<div v-for="index in $window.Object.keys(action.activeRoutes)" class="has-button-close">
								<n-form-combo v-model="action.activeRoutes[index]"
									:filter="$services.page.getPageRoutes"
									:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }" 
									:extracter="function(x) { return x.alias }" :key="'active-route-' + index"/>
								<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="action.activeRoutes.splice(index, 1)"><icon name="times"/></button>
							</div>
						</div>
						
						<n-form-switch v-model="action.mask" label="Mask the routing" v-if="action.route || action.routeFormula"/>
						
						<div class="is-alert is-variant-danger-outline is-size-small"><span class="is-text">A route action is the final action, anything after this might not get executed</span></div>
					</div>
					
					<div v-else-if="action.type == 'event'" class="is-column is-spacing-gap-medium">
						<page-event-value :page="page" :container="action" title="Event to emit" name="event" :inline="true" :allow-fields="!action.eventContent"
							@resetEvents="$updateEvents"/>
							
						<n-form-combo v-model="action.eventContent" :items="$window.Object.keys($services.triggerable.getInternalState(page, trigger, action, triggers))" label="Event content" after="Choose the event content from the available state"
							v-if="!action.event || !action.event.eventFields || !action.event.eventFields.length"
							@input="$updateEvents"/>
							
						<n-form-switch v-model="action.allowUntrigger" label="Remove event when trigger ends"
							after="Triggers are limited in time, for example a hover effect might stop, a selection might be undone or the button that triggered a click might be removed alltogether. Enable this if you want the event to be unset at that point."/>
					</div>
					
					<div v-else-if="action.type == 'notification'" class="is-column is-spacing-gap-medium">
						<n-form-text v-model="action.notificationDuration" label="Duration" :timeout="600" info="How long the notification should stay up (in ms)"/>
						<n-form-text v-model="action.notificationTitle" label="Title" :timeout="600" info="An optional title for this notification, it can include variables from the originating event using the {{}} syntax"/>
						<n-form-text v-model="action.notificationMessage" label="Message" :timeout="600" info="An optional title for this notification, it can include variables from the originating event using the {{}} syntax"/>
						<n-form-combo v-model="action.notificationColor" label="Color" :filter="getAvailableColors" :extracter="function(x) { return x.name }" :formatter="function(x) { return x.name }" />
						<n-form-combo v-model="action.notificationSeverity" label="Severity" :timeout="600" :items="['success', 'warning', 'error', 'info', 'danger']" :placeholder="info" v-if="false"/>
						<n-form-text v-model="action.notificationIcon" label="Icon" :timeout="600" info="The correct value for this depends on your icon provider"/>
						<n-form-switch v-model="action.notificationCloseable" label="Closeable" info="Can the user explicitly close the notification?"/>
					</div>
					
					<div v-else-if="action.type == 'action'" class="is-column is-spacing-gap-medium">
						<n-form-combo v-model="action.action"
							label="Action to run"
							:filter="$services.page.getAvailableActions.bind($self, $services.page.getPageInstance(page, $self))"
							:formatter="function(x) { return x.title ? x.title : x.name }"
							:extracter="function(x) { return x.name }"
							@input="action.actionTarget = null"
							key="button-action"
							/>
							
						<n-form-combo v-model="action.actionTarget" v-if="action.action"
							label="The target you want to run the action on"
							:filter="$services.page.getActionTargets.bind($self, $services.page.getPageInstance(page, $self), action.action)"
							:formatter="function(x) { return x.name  ? x.name : (x.alias ? $services.page.prettifyRouteAlias(x.alias) : x.id) }"
							:extracter="function(x) { return x.id }"
							key="button-action-target"
							/>
							
						<n-page-mapper v-if="action.action && action.actionTarget && $services.page.getActionInput($services.page.getPageInstance(page, $self), action.actionTarget, action.action)" 
							:to="{properties:$services.page.getActionInput($services.page.getPageInstance(page, $self), action.actionTarget, action.action)}"
							:from="getAvailableParameters(trigger, action)" 
							key="button-action-mapper"
							v-model="action.bindings"/>
							
						<p class="is-p is-size-small" v-if="action.action && action.actionTarget && !$services.page.getActionOutput($services.page.getPageInstance(page, $self), action.actionTarget, action.action)">This action does not have an output</p>
						<div v-else-if="action.action && action.actionTarget">
							<p class="is-p is-size-small">This action has an output. If you emit an event after this action, it will (by default) have the content of the action output. You can also bind the result to a local variable to use in subsequent actions.</p>
							<n-form-text v-model="action.resultName" label="Local variable name of output"/>
						</div>
					</div>
					
					<div v-else-if="action.type == 'javascript'" class="is-column is-spacing-gap-medium">
						<n-form-ace v-model="action.javascript" label="Javascript to execute"/>	
					</div>
					
					<div v-else-if="action.type == 'confirmation'" class="is-column is-spacing-gap-medium">
						<n-form-text v-model="action.confirmation" label="Confirmation message" :timeout="600"/>
					</div>
					
					<div v-else-if="action.type == 'scroll'" class="is-column is-spacing-gap-medium">
						<n-form-text v-model="action.scrollTo" label="Scroll to" placeholder="e.g. .is-messages" :timeout="600"/>
						<n-form-combo v-model="action.scrollBehavior" :items="['smooth', 'instant']" placeholder="smooth" label="Scroll behavior"/>
						<n-form-combo v-model="action.scrollBlock" :items="['start', 'center', 'end', 'nearest']" placeholder="start" label="Vertical scroll position"/>
						<n-form-combo v-model="action.scrollInline" :items="['start', 'center', 'end', 'nearest']" placeholder="nearest" label="Horizontal scroll position"/>
					</div>
					
					<div v-else-if="action.type == 'operation'" class="is-column is-spacing-gap-medium">
						<n-form-combo :key="'operation' + page.content.actions.indexOf(action)" 
							:formatter="function(x) { return x.id }"
							:extracter="function(x) { return x.id }"
							v-model="action.operation" label="Operation" :filter="$services.page.getTriggerOperations" />
							
						<n-page-mapper v-if="action.operation" :to="$services.page.getSimpleKeysFor($services.page.getSwaggerOperationInputDefinition(action.operation), true, true)"
							:key="action.operation + '-mapper'"
							:from="getAvailableParameters(trigger, action)" 
							v-model="action.bindings"/>
							
						<n-form-text v-model="action.resultName" label="Local variable name of the operation output" v-if="action.operation && $window.Object.keys($services.page.getSwaggerOperationOutputDefinition(action.operation)).length > 0"
							after="You can capture the output of this service to use in further actions"/>
					</div>
					
					<div v-else-if="action.type == 'download'" class="is-column is-spacing-gap-medium">
						<n-form-switch v-model="action.allowArbitraryDownload" label="Allow any service"/>
						
						<n-form-combo v-if="!action.allowArbitraryDownload" :key="'operation' + page.content.actions.indexOf(action)" 
							:formatter="function(x) { return x.id }"
							:extracter="function(x) { return x.id }"
							v-model="action.operation" label="Operation" :filter="$services.page.getDownloadOperations" />
						<n-form-combo v-else :key="'any-operation' + page.content.actions.indexOf(action)" 
							:formatter="function(x) { return x.id }"
							:extracter="function(x) { return x.id }"
							v-model="action.operation" label="Operation" :filter="$services.page.getOperations" />
						
						<n-form-text label="File name" v-model="action.fileName"/>
						
						<n-page-mapper v-if="action.operation" :to="$services.page.getSimpleKeysFor($services.page.getSwaggerOperationInputDefinition(action.operation), true, true)"
							:key="action.operation + '-mapper'"
							:from="getAvailableParameters(trigger, action)" 
							v-model="action.bindings"/>
							
						<n-form-combo v-if="action.operation && $services.swagger.operations[action.operation] && ($services.swagger.operations[action.operation]['x-downloadable'] == 'true' || action.allowArbitraryDownload)"
							label="Download as"
							v-model="action.downloadAs"
							:items="['excel', 'csv', 'json', 'xml']"/>
					</div>
					
					<div v-else-if="action.type == 'variable'" class="is-column is-spacing-gap-medium">
						<n-page-mapper :to="{properties:getAvailableParameters(trigger, action)}"
							:from="getAvailableParameters(trigger, action)" 
							:key="action.type + '-mapper'"
							v-model="action.bindings"/>
						<n-form-switch v-model="action.allowUntrigger" label="Reverse when trigger ends"
							after="Triggers are limited in time, for example a hover effect might stop, a selection might be undone or the button that triggered a click might be removed alltogether. Enable this if you want the reverse action to take place at that point."/>
						<n-form-ace v-model="action.defaultValue" label="Default value"/>
					</div>
					
					<div v-else-if="action.type == 'function'" class="is-column is-spacing-gap-medium">
						<n-form-combo v-model="action.function" label="Function" :filter="$services.page.listFunctions" />
						<n-form-text v-if="action.function && $services.page.hasFunctionOutput(action.function)" v-model="action.resultName" label="Local variable name of the function output"/>
						
						<n-page-mapper v-if="action.function" 
							:to="$services.page.getFunctionInput(action.function)"
							:from="getAvailableParameters(trigger, action)" 
							key="button-function-mapper"
							v-model="action.bindings"/>
					</div>
					
					<div v-else-if="action.type == 'visibility'" class="is-column is-spacing-gap-medium">
						<n-form-combo v-model="action.closeableTarget" label="Closeable item" :filter="$services.page.listCloseableItems.bind($self, page)"
							:extracter="function(x) { return x.id }"
							:formatter="function(x) { return $services.page.formatPageItem($services.page.getPageInstance(page), x) }"/>
						<n-form-combo v-model="action.closeableAction"
							placeholder="Unless you set an explicit value, it will toggle" :items="[{name: 'visible', title: 'Show it'}, {name: 'hidden', title: 'Hide it'}]"
							label="Visibility change"
							:extracter="function(x) { return x.name }"
							:formatter="function(x) { return x.title }"/>
							
						<n-form-switch v-model="action.allowUntrigger" label="Reverse when trigger ends"
							after="Triggers are limited in time, for example a hover effect might stop, a selection might be undone or the button that triggered a click might be removed alltogether. Enable this if you want the reverse action to take place at that point."/>
					</div>
						
				</div>
				
				<div class="is-row is-align-end">
					<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addAction(trigger)"><icon name="plus"/><span class="is-title">Action</span></button>
				</div>
			</n-collapsible>
		</div>
	</div>
</script><script type='x/templates' id="big-ace">
	<div class="big-ace">
		<div class="is-row is-align-end is-spacing-medium">
			<button class="is-button is-size-small is-variant-ghost" @click="close"><icon name="times"/></button>
		</div>
		<n-ace :mode='mode' :timeout='timeout' :value='value' @input="function(value) { $emit('input', value) }"/>
	</div>
</script><script type='x/templates' id="data-configure">
	<div class="is-column is-spacing-gap-medium">
		<n-form-combo label="Data type" 
			v-if="!target.type"
			v-model="target.type" :filter="getRepeatTypes"
			:formatter="function(x) { return x.title }"
			:extracter="function(x) { return x.name }"/>
		
		<n-form-combo label="Operation" v-model="target.operation" 
			:filter="$services.page.getArrayOperations"
			v-if="target.type == 'operation'"
			:formatter="function(x) { return x.id }"
			:extracter="function(x) { return x.id }"/>
		<n-form-combo label="Array" v-model="target.array"
			:filter="function(value) { return $services.page.getAllArrays(page) }"
			v-else-if="target.type == 'array'"
			/>
			
		<component v-if="getRepeatConfigurator()" :is="getRepeatConfigurator()" :target="target" :page="page"/>
			
		<n-form-text v-model="target.emptyPlaceholder" label="Empty Place Holder" after="Can be shown if there is no data"/>
		<n-form-text v-model="target.loadingPlaceholder" label="Loading Place Holder" v-if="target.operation" after="Can be shown while the operation is loading data"/>
		
		<div v-for="(defaultOrderBy, index) in target.defaultOrderBy" class="has-button-close">
			<div class="is-row">
				<n-form-combo v-model="defaultOrderBy.name" :filter="getOrderByFields" placeholder="Order by field"/>
				<n-form-combo v-model="defaultOrderBy.direction" :items="['asc', 'desc']" placeholder="Direction"/>
			</div>
			<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="target.defaultOrderBy.splice(index, 1)"><icon name="times"/></button>
		</div>
		<div class="is-row is-align-end" v-if="getOrderByFields()">
			<button @click="target.defaultOrderBy.push({name: null, direction: 'asc'})" class="is-button is-size-small"><icon name="plus"/><span class="is-title">Order by</span></button>
		</div>
		
		<n-page-mapper v-if="target.operation && operationParameters.length > 0 && Object.keys($services.page.getPageParameters(page)).length" 
			:to="operationParameters"
			:from="$services.page.getAvailableParameters(page, null, true)"
			v-model="target.bindings"/>
	</div>
</script>


<script type='x/templates' id="data-pipeline-configure">
	<div class="is-column is-spacing-gap-medium has-button-close">
		<n-form-text v-model="target.runtimeAlias" label="The runtime alias for this data" after="You can expose this data to the rest of the page for other uses"/>
		<data-configure :target="pipeline" :page="page"/>
		<n-form-ace :label="target.operation || target.array ? 'Transformation script' : 'Generation script'" v-model="target.script"/>
		<n-form-ace label="Example of expected output" v-if="target.script" v-model="target.template"/>
		<button v-if="removable" class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="$emit('remove')"><icon name="times"/></button>
		<slot></slot>
	</div>
</script>

<script type='x/templates' id="data-pipelines-configure">
	<div class="is-column is-spacing-gap-medium">
		<data-pipeline-configure :pipeline="pipeline" v-for="(pipeline, index) in target.pipelines" @remove="target.pipelines.splice(index, 1)"
			:removable="allowed != 1"
			:page="page"
			:target="target"
			:edit="edit">
			<slot name="pipeline" :pipeline="pipeline"/>
		</data-pipeline-configure>
		<div class="is-row is-align-end" v-if="allowed == null || allowed > target.pipelines.length">
			<button @click="addPipeline" class="is-button is-variant-primary-outline is-size-small"><icon name="plus"/><span class="is-text">Pipeline</span></button>
		</div>
	</div>
</script><script type='x/templates' id="page-event-value">
	<component :is="inline ? 'div' : 'n-collapsible'" :title="title" class="is-event-value">
		<div :class="{'padded-content': !inline}" class="is-column is-spacing-vertical-gap-small">
			<n-form-text v-model="container[name].name" :label="inline ? title : 'Event Name'" :timeout="600" @input="$updateEvents()" v-if="nameModifiable"/>
			<div v-for="eventField in container[name].eventFields" class="has-button-close is-column is-color-body is-spacing-medium  is-border-full">
				<n-form-text v-model="eventField.name" label="Field Name" :timeout="600"/>
				<n-form-combo v-model="eventField.stateValue" v-if="!eventField.isFixed" label="State Value"
					:filter="function(value) { return (keys ? keys : $services.page.getSimpleKeysFor({properties:$services.page.getAllAvailableParameters(page, null, true)}, true, true)).filter(function(x) { return !value || x.toLowerCase().indexOf(value.toLowerCase()) >= 0 }) }"/>
				<n-form-text v-model="eventField.fixedValue" v-else label="Fixed Value" :timeout="600"/>
				<n-form-switch v-model="eventField.isFixed" label="Fixed?"/>
				<button @click="container[name].eventFields.splice(container[name].eventFields.indexOf(eventField), 1) & $updateEvents()" class="is-button is-variant-close is-size-small"><icon name="times"/></button>
			</div>
		</div>
		<div class="is-row is-align-end is-spacing-vertical-medium" v-if="container[name].name">
			<button v-if="allowFields" class="is-button is-variant-primary-outline is-size-xsmall" @click="addEventField(container[name]) & $updateEvents()"><icon name="plus"/>Event Field</button>
		</div>
	</component>
</script>
<script type='x/templates' id="n-form-page">
	<div class="n-form-component n-form-page">
		<n-page :editable="true" :embedded="true" :page="page" :page-instance-id="page.counter"/>
	</div>
</script><script type='x/templates' id="n-page-mapper">
	<div class="is-column is-spacing-vertical-gap-medium">
		<div v-for="field in fieldsToMap">
			<n-form-combo :label="'Map to ' + field" :labels="sources" :filter="fieldsFrom" 
				class="vertical"
				:value="getValueFor(field)"
				:initial-label="getLabelFor(field)"
				@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(field, newValue, selectedLabel) }"/>
			
			<n-form-switch v-model="value[field].lambda" label="As lambda" 
				v-if="isLambdable(field)"/>

			<n-collapsible :title="'Mapping for: ' + getValueFor(field)" v-if="getLabelFor(field) == '$function'">
				<n-page-mapper 
					v-if="true || !value[field].lambda"
					:to="$services.page.getFunctionInput(getValueFor(field))" 
					:from="from"
					v-model="getBindingsFor(field)"/>
				<n-form-combo label="Output field"
					:filter="$services.page.getFunctionOutput.bind($self, getValueFor(field))"
					v-model="getObjectFor(field).output"/>
			</n-collapsible>
		</div>
	</div>
</script>


<script type='x/templates' id="n-page-mapper2">
	<div class="is-column is-spacing-gap-small">
		
		
		<div v-for="field in mappedFields" class="has-button-close is-column is-spacing-vertical-top-medium">
			
			<div v-if="isFixedValue(field)" class="is-column is-spacing-gap-small">
				<n-form-ace
					mode="javascript"
					:label="'Map to ' + field" 
					v-if="isComputedValue(field)"
					:value="getValueFor(field).substring(1)"
					@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(field, '=' + newValue, 'fixed') }"/>
				<n-form-text v-else
					:label="'Map to ' + field" 
					:value="getValueFor(field)"
					@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(field, newValue, 'fixed') }"/>
				<n-form-switch v-if="allowComputed" :value="isComputedValue(field)" @input="switchComputed(field)" label="Computed value"/>
			</div>
			
			<n-form-combo 
				v-else-if="labelChoice"
				:key="'combo_mapper_' + field"
				:label="'Map to ' + field" 
				:labels="sources" 
				:filter="fieldsFrom" 
				class="vertical"
				:value="getValueFor(field)"
				:initial-label="getLabelFor(field)"
				@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(field, newValue, selectedLabel) }"/>
				
			<n-form-combo 
				v-else
				:key="'combo_mapper_' + field"
				:label="field" 
				:filter="allFieldsFrom" 
				class="vertical"
				:value="getValueFor(field)"
				@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(field, newValue, selectedLabel) }"/>
			
			<button class="is-button is-size-small is-variant-close" @click="removeField(field)"><icon name="times"/></button>
			
			<n-form-switch v-model="value[field].lambda" label="As lambda" 
				v-if="isLambdable(field)"/>

			<n-collapsible :title="'Mapping for: ' + getValueFor(field)" v-if="getLabelFor(field) == '$function'">
				<n-page-mapper 
					v-if="true || !value[field].lambda"
					:to="$services.page.getFunctionInput(getValueFor(field))" 
					:from="from"
					v-model="getBindingsFor(field)"/>
				<n-form-combo label="Output field"
					:filter="$services.page.getFunctionOutput.bind($self, getValueFor(field))"
					v-model="getObjectFor(field).output"/>
			</n-collapsible>
		</div>
		
		<div class="is-column is-spacing-medium is-color-body" v-if="adding">
			<n-form-combo 
				v-model="fieldToAdd"
				placeholder="Field to add"
				:filter="getUnmappedField"/>
				
			<div v-if="false">
				<n-form-radio
					v-model="fieldMode"
					:extracter="function(x) { return x.name }"
					:formatter="function(x) { return x.title }"
					:items="[{name: 'fixed', title: 'Set a fixed value'},{name: 'map', title: 'Map an existing value'}]"/>
					
				<div class="is-row is-align-space-between">
					<button class="is-button is-size-small is-variant-link" @click="resetField">Cancel</button>
					<button class="is-button is-size-small is-variant-primary" @click="addField">Add mapping</button>
				</div>
			</div>
			<div v-else-if="fieldMode == 'mapRecursive'" class="is-column is-spacing-gap-medium">
				<n-form-combo 
					:key="'combo_mapper_recursive'"
					v-model="fieldToMapRecursively"
					label="Field to map recursively"
					:labels="sources" 
					:filter="fieldsFrom"
					@input="function(newValue, formatted, rawValue, selectedLabel) { setValue(fieldToAdd, newValue, selectedLabel) }"/>
				<div class="is-row is-align-space-between">
					<button class="is-button is-size-small is-variant-link" @click="resetField">Cancel</button>
				</div>
			</div>
			<div v-else>
				<div class="is-row is-align-space-between">
					<button class="is-button is-size-small is-variant-link" @click="resetField">Cancel</button>
					<div class="is-row is-wrap-none">
						<button class="is-button is-size-small is-variant-secondary" @click="function() { fieldMode = 'fixed'; addField() }"><icon name="plus"/><span class="is-text">Fixed</span></button>
						<button class="is-button is-size-small is-variant-primary" @click="function() { fieldMode = 'map'; addField() }"><icon name="plus"/><span class="is-text">Mapping</span></button>
						<button v-if="allowRecursiveMapping" class="is-button is-size-small is-variant-primary" @click="function() { fieldMode = 'mapRecursive' }"><icon name="plus"/><span class="is-text">Recursive</span></button>
					</div>
				</div>
			</div>
		</div>
		
		<div class="is-row is-align-end">
			<button class="is-button is-size-xsmall is-variant-primary-outline" :disabled="!unmappedFields.length" @click="adding = true"><icon name="plus"/><span class="is-text">Mapping</span></button>
		</div>
	</div>
</script><script type='x/templates' id="n-form-attachment-uploader-configure">
	<div>
		<n-form-text label='Maximum amount' v-model='field.maxFiles' placeholder="unlimited" :timeout="600" v-if="isArray"/>
		<n-form-text label='Label drop' v-model='field.dropLabel' :timeout="600"/>
		<n-form-text label='Label browse' v-model='field.browseLabel' :timeout="600"/>
		<n-form-text label='Icon browse' v-model='field.browseIcon' :timeout="600"/>
		
		<h4 class="category">Reservation</h4>
		<p class="subscript">Immediately reserve an attachment spot, binary data will be streamed lazily. The output type of the reservation should conform mostly to the expected output type from the upload.</p>
		<n-form-combo key="operation-attachment-reserevation" 
			:formatter="function(x) { return x.id }"
			:extracter="function(x) { return x.id }"
			v-model="field.reservationOperation" label="Operation" :filter="$services.page.getModifyOperations" />
							
		<n-page-mapper v-if="field.reservationOperation" :to="getReservationInputFields()"
			:key="field.reservationOperation + '-mapper'"
			:from="getAvailableReservationParameters()" 
			v-model="field.reservationBindings"/>
			
		<h4 class="category">Upload</h4>
		<p class="subscript" v-if="field.uploadOperation">Once the reservations are done, they will be added to the bound value. After that uploading of the binary data will start..</p>
		<p class="subscript" v-else>Once a file is selected, we will start uploading, the result from this service is added to the value</p>
		<n-form-combo key="operation-attachment-upload" 
			:formatter="function(x) { return x.id }"
			:extracter="function(x) { return x.id }"
			v-model="field.uploadOperation" label="Operation" :filter="$services.page.getModifyOperations" />
							
		<n-page-mapper v-if="field.uploadOperation" :to="$services.page.getSimpleKeysFor($services.page.getSwaggerOperationInputDefinition(field.uploadOperation), true, true)"
			:key="field.uploadOperation + '-mapper'"
			:from="getAvailableUploadParameters()" 
			v-model="field.uploadBindings"/>
			
		<n-form-combo key="operation-attachment-url" 
			v-if="field.uploadOperation && field.reservationOperation"
			label="URL field"
			after="We can temporarily store a frontend URL in a reserved document until the actual store is ready"
			v-model="field.urlField" 
			:filter="getOutputUrlFieldOptions" />

		<n-form-section v-for='(fileType, index) in field.fileTypes' class="is-column is-color-body is-spacing-medium has-button-close">
			<n-form-text v-model="fileType.contentType" label="Content Type" placeholder="image/*" :timeout="600"/>
			<button class="is-button is-variant-close is-size-small" @click="field.fileTypes.splice(index, 1)"><icon name="times"/></button>
		</n-form-section>
		<div class="is-row is-align-end">
			<button class="is-button is-variant-primary-outline is-size-xsmall" @click="field.fileTypes.push({})"><span class="fa fa-plus"></span>Filetype</button>
		</div>
			
		<h4 class="category">Images</h4>
		<n-form-text label='Max width' v-model='field.maxWidth' :timeout="600"/>
		<n-form-text label='Max height' v-model='field.maxHeight' :timeout="600"/>
		
	</div>
</script> 


<script type='x/templates' id="n-form-attachment-uploader">
	<div class="n-form-attachment-uploader">
		<n-input-file :types="allowedFileTypes" ref='form' :amount='remaining > 1 ? remaining : 1'
			v-if="!readOnly && (remaining == null || remaining > 0)"
			@change='changed'
			:value='files'
			:name='field.name'
			:disabled="disabled"
			:capture="field.capture"
			:dropLabel='field.dropLabel ? $services.page.translate(field.dropLabel) : null'
			:browseLabel='field.browseLabel ? $services.page.translate(field.browseLabel) : null'
			:browseIcon='field.browseIcon'
			:deleteIcon='field.deleteIcon'
			:visualize-file-names="false"
			class="is-column"
			:class="getChildComponentClasses('file-input')"
			:button-class="[getChildComponentClasses('file-input-button'), {'has-text': field.browseLabel, 'has-icon': field.browseIcon }]"
			/>
		<n-messages :messages="messages" v-if="messages && messages.length"/>
		<div class="is-content-after" v-if="field.after" v-html="$services.page.translate(field.after)"></div>
	</div>
</script><script type='x/templates' id="page-image-configure">
	<div class="is-column is-spacing-medium">
		<div v-if="!cell.state.imageType">
			<n-form-radio label="Type of image"
				v-model="cell.state.imageType"
				:items="[{name: 'variable', title: 'Based on variable'}, {name: 'static', title: 'Static image'}, {name: 'operation', title: 'Image loaded from a REST call'}, {name: 'bytes', title: 'Image loaded from a byte array'}]"
				:formatter="function(x) { return x.title }"
				:extracter="function(x) { return x.name }"/>
		</div>
		<div v-else-if="cell.state.imageType == 'static'" class="is-column is-spacing-gap-medium">
			<n-form-text v-model="cell.state.href" label="Full Link" v-if="!cell.state.imagePath"/>
			<n-form-text v-model="cell.state.imagePath" label="Image path to search" v-if="!cell.state.href"/>
			<n-form-switch v-model="cell.state.absolute" label="Absolute" v-if="!cell.state.inline"/>
			<div class="is-inline-image-menu" v-if="edit">
				<button class="is-button is-variant-primary is-size-xsmall is-position-center" :disabled="!hasPrevious" @click="previous"><icon name="chevron-left"/><span class="is-text">Previous</span></button>
				<n-input-file v-model="files" @change="upload" :types="['image/*']"/>
				<button class="is-button is-variant-primary is-size-xsmall is-position-center" :disabled="!hasNext" @click="next"><icon name="chevron-right"/><span class="is-text">Next</span></button>
			</div>
		</div>
		<div v-else-if="cell.state.imageType == 'operation'" class="is-column is-spacing-gap-medium">
			<n-form-combo v-model="cell.state.imageOperation" :filter="$services.page.getBinaryOperations"
				label="Operation to use"
				:formatter="function(x) { return x.id }"
				:extracter="function(x) { return x.id }"/>
				
			<n-page-mapper v-if="cell.state.imageOperation" 
				:to="$services.page.getSwaggerOperationInputDefinition(cell.state.imageOperation)"
				:from="$services.page.getAllAvailableParameters(page)" 
				:key="cell.state.operation + '-image-mapper'"
				v-model="cell.state.bindings"/>
		</div>
		<div v-else-if="cell.state.imageType == 'bytes'" class="is-column is-spacing-gap-medium">
			<p class="is-p">Add mappings for the byte content</p>
			<n-page-mapper 
				:to="['byteValue', 'contentTypeValue']"
				:from="$services.page.getAllAvailableParameters(page)" 
				:key="cell.state.operation + '-image-byte-data'"
				v-model="cell.state"/>
			<n-form-combo v-model="cell.state.byteValue" :filter="getAllKeys" label="Byte field" v-if="false"/>
			<n-form-combo v-model="cell.state.contentTypeValue" :filter="getAllKeys" label="Content type field" placeholder="image/jpeg" v-if="false"/>
		</div>
		<div v-else-if="cell.state.imageType == 'variable'" class="is-column is-spacing-gap-medium">
			<n-form-combo v-model="cell.state.imageUrlVariable" :filter="function(value) { return $services.page.getPageVariables(page, value) }"
				label="URL Variable"/>
		</div>
		
		<div v-if="cell.state.imageType" class="is-column is-spacing-gap-medium">
			<n-form-text v-model="cell.state.title" label="Title"/>
			<n-form-text v-model="cell.state.emptyImage" label="The placeholder image to show if no image is available"/>
			<div class="is-row is-align-end is-spacing-vertical-medium">
				<button class="is-button is-variant-danger-outline is-size-xsmall" @click="cell.state.imageType = null">Reset Image Type</button>
			</div>
		</div>
	</div>
</script>

<script type='x/templates' id="page-image">
	<img :src="calculatedUrl ? calculatedUrl : emptyImage"
		class="is-image"
		:draggable="false"
		:class="getChildComponentClasses('image')"
		:title="title"/>
</script><script type='x/templates' id="page-markdown-text">
	<template v-if="edit">
		<textarea style="min-height:100%" :rows="rowHeight" v-model="cell.state.content"></textarea>
	</template>
	<template v-else>
		<article class="is-article" v-content="formatted"/>
	</template>
</script><script type='x/templates' id="nabu-pages">
	<div class="nabu-pages">
		<ul class="is-row is-menu is-variant-toolbar is-dark is-main-top is-primary-highlight is-content-width-large is-height-fixed-3">
			<li class="is-column"><button @click="selectedTab = 'pages'" class="is-button is-variant-ghost-lighter is-size-small is-wrap-none"><img class="is-icon" src="/resources/images/branding/nabu-logo.svg"/><span class="is-text">Page Builder</span></button></li>
			<li class="is-column is-position-right" @click="selectedTab = 'pages'"><button :class="{'is-active': selectedTab == 'pages' }" class="is-button is-variant-ghost-lighter is-size-small"><icon name="file-alt"/><span class="is-text">Pages</span></button></li>
			<li class="is-column" @click="selectedTab = 'settings'"><button :class="{'is-active': selectedTab == 'settings' }" class="is-button is-variant-ghost-lighter is-size-small"><icon name="cogs"/><span class="is-text">Settings</span></button></li>
			<li class="is-column" @click="selectedTab = 'script'"><button :class="{'is-active': selectedTab == 'script' }" class="is-button is-variant-ghost-lighter is-size-small"><icon name="file-code"/><span class="is-text">Script</span></button></li>
			<li v-for="entry in getAdditionalSettings()" class="is-column" @click="selectedTab = entry.route"><button :class="[{'is-active': selectedTab == entry.route }, 'setting-' + entry.name]" class="is-button is-variant-ghost-lighter is-size-small"><icon v-if="entry.icon" :name="entry.icon"/><span class="is-text">{{entry.title}}</span></button></li>
		</ul>
		<div class="is-row is-content-width-large is-direction-vertical is-height-remainder-3 is-overflow-auto" v-if="$services.page.canEdit">
			<n-prompt v-if="showing" class="is-modal">
				<n-form class="is-color-background is-spacing-large is-shadow-xsmall is-variant-vertical">
					<h3 class="is-h3">Page properties</h3>
					<n-form-section>
						<n-form-text v-for="key in Object.keys(parameters)" v-model="parameters[key]" :label="key"/>
					</n-form-section>
					<footer class="is-row is-align-space-between">
						<button @click="showing=false" class="is-button is-variant-link">Cancel</button>
						<button @click="doRoute" class="is-button is-variant-primary">Open page</button>
					</footer>
				</n-form>
			</n-prompt>
			<n-form v-if="$services.page.canEdit()" mode="component" ref="form">
				<div v-if="selectedTab == 'settings'">
					<h1 class="is-h1">General Settings</h1>
					<div class="divider">
						<p class="subscript">Configure some general settings for your application.</p>
					</div>
					
					<div class="panes">
						<div class="pane">
							<h4 class="category">Basic</h4>
							<div class="padded-content">
								<n-form-text v-model="$services.page.title" label="The website title as shown in the top bar" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-combo v-model="$services.page.home" label="Guest Home Page" :filter="$services.page.getRoutes" @input="$services.page.saveConfiguration"/>
								<n-form-combo v-model="$services.page.homeUser" label="User Home Page" :filter="$services.page.getRoutes" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.googleSiteVerification" label="Google site verification code" :timeout="600" @input="$services.page.saveConfiguration" v-if="false"/>
								<n-form-text v-model="$services.page.geoRefusalTimeout" label="Timeout (in hours) that a geo refusal is stored" info="No timeout means we have no geo enabled" type="number" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.theme" label="The theme to use for this application" :timeout="600" @input="$services.page.saveConfiguration"/>
							</div>
						</div>
						<div class="pane">
							<h4 class="category">Branding</h4>		
							<div class="padded-content">
								<n-form-text v-model="$services.page.branding.siteName" label="The name of your site" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.favicon" placeholder="/resources/images/logo.png" label="The location of the favicon" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.title" :placeholder="$services.page.title" label="The meta title for your application" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.description" label="The meta description for your application" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.image" placeholder="/resources/images/hero.png" label="The meta image for your application, minimum 1200×630 pixels, max 1mb" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.imageAlt" label="Alternative text for your main image" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.facebookAppId" label="Your facebook app id" info="Mostly interesting for analytics" placeholder="your_app_id" :timeout="600" @input="$services.page.saveConfiguration"/>
								<n-form-text v-model="$services.page.branding.twitterUserName" placeholder="@website-username" info="Mostly interesting for analytics" label="Your facebook app id" :timeout="600" @input="$services.page.saveConfiguration"/>
							</div>
						</div>
					</div>
					<div class="odd-block">
						<div class="divider">
							<h1>Application Properties</h1>
							<p class="subscript">You can add configuration properties to your application that you can reuse in all pages.</p>
						</div>
						<div class="panes">
							<div class="pane">
								<h4 class="category">Static</h4>	
								<div class="padded-content">
									<p class="subscript">A static property remains the same across environments.</p>
								</div>
								<div class="list-actions">
									<button @click="$services.page.properties.push({key:null,value:null})"><span class="fa fa-plus"></span>Static property</button>
								</div>
								<div class="padded-content">
									<div class="list-row" v-for="property in $services.page.properties">
										<n-form-text v-model="property.key" label="Key" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="property.value" label="Value" :timeout="600" @input="$services.page.saveConfiguration"/>
										<span @click="$services.page.properties.splice($services.page.properties.indexOf(property), 1); $services.page.saveConfiguration()" class="fa fa-times"></span>
									</div>
								</div>
							</div>
							<div class="pane">
								<h4 class="category">Environment</h4>	
								<div class="padded-content">
									<p class="subscript">An environment property can be configured differently per environment.</p>
								</div>
								<div class="list-actions">
									<button @click="$services.page.environmentProperties.push({key:null,value:null})"><span class="fa fa-plus"></span>Environment property</button>
								</div>
								<div class="padded-content">
									<div class="list-row" v-for="property in $services.page.environmentProperties">
										<n-form-text v-model="property.key" label="Key" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="property.value" label="Value" :timeout="600" @input="$services.page.saveConfiguration"/>
										<span @click="$services.page.environmentProperties.splice($services.page.environmentProperties.indexOf(property), 1); $services.page.saveConfiguration()" class="fa fa-times"></span>
									</div>
								</div>
							</div>
							<div class="pane">
								<h4 class="category">State</h4>	
								<div class="padded-content">
									<p class="subscript">Retrieve data from the backend that can be used by all your pages.</p>
								</div>
								<div class="list-actions">
									<button @click="$services.page.applicationState.push({name:null,operation:null})"><span class="fa fa-plus"></span>State</button>
								</div>
								<div class="padded-content">
									<div class="list-row" v-for="state in $services.page.applicationState">
										<n-form-text v-model="state.name" :required="true" label="State Name" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-combo v-model="state.operation" :filter="$services.page.getStateOperations" label="Operation" @input="$services.page.saveConfiguration"/>
										<span @click="$services.page.applicationState.splice($services.page.applicationState.indexOf(state), 1); $services.page.saveConfiguration()" class="fa fa-times"></span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<div v-else-if="selectedTab == 'pages'" @drop="dropOnPages($event)" @dragover="dragOverPages($event)" class="is-column is-variant-cards">
					<div class="is-column is-variant-card">
						<div class="is-row is-variant-card-header">
							<h1 class="is-h1">Pages</h1>
							<ul class="is-menu is-variant-toolbar is-row is-position-right is-position-cross-center">
								<li class="is-column"><button class="is-button is-size-small is-variant-primary has-tooltip" @click="create()"><icon name="plus"/><span class="is-text">Add page</span><span class="is-tooltip is-position-top is-width-medium">Add a new page to your application</span></button></li>
								<li class="is-column" v-if="hasTemplates"><button class="is-button is-size-small is-variant-primary-outline has-tooltip" @click="showTemplates = true"><icon name="plus"/><span class="is-text">Add template</span><span class="is-tooltip is-position-top is-width-medium">Add an existing template page to your application</span></button></li>
							</ul>
						</div>
						<div class="is-row is-variant-card-content">
							<p class="is-p">In this section you can manage all the pages available in your application.</p>
							<p class="is-p">Pages are divided into categories allowing you to group them together in whatever way you see fit.</p>
						</div>
					</div>
					<div v-for="category in categories" class="is-column is-variant-card">
						<div class="is-row is-variant-card-header">
							<h3 class="is-h3" :key="category" :ref="'category_' + category">
								<span class="is-text">{{category}}</span>
							</h3>
							<ul class="is-menu is-variant-toolbar is-position-right is-position-cross-center">
								<li class="is-column"><button class="is-button is-size-small is-variant-primary has-tooltip" @click="create(category)"><icon name="plus"/><span class="is-text">Add page</span><span class="is-tooltip is-position-top is-width-medium">Add a new page to this category</span></button></li>
								<li class="is-column"><button class="is-button is-variant-primary-outline is-size-small has-tooltip" @click="copyCategory(category)"><icon name="copy"/><span class="is-text">Copy category</span><span class="is-tooltip is-position-top is-width-medium">Copy all pages in this category</span></button></li>
							</ul>
						</div>
						<div class="is-row is-variant-card-content">
							<n-collapsible :only-one-open="true" :title="page.content.label ? page.content.label : (page.name ? page.name : 'Unnamed Page')" v-for="page in getPagesFor(category)" :key="page.id" :after="getPageTypeBadge(page)">
								<ul slot="buttons" class="is-menu is-variant-toolbar is-align-end">
									<li class="is-column"><button class="is-button is-size-small is-variant-primary has-tooltip" @click="route(page)" title="Open this page"><icon name="search"/><span class="is-tooltip is-position-top">Open page</span></button></li>
									<li class="is-column"><button class="is-button is-size-small is-variant-primary-outline has-tooltip" @click="copy(page)"><icon name="copy"/><span class="is-tooltip is-position-top">Copy page</span></button></li>
									<li class="is-column"><button class="is-button is-size-small is-variant-danger-outline has-tooltip" @click="remove(page)"><icon name="trash"/><span class="is-tooltip is-position-top is-color-danger">Delete page</span></button></li>
								</ul>
								<div class="is-row is-spacing-horizontal-gap-large">
									<n-form class="is-form is-fill-normal is-variant-vertical" content-class="is-variant-card-contrast is-column">
										<n-form-text :value="page.content.label ? page.content.label : page.name" label="Page name" :required="true" :timeout="600" @input="function(newValue) { updatePageName(page, newValue) }" 
											after="The page name must be unique across the application"
											:suffix="page.content.name"/>
										<n-form-text v-if="!page.content.initial" v-model="page.content.path" label="Path" :timeout="600" @input="save(page)"
											after="The path that this page can be reached on, it should always start with a leading slash"
											placeholder="No path set, this page can not be browsed to"/>
										<n-form-text v-model="page.content.category" label="Category" :timeout="600" @input="save(page)"
											after="The category this page belongs to"/>
										<n-form-switch label="Is slow" v-if="!page.content.initial" v-model="page.content.slow" @input="save(page)"
											after="When this page is slow, we can show a loading icon when the user wants to reach it"/>
										<n-form-combo v-if="!page.content.initial" v-model="page.content.pageParent" label="Page Parent" :timeout="600" @input="save(page)"
											placeholder="No page parent"
											empty-value="No available parents"
											after="Choose the parent page in which this page is nested by default when the user browses to it"
											:filter="function(value) { return $services.page.getParentRoutes(value, [page.content.name]) }"/>
										<n-form-text
											v-model="page.content.defaultAnchor" label="Default Content Anchor" :timeout="600" @input="save(page)" placeholder="No content anchor"
											after="The content anchor is where child pages will automatically be routed as needed"/>
										<n-form-switch after="Set this page as a default common root to all other pages that don't have any parent specified"
											v-if="false && page.content.defaultAnchor" label="Is default parent page" v-model="page.content.initial" @input="save(page)"/>
										<n-form-text v-model="page.content.title" label="Title" after="You can fill in a custom application title that will appear when this page is routed" :timeout="600" @input="save(page)"
											/>
										<!-- support for pages with input values -->
									</n-form>
									<div class="is-column is-spacing-vertical-gap-medium is-fill-normal">
										<h3 class="is-h3">
											<span class="is-text">Metadata</span>
											<ul class="is-menu is-variant-toolbar is-position-right">
												<li class="is-column"><button class="is-button is-variant-warning is-align-end is-size-small" @click="page.content.properties ? page.content.properties.push({}) : $window.Vue.set(page.content, 'properties', [{}])"><span class="fa fa-plus"></span>Property</button></li>
											</ul>
										</h3>
										<p class="is-p">You can add custom metadata properties to your page.</p>
										<div v-if="page.content.properties" class="is-column is-spacing-vertical-gap-medium">
											<n-form v-for="property in page.content.properties" class="has-button-close is-spacing-large is-color-body is-variant-vertical">
												<div class="is-row is-spacing-horizontal-gap-medium">
													<n-form-text v-model="property.key" label="Key" :timeout="600" @input="save(page)" class="is-fill-normal"/>
													<n-form-text v-model="property.value" label="Value":timeout="600" @input="save(page)" class="is-fill-normal"/>
													<button @click="page.content.properties.splice(page.content.properties.indexOf(property), 1)" class="is-button is-variant-close"><icon name="times"/></button>
												</div>
											</n-form>
										</div>
									</div>
								</div>
							</n-collapsible>
						</div>
					</div>
					<n-sidebar v-if="showTemplates" @close="showTemplates = false" class="page-components-overview">
						<n-collapsible v-for="category in templateCategories" :title="$services.page.prettify(category)" content-class="is-pattern-underline">
							<div class="is-row is-height-fixed-4 is-align-cross-center is-spacing-horizontal-medium is-spacing-vertical-small is-highlight-light is-cursor-pointer" v-for="template in getTemplateCategory(category)" :class="{'is-selected': selectedTemplates.indexOf(template) >= 0 }" :draggable="true" 
									@dragstart="dragTemplate($event, template)">
								<img :draggable="false" :src="'/resources/' + template.icon" v-if="template.icon && template.icon.match(/^.*\.[^.]+$/)" class="is-column is-width-column-1"/>
								<icon v-else-if="template.icon" :name="template.icon" class="is-column is-width-column-1"/>
								<div class="is-column is-width-column-11">
									<h5 class="is-h5 is-size-medium">{{ template.name }}</h5>
									<p class="is-p is-size-xsmall" v-if="template.description">{{ template.description }}</p>
								</div>
							</div>
						</n-collapsible>
					</n-sidebar>
				</div>
				
				<div v-else-if="selectedTab == 'script'">
					<div class="odd-block">
						<div class="panes">
							<div class="pane">
								<h4 class="category">Devices</h4>
								<p class="subscript category-subscript">You can define a device based on the width (in pixels). You can use these devices to conditionally render content both in page builder and in scss.</p>
								<div class="padded-content">
									<div class="list-actions">
										<button @click="$services.page.devices.push({name:null,width:0})"><span class="fa fa-plus"></span>Device</button>
									</div>
									<div class="padded-content">
										<div class="list-row">
											<n-form-text :value="'phone'" :required="true" label="Device Name" :disabled="true"/>
											<n-form-text v-model="getDevice('phone').width" type="number" label="Width" :timeout="600" @input="$services.page.saveConfiguration" placeholder="512"/>
										</div>
										<div class="list-row">
											<n-form-text :value="'tablet'" :required="true" label="Device Name" :disabled="true"/>
											<n-form-text v-model="getDevice('tablet').width" type="number" label="Width" :timeout="600" @input="$services.page.saveConfiguration" placeholder="960"/>
										</div>
										<div class="list-row">
											<n-form-text :value="'desktop'" :required="true" label="Device Name" :disabled="true"/>
											<n-form-text v-model="getDevice('desktop').width" type="number" label="Width" :timeout="600" @input="$services.page.saveConfiguration" placeholder="1280"/>
										</div>
										<div class="list-row">
											<n-form-text :value="'wide'" :required="true" label="Device Name" :disabled="true"/>
											<n-form-text v-model="getDevice('wide').width" type="number" label="Width" :timeout="600" @input="$services.page.saveConfiguration" placeholder="2560"/>
										</div>
										<div class="list-row" v-for="device in $services.page.devices.filter(function(x) { return x.name != 'phone' && x.name != 'tablet' && x.name != 'desktop' && x.name != 'wide' })">
											<n-form-text v-model="device.name" :required="true" label="Device Name" :timeout="600" @input="$services.page.saveConfiguration"/>
											<n-form-text v-model="device.width" type="number" label="Width" :timeout="600" @input="$services.page.saveConfiguration"/>
											<span @click="$services.page.devices.splice($services.page.devices.indexOf(device), 1); $services.page.saveConfiguration()" class="fa fa-times"></span>
										</div>
									</div>
								</div>
							</div>
							<div class="pane">
								<h4 class="category">Imports</h4>
								<p class="subscript category-subscript">Import scripts from external providers like google maps. If you made an application variable called for example 'myApiKey', you can use it in your import url with this syntax: <code v-pre>https://example.com?apikey={{ application.myApiKey }}</code></p>
								<div class="padded-content">
									<div class="list-actions">
										<button @click="$services.page.imports.push({link:null, type: 'javascript', async: true})"><span class="fa fa-plus"></span>Import</button>
									</div>
									<div class="padded-content">
										<div class="list-row" v-for="single in $services.page.imports">
											<n-form-text v-model="single.link" :required="true" label="Link" :timeout="600" @input="$services.page.saveConfiguration"/>
											<n-form-combo v-if="false" v-model="single.type" :items="['javascript', 'css']" label="Type" :timeout="600" @input="$services.page.saveConfiguration"/>
											<n-form-switch v-model="single.async" label="Asynchronous" :timeout="600" @input="$services.page.saveConfiguration"/>
											<span @click="$services.page.imports.splice($services.page.imports.indexOf(single), 1); $services.page.saveConfiguration()" class="fa fa-times"></span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<div v-else v-route-render="{alias: selectedTab}"></div>
			</n-form>
		</div>
		<div v-else>You don&#39;t have permission to view this page, you might want to try to <a v-route:login>log in</a> as a user with sufficient privileges</div>
	</div>
</script>

<script type='x/templates' id="nabu-create-page">
	<n-form class="is-color-background is-spacing-large is-shadow-xsmall is-variant-vertical" ref="form">
		<h3 class="is-h3">Add a new page</h3>
		<n-form-section>
			<n-form-text v-model="name" label="Page name" :required="true" :validator="validator" after="The name of your page should be unique within your application"/>
			<div v-if="!fixedCategory" class="is-column is-spacing-vertical-gap-medium">
				<n-form-switch :invert="true" label="Add to an existing category" v-model="newCategory" v-if="hasAnyCategories"/>
				<n-form-combo v-if="!newCategory" v-model="category" label="Existing Category" :required="true" :filter="checkCategory" after="Choose an existing category"/>
				<n-form-text v-else v-model="category" label="New Category" :required="true" after="Create a new category with this name"/>
			</div>
		</n-form-section>
		<footer class="is-row is-align-space-between">
			<button @click="$reject" class="is-button is-variant-link" type="button">Cancel</button>
			<button @click="$resolve({category:fixedCategory ? fixedCategory : category, name:name})" type="submit" class="is-button is-variant-primary">Add</button>
		</footer>
	</n-form>
</script>

<script type='x/templates' id="nabu-pages-paste">
	<n-form class="is-color-background is-spacing-large is-shadow-xsmall is-variant-vertical" ref="form">
		<n-form-section>
			<n-form-text v-model="category" label="Paste in category" :required="true"/>
			<n-form-text v-model="name" label="Paste with name" :required="true"/>
		</n-form-section>
		<footer class="is-row is-align-space-between">
			<button @click="$reject" class="is-button is-variant-link" type="button">Cancel</button>
			<button @click="$resolve({category:category, name:name})" class="is-button is-variant-primary" type="submit">Add</button>
		</footer>
	</n-form>
</script>
<script type='x/templates' id="page-form-configure-all">
	<n-form class="is-variant-floating-labels">
		<n-collapsible title="Form Settings" content-class="is-spacing-medium">
			<n-form-combo label="Operation" :value="operation" :filter="getOperations"
				@input="updateOperation"
				:formatter="function(x) { return x.id }"
				v-if="!cell.state.pageForm && !cell.state.functionForm"/>
			<n-form-switch label="Page form" v-model="cell.state.pageForm"
				v-if="!cell.state.operation && !cell.state.functionForm"/>
			<n-form-switch label="Function form" v-model="cell.state.functionForm"
				v-if="!cell.state.operation && !cell.state.pageForm"/>
			<n-form-combo label="Function" v-model="cell.state.functionId" v-if="cell.state.functionForm" 
				:filter="$services.page.listFunctions"/>
			<div class="list-actions">
				<button @click="generateForm"><span>Generate form</span></button>
			</div>
			<n-form-text v-model="cell.state.title" label="Title" :timeout="600"/>
			<n-form-text v-model="cell.state.formId" label="Form Id" :timeout="600"/>
			<n-form-text v-model="cell.state.componentGroup" label="Component Group" :timeout="600"/>
			<n-form-text v-model="cell.state.analysisId" label="Analysis Id" info="You can set an explicit name for this form for analysis purposes" :timeout="600"/>
			<n-form-text v-model="cell.state.class" label="Form Class" :timeout="600"/>
			<n-form-switch v-model="cell.state.immediate" label="Save On Change"/>
			<n-form-text v-model="cell.state.cancel" v-if="!cell.state.immediate" label="Cancel Label" :timeout="600"/>
			<n-form-text v-model="cell.state.ok" v-if="!cell.state.immediate" label="Ok Label" :timeout="600"/>
			<n-form-text v-model="cell.state.next" v-if="!cell.state.immediate && cell.state.pages.length > 1" label="Next Label" :timeout="600"/>
			<n-form-text v-model="cell.state.previous" v-if="!cell.state.immediate && cell.state.pages.length > 1" label="Previous Label" :timeout="600"/>
			<n-form-text v-model="cell.state.event" label="Success Event" :timeout="600" @input="$updateEvents()"/>
			<n-form-text v-model="cell.state.cancelEvent" label="Cancel Event" :timeout="600" @input="$updateEvents()"/>
			<n-form-text v-if="cell.state.event" v-model="cell.state.submitEvent" label="Submit Event" @input="$updateEvents()" :timeout="600"/>
			<n-form-text v-if="cell.state.operation || cell.state.functionForm" v-model="cell.state.errorEvent" label="Error Event" :timeout="600" @input="$updateEvents()" :timeout="600"/>
			<n-form-text v-model="cell.state.errorEventCodes" label="Error Event Codes" v-if="cell.state.errorEvent" :timeout="600"/>
			<n-form-switch v-if="!cell.state.pageForm && !cell.state.functionForm" v-model="cell.state.synchronize" label="Synchronize Changes"/>
			<n-form-switch v-model="cell.state.autofocus" label="Autofocus"/>
			<n-form-switch v-model="cell.state.autoclose" label="Autoclose"/>
			<n-form-switch v-if="cell.state.pages.length >= 2" v-model="cell.state.pageTabs" label="Pages as tabs"/>
			<n-form-switch v-if="cell.state.pages.length >= 2" v-model="cell.state.partialSubmit" label="Allow partial submit"/>
			<n-form-switch v-model="cell.state.allowReadOnly" label="Allow read only mode"/>
			<n-form-switch v-if="cell.state.allowReadOnly" v-model="cell.state.startAsReadOnly" label="Start in read only mode"/>
			<n-form-switch v-if="cell.state.allowReadOnly" v-model="cell.state.onlyOneEdit" label="Allow only one in edit mode"/>
			<n-form-text v-if="cell.state.allowReadOnly" v-model="cell.state.edit" label="Edit Label" :timeout="600"/>
			<n-form-text v-if="cell.state.allowReadOnly" v-model="cell.state.editIcon" label="Edit Icon" :timeout="600"/>
			<n-form-text v-model="cell.state.mode" label="Message Mode (the literal 'component' or a number)" :timeout="600"/>
			<n-form-text v-model="cell.state.formValidationMessages" label="Amount of validation messages to show at form level" placeholder="0"/>
			<n-form-text v-model="cell.state.validationTimeout" label="Validation Timeout" :timeout="600"/>
			<n-form-switch v-model="cell.state.validateOnBlur" label="Validate on blur"/>
			
			<div class="list-actions">
				<button @click="!cell.state.submitOnEvent ? $window.Vue.set(cell.state, 'submitOnEvent', [null]) : cell.state.submitOnEvent.push(null)"><span class="fa fa-plus"></span>Submit Event Listener</button>
			</div>
			<div class="padded-content" v-if="cell.state.submitOnEvent">
				<div v-for="i in Object.keys(cell.state.submitOnEvent)" class="list-row">
					<n-form-combo v-model="cell.state.submitOnEvent[i]"
						label="Submit on event"
						:filter="function(x) { return $services.page.getPageInstance(page, $self).getAvailableEvents() }"/>
					<span @click="cell.state.submitOnEvent.splice(i, 1)" class="fa fa-times"></span>
				</div>
			</div>
			
			<div class="list-actions">
				<button @click="!cell.state.cancelOnEvent ? $window.Vue.set(cell.state, 'cancelOnEvent', [null]) : cell.state.cancelOnEvent.push(null)"><span class="fa fa-plus"></span>Cancel Event Listener</button>
			</div>
			<div class="padded-content" v-if="cell.state.cancelOnEvent">
				<div v-for="i in Object.keys(cell.state.cancelOnEvent)" class="list-row">
					<n-form-combo v-model="cell.state.cancelOnEvent[i]"
						label="Cancel on event"
						:filter="function(x) { return $services.page.getPageInstance(page, $self).getAvailableEvents() }"/>
					<span @click="cell.state.cancelOnEvent.splice(i, 1)" class="fa fa-times"></span>
				</div>
			</div>
		</n-collapsible>
		<n-collapsible title="Value Binding" v-if="!cell.state.pageForm" content-class="is-spacing-medium">
			<div class="list-row">
				<n-form-combo :items="Object.keys(availableParameters)" v-model="autoMapFrom"/>
				<button @click="automap" :disabled="!autoMapFrom">Automap</button>
			</div>
			<div class="padded-content">
				<n-page-mapper :to="fieldsToAdd" :from="availableParameters" 
					v-model="cell.bindings"/>
			</div>
		</n-collapsible>
		<n-collapsible title="Validation Codes" content-class="is-spacing-medium">
			<div v-if="cell.state.codes">
				<div class="list-row" v-for="code in cell.state.codes">
					<n-form-text v-model="code.code" label="Code" :timeout='600'/>
					<n-form-text v-model="code.title" label="Title" :timeout='600'/>
					<span @click="cell.state.codes.splice(cell.state.codes.indexOf(code), 1)" class="fa fa-times"></span>
				</div>
			</div>
			<div class="list-actions">
				<button @click="cell.state.codes ? cell.state.codes.push({code:null,title:null}) : $window.Vue.set(cell.state, 'codes', [{code:null,title:null}])">Add code</button>
			</div>
		</n-collapsible>
		<h2 class="is-h4 is-spacing-medium is-color-primary-outline is-spacing-vertical-top-large">
			<span class="is-text">Form Pages</span>
			<ul class="is-menu is-variant-toolbar is-align-end is-spacing-vertical-medium">
				<li class="is-column" v-if="$services.page.isCopied('page-form-page')"><button class="is-button is-variant-warning is-size-xsmall" @click="pastePage"><icon name="paste"/>Paste page</button></li>
				<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall" @click="addPage"><icon name="plus"/>Form Page</button></li>
			</ul>
		</h2>
		<n-collapsible v-for="(cellPage, index) in cell.state.pages" :only-one-open="true" :title="cellPage.name ? cellPage.name : 'Unnamed'" class="is-highlight-left" :start-open="index == 0" after="Page">
			<ul class="is-menu is-variant-toolbar is-align-end is-spacing-horizontal-right-medium" slot="buttons">
				<li class="is-column" v-if="cell.state.pages.length > 1"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="upAllPage(cellPage)"><icon name="chevron-circle-left"/></button></li>
				<li class="is-column" v-if="cell.state.pages.length > 1"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="upPage(cellPage)"><icon name="chevron-circle-up"/></button></li>
				<li class="is-column" v-if="cell.state.pages.length > 1"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="downPage(cellPage)"><icon name="chevron-circle-down"/></button></li>
				<li class="is-column" v-if="cell.state.pages.length > 1"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="downAllPage(cellPage)"><icon name="chevron-circle-right"/></button></li>
				<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline has-tooltip" @click="$services.page.copyItem('page-form-page', cellPage, true)"><icon name="copy"/><span class="is-tooltip">Copy page</span></button></li>
				<li class="is-column" v-if="cell.state.pages.length > 1"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="deletePage(cellPage)"><icon name="times"/></button></li>
			</ul>
			<page-form-configure :title="cellPage.name"
					:allow-read-only="cell.state.allowReadOnly"
					:schema-resolver="getSchemaFor"
					:groupable="true"
					:edit-name="true"
					:fields="cellPage.fields" 
					:is-list="isList"
					:possible-fields="fieldsToAdd"
					:page="page"
					@input="function(newValue) { cellPage.name = newValue }"
					:cell="cell"
					root-tag="div"
					:dark="true">
				<template slot="buttons">
					<li class="is-column" v-if="$services.page.isCopied('page-form-field')"><button class="is-button is-size-xsmall is-variant-warning"  @click="function() { pasteField(cellPage) }"><icon name="paste"/>Paste field</button></li>
				</template>
				<div class="is-column is-spacing-vertical-gap-medium" slot="configuration">
					<n-form-text v-model="cellPage.disabledIf" label="Disabled if" v-if="!cellPage.enabledIf"/>
					<n-form-text v-model="cellPage.enabledIf" label="Enabled if" v-if="!cellPage.disabledIf"/>
				</div>
			</page-form-configure>
		</n-collapsible>
		
	</n-form>
</script>
<script type='x/templates' id="page-form">
	<div class="page-form"
			@drop="drop($event)" 
			@dragover="dragOver($event)"
			@dragexit="dragExit($event)">
	
		<div class="form-tabs" v-if="cell.state.pages.length >= 2 && (cell.state.pageTabs || edit)">
			<button v-for="page in cell.state.pages" :disabled="!isPageActive(page)" @click="setPage(page)"
				:class="{'is-active': currentPage == page}"><span>{{$services.page.interpret($services.page.translate(page.name), self)}}</span></button>
		</div>
		<h2 class="is-h2" v-if="cell.state.title" :class="getChildComponentClasses('form-title')">{{$services.page.translate($services.page.interpret(cell.state.title, $self))}}</h2>
		<n-form :class="[cell.state.class, {'form-read-only': readOnly, 'form-edit': !readOnly}, {'form-error': !!error }, getChildComponentClasses('form-main')]" ref="form" :id="cell.state.formId" :component-group="cell.state.componentGroup ? cell.state.componentGroup : 'form'" 
				:mode="cell.state.mode">
			<header class="p-form-header" slot="header" v-if="cell.state.dynamicHeader"><component :is="cell.state.dynamicHeader" :form="$self" :page="page" :cell="cell"/></header>
			<n-form-section :key="'form_page_' + cell.state.pages.indexOf(currentPage)" :class="getChildComponentClasses('form-container')">
				<n-form-section v-for="group in getGroupedFields(currentPage)" :class="'is-variant-' + group.group" class="is-form-group">
					<n-form-section v-for="field in group.fields" :key="field.name + '_section'" v-if="!isPartOfList(field.name) && !isHidden(field) && (!readOnly || !field.hideInReadOnly)">
						<component v-if="isList(field.name)"
							:read-only="readOnly"
							:is="getProvidedListComponent(field.type)"
							:value="result"
							:page="page"
							:cell="cell"
							:edit="edit"
							:field="field"
							:disabled="isDisabled(field)"
							@changed="changed"
							:timeout="600"
							:schema="getSchemaFor(field.name)"/>
						<page-form-field v-else-if="!field.arbitrary" :key="field.name + '_value'" :field="field" :schema="getSchemaFor(field.name)" 
							:value="getCurrentValue(field)"
							:parent-value="result"
							:schema-resolver="getSchemaFor"
							@changed="changed"
							@input="function(newValue, otherField) { $window.Vue.set(result, otherField ? otherField : field.name, newValue); changed(field.name); }"    
							:timeout="600"
							:page="page"
							:read-only="readOnly"
							:cell="cell"
							:codes="cell.state.codes"
							:is-disabled="isDisabled(field)"
							@label="function(value) { $window.Vue.set(labels, field.name, value) }"
							v-focus="cell.state.autofocus == true && currentPage.fields.indexOf(field) == 0"
							:validate-timeout="cell.state.validationTimeout"
							:validate-on-blur="cell.state.validateOnBlur"/>
						<page-arbitrary v-else-if="!isHidden(field)"
							:edit="edit"
							:page="page"
							:cell="cell"
							:target="field"
							:component="form"/>
					</n-form-section>
				</n-form-section>
			</n-form-section>
			<footer class="p-form-footer" slot="footer">
				<footer v-if="cell.state.dynamicFooter" class="footer-custom"><component :is="cell.state.dynamicFooter" :read-only="readOnly" :form="$self" :page="page" :cell="cell"/></footer>
				<footer v-else-if="readOnly" class="footer-edit">
					<button class="form-edit" :id="cell.state.formId ? cell.state.formId + '_edit' : null" @click="readOnly = false" v-if="cell.state.edit || cell.state.editIcon">
						<span class="fa" :class="cell.state.editIcon" v-if="cell.state.editIcon"></span>
						<span>{{$services.page.translate($services.page.interpret(cell.state.edit, $self))}}</span>
					</button>
				</footer>
				<ul class="is-menu" :class="getChildComponentClasses('form-button-container')" v-else-if="!cell.state.immediate">
					<li class="is-column" v-if="cell.state.cancel && (!cell.state.previous || cell.state.pages.indexOf(currentPage) == 0)">
						<button class="is-button" 
							:class="getChildComponentClasses('form-button-cancel')"
							:disabled="doingIt" href="javascript:void(0)" @click="cancel" :id="cell.state.formId ? cell.state.formId + '_cancel' : null">{{$services.page.translate($services.page.interpret(cell.state.cancel, $self))}}</button>
					</li>
					<li class="is-column" v-if="cell.state.previous && cell.state.pages.indexOf(currentPage) > 0">
						<button class="is-button" 
							:class="getChildComponentClasses('form-button-previous')"
							:disabled="doingIt" href="javascript:void(0)" @click="previousPage" :id="cell.state.formId ? cell.state.formId + '_previous' : null">{{$services.page.translate($services.page.interpret(cell.state.previous, $self))}}</button>
					</li>
					<li class="is-column" v-if="cell.state.next && hasNextActivePage(currentPage)">
						<button class="is-button"
							:class="getChildComponentClasses('form-button-next')"
							:id="cell.state.formId ? cell.state.formId + '_next' : null" @click="nextPage">{{$services.page.translate($services.page.interpret(cell.state.next, $self))}}</button>
					</li>
					<li class="is-column" v-else-if="cell.state.ok">
						<button :disabled="doingIt" class="is-button" :id="cell.state.formId ? cell.state.formId + '_submit' : null" @click="doIt"
							:class="getChildComponentClasses('form-button-ok')">{{$services.page.translate($services.page.interpret(cell.state.ok, $self))}}</button>
					</li>
					<li class="is-column" v-if="cell.state.pages.length >= 2 && cell.state.partialSubmit && cell.state.next && cell.state.pages.indexOf(currentPage) < cell.state.pages.length - 1 && cell.state.ok">
						<button class="is-button" :id="cell.state.formId ? cell.state.formId + '_submit' : null" @click="doIt" 
							:class="getChildComponentClasses('form-button-ok')"
							:disabled="doingIt">{{$services.page.translate($services.page.interpret(cell.state.ok, $self))}}</button>
					</li>
				</ul>
				<footer class="footer-messages">
					<n-messages :messages="messages"/>
				</footer>
			</footer>
		</n-form>
	</div>
</script>

<script type='x/templates' id="page-form-field">
	<component
		:readOnly="readOnly"
		:placeholder="field.placeholder ? $services.page.translate(field.placeholder) : null"
		class="page-form-field"
		:class="fieldClasses(field)"
		:is="getProvidedComponent(field.type)"
		:value="usesMultipleFields(field.type) ? parentValue : value"
		:parent-value="parentValue"
		:page="page"
		:codes="codes"
		:cell="cell"
		@blur="blur"
		:field="field"
		@input="function(newValue, otherField) { $emit('input', newValue, otherField); slowValidate(); }"
		v-bubble:label
		v-bubble:changed
		:label="field.hideLabel ? null : $services.page.translate($services.page.interpret(fieldLabel, $self))"
		:timeout="timeout"
		:schema="schema"
		:schema-resolver="schemaResolver"
		:disabled="isDisabled"/>
</script>

<script type='x/templates' id="page-form-configure">
	<component :is="rootTag" class="list" :title="title">
		<div class="is-column is-spacing-medium">
			<n-form-text :value="title" label="Form Page Name" v-if="editName" v-bubble:input/>
			<slot name="configuration"></slot>
			<ul class="is-menu is-variant-toolbar is-align-end">
				<li class="is-column"><button class="is-button is-variant-primary is-size-xsmall" @click="addField(false)"><icon name="plus"/>Field</button></li>
				<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall" @click="addField(true)"><icon name="plus"/>Content</button></li>
				<slot name="buttons"></slot>
			</ul>
		</div>
		<n-collapsible v-for="field in fields" :title="field.label ? field.label : (field.name ? field.name : 'unnamed')" :class="{'dark': dark}" class="is-color-primary-light" :after="field.arbitrary ? 'Content' : 'Field'" content-class="is-spacing-medium">
			<ul class="is-menu is-variant-toolbar is-spacing-horizontal-right-medium" slot="buttons">
				<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="upAll(field)"><icon name="chevron-circle-left"/></button></li>
				<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="up(field)"><icon name="chevron-circle-up"/></button></li>
				<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="down(field)"><icon name="chevron-circle-down"/></button></li>
				<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="downAll(field)"><icon name="chevron-circle-right"/></button></li>
				<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall has-tooltip" @click="$services.page.copyItem('page-form-field', field, true)"><icon name="copy"/><span class="is-tooltip">Copy field</span></button></li>
				<li class="is-column"><button class="is-button is-variant-danger-outline is-size-xsmall has-tooltip" @click="fields.splice(fields.indexOf(field), 1)"><icon name="times"/></button></li>
			</ul>
			<page-configure-arbitrary v-if="field.arbitrary" 
				:page="page"
				:cell="cell"
				:target="field"
				:keys="possibleFields"/>
				
			<page-form-configure-single v-else :field="field" :possible-fields="possibleFields"
				:groupable="groupable"
				:hidable="true"
				:is-list="isList"
				:page="page"
				:schema="schemaResolver(field.name)"
				:cell="cell"/>
				
			<n-form-switch v-model="field.hideInReadOnly" v-if="allowReadOnly" label="Hide In Read Only Mode"/>
			<n-form-combo :filter="function(x) { return possibleFields }" v-model="field.resetOnUpdate" label="Reset on update" after="You can reset a field if this particular field is updated"/>
		</n-collapsible>
		<div class="is-row is-spacing-medium is-align-end" v-if="allowPaste">
			<button class="is-button is-variant-warning is-size-xsmall has-tooltip" v-if="$services.page.isCopied('page-form-field')" @click="function() { pasteField(cellPage) }"><icon name="paste"/><span class="is-tooltip">Paste field</span></button>
		</div>
	</component>
</script>

<script type='x/templates' id="page-form-configure-single">
	<div class="is-column is-spacing-vertical-gap-medium">
		<n-form-combo v-model="field.name" label="Field Name" :filter="filterFieldNames" v-if="!usesMultipleFields(field.type)"/>
		<n-form-text v-model="field.label" label="Label" v-if="allowLabel" />
		<n-form-text v-model="field.placeholder" label="Placeholder" />
		<n-form-text v-model="field.hidden" label="Hide field if" v-if="hidable" />
		<n-form-text v-model="field.disabled" label="Disable field if" />
		<n-form-combo v-model="field.group" label="Field Group" v-if="groupable && !field.joinGroup" :filter="getAvailableRowGrouping" />
		<n-form-checkbox v-model="field.joinGroup" label="Join Field Group" v-if="groupable && !field.group" />
		<n-form-text v-model="field.description" label="Description" v-if="false && allowDescription" />
		<n-form-combo v-model="field.descriptionType" label="Description type" v-if="field.description" :items="['info','before','after']"/>
		<n-form-text v-model="field.descriptionIcon" label="Description icon" v-if="field.description"/>
		<n-form-combo v-model="field.type" :filter="filterTypes" label="Type"/>
		<n-form-text v-model="field.value" v-if="field.type == 'fixed'" label="Fixed Value"/>
		<n-form-switch v-model="field.hideLabel" label="Hide label"/>
		<component v-if="field.type && ['fixed'].indexOf(field.type) < 0"
			:possible-fields="possibleFields"
			:is="getProvidedConfiguration(field.type)"
			:page="page"
			:cell="cell"
			:schema="schema"
			:field="field"/>
			
		<page-event-value class="no-more-padding" :page="page" :container="field" title="Validation Success Event" name="validationSuccessEvent" @resetEvents="$updateEvents()" :inline="true"/>
		
		<h4 class="is-h4">Field Styling</h4>
		<div class="is-row is-align-end">
			<button class="is-button is-variant-primary-outline is-size-xsmall" @click="field.styles == null ? $window.Vue.set(field, 'styles', [{class:null,condition:null}]) : field.styles.push({class:null,condition:null})"><icon name="plus"/>Style</button>
		</div>
		
		<div v-if="field.styles">
			<div class="is-column is-spacing-medium is-color-body has-button-close" v-for="style in field.styles">
				<n-form-text v-model="style.class" label="Class" timeout="600"/>
				<n-form-text v-model="style.condition" label="Condition" timeout="600"/>
				<button class="is-button is-variant-close" @click="field.styles.splice(field.styles.indexOf(style), 1)"><icon name="times"/></button>
			</div>
		</div>
		
		<h4 class="is-h4">Update Listener</h4>
		<p class="is-p is-size-small is-color-light">Whenever an event is emitted, you can capture a value from it by configuring an update listener.</p>
		<div class="is-row is-align-end">
			<button class="is-button is-variant-primary-outline is-size-xsmall" @click="field.listeners ? field.listeners.push({to:null, field: null}) : $window.Vue.set(field, 'listeners', [{}])"><icon name="plus"/>Update Listener</button>
		</div>
		<div v-if="field.listeners">
			<div class="is-column is-spacing-medium is-color-body has-button-close" v-for="i in Object.keys(field.listeners)">
				<n-form-combo v-model="field.listeners[i].to" :filter="function(value) { return $services.page.getAllAvailableKeys(page, true, value) }" />
				<n-form-combo v-model="field.listeners[i].field" v-if="field.type && field.type.indexOf('.') >= 0" :filter="listFields.bind($self, field.type)" />
				<button class="is-button is-variant-close" @click="field.listeners.splice(i, 1)"><icon name="times"/></button>
			</div>
		</div>
	</div>
</script>

<script type='x/templates' id="page-configure-arbitrary">
	<div class="page-configure-arbitrary">
		<n-form-text v-model="target.label" label="Label"/>
		<n-form-text v-model="target.class" label="Class"/>
		<n-form-combo v-model="target.route" label="Route" :filter="filterRoutes"/>
		<n-page-mapper v-if="target.route" :to="getTargetParameters(target)"
			:from="availableParameters" 
			v-model="target.bindings"/>
		<n-form-ace v-model="target.hidden" label="Hide If"/>
		<p class="subscript" v-if="instance == null">Not seeing your configuration options? Make sure at least one instance is rendered.</p>
		<component v-if="hasConfigurator" :is="getCellConfigurator(cell)" v-bind="getCellConfiguratorInput(cell)"/>
	</div>
</script>

<script type='x/templates' id="page-arbitrary">
	<div class="page-arbitrary">
		<div @click.native="handle" :class="target.class" v-route-render="{ alias: target.route, parameters: getParameters(), mounted: mounted, created:created }"></div>
	</div>
</script> <script type='x/templates' id="nabu-form-component">
	<component :is="formComponent" :page="page" :cell="cell"
		:codes="cell.state.codes"
		ref="input"
		:field="cell.state"
		:class="[getChildComponentClasses('form-component'), {'is-read-only': !editable }]"
		@blur="blur"
		@label="updateLabel"
		:component-group="cell.state.componentGroup ? cell.state.componentGroup : 'form'"
		:value="cell.state.useComputed ? computedValue : value"
		:parent-value="parentValue"
		:label="$services.page.translate($services.page.interpret(cell.state.label, $self))"
		:timeout="cell.state.timeout"
		:disabled="disabled || !editable"
		:schema="getSchema()"
		:required="isRequired()"
		:placeholder="placeholder"
		:child-components="childComponents"
		@input="update"/>
</script>


<script type='x/templates' id="nabu-form-component-configuration">
	<div>
		<template v-if="$services.page.activeSubTab == 'form'">
			<h2 class="section-title">Value binding</h2>
			<div class="is-column is-spacing-medium">
				<n-form-switch v-model="cell.state.useComputed" label="Use computed value" after="Instead of binding directly to a field, you can calculate the original value and update it through change listeners"/>
				<n-form-combo v-model="cell.state.name" label="Field Name" :filter="availableFields" v-if="!cell.state.useComputed"/>
				<n-form-combo v-model="cell.state.rawName" label="Raw Field Name" :filter="availableFields" v-if="!cell.state.useComputed" after="In some cases the value is derived from a raw value that might also be interesting, you can capture that here"/>
				<n-form-ace v-model="cell.state.computed" label="Initial value for computed" v-else/>
				<n-form-text v-model="cell.state.timeout" label="Timeout" info="How long should the system wait before the new value is applied?"/>
				<n-form-switch v-model="cell.state.initializeArray" label="Initialize empty array if null" v-if="isArrayField()"/>
			</div>
			<h2 class="section-title">Copywriting</h2>
			<div class="is-column is-spacing-medium">
				<n-form-text v-model="cell.state.label" label="Label"/>
				<n-form-text v-model="cell.state.placeholder" label="Placeholder"/>
				<n-form-text v-model="cell.state.defaultValue" label="Default value"/>
				<n-form-text v-model='cell.state.info' label='Info Content'/>
				<n-form-text v-model='cell.state.before' label='Before Content'/>
				<n-form-text v-model='cell.state.beforeIcon' label='Before Icon' v-if='cell.state.before'/>
				<n-form-text v-model='cell.state.after' label='After Content'/>
				<n-form-text v-model='cell.state.afterIcon' label='After Icon' v-if='cell.state.after'/>
				<n-form-text v-model='cell.state.suffix' label='Suffix' v-if='!cell.state.suffixIcon'/>
				<n-form-text v-model='cell.state.suffixIcon' label='Suffix Icon' v-if='!cell.state.suffix'/>
			</div>
			<h2 class="section-title">Misc</h2>
			<div class="is-column is-spacing-medium">
				<n-form-ace mode="javascript" v-model="cell.state.disabled" label="Disable if" />
				<n-form-switch v-model="cell.state.validateOnBlur" label="Validate on blur"/>
				<n-form-combo v-model="cell.state.required" label="Required" :items="[{value: true, title: 'Always'}, {value: false, title: 'Depends on the schema'}, {value: 'condition', title: 'Based on a condition'}]"
					:extracter="function(x) { return x.value }"
					:formatter="function(x) { return x.title }"/>
				<n-form-ace v-if="cell.state.required == 'condition'" v-model="cell.state.requiredCondition" label="Required" after="You can force this field to be mandatory"/>
				<n-form-text v-model="cell.state.componentGroup" label="Component Group"/>
				<n-form-switch v-model="cell.state.readOnly" label="Render as read only" v-if="cell.state.readOnly"/>
				<n-form-ace v-model="cell.state.readOnlyCondition" label="Read only if" v-else/>
				<n-form-switch v-if="cell.triggers && cell.triggers.length" v-model="cell.state.lockDuringTrigger" label="Lock during trigger"/>
				<n-form-switch v-model="cell.state.translatable" label="Translatable"/>
			</div>
			
		</template>
		
		<component :is="configurationComponent" :page="page" :cell="cell" :field="cell.state" :possible-fields="availableFields()" v-if="$services.page.activeSubTab != 'form' && $services.page.activeSubTab != 'validation'"/>
		
		<div class="is-column is-spacing-medium" v-if="$services.page.activeSubTab == 'validation'">
			<h3 class="is-h3">Validation Messages</h3>
			<p class="is-p is-size-small">You can remap specific validation codes to provide the user with a different message than the default message available for that code.</p>
			<div v-if='cell.state.codes' class="is-column is-spacing-vertical-gap-medium">
				<div class="is-column is-color-body is-spacing-medium has-button-close" v-for='code in cell.state.codes' :timeout='600'>
					<n-form-text v-model='code.code' label='Code' :timeout='600' after="The code you want to remap, for example 'required'"/>
					<n-form-text v-model='code.title' label='Title' :timeout='600' after="The message you want to show the user"/>
					<button class="is-button is-variant-close" @click='cell.state.codes.splice(cell.state.codes.indexOf(code), 1)'><icon name="times"/></button>
				</div>
			</div>
			<div class="is-row is-align-end">
				<button class="is-button is-size-xsmall is-variant-primary-outline" @click="cell.state.codes ? cell.state.codes.push({code:null,title:null}) : $window.Vue.set(cell.state, 'codes', [{code:null,title:null}])"><icon name="plus"/><span class="is-text">Message</span></button>
			</div>
		</div>
		
		<page-triggerable-configure v-if="cell.state.triggers && cell.state.triggers.length" :page="page" :target="cell.state" :triggers="{'update': {}}" :allow-closing="true"/>
	</div>
</script>
<script type='x/templates' id="nabu-form-dynamic-component">
	<div class="is-column" :class="getChildComponentClasses('dynamic-field-container')">
		<component v-for="record in records"
			:is="getComponentFor(record)"
			:value="getValueFor(record)"
			@input="function(value, label, field) { update(record, value) }"
			:component-group="cell.state.componentGroup ? cell.state.componentGroup : 'form'"
			:parent-value="getParentValue()"
			:page="page"
			:cell="getParametersFor(record)"
			:disabled="disabled || readOnly"
			:class="{'is-read-only': readOnly }"
			:field="getParametersFor(record).state"
			:label="getLabelFor(record)"
			:timeout="cell.state.timeout"></component>
	</div>
</script>

<script type='x/templates' id="nabu-form-dynamic-component-configure">
	<div class="data-trace-viewer-configure is-column is-spacing-medium">
		<n-form-switch v-model="cell.state.stringified" label="Stringified value" after="By default this component expects an array but you can also work on a JSON stringified string that contains an array of key/values. This is primarily useful if it is also stored as such."/>
		<n-form-combo v-model="cell.state.name" label="Field Name" :filter="availableFields" :after="cell.state.stringified ? 'The string field that contains a JSON stringified array' : 'The array of key/values where you want to store the dynamic data'"/>
		
		<p class="is-content is-variant-subscript" v-if="cell.state.stringified">
			The stringified version will be an object where all properties are expressed as a simple key with a string value, for example: { "exampleKey": "exampleValue" }.
			This can be parsed in the backend with a json unmarshal on an object that has a list of properties (e.g. nabu.utils.types.Property).
			It is not stored in the structure of the target object because this component is often used for configuration where values might still need further interpretation based on rules. If such a rule based value were to exist in an integer field however, it could never be parsed correctly.
		</p>
		
		<data-configure :target="cell.state" :page="page"/>
		
		<div v-for="custom in cell.state.custom" class="is-column is-spacing-medium">
			<n-form-text v-model="custom.name" label="Type name"/>
			<n-form-combo v-model="custom.component" label="Component" :filter="getAvailableComponents" :formatter="function(x) { return x.name ? x.name : x.component }" :extracter="function(x) { return x.name }"/>
			<component v-if="getCustomConfiguration(custom)" :is="getCustomConfiguration(custom)" :page="page" :cell="cell" 
				:field="custom.configuration"
				class="is-column is-spacing-gap-medium"/>
		</div>
		<div class="is-row is-align-end is-spacing-vertical-small">
			<button class="is-button is-size-xsmall is-variant-primary-outline" @click="cell.state.custom.push({configuration:{}})"><icon name="plus"/><span class="is-text">Custom type</span></button>
		</div>
	</div>
</script><script type='x/templates' id="custom-validator-edit">
	<n-collapsible title="Validations" class="page-validations list">
		<n-form-text v-model="cell.state.componentGroup" label="Component Group"/>
		<div class="list-actions">
			<button @click="addValidation">Add Validation</button>
		</div>
		
		<div v-if="cell.state.validations">
			<n-collapsible class="list-item" :title="validation.label ? validation.label : 'Unlabeled'" v-for="validation in cell.state.validations">
				<div slot="buttons">
					<button @click="deleteValidation(validation)"><span class="fa fa-trash"></span></button>
				</div>
				<n-form-text v-model="validation.label" label="Label" :timeout="600"/>
				<n-form-ace v-model="validation.condition" label="Condition to show message" info="Use the variable 'response' to access the response (if any)" :timeout="600"/>
				<n-form-text v-model="validation.code" label="Code" :timeout="600"/>
				<n-form-text v-model="validation.message" label="Message" :timeout="600"/>
				<n-form-combo v-model="validation.operationId" :filter="getOperations" label="Validation enrichment service"/>
				<n-form-text v-model="validation.operationSuccessEvent" v-if="validation.operationId" label="Operation Success Event" :timeout="600" @input="$updateEvents()"/>
				<n-page-mapper v-if="validation.operationId" v-model='validation.bindings' :from="availableParameters" :to="getOperationParameters(validation.operationId, true)"/>
			
				<div v-if="validation.operationId">
					<h2>Validation Codes</h2>
					<div v-if='validation.codes'>
						<div class='list-row' v-for='code in validation.codes' :timeout='600'>
							<n-form-text v-model='code.code' label='Code' :timeout='600'/>
							<n-form-text v-model='code.title' label='Title' :timeout='600'/>
							<span @click='validation.codes.splice(validation.codes.indexOf(code), 1)' class='fa fa-times'></span>
						</div>
					</div>
					<div class='list-actions'>
						<button @click="validation.codes ? validation.codes.push({code:null,title:null}) : $window.Vue.set(validation, 'codes', [{code:null,title:null}])"><span class="fa fa-plus"></span>Code</button>
					</div>
				</div>	
				<h4>Reset Listeners</h4>
				<p class="subscript">Whenever an event is emitted, you can clear the validation state.</p>
				<div class="list-item-actions">
					<button @click="validation.resetListeners ? validation.resetListeners.push({to:null, field: null}) : $window.Vue.set(validation, 'resetListeners', [{to:null,field:null}])"><span class="fa fa-plus"></span>Reset Listener</button>
				</div>
				<div v-if="validation.resetListeners">
					<div class="list-row" v-for="i in Object.keys(validation.resetListeners)">
						<n-form-combo v-model="validation.resetListeners[i].to" :filter="function(value) { return $services.page.getPageInstance(page, $self).getAvailableEvents() }" />
						<span @click="validation.resetListeners.splice(i, 1)" class="fa fa-times"></span>
					</div>
				</div>
			</n-collapsible>
		</div>
	</n-collapsible>
</script>

<script type='x/templates' id="custom-validator">
	<div class="custom-validator" :component-group="cell.state.componentGroup ? cell.state.componentGroup : 'form'">
		<n-form>
			<div class="n-form-component n-form-invalid">
				<n-messages :messages="messages"></n-messages>
			</div>
		</n-form>
	</div>
</script><script type='x/templates' id="default-offline">
	<div class="is-column is-align-center is-spacing-medium is-height-fixed-max">
		<h1 class="is-h1 is-size-xxxlarge">{{$services.page.translate("We&#39;ll be back soon!")}}</h1>
		<h6 class="is-h6">{{$services.page.translate(message)}}</h6>
	</div>
</script><script type='x/templates' id="typography-richtext">
	<div class="typography-richtext">
		<n-form-richtext v-if="edit" :value="cell.state.content" @input="update" :clean-style='cell.state.cleanStyle' :class="{'richtext-empty': !cell.state.content || !cell.state.content.replace(/<[^>]+>/, '') }"/>
		<div v-else-if="!cell.state.highlight" v-content.parameterized="{value:$services.page.translate(cell.state.content), sanitize: true, compile: cell.state.compile }"></div>
		<div v-else v-content="highlight($services.page.translate(cell.state.content))"></div>
	</div>
</script>

<script type='x/templates' id="typography-richtext-configure">
	<div class="is-column is-spacing-medium">
		<n-form-switch v-model='cell.state.compile' label='Compile content'/>
	</div>
</script><script type='x/templates' id="page-code">
	<div class="page-code">
		<n-form-text type="area" v-if="edit" v-model="cell.state.content"/>
		<div v-else v-content="highlight(cell.state.content)"></div>
	</div>
</script><script type='x/templates' id="nabu-console">
	<n-sidebar class="nabu-console">
		<div class="is-row">
			<button class="is-button is-variant-tab" @click="tab = 'features'" :class="{'is-active': tab == 'features'}">Features</button
			><button class="is-button is-variant-tab" @click="tab = 'events'" :class="{'is-active': tab == 'events'}" v-if="false">Events</button
			><button class="is-button is-variant-tab" @click="tab = 'inspect'" :class="{'is-active': tab == 'inspect'}">Inspect</button>
		</div>
		<div v-if="tab == 'events'">
			<div class="menu">
				<n-form-text type="text" placeholder="Search" v-model="search" :timeout="400"/>
				<button v-if="false" @click="$services.page.reports.splice(0)">Clear</button>
			</div>
			<div class="content">
				<div class="nabu-console-report nabu-console-report-title">
					<div class="timestamp">Timestamp</div>
					<div class="source">Source</div>
					<div class="type">Type</div>
					<div class="content">Content</div>
				</div>
				<div class="nabu-console-reports">
					<div class="nabu-console-report" v-for="report in $services.page.reports" :class="[{'selected': selected == report, 'hidden': isHidden(report) }, report.category]">
						<div class="timestamp"><span class="icon" @click="selected = selected == report ? null : report"><span v-if="selected == report">-</span><span v-else>+</span></span>{{$services.formatter.date(report.timestamp, 'MMM dd, HH:mm:ss')}}</div>
						<div class="source">{{report.source}}<span v-if="report.category" class="category">{{report.category}}</span></div>
						<div class="type"><span v-if="report.type">{{report.type }}</span><span class="name" v-if="report.name">{{report.name}}</span></div>
						<div class="content" @click="selected = report">{{report.properties ? JSON.stringify(report.properties, null, 2) : null }}</div>
					</div>
				</div>
			</div>
		</div>
		<div v-else-if="tab == 'features'">
			<div class="is-row is-align-end is-spacing-medium">
				<button class="is-button is-variant-primary-outline is-size-xsmall" @click="resetFeatures">Reset</button>
			</div>
			<div class="is-column is-spacing-medium is-spacing-gap-large">
				<h3 class="is-h3">Enabled Features</h3>
				<div class="is-column is-spacing-gap-small">
					<n-form-switch class="is-size-small" :value="true" @input="disableFeature(feature)" v-for="feature in enabledFeatures" :label="feature.description ? feature.description : feature.name"/>
				</div>
				<h3 class="is-h3">Disabled Features</h3>
				<div class="is-column is-spacing-gap-small">
					<n-form-switch class="is-size-small" @input="enableFeature(feature)" v-for="feature in disabledFeatures" :label="feature.description ? feature.description : feature.name"/>
				</div>
			</div>
		</div>
		<div v-else-if="tab == 'inspect'">
			<div class="content" v-content="cleanedUpContent"></div>
		</div>
	</n-sidebar>
</script><script type='x/templates' id="page-video">
	<div class="page-video">
		<n-sidebar v-if="configuring" @close="configuring = false" class="settings" :inline="true">
			<n-form class="layout2">
				<n-form-section>
					<n-collapsible title="Video Settings">
						<n-form-text v-model="cell.state.title" label="Title"/>
						<n-form-text v-model="cell.state.height" label="Height"/>
						<n-form-text v-model="cell.state.videoPath" label="Video Path"/>
						<n-form-switch v-model="cell.state.absolute" label="Absolute"/>
						<n-form-switch v-model="cell.state.muted" label="Muted"/>
						<n-form-switch v-model="cell.state.controls" label="Controls"/>
						<n-form-switch v-model="cell.state.loop" label="Loop"/>
						<n-form-switch v-model="cell.state.autoplay" label="Autoplay"/>
						<n-form-text v-model='cell.state.fallbackUrl' label='Fallback Image Url'/>
					</n-collapsible>
					<n-collapsible title="Video Content" class="images">
						<n-input-file v-model="files" @change="upload" :types="['video']"/>
						<div class="image-container" v-for="image in images" :class="{'selected': image.relativePath == cell.state.href }" @click="cell.state.href = image.relativePath">
							<video :src="'/' + image.relativePath"/>
						</div>
					</n-collapsible>
				</n-form-section>
			</n-form>
		</n-sidebar>
		
		<video v-if="fullHref" :autoplay="cell.state.autoplay" :loop="cell.state.loop" preload="" :muted="cell.state.muted" class="video" :controls="cell.state.controls">
			<source :src="fullHref">
			<img v-if="cell.state.fallbackUrl" :src="cell.state.fallbackUrl" alt="Your browser does not support this video type">
		</video>
		
		<n-input-file v-else-if="edit" v-model="files" @change="upload" :types="['video']"/>
	</div>
</script><script type='x/templates' id="page-youtube">
	<div class="page-youtube">
		<n-sidebar v-if="configuring" @close="configuring = false" class="settings" :inline="true">
			<n-form class="layout2">
				<n-form-section>
					<n-collapsible title="Youtube settings">
						<n-form-text v-model='cell.state.url' label='Url'/>
						<n-form-text v-model='cell.state.width' label='Width'/>
						<n-form-text v-model='cell.state.height' label='Height'/>
						<n-form-switch v-model="cell.state.hideControls" label="Hide Controls"/>
					</n-collapsible>
				</n-form-section>
			</n-form>
		</n-sidebar>
		<iframe ref="iframe" v-if="url && !$services.page.isSsr" :width="cell.state.width ? cell.state.width : 560" :height="cell.state.height ? cell.state.height : 315" :src="url" 
			frameborder="0" 
			allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
		<a :href="url" rel="nofollow noreferrer noopener" v-else-if="$services.page.isSsr">Go to youtube</a>
	</div>
</script><script type='x/templates' id="page-share-social">
	<div class="page-share-social" :class="cell.state.class">
		<n-sidebar v-if="configuring" @close="configuring = false" class="settings" :inline="true">
			<n-form class="layout2">
				<n-form-section>
					<n-collapsible title="Share settings">
						<n-form-text v-model="cell.state.link" label="Link to share" info="Defaults to the current page"/>
						<n-form-combo v-model="cell.state.class" label="Class" 
							:filter="function(value) { return $services.page.classes('page-share-social', value) }"/>
						<div class="list">
							<div v-for="i in Object.keys(cell.state.share)" class="list-row">
								<n-form-combo label="Provider" v-model="cell.state.share[i].provider" :items="['facebook', 'linkedin', 'twitter', 'pinterest']"/>
								<button @click="cell.state.share.splice(i)"><span class="fa fa-trash"></span></button>
							</div>
						</div>
						<button @click="cell.state.share.push({})">Add Provider</button>
					</n-collapsible>
				</n-form-section>
			</n-form>
		</n-sidebar>
		<div class="share-icons" v-if="cell.state.share">
			<div class="share-icon" v-for="share in cell.state.share">
				<a :href="generateLink(share.provider)" target="_blank" @click="analyze" rel="noopener noreferrer nofollow">
					<span :class="share.provider" class="icon"></span>
				</a>
			</div>
		</div>
	</div>
</script><script type='x/templates' id="page-add-cell">
	<n-form class="layout2 page">
		<n-form-section>
			<n-form-combo label="Show On" v-model="on" :items="availableEvents"/>
			<n-form-combo label="Route" :filter="filterRoutes" v-model="route"
				:formatter="function(x) { return x.alias }"
				:required="true"/>
			<n-form-combo label="Target" v-if="on" :items="['page', 'sidebar']" v-model="target"/>
		</n-form-section>
		<n-page-mapper :to="parameters" v-if="parameters.length" :from="availableParameters" v-model="bindings"/>
		<footer class="actions">
			<a href="javascript:void(0)" @click="$reject()">Cancel</a>
			<button @click="set" :disabled="!route">Set Content</button>
		</footer>
	</n-form>
</script><script type='x/templates' id="page-components-overview">
	<div class="page-components-overview" @drop.prevent="function($event) { $event.stopPropagation() }">
		<div class="tabbed-menu is-row is-spacing-xsmall is-spacing-vertical-bottom-none">
			<button @click="selected = 'components'" class="is-button is-size-xsmall" :class="{'is-active': selected == 'components'}">Components</button>
			<button @click="selected = 'operations'" class="is-button is-size-xsmall" :class="{'is-active': selected == 'operations'}">Operations</button>
		</div>
		<p class="is-p is-size-small is-color-light is-spacing-medium">Drag and drop a component of your choice into a row.</p>
		<div v-if="selected == 'components'">
			<n-collapsible :only-one-open="true" v-for="category in componentCategories" :title="prettyPrint(category)" content-class="is-pattern-underline">
				<div class="is-row is-height-fixed-4 is-align-cross-center is-spacing-horizontal-medium is-spacing-vertical-small is-highlight-light is-cursor-pointer" v-for="(component, index) in getComponentCategory(category)" :draggable="true"
						@dragstart="dragComponent($event, component)">
					<img :draggable="false" :src="'/resources/' + component.icon" class="is-column is-width-fixed-2" v-if="component.icon && component.icon.match(/^.*\.[^.]+$/)"/>
					<icon v-else-if="component.icon" :name="component.icon" class="is-column is-width-column-1"/>
					<div class="is-column is-width-column-11">
						<h5 class="is-h5 is-size-medium is-spacing-horizontal-gap-small">
							<span class="is-text">{{ component.name }}</span>
							<span class="is-badge is-size-xsmall is-color-secondary-outline" v-if="component.type">{{component.type}}</span>
							<span class="is-badge is-size-xsmall is-color-secondary-outline" v-if="component.templateVersion">v{{component.templateVersion}}</span>
						</h5>
						<p class="is-p is-size-xsmall" v-if="component.description">{{ component.description }}</p>
					</div>
				</div>
			</n-collapsible>
		</div>
		<div v-else-if="selected == 'templates'">
			<n-collapsible class="component-category" v-for="category in templateCategories" :title="prettyPrint(category)" content-class="is-pattern-underline">
				<div class="is-row is-height-fixed-4 is-align-cross-center is-spacing-horizontal-medium is-spacing-vertical-small is-highlight-light is-cursor-pointer" v-for="template in getTemplateCategory(category)" :draggable="true"
						@dragstart="dragTemplate($event, template)">
					<img :draggable="false" :src="'/resources/' + template.icon" class="is-column is-width-fixed-2" v-if="template.icon && template.icon.match(/^.*\.[^.]+$/)"/>
					<icon v-else-if="template.icon" :name="template.icon" class="is-column is-width-column-1"/>
					<div class="is-column is-width-column-11">
						<h5 class="is-h5 is-size-medium">{{ template.name }}<span class="is-content is-size-xsmall is-color-neutral is-spacing-horizontal-left-medium" v-if="template.type">{{template.type}}</span></h5>
						<p class="is-p is-size-xsmall" v-if="template.description">{{ template.description }}</p>
					</div>
				</div>
			</n-collapsible>
		</div>
		<div v-else-if="selected == 'operations'">
			<div class="is-column is-spacing-medium">
				<n-form-text v-model="operationSearch" placeholder="Search operations..." :timeout="300"/>
			</div>
			<n-collapsible class="component-category" v-for="category in getOperationCategories()" :title="prettyPrint(category)" content-class="is-pattern-underline" v-if="hasAnyOperationMatch(category)">
				<div class="is-row is-height-fixed-4 is-align-cross-center is-spacing-horizontal-medium is-spacing-vertical-small is-highlight-light is-cursor-pointer" v-for="operation in getOperationCategory(category)" v-if="hasAnyOperationMatch(category, operation)" :draggable="true"
						@dragstart="dragOperation($event, operation)">
					<div class="is-column is-width-column-11">
						<p class="is-p is-size-xsmall">{{ operation.id }}</p>
						<p class="is-p is-size-xxsmall" v-if="operation.summary">{{ operation.summary }}</p>
					</div>
				</div>
			</n-collapsible>
		</div>
	</div>
</script>


<script type='x/templates' id="page-components-selector">
	<div class="is-column is-spacing-large is-color-background">
		<h2 class="is-h2">Select Component</h2>
		<div class="is-column is-pattern-underline">
			<div class="is-row is-height-fixed-4 is-spacing-medium is-cursor-pointer is-highlight-light" v-for="component in components" @click="$resolve(component)">
				<img :draggable="false" :src="'/resources/' + component.icon" class="is-image is-ratio-square is-width-fixed-2" v-if="component.icon && component.icon.match(/^.*\.[^.]+$/)"/>
				<icon v-else-if="component.icon" :name="component.icon" class="is-column is-width-column-1"/>
				<div class="about">
					<h4 class="is-h4">{{ component.name }}</h4>
					<p class="is-p is-size-small" v-if="component.description">{{ component.description }}</p>
				</div>
			</div>
		</div>
		<div class="is-row is-align-end is-spacing-vertical-top-medium">
			<button class="is-button is-variant-secondary" @click="$reject()">Cancel</button>
		</div>
	</div>
</script><script type='x/templates' id="nabu-optimized-page-column">
	<n-page-row 
		v-fragment
		:row="page.content.rows[0]"
		:page="page" 
		:edit="edit"
		:depth="0"
		:parameters="parameters"
		:ref="page.name + '_rows'"
		:root="true"
		:page-instance-id="pageInstanceId"
		:stop-rerender="stopRerender"
		:key="'page_' + pageInstanceId + '_row_' + page.content.rows[0].id"
		@update="updateEvent"
		@select="selectItem"
		@viewComponents="viewComponents = edit"
		@removeRow="function(x) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { page.content.rows.splice(page.content.rows.indexOf(x), 1) }) }"/>
</script>

<script type='x/templates' id="page-shortkey">
	<span class="shortkey is-badge"><span v-if="ctrl && $window.navigator.platform.toLowerCase().indexOf('mac') >= 0">CMD + </span><span v-else-if="ctrl">CTRL + </span><span v-if="alt">ALT + </span><slot></slot></span>
</script>

<script type='x/templates' id="nabu-optimized-page">
	<n-page-row 
		@update="updateEvent"
		:row="page.content.rows[0]"
		:page="page" 
		:edit="edit"
		:depth="0"
		:parameters="parameters"
		:ref="page.name + '_rows'"
		:root="true"
		:page-instance-id="pageInstanceId"
		:stop-rerender="stopRerender"
		:key="'page_' + pageInstanceId + '_row_' + page.content.rows[0].id"
		@select="selectItem"
		@viewComponents="viewComponents = edit"
		@removeRow="function(x) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { page.content.rows.splice(page.content.rows.indexOf(x), 1) }) }"/>
</script>

<script type='x/templates' id="nabu-page">
	<component :edit="edit" :is="pageTag()" :inline-all="true" class="is-page is-grid" :body-class="bodyClasses" :page="page.name" 
			@update="updateEvent"
			@drop="dropMenu($event)" @dragover="dragOver($event)"
			:class="[classes, getGridClasses()]"
			>
		<div class="is-page-edit-menu" v-if="false && !page.content.readOnly && $services.page.canEdit() && $services.page.wantEdit && !embedded && !$services.page.editing" 
				:draggable="true" 
				@dragstart="dragMenu($event)"
				:class="{'is-bookmarkable': !!page.content.path}"
				:style="{'top': page.content.menuY ? page.content.menuY + 'px' : '0px', 'left': page.content.menuX ? page.content.menuX + 'px' : '0px'}">
			<span>{{page.name}}</span>
			<button class="is-button is-variant-ghost is-size-xsmall" v-if="page.content.path && hasConfigureListener()" @click="triggerConfiguration()"><icon name="cog"/></button>
			<button class="is-button is-variant-ghost is-size-xsmall" @click="goIntoEdit"><icon name="pencil-alt"/></button>
			<button class="is-button is-variant-ghost is-size-xsmall" @click="$services.router.route('pages')"><icon name="copy"/></button>
			<button v-if="page.content.path && $services.language && $services.language.available.length" class="is-button language-selector is-variant-ghost">
				<span class="current">{{hasLanguageSet() ? $services.language.current.name : "none"}}</span>
				<div class="options">
					<span v-for="language in $services.language.available" @click="$services.language.current = language">{{language.name}}</span>
					<span v-if="$services.language.current && true" @click="$services.language.current = null">unset</span>
				</div>
			</button>
			<button class="is-button is-variant-ghost is-size-xsmall" @click="$window.console.log('Page: ' + page.name, $self.variables, $self)"><icon name="terminal"/></button>
			<button class="is-button is-variant-ghost is-size-xsmall" v-if="$services.page.disableReload" @click="$services.page.disableReload = false"><icon name="sync"/></button>
			<button class="is-button is-variant-ghost is-size-xsmall" v-else @click="$services.page.disableReload = true"><icon name="ban"/></button>
		</div>
		
		<n-sidebar v-if="edit && page.content.rows" position="left" class="is-header-size-xlarge is-page-editing" :class="{'is-page-editing-large': !collapsedMenu, 'is-page-editing-small': collapsedMenu}" :inline="true" :autocloseable="false" ref="sidemenu"
				@close="stopEdit">
			<template v-if="!collapsedMenu">
				<div class="is-column is-spacing-medium is-align-left is-spacing-vertical-gap-small" slot="header">
						<h3 class="is-h3 is-color-neutral">
							<div class="is-row is-spacing-horizontal-gap-medium is-align-center">
								{{page.content.label ? page.content.label : page.content.name}}
								<ul class="is-menu is-variant-toolbar">
									<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall" @click="save"><span class="is-text">Save</span></button></li>
									<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="updateTemplates"><span class="is-text">Update Templates</span></button></li>
								</ul>
							</div>
						</h3>
						<p class="is-p is-size-xsmall">Last saved: {{saved ? $services.formatter.date(saved, 'HH:mm:ss') : 'never' }}</p>
					
					
					<ul class="is-menu is-variant-toolbar">
						<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-small is-border-underline" @click="activeTab = 'layout'" :class="{'is-active': activeTab == 'layout'}"><icon name="align-left"/><span class="is-text">Layout</span></button></li>
						<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-small is-border-underline" @click="activeTab = 'settings'" :class="{'is-active': activeTab == 'settings'}"><icon name="cog"/><span class="is-text">Page</span></button></li>
						<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-small is-border-underline" @click="activeTab = 'components'" :class="{'is-active': activeTab == 'components'}"><icon name="cubes"/><span class="is-text">Content</span></button></li>
						<li class="is-column" v-if="cell || row"><button class="is-button is-variant-primary-outline is-size-small is-border-underline" @click="activeTab = 'selected'" :class="{'is-active': activeTab == 'selected'}"><icon name="cube"/>
							<span class="is-text" v-if="true">{{$services.page.formatPageItem($self, selectedType == 'cell' ? cell : row)}}</span>
							<span class="is-text" v-else-if="selectedType == 'cell' && cell && cell.name">{{cell.name}}</span>
							<span class="is-text" v-else-if="selectedType == 'cell' && cell && cell.alias">{{$services.page.prettifyRouteAlias(cell.alias)}}</span>
							<span class="is-text" v-else-if="selectedType == 'row' && row && row.name">{{row.name}}</span>
							<span class="is-text" v-else>Selected {{selectedType == 'cell' ? "cell" : "row"}}</span></button>
						</li>
					</ul>
				</div>
			</template>
			<template v-else>

			</template>
			<div class="is-row">
				<div class="is-column is-width-fixed-3 is-column is-align-cross-center is-align-main-start is-page-editing-small-menu is-spacing-gap-small">
					<div class="is-column is-spacing-vertical-medium is-spacing-gap-small">
						<button class="is-button is-size-small has-tooltip" @click="stopEdit"><icon name="times"/><span class="is-tooltip is-position-bottom">Stop editing <shortkey :ctrl="true">E</shortkey></span></button>
						<button class="is-button is-size-small has-tooltip" @click="save"><icon name="save"/><span class="is-tooltip is-position-bottom">Last saved: {{saved ? $services.formatter.date(saved, 'HH:mm:ss') : 'never' }}<shortkey :ctrl="true">S</shortkey></span></button>
					</div>
					<div class="is-column is-spacing-vertical-medium is-spacing-gap-small">
						<button class="is-button is-size-small has-tooltip" @click="activeTab = 'layout'" :class="{'is-active': activeTab == 'layout'}"><icon name="align-left"/><span class="is-tooltip">Layout<shortkey :ctrl="true">D</shortkey></span></button>
						<button class="is-button is-size-small has-tooltip" @click="activeTab = 'settings'" :class="{'is-active': activeTab == 'settings'}"><icon name="file"/><span class="is-tooltip">Page Settings<shortkey :ctrl="true">B</shortkey></span></button>
						<button class="is-button is-size-small has-tooltip" @click="activeTab = 'components'" :class="{'is-active': activeTab == 'components'}"><icon name="cubes"/><span class="is-tooltip">Components and operations</span></button>
						<button :disabled="cell == null && row == null" class="is-button is-size-small has-tooltip" @click="activeTab = 'selected'" :class="{'is-active': activeTab == 'selected'}"><icon name="cube"/><span v-if="cell != null || row != null" class="is-tooltip">{{$services.page.formatPageItem($self, selectedType == 'cell' ? cell : row)}}<shortkey :ctrl="true">G</shortkey></span><span v-else class="is-tooltip">Select an component on the page</span></button>
					</div>
					<div class="is-column is-spacing-vertical-medium is-spacing-gap-small">
						<button class="is-button is-size-small has-tooltip" @click="stopEdit(); $services.router.route('pages')"><icon name="copy"/><span class="is-tooltip">View all pages</span></button>
						<button class="is-button is-size-small has-tooltip" @click="updateTemplates"><icon name="upload"/><span class="is-tooltip">Update all templates in page</span></button>
					</div>
					<div class="is-column is-spacing-vertical-medium is-spacing-gap-small bottom-container">
						<div class="page-name">{{page.content.label ? page.content.label : page.content.name}}</div>
						<button class="is-button is-size-xsmall has-tooltip collapser" @click="collapsedMenu = !collapsedMenu"><icon :name="collapsedMenu ? 'chevron-right' : 'chevron-left'"/><span class="is-tooltip">{{collapsedMenu ? 'Expand toolbar' : 'Collapse toolbar'}}</span></button>
					</div>
				</div>
				<div v-show="!collapsedMenu" class="is-column is-fill-normal menu-content">
					<div class="is-row is-spacing-vertical-small is-spacing-medium is-spacing-gap-xsmall is-wrap-wrap breadcrumbs" v-if="selectedItemPath.length && $services.page.showBreadcrumbs">
						<button v-for="(single, singleIndex) in selectedItemPath" class="is-button is-size-xsmall" :class="{'has-renderer': single.renderer, 'is-active': (selectedType == 'cell' && cell == single) || (selectedType == 'row' && row == single)}"
							@click="selectTarget(single)"><span class="is-text">{{$services.page.formatPageItem($self, single)}}</span><span class="is-tag is-size-xxsmall" :class="{'is-variant-primary': single.renderer, 'is-variant-primary-outline': !single.renderer}">{{singleIndex + 1}}</span></button>
					</div>
					
					<div v-show="edit && page.content.rows && activeTab  == 'layout'" class="layout">
						<div class="tabbed-menu is-row is-spacing-xsmall is-spacing-vertical-bottom-none">
							<button class="is-button is-size-xsmall">Layout</button>
						</div>
						<page-sidemenu :rows="page.content.rows" :page="page"
							:selected="cell ? cell : row"
							@select="selectItem"
							@removeRow="function(row) { $confirm({title: 'Delete row', message:'Are you sure you want to delete this row?'}).then(function() { page.content.rows.splice(page.content.rows.indexOf(row), 1) }) }"/>
						<ul class="is-menu is-variant-toolbar is-align-end is-spacing-vertical-medium is-spacing-horizontal-right-small">
							<li class="is-column" v-if="$services.page.copiedRow"><button class="is-button is-variant-warning is-size-xsmall" @click="pasteRow()"><icon name="paste"/><span class="is-text">Paste copied row</span></button></li>
							<li class="is-column"><button class="is-button is-variant-primary is-size-xsmall" @click="addRow(page.content)"><icon name="plus"/><span class="is-text">New row</span></button></li>
						</ul>
					</div>
					<div v-if="activeTab == 'settings'">
						<div class="tabbed-menu is-row is-spacing-xsmall is-spacing-vertical-bottom-none">
							<button @click="$services.page.activeSubTab = 'component'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'component'}">Page</button>
							<button @click="$services.page.activeSubTab = 'container'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'container'}">Misc</button>
							<button @click="$services.page.activeSubTab = 'variables'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'variables'}">Variables</button>
							<button @click="$services.page.activeSubTab = 'styling'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'styling'}">Styling</button>
							<button @click="$services.page.activeSubTab = 'triggers'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'triggers'}">Triggers</button>
							<button @click="$services.page.activeSubTab = 'analysis'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'analysis'}">Analysis</button>
						</div>
						<n-form class="is-variant-floating-labels">
							<template v-if="$services.page.activeSubTab == 'component'">
								<h2 class="section-title">Routing</h2>
								<div class="is-column is-spacing-medium">	
									<p class="is-p is-size-small is-color-light">These settings will determine how the page is routed throughout the application.</p>
									<n-form-text v-model="page.content.category" label="Category" info="The category this page belongs to"/>
									<n-form-text v-model="page.content.path" label="Path" info="The path this page can be found on, if you don't want to expose it via a dedicated path, leave this empty.<br/><br/> You can use the following syntax to define path variables:<br/>/path/to/{myVariable}/is"/>
									<n-form-text v-model="page.content.title" label="Title" info="You can fill in a custom application title that will appear when this page is routed"/>
									<n-form-combo label="Page Parent" :filter="$services.page.getParentRoutes" v-model="page.content.pageParent"
										empty-value="No available parents"/>
									<n-form-text v-model="page.content.defaultAnchor" label="Content Anchor"
										after="Choose the parent page in which this page is nested by default when the user browses to it"/>
									<n-form-text v-model="page.content.autoRefresh" label="Auto-refresh"/>
									<n-form-switch label="Is slow" v-if="!page.content.initial" v-model="page.content.slow" after="If the route is slow, we can render a loading icon"/>
									<n-form-switch label="Route Error in Self" v-model="page.content.errorInSelf" after="If you check this, the error page will be routed in the element that this page appears in"/>
								</div>
								<h2 class="section-title">Security</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light">You can configure additional security on a page to limit access. If nothing is configured, everyone is allowed. You can use pseudo roles like $user and $guest.</p>
									
									<n-form-switch v-model="page.content.useFixedServiceContext" label="Use fixed service context"/>
									<n-form-combo v-model="page.content.serviceContext" v-if="!page.content.useFixedServiceContext" label="Service Context Variable"
										:filter="$services.page.filterPageStartupParameters.bind($self, page)"/>
									<n-form-text v-model="page.content.fixedServiceContext" label="Fixed service context" v-else/>
									
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="page.content.roles ? page.content.roles.push('') : $window.Vue.set(page.content, 'roles', [''])"><icon name="plus"/>Role</button>
									</div>
									<div v-if="page.content.roles">
										<div v-for="i in Object.keys(page.content.roles)" class="has-button-close">
											<n-form-text v-model="page.content.roles[i]" placeholder="Role e.g. $user, $guest, ..." :timeout="600"/>
											<button class="is-button is-variant-close is-size-small" @click="page.content.roles.splice(i, 1)"><icon name="times"/></button>
										</div>
									</div>
								</div>
								<h2 class="section-title">Branding</h2>
								<div class="is-column is-spacing-medium">
									<div class="is-row is-align-end" v-if="!page.content.branding">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="$window.Vue.set(page.content, 'branding', {})">Enable Page Branding</button>
									</div>
									<div v-else class="is-column is-spacing-vertical-gap-medium">
										<div class="is-row is-align-end">
											<button class="is-button is-variant-danger-outline is-size-xsmall" @click="$window.Vue.set(page.content, 'branding', null)">Disable Page Branding</button>
										</div>
										<n-form-text v-model="page.content.branding.siteName" label="The name of your application" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.favicon" placeholder="/resources/images/logo.png" label="The location of the favicon" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.title" :placeholder="$services.page.title" label="The meta title for your application" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.description" label="The meta description for your application" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.image" placeholder="/resources/images/hero.png" label="The meta image for your application" info="Minimum 1200×630 pixels, max 1mb" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.imageAlt" label="Alternative text for your main image" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.facebookAppId" label="Your facebook app id" info="Mostly interesting for analytics" placeholder="your_app_id" :timeout="600" @input="$services.page.saveConfiguration"/>
										<n-form-text v-model="page.content.branding.twitterUserName" placeholder="@website-username" info="Mostly interesting for analytics" label="Your facebook app id" :timeout="600" @input="$services.page.saveConfiguration"/>
									</div>
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'container'">
								<h2 class="section-title">Formatters</h2>
								<div class="is-column is-spacing-medium">	
									<n-collapsible :only-one-open="true" v-for="(formatter, index) in page.content.formatters" :title="formatter.name ? formatter.name : 'Unnamed'" content-class="is-spacing-medium">
										<ul slot="buttons" class="is-menu is-variant-toolbar is-spacing-horizontal-right-small">
											<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="page.content.formatters.splice(index, 1)"><icon name="times"/></button></li>
										</ul>
										<n-form-text v-model="formatter.name" label="Name"/>
										<n-form-switch v-model="formatter.global" label="Global" v-if="false"/>
										<n-form-ace v-model="formatter.script" label="Script"  mode="javascript"/>
									</n-collapsible>
									<div class="is-row is-align-end is-spacing-horizontal-right-small">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="page.content.formatters.push({})"><icon name="plus"/><span class="is-text">Formatter</span></button>
									</div>
								</div>
								<h2 class="section-title">Plugins</h2>
								<component v-for="plugin in plugins" :is="plugin.configure" 
									:page="page" 
									:edit="edit"/>
								<div class="is-column is-spacing-medium" v-if="!plugins.length">	
									No plugins found
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'variables'">
								<h2 class="section-title">Path</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light">Path variables can be defined in the 'path' under 'General Settings'. Use {} syntax to denote variable parts. Path variables are bookmarkable.</p>
									<p class="is-p is-size-small is-color-danger-outline" v-if="!$services.page.pathParameters(page.content.path).length">No variables found in the current path.</p>
									<p class="is-p is-size-small is-color-success-outline" v-else>Found the following path variables: {{$services.page.pathParameters(page.content.path).join(", ")}}</p>
								</div>
								<h2 class="section-title">Query</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light">You can use query variables to feed input values to your page from another page or another application. Query variables are bookmarkable.</p>
									<div class="is-row is-align-end">
										<button class="is-button is-color-primary-outline is-size-xsmall" @click="page.content.query.push(null)"><icon name="plus"/>New query parameter</button>
									</div>
									<div v-if="page.content.query && page.content.query.length" class="is-column is-spacing-gap-small">
										<div v-for="i in Object.keys(page.content.query)" class="has-button-close">
											<n-form-text v-model="page.content.query[i]" :timeout="600" placeholder="Name of the parameter"/>
											<button @click="removeQuery(i)" class="is-button is-variant-close is-size-small"><icon name="times"/></button>
										</div>
									</div>
								</div>
								<h2 class="section-title">Internal</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light">You can use internal variables to store data that you capture.</p>
									<div class="is-row is-align-end">
										<button class="is-button is-color-primary-outline is-size-xsmall" @click="addPageParameter"><icon name="plus"/>New internal parameter</button>
									</div>
								</div>
								<div class="is-accordion" v-if="page.content.parameters">
									<n-collapsible :only-one-open="true" class="is-color-primary-light" v-for="parameter in page.content.parameters" :title="parameter.name ? parameter.name : 'unnamed'" after="Internal">
										<ul slot="buttons" class="is-menu is-variant-toolbar is-spacing-horizontal-right-small">
											<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="moveInternalUp(parameter)"><icon name="chevron-circle-up"/></button></li>
											<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="moveInternalDown(parameter)"><icon name="chevron-circle-down"/></button></li>
											<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="page.content.parameters.splice(page.content.parameters.indexOf(parameter), 1)"><icon name="times"/></button></li>
										</ul>
										<div class="is-column is-spacing-medium">
											<n-form-text v-model="parameter.name" :required="true" label="Name" :timeout="600"/>
											<n-form-switch v-model="parameter.private" label="Private parameter"/>
											<n-form-combo v-if="!parameter.useDefinition" v-model="parameter.type" label="Type" :filter="getParameterTypes" :placeholder="parameter.template ? 'Calculated from template' : (parameter.default || parameter.defaultScript ? 'Calculated from default' : 'string')"/>
											<n-form-combo v-if="false" v-model="parameter.type" label="Type" :filter="getParameterTypes" :placeholder="parameter.template ? 'Calculated from template' : (parameter.default || parameter.defaultScript ? 'Calculated from default' : 'string')"/>
											<n-form-switch v-model="parameter.isArray" v-if="parameter.type" label="Is an array"/>
											<n-form-combo v-model="parameter.format" label="Format" v-if="parameter.type == 'string'" :items="['date-time', 'uuid', 'uri', 'date', 'password']"/>
											<n-form-text v-model="parameter.default" label="Default Value" v-if="!parameter.complexDefault && (!parameter.defaults || !parameter.defaults.length)"/>
											<n-form-switch v-model="parameter.complexDefault" label="Use script for default value"/>
											<n-form-ace mode="javascript" v-model="parameter.defaultScript" label="Default Value" v-if="parameter.complexDefault && (!parameter.defaults || !parameter.defaults.length)" @input="initializeDefaultParameters(true, [parameter.name], true)"/>
											<p class="is-p is-size-small is-color-light" v-if="(parameter.default || parameter.defaultScript) && !parameter.private">Note that public variables can not be recalculated through the refresh state action</p>
											<p class="is-p is-size-small is-color-light" v-if="(parameter.default || parameter.defaultScript) && parameter.private">Private default values can be recalculated using the refresh state action</p>
											<n-form-text v-if="!parameter.useDefinition && (!parameter.defaults || !parameter.defaults.length)" v-model="parameter.template" label="Template Value" after="You can use a template to determine the data type"/>
											<n-form-switch v-if="!parameter.type && !parameter.template" v-model="parameter.useDefinition" label="Use type definition" after="You can add a custom JSON schema definition for this variable"/>
											<n-form-ace v-if="parameter.useDefinition" v-model="parameter.definition" label="JSON Schema"/>
											
											<div v-if="parameter.type && parameter.type.indexOf('.') > 0 && !parameter.default">
												<h4 class="is-h4">Default Values</h4>
												<p class="is-p is-size-small is-color-light">You can set separate default values for particular fields.</p>
												<div class="is-row is-align-end">
													<button class="is-button is-variant-primary-outline is-size-xsmall" @click="parameter.defaults ? parameter.defaults.push({query:null,value:null}) : $window.Vue.set(parameter, 'defaults', [{query:null,value:null}])"><icon name="plus"/>Default Value</button>
												</div>
												<div v-if="parameter.defaults">
													<n-form-section class="is-column is-spacing-medium has-button-close is-color-body" v-for="defaultValue in parameter.defaults">
														<n-form-combo v-model="defaultValue.query" placeholder="Query" :filter="listFields.bind($self, parameter.type)"/>
														<n-form-text v-model="defaultValue.value" placeholder='Value'/>
														<button class="is-button is-variant-close is-size-small" @click="parameter.defaults.splice(parameter.defaults.indexOf(defaultValue), 1)"><icon name="times"/></button>
													</n-form-section>
												</div>
											</div>
											<n-form-switch v-if="false" v-model="parameter.global" label="Is translation global?"/>
											<n-form-switch v-model="parameter.store" label="Store in browser"/>
											<n-form-switch v-model="parameter.emitUpdate" label="Emit to parent"/>
										</div>
										<page-triggerable-configure :page="page" :target="parameter" :triggers="getStateEvents()"/>
									</n-collapsible>
								</div>
								<h2 class="section-title">External</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light">You can add additional data from the backend or the application to this page. For example when building a detail view of an item, you can retrieve all the necessary information based on an id that you get from the path.</p>
									<ul class="is-menu is-variant-toolbar is-align-end">
										<li class="is-column"><button class="is-button is-color-primary-outline is-size-xsmall has-tooltip" @click="addState"><icon name="plus"/>Backend<span class="is-tooltip">Load initial state from the backend</span></button></li>
										<li class="is-column"><button class="is-button is-color-primary-outline is-size-xsmall has-tooltip" @click="addApplicationState"><icon name="plus"/></span>Application<span class="is-tooltip">Use state available at the application level</span></button></li>
										<li class="is-column"><button class="is-button is-color-primary-outline is-size-xsmall has-tooltip" @click="function() { if (page.content.stateErrors) page.content.stateErrors.push({}); else $window.Vue.set(page.content, 'stateErrors', [{}]) }"><icon name="plus"/>Error<span class="is-tooltip">In case of state errors when loading, where should the user be routed?</span></button></li>
									</ul>
								</div>
								<div class="is-accordion is-highlight-left">
									<n-collapsible :only-one-open="true" :title="state.name ? state.name : 'unnamed'" v-for="state in page.content.states" :after="state.inherited ? 'Application' : 'Backend'" class="is-color-primary-light" content-class="is-spacing-medium">
										<div slot="buttons" class="is-row is-spacing-horizontal-right-small">
											<button class="is-button is-variant-danger-outline is-size-xsmall" @click="page.content.states.splice(page.content.states.indexOf(state), 1)"><icon name="times"/></button>
										</div>
										<n-form-text :value="state.name" @input="function(newValue) { if (!validateStateName(newValue).length) state.name = newValue; }" label="Name" :required="true" :validator="validateStateName" :timeout="600"/>
										<div v-if="state.inherited">
											<n-form-combo v-model="state.applicationName" :filter="$services.page.getApplicationStateNames" label="Application State" />
										</div>
										<div v-else class="is-column is-spacing-gap-medium">
											<n-form-combo :value="state.operation" :filter="getStateOperations" label="Operation" @input="function(newValue) { setStateOperation(state, newValue) }"/>
											<n-page-mapper v-if="state.operation && Object.keys($services.page.getPageParameters(page)).length" :to="getOperationParameters(state.operation)"
												:from="$services.page.getPageStartupParameters(page)" 
												v-model="state.bindings"/>
											<n-form-switch v-model="state.enableParameterWatching" v-if="Object.keys(state.bindings).length > 0" label="Watch input bindings for change"/>
										</div>
										<n-form-ace mode="javascript" v-model="state.condition" label="Condition" info="If left empty it will always run. If filled in, it will only run if the condition returns true." :timeout="600"/>
										<page-triggerable-configure :page="page" :target="state" :triggers="{'initial': {}, 'update': {}}"/>
										<page-event-value :page="page" :container="state" title="Successful Update Event" name="updateEvent" @resetEvents="resetEvents" :inline="true" v-if="state.updateEvent && state.updateEvent.name" after="This is deprecated and should be replaced with triggers"/>
										<div class="is-column is-spacing-gap-medium" v-if="state.refreshOn && state.refreshOn.length > 0">
											<h4 class="is-h4">Refresh Events</h4>
											<p class="is-p is-size-small is-color-light">You can refresh this state when a particular event occurs. This is deprecated and should be replaced with parameter watching.</p>
											<div class="list" v-if="state.refreshOn">
												<div v-for="i in Object.keys(state.refreshOn)" class="has-button-close">
													<n-form-combo v-model="state.refreshOn[i]" :filter="getAvailableEvents" placeholder="event"/>
													<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="state.refreshOn.splice(i, 1)"><icon name="times"/></button>
												</div>
											</div>
											<div class="is-row is-align-end">
												<button class="is-button is-variant-primary-outline is-size-xsmall" @click="state.refreshOn ? state.refreshOn.push('') : $window.Vue.set(state, 'refreshOn', [''])"><icon name="plus"/>Refresh Event</button>
											</div>
										</div>
									</n-collapsible>
								</div>
								<div v-if="page.content.stateErrors" class="is-accordion is-highlight-left">
									<n-collapsible :only-one-open="true" class="is-color-primary-light" :title="stateError.code ? stateError.code : 'no code'" v-for="stateError in page.content.stateErrors" after="Error" content-class="is-spacing-medium">
										<div slot="buttons" class="is-row is-spacing-horizontal-right-small">
											<button class="is-button is-variant-danger-outline is-size-xsmall" @click="page.content.stateErrors.splice(page.content.stateErrors.indexOf(stateError), 1)"><icon name="times"/></button>
										</div>
										<n-form-text v-model="stateError.code" label="Error Code" :timeout="600"/>
										<n-form-combo label="Error Page" :filter="$services.page.getRoutes" v-model="stateError.route"/>
									</n-collapsible>
								</div>
								<n-collapsible title="Computed" class="list" v-if="false">
									<div class="padded-content">
										<p class="is-p is-size-small is-color-light">You can compute new values based on existing state. This is especially interesting if the calculation is non trivial and you don't want to embed it into the page.</p>
										<div class="is-row is-align-end">
											<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addComputed"><icon name="plus"/>Computed State</button>
										</div>
									</div>
									<div v-if="page.content.computed" class="is-accordion is-highlight-left">
										<n-collapsible class="is-color-primary-light" :title="state.name ? state.name : 'unnamed'" v-for="state in page.content.computed" content-class="is-spacing-medium">
											<n-form-text :timeout="600" :value="state.name" @input="function(newValue) { if (!validateStateName(newValue).length) state.name = newValue; }" label="Name" :required="true" :validator="validateStateName"/>
											<n-page-mapper v-if="false && state.name" :to="[state.name]"
												:from="availableParameters" 
												v-model="state.bindings"/>
											<n-form-ace mode="javascript" v-model="state.script"/>
											<div class="list" v-if="state.refreshOn">
												<div v-for="i in Object.keys(state.refreshOn)" class="has-button-close">
													<n-form-combo v-model="state.refreshOn[i]" :filter="getAvailableEvents" placeholder="event"/>
													<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="state.refreshOn.splice(i, 1)"><icon name="times"/></button>
												</div>
											</div>
											<div class="is-row is-align-end">
												<button class="is-button is-variant-primary-outline is-size-xsmall" @click="state.refreshOn ? state.refreshOn.push('') : $window.Vue.set(state, 'refreshOn', [''])"><icon name="plus"/>Refresh Event</button>
											</div>
										</n-collapsible>
									</div>
								</n-collapsible>	
							</template>
							<template v-if="$services.page.activeSubTab == 'styling'">
								<h2 class="section-title">Page Style</h2>
								<div class="is-column is-spacing-medium">	
									<n-form-combo label="Page Type" :filter="getPageTypes" v-model="page.content.pageType" info = "The page type determines how the page is rendered. For example an email requires different rendering from a webpage."/>
									<n-form-text v-model="page.content.class" label="CSS Class" info = "The main css class for this page" :timeout="600"/>
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="page.content.styles == null ? $window.Vue.set(page.content, 'styles', [{class:null,condition:null}]) : page.content.styles.push({class:null,condition:null})"><icon name="plus"/>Page style</button>
									</div>
									
									<div v-if="page.content.styles" class="is-column is-spacing-vertical-gap-medium">
										<n-form v-for="style in page.content.styles" class="has-button-close is-spacing-medium is-color-body">
											<n-form-section class="is-column is-spacing-vertical-small">
												<n-form-text v-model="style.class" label="CSS Class" :timeout="600" class="is-size-small"/>
												<n-form-text v-model="style.condition" label="Condition" :timeout="600" class="is-size-small"/>
												<button @click="page.content.styles.splice(page.content.styles.indexOf(style), 1)" class="is-button is-variant-close is-size-small"><icon name="times"/></button>
											</n-form-section>
										</n-form>
									</div>
								</div>
								<h2 class="section-title">Body Style</h2>
								<aris-editor 
									:key="'cell_' + page.name + '_aris_editing'"
									v-if="$services.page.useAris && $services.page.normalizeAris(page, page.content, 'page', getPageArisComponents())" :child-components="getPageArisComponents()" :container="page.content.aris"
									/>
								<div class="is-column is-spacing-medium">	
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="page.content.bodyStyles == null ? $window.Vue.set(page.content, 'bodyStyles', [{class:null,condition:null}]) : page.content.bodyStyles.push({class:null,condition:null})"><icon name="plus"/>Body style</button>
									</div>
									
									<div v-if="page.content.bodyStyles" class="is-column is-spacing-vertical-gap-medium">
										<n-form v-for="style in page.content.bodyStyles" class="has-button-close is-spacing-medium is-color-body">
											<n-form-section class="is-column is-spacing-vertical-small">
												<n-form-text v-model="style.class" label="CSS Class" class="is-size-small"/>
												<n-form-text v-model="style.condition" label="Condition" class="is-size-small"/>
												<button @click="page.content.bodyStyles.splice(page.content.bodyStyles.indexOf(style), 1)" class="is-button is-variant-close is-size-small"><icon name="times"/></button>
											</n-form-section>
										</n-form>
									</div>
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'triggers'">
								<h2 class="section-title">Triggers</h2>
								<page-triggerable-configure :page="page" :target="page.content" :triggers="getEvents()" />
								<h2 class="section-title">Analysis</h2>
								<div class="is-row is-align-end is-spacing-medium">
									<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addAnalysis"><icon name="plus"/>Analysis</button>
								</div>
								<n-collapsible :only-one-open="true" class="is-color-primary-light" :title="(analysis.chainEvent && analysis.chainEvent.name ? analysis.chainEvent.name : 'unnamed')" :after="analysis.on ? 'on ' + analysis.on : 'no trigger yet'" v-for="analysis in page.content.analysis" content-class="is-spacing-medium">
									<div slot="buttons" class="is-row is-spacing-horizontal-right-small">
										<button class="is-button is-size-xsmall is-variant-danger-outline" @click="page.content.analysis.splice(page.content.analysis.indexOf(analysis), 1)"><icon name="times"/></button>
									</div>
									<n-form-combo v-model="analysis.on" label="Trigger On" :filter="getAvailableEvents"/>
									<n-form-text v-model="analysis.condition" label="Condition" v-if="analysis.on" :timeout="600"/>
									<page-event-value :inline="true" class="no-more-padding" :page="page" :container="analysis" title="Analysis Event" name="chainEvent" @resetEvents="resetEvents"/>
								</n-collapsible>
								
								<h2 class="section-title">Publish global events</h2>
								<div class="is-column is-spacing-medium">	
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addGlobalEvent"><icon name="plus"/>Global Event</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="page.content.globalEvents">
										<n-form-section class="is-column is-color-body has-button-close is-spacing-medium" v-for="i in Object.keys(page.content.globalEvents)">
											<n-form-combo v-model="page.content.globalEvents[i].localName"
												label="Local Name"
												:filter="getAvailableEvents"/>
											<n-form-text v-model="page.content.globalEvents[i].globalName" 
												label="Global Name"
												:placeholder="page.content.globalEvents[i].localName"/>
											<button class="is-button is-variant-close" @click="page.content.globalEvents.splice(i, 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
								<h2 class="section-title">Subscribe global events</h2>
								<div class="is-column is-spacing-medium">	
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addGlobalEventSubscription"><icon name="plus"/>Global Event</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="page.content.globalEventSubscriptions">
										<n-form-section class="is-column is-color-body has-button-close is-spacing-medium" v-for="i in Object.keys(page.content.globalEventSubscriptions)">
											<n-form-combo v-model="page.content.globalEventSubscriptions[i].globalName"
												label="Global Name"
												:items="$window.Object.keys($services.page.getGlobalEvents())"/>
											<n-form-text v-model="page.content.globalEventSubscriptions[i].localName" 
												label="Local Name"
												:placeholder="page.content.globalEventSubscriptions[i].globalName"/>
											<button class="is-button is-variant-close" @click="page.content.globalEventSubscriptions.splice(i, 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
							</template>
						</n-form>
					</div>
					
					<page-components-overview v-else-if="activeTab == 'components'"/>
					
					<div v-else-if="activeTab == 'selected' && cell && selectedType == 'cell'" :key="'page_' + pageInstanceId + '_cell_' + cell.id + '_configuration'">
						<div class="tabbed-menu is-row is-spacing-xsmall is-spacing-vertical-bottom-none">
							<button @click="$services.page.activeSubTab = 'container'" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == 'container'}">Cell<span class="is-tooltip is-position-bottom">Show cell details <shortkey alt="true">1</shortkey></span></button>
							<button @click="$services.page.activeSubTab = 'styling'" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == 'styling'}">Styling<span class="is-tooltip is-position-bottom">Configure styling <shortkey alt="true">2</shortkey></span></button>
							<button @click="$services.page.activeSubTab = 'triggers'" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == 'triggers'}">Triggers<span class="is-tooltip is-position-bottom">React to triggers <shortkey alt="true">3</shortkey></span></button>
							<button @click="$services.page.activeSubTab = 'component'" v-if="cell && $services.page.availableSubTabs.length == 0 && canConfigureInline(cell)" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == 'component'}">{{cell.alias && false ? $services.page.prettifyRouteAlias(cell.alias) : "Main"}}<span class="is-tooltip is-position-bottom">General configuration <shortkey alt="true">4</shortkey></span></button>
							<button @click="$services.page.activeSubTab = customSubTab" v-for="(customSubTab, index) in $services.page.availableSubTabs" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == customSubTab}">{{customSubTab == 'component' ? (cell.alias && false ? $services.page.prettifyRouteAlias(cell.alias) : "Main") : $services.page.prettify(customSubTab)}}<span class="is-tooltip is-position-bottom">Configure <shortkey alt="true">{{index + 4}}</shortkey></span></button>
							<button @click="$services.page.activeSubTab = 'analysis'" class="is-button is-size-xsmall has-tooltip" :class="{'is-active': $services.page.activeSubTab == 'analysis'}">Analysis<span class="is-tooltip is-position-bottom">Show cell details <shortkey alt="true">{{4 + $services.page.availableSubTabs.length}}</shortkey></span></button>
						</div>
						<n-form class="is-variant-floating-labels" key="cell-form">
							<template v-if="$services.page.activeSubTab == 'container'">
								<h2 class="section-title">General</h2>
								<div class="is-column is-spacing-medium"> 
									<n-form-text label="Name" v-model="cell.name" placeholder="A descriptive name for this cell" :timeout="600" :suffix="cell.id"/>
									<n-form-text label="Cell Id" v-model="cell.customId" placeholder="Add targetable container with id to this cell" :timeout="600"/>
								</div>
								
								<h2 class="section-title">Content</h2>
								<div class="is-column is-spacing-medium"> 
									<p class="section-description">A cell can contain either a renderer or content. A renderer is used to layout child content.</p>
									<n-form-combo label="Content" :filter="$services.page.getEmbeddableRoutes" v-model="cell.alias"
										v-if="!cell.renderer"
										:key="'page_' + pageInstanceId + '_' + cell.id + '_alias'"
										@input="$services.page.normalizeAris(page, cell)"/>
									<n-form-combo label="Renderer" v-if="!cell.alias" v-model="cell.renderer" :items="$services.page.getRenderers('cell')" 
										empty-value="No renderers found"
										:formatter="function(x) { return x.title ? x.title : x.name }"
										:extracter="function(x) { return x.name }" info="Use a specific renderer for this cell"/>
									<n-page-mapper v-if="cell.alias && $window.Object.keys(getRouteParameters(cell).properties).length" 
										:key="'page_' + pageInstanceId + '_' + cell.id + '_mapper'"
										:to="getRouteParameters(cell)"
										:from="getAvailableParameters(cell)" 
										v-model="cell.bindings"/>
									<n-form-text v-model="cell.contentRuntimeAlias" v-if="cell.alias && $window.Object.keys(getRouteParameters(cell).properties).length" label="Content Runtime Alias"/>
									<n-form-switch v-if="cell.alias" label="Stop Rerender" v-model="cell.stopRerender" info="All components are reactive to their input, you can however prevent rerendering by settings this to true"/>
									
									<div v-if="cell.renderer && $services.page.getRendererState(cell.renderer, cell, page, $services.page.getAllAvailableParameters(page))" class="is-column is-spacing-vertical-gap-medium">
										<n-form-text v-model="cell.runtimeAlias" label="Runtime alias for renderer state" :timeout="600"/>
										<n-form-switch v-model="cell.retainState" label="Retain state once cell is destroyed" v-if="cell.runtimeAlias"/>
										<n-form-switch v-model="cell.mergeState" label="Merge existing state when the rendered is created" v-if="cell.runtimeAlias"/>
									</div>
									<div v-if="cell.renderer && $services.page.getRendererConfiguration(cell.renderer)">
										<component :is="$services.page.getRendererConfiguration(cell.renderer)" :target="cell" :page="page"/>
									</div>
									<renderer-bindings :target="cell" :page="page" v-if="cell.renderer"/>
								</div>
								
								<template v-if="getParentConfig(cell) || getSlots(cell)">
									<h2 class="section-title">Parent</h2>
									<div class="is-column is-spacing-medium">
										<p class="section-description">Configuration options from the parent of this cell.</p>
										<n-form-combo label="Target slot in renderer" v-if="getSlots(cell)" v-model="cell.rendererSlot" :items="getSlots(cell)"/>
										
										<component v-if="getParentConfig(cell)" :is="getParentConfig(cell)"
											:cell="cell"
											:row="row"
											:page="page"/>
									</div>
								</template>
								
								<h2 class="section-title">Conditions</h2>
								<div class="is-column is-spacing-medium">
									<p class="section-description" v-if="!$services.page.isCloseable(cell) && !cell.condition">By default the cell will be visible.</p>
									<p class="section-description" v-else>By default the cell will be hidden.</p>
									<n-form-combo label="Hide this cell" 
										:items="[{name:'event', title:'Until an event occurs'}, {name: 'script', title: 'Until a condition is met'}, {name:'toggle', title: 'Until explicitly toggled'}, {name: 'device', title: 'On certain devices'}]"
										:extracter="function(x) { return x.name }"
										:formatter="function(x) { return x.title }"
										:value="getHideMode(cell)"
										@input="function(value) { setHideMode(cell, value) }"/>
										
									<n-form-switch v-if="$services.page.isCloseable(cell)" label="Cascade close" v-model="cell.cascadeClose"/>
										
									<n-form-combo label="The event that has to occur" v-model="cell.on" :filter="getAvailableEvents" v-if="cell.state.hideMode == 'event'" />

									<n-form-text type="number" v-model="cell.showTimeout" v-if="cell.state.hideMode == 'event'" label="Hide automatically after this amount of ms"/>
										
									<n-form-switch label="Start visible" v-model="cell.startVisible" v-if="cell.state.hideMode == 'toggle'" />
									
									<n-form-switch label="Hide until toggled explicitly" v-model="cell.closeable" v-if="false && !cell.on && (cell.target == 'page' || cell.target == null)" />
									
									<n-form-switch label="Autoclose once visible" v-model="cell.autocloseable" v-if="cell.closeable" after="Once it is toggled to visible and the user clicks outside this cell, do you want to automatically hide it again?"/>
									
									<n-form-ace mode="javascript" label="Condition" v-model="cell.condition" :timeout="600" v-if="cell.state.hideMode == 'script'"/>
									
									<div v-if="$services.page.devices.length && cell.state.hideMode == 'device'" class="is-column is-spacing-vertical-gap-medium">
										<p class="is-p is-size-small is-color-light is-spacing-vertical-bottom-small">Render the cell only if these device rules are met.</p>
										<div class="is-row is-align-end">
											<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addDevice(cell)"><icon name="plus"/>Device rule</button>
										</div>
										<div v-if="cell.devices" class="is-column is-spacing-vertical-gap-medium">
											<div class="has-button-close is-column is-spacing-medium is-color-body" v-for="device in cell.devices">
												<p class="is-p is-size-small">Only render cell if device:</p>
												<n-form-combo v-model="device.operator" :items="['>', '>=', '<', '<=', '==']"/>
												<n-form-combo v-model="device.name" 
													:filter="suggestDevices"/>
												<button class="is-button is-variant-close" @click="cell.devices.splice(cell.devices.indexOf(device), 1)"><icon name="times"/></button>
											</div>
										</div>
									</div>
									<n-form-text label="Show only if user has permission" v-model="cell.permission" placeholder="E.g. company.list"/>
									<n-form-text :label="cell.permission ? 'Optional permission context' : 'Show only if user has any permission in context'" v-model="cell.permissionContext" placeholder="E.g. crm" />
									<n-form-text :label="cell.permission ? 'Optional permission service context' : 'Show only if user has any permission in service context'" v-model="cell.permissionServiceContext" placeholder="E.g. default" />
									<n-form-switch label="Permission inversion" v-model="cell.permissionInversion" info="Invert permission check"/>
								</div>
								
								<h2 class="section-title">Location</h2>
								<div class="is-column is-spacing-medium">
									<p class="section-description">By default a cell will render in the page, there are other options however.</p>
									<n-form-combo label="Render in" :items="['page', 'sidebar', 'prompt', 'absolute', 'pane']" v-model="cell.target" />
									<n-form-switch v-if="cell.target == 'absolute'" v-model="cell.targetInEdit" label="Show absolute positioning in edit mode as well"/>
									<n-form-switch label="Prevent Auto Close" v-model="cell.preventAutoClose" v-if="cell.target == 'sidebar'"
										after="The sidebar will automatically close when the user clicks elsewhere unless this is toggled"/>
									<n-form-switch label="Optimize (may result in stale content)" v-model="cell.optimizeVueKey" v-if="cell.on"/>
									<n-form-text label="Top" v-model="cell.top" v-if="cell.target == 'absolute'"/>
									<n-form-text label="Bottom" v-model="cell.bottom" v-if="cell.target == 'absolute'"/>
									<n-form-text label="Left" v-model="cell.left" v-if="cell.target == 'absolute'"/>
									<n-form-text label="Right" v-model="cell.right" v-if="cell.target == 'absolute'"/>
									<n-form-text label="Minimum Width" v-model="cell.minWidth" v-if="cell.target == 'absolute'"/>
									<n-form-switch label="Position fixed?" v-model="cell.fixed" v-if="cell.target == 'absolute'"/>
									<n-form-switch label="Autoclose" v-model="cell.autoclose" v-if="cell.target == 'absolute' || cell.target == 'prompt'"/>
									<n-form-combo label="Snap Point" v-model="cell.snapPoint" v-if="cell.target == 'absolute'" :items="['top-left', 'top-right', 'bottom-left', 'bottom-right', 'center']" placeholder="top-left"/>
								</div>
								
								<h2 class="section-title">Templating</h2>
								<div class="is-column is-spacing-medium">
									<template-manager :target="cell" :page="page"/>
								</div>
								
								<h2 class="section-title">States</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small is-color-light is-spacing-vertical-bottom-small">Set dynamic states on the cell</p>
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addTargetState(cell)"><icon name="plus"/>State</button>
									</div>
									<div v-if="cell.states" class="is-column is-spacing-vertical-gap-medium">
										<div class="has-button-close is-column is-spacing-medium is-color-body" v-for="(state, index) in cell.states">
											<n-form-text v-model="state.name" label="Name"/>
											<n-form-ace v-model="state.condition" label="Condition"/>
											<button class="is-button is-variant-close" @click="cell.states.splice(index, 1)"><icon name="times"/></button>
										</div>
									</div>
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'component' || $services.page.availableSubTabs.indexOf($services.page.activeSubTab) >= 0">
								<component :is="getCellConfigurator(cell)" v-bind="getCellConfiguratorInput(cell)" v-if="canConfigureInline(cell)"/>
								<div v-else class="is-column is-spacing-medium">This cell has no additional configuration</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'styling'">
								<h2 class="section-title">Aris</h2>
								<aris-editor 
										:key="'cell_' + cell.id + '_aris_editing'"
										v-if="$services.page.useAris && $services.page.normalizeAris(page, cell)" :child-components="$services.page.getCellComponents(page, cell)" :container="cell.aris"
										:specific="cell.alias"/>
										
								<h2 class="section-title">Other</h2>
								<div class="is-column is-spacing-medium" v-if="cell.class || (cell.styles && cell.styles.length)">
									<n-form-text label="Cell Class" v-model="cell.class" :timeout="600"/>
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="cell.styles == null ? $window.Vue.set(cell, 'styles', [{class:null,condition:null}]) : cell.styles.push({class:null,condition:null})"><icon name="plus"/>Cell Style</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="cell.styles">
										<n-form-section class="is-column is-color-body is-spacing-medium has-button-close" v-for="style in cell.styles">
											<n-form-text v-model="style.class" label="Class"/>
											<n-form-text v-model="style.condition" label="Condition" class="vertical"/>
											<button class="is-button is-variant-close" @click="cell.styles.splice(cell.styles.indexOf(style), 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
								
								<div class="is-column is-spacing-medium">
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="cell.styleVariables == null ? $window.Vue.set(cell, 'styleVariables', [{name:null,rule:null,condition:null}]) : cell.styleVariables.push({name:null,rule:null,condition:null})"><icon name="plus"/>Style Variable</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="cell.styleVariables">
										<n-form-section class="is-column is-color-body is-spacing-medium has-button-close" v-for="style in cell.styleVariables">
											<n-form-text v-model="style.name" label="Variable"/>
											<n-form-text v-model="style.rule" label="Value" class="vertical"/>
											<n-form-text v-model="style.condition" label="Condition" class="vertical"/>
											<button class="is-button is-variant-close" @click="cell.styleVariables.splice(cell.styleVariables.indexOf(style), 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
								
							</template>
							<template v-else-if="$services.page.activeSubTab == 'triggers'">
								<h2 class="section-title">Triggers</h2>
								<div class="is-column is-spacing-medium">
									<p class="section-description">You can add triggers to react to user interaction with the content.</p>
									<n-form-switch v-model="cell.state.stopClickPropagation" label="Stop click propagation"/>
									<n-form-switch v-model="cell.state.stopHoverPropagation" label="Stop hover propagation"/>
								</div>
								<page-triggerable-configure :page="page" :target="cell" :triggers="getTriggersForCell(cell)" :allow-closing="true"/>
							</template>
							<template v-else-if="$services.page.activeSubTab == 'analysis'">
								<h2 class="section-title">Analysis</h2>
								<n-form-text v-model="cell.analysisId" label="Analysis id"/>
							</template>
						</n-form>
					</div>
					
					<div v-else-if="activeTab == 'selected' && row && selectedType == 'row'" :key="'page_' + pageInstanceId + '_row_' + row.id + '_configuration'">
						<div class="tabbed-menu is-row is-spacing-xsmall is-spacing-vertical-bottom-none">
							<button @click="$services.page.activeSubTab = 'container'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'container'}">Row</button>
							<button @click="$services.page.activeSubTab = 'styling'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'styling'}">Styling</button>
							<button @click="$services.page.activeSubTab = 'triggers'" class="is-button is-size-xsmall" :class="{'is-active': $services.page.activeSubTab == 'triggers'}">Triggers</button>
						</div>
						<n-form class="is-variant-floating-labels" key="cell-form">
							<template v-if="$services.page.activeSubTab == 'container'">
								<h2 class="section-title">General</h2>
								<div class="is-column is-spacing-medium">
									<n-form-text label="Name" v-model="row.name" placeholder="A descriptive name for this row" :timeout="600" :suffix="row.id"/>
									<n-form-text label="Row Id" v-model="row.customId" placeholder="Add an id to this row, useful for skeletons"/>
								</div>
								<h2 class="section-title">Content</h2>
								<div class="is-column is-spacing-medium">
									<n-form-combo label="Renderer" v-model="row.renderer" :items="$services.page.getRenderers('row')"  :formatter="function(x) { return x.title ? x.title : x.name }" :extracter="function(x) { return x.name }"/>
									
									<div v-if="row.renderer && $services.page.getRendererState(row.renderer, row, page, $services.page.getAllAvailableParameters(page))" class="is-column is-spacing-vertical-gap-medium">
										<n-form-text v-model="row.runtimeAlias" label="Runtime alias for renderer state" :timeout="600"/>
										<n-form-switch v-model="row.retainState" label="Retain state once row is destroyed" v-if="row.runtimeAlias"/>
										<n-form-switch v-model="row.mergeState" label="Merge existing state when the rendered is created" v-if="row.runtimeAlias"/>
									</div>
									<div v-if="row.renderer && $services.page.getRendererConfiguration(row.renderer)">
										<component :is="$services.page.getRendererConfiguration(row.renderer)" :target="row" :page="page"/>
									</div>
									
									<renderer-bindings :target="row" :page="page" v-if="row.renderer"/>	
								</div>
								<template v-if="getParentConfig(row) || getSlots(row)">
									<h2 class="section-title">Parent</h2>
									<div class="is-column is-spacing-medium">
										<p class="section-description">Configuration options from the parent of this row.</p>
										<n-form-combo label="Target slot in renderer" v-if="getSlots(row)" v-model="row.rendererSlot" :items="getSlots(row)"/>
										
										<component v-if="getParentConfig(row)" :is="getParentConfig(row)"
											:row="row"
											:page="page"/>
									</div>
								</template>
								<h2 class="section-title">Conditions</h2>
								<div class="is-column is-spacing-medium">
									<p class="is-p is-size-small" v-if="!$services.page.isCloseable(row) && !row.condition">By default the row will be visible.</p>
									<p class="is-p is-size-small" v-else>By default the row will be hidden.</p>
									
									<n-form-combo label="Hide this row" 
										:items="[{name:'event', title:'Until an event occurs'}, {name: 'script', title: 'Until a condition is met'}, {name:'toggle', title: 'Until explicitly toggled'}, {name: 'device', title: 'On certain devices'}]"
										:extracter="function(x) { return x.name }"
										:formatter="function(x) { return x.title }"
										:value="getHideMode(row)"
										@input="function(value) { setHideMode(row, value) }"/>
										
										
									<n-form-switch v-if="$services.page.isCloseable(row)" label="Cascade close" v-model="row.cascadeClose"/>
									
									<n-form-combo label="The event that has to occur" v-model="row.on" :filter="getAvailableEvents" v-if="row.state.hideMode == 'event'"/>
									
									<n-form-switch label="Start visible" v-model="row.startVisible" v-if="row.state.hideMode == 'toggle'" />
									
									<n-form-switch label="Hide by default" v-model="row.closeable"
										v-if="false"/>
										
									<n-form-switch label="Autoclose once visible" v-model="row.autocloseable" v-if="row.closeable" after="Once it is toggled to visible and the user clicks outside this row, do you want to automatically hide it again?"/>
									
									<n-form-ace mode="javascript" label="Condition" v-model="row.condition" v-if="row.state.hideMode == 'script'" class="vertical"/>
									
									<div v-if="$services.page.devices.length && row.state.hideMode == 'device'" class="is-column is-spacing-vertical-medium">
										<p class="is-p is-size-small is-color-light is-spacing-vertical-bottom-small">Render the row only if these device rules are met.</p>
										<div class="is-row is-align-end">
											<button class="is-button is-variant-primary-outline is-size-xsmall" @click="addDevice(row)"><icon name="plus"/>Device rule</button>
										</div>
										<div v-if="row.devices" class="is-column is-spacing-vertical-gap-medium">
											<div class="is-column is-spacing-medium is-color-body has-button-close" v-for="device in row.devices">
												<p class="is-p is-size-small">Only render row if device:</p>
												<n-form-combo v-model="device.operator" :items="['>', '>=', '<', '<=', '==']"/>
												<n-form-combo v-model="device.name" 
													:filter="suggestDevices"/>
												<button class="is-button is-variant-close" @click="row.devices.splice(row.devices.indexOf(device), 1)"><icon name="times"/></button>
											</div>
										</div>
									</div>
									<n-form-text label="Show only if user has permission" v-model="row.permission" placeholder="E.g. company.list"/>
									<n-form-text :label="row.permission ? 'Optional permission context' : 'Show only if user has any permission in context'" v-model="row.permissionContext" placeholder="E.g. crm" />
									<n-form-text :label="row.permission ? 'Optional permission service context' : 'Show only if user has any permission in service context'" v-model="row.permissionServiceContext" placeholder="E.g. default" />
								</div>
								<h2 class="section-title">Templating</h2>
								<div class="is-column is-spacing-medium">
									<template-manager :target="row" :page="page"/>
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'styling'">
								<h2 class="section-title">Row styling</h2>
								<aris-editor v-if="$services.page.useAris && $services.page.normalizeAris(page, row, 'row')" :child-components="$services.page.getRowComponents(page, row)" :container="row.aris"/>
								<div class="is-column is-spacing-medium" v-if="row.class && (row.styles || row.styles.length)">
									<n-form-text label="Class" v-model="row.class" :timeout="600"/>
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="row.styles == null ? $window.Vue.set(row, 'styles', [{class:null,condition:null}]) : row.styles.push({class:null,condition:null})"><icon name="plus"/>Row Style</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="row.styles">
										<n-form-section class="is-column is-color-body is-spacing-medium has-button-close" v-for="style in row.styles">
											<n-form-text v-model="style.class" label="Class"/>
											<n-form-text v-model="style.condition" label="Condition" class="vertical"/>
											<button class="is-button is-variant-close" @click="row.styles.splice(row.styles.indexOf(style), 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
								<div class="is-column is-spacing-medium">
									<div class="is-row is-align-end">
										<button class="is-button is-variant-primary-outline is-size-xsmall" @click="row.styleVariables == null ? $window.Vue.set(row, 'styleVariables', [{name:null,rule:null,condition:null}]) : row.styleVariables.push({name:null,rule:null,condition:null})"><icon name="plus"/>Style Variable</button>
									</div>
									<div class="is-column is-spacing-vertical-gap-medium" v-if="row.styleVariables">
										<n-form-section class="is-column is-color-body is-spacing-medium has-button-close" v-for="style in row.styleVariables">
											<n-form-text v-model="style.name" label="Variable"/>
											<n-form-text v-model="style.rule" label="Value" class="vertical"/>
											<n-form-text v-model="style.condition" label="Condition" class="vertical"/>
											<button class="is-button is-variant-close" @click="row.styleVariables.splice(row.styleVariables.indexOf(style), 1)"><icon name="times"/></button>
										</n-form-section>
									</div>
								</div>
							</template>
							<template v-if="$services.page.activeSubTab == 'triggers'">
								<h2 class="section-title">Triggers</h2>
								<div class="is-column is-spacing-medium">
									<p class="section-description">You can add triggers to react to user interaction with the content.</p>
									<n-form-switch v-model="row.state.stopClickPropagation" label="Stop click propagation"/>
									<n-form-switch v-model="row.state.stopHoverPropagation" label="Stop hover propagation"/>
								</div>
								<page-triggerable-configure :page="page" :target="row" :triggers="getTriggersForCell(row)" :allow-closing="row.target && row.target != 'page'"/>
							</template>
						</n-form>
					</div>
				</div>
				</div>
		</n-sidebar>
		
		<template v-if="page.content.rows">
			<n-page-row 
				:active-views="activeViews"
				@update="updateEvent"
				v-for="row in page.content.rows"
				:row="row"
				:page="page" 
				:edit="edit"
				:depth="0"
				:parameters="parameters"
				:ref="page.name + '_rows'"
				:root="true"
				:page-instance-id="pageInstanceId"
				:stop-rerender="stopRerender"
				@select="selectItem"
				@viewComponents="viewComponents = edit"
				:slot="row.rendererSlot"
				@removeRow="function(x) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { page.content.rows.splice(page.content.rows.indexOf(x), 1) }) }"/>
		</template>
		
		<div class="page-menu n-page-menu" v-if="edit && false">
			<button @click="viewComponents = !viewComponents"><span class="fa fa-cubes" title="Add Components"></span></button>
		</div>
	</component>
</script>

<script type='x/templates' id="page-row">
	<component :is="rowTagFor(row)" :id="row.customId && !row.renderer ? row.customId : page.name + '_' + row.id" 
			:draggable="isDraggable(row)"
			@update="updateEvent"
			:class="$window.nabu.utils.arrays.merge(['page-row-' + row.cells.length, row.class ? row.class : null, {'collapsed': row.collapsed}, {'empty': edit && (!row.cells || !row.cells.length) } ], rowClasses(row))"  
			:key="'page_' + pageInstanceId + '_row_' + row.id"
			:row-key="'page_' + pageInstanceId + '_row_' + row.id"
			v-if="edit || shouldRenderRow(row)"
			:style="rowStyles(row)"
			@drop="drop($event, row)" 
			@dragend="$services.page.clearDrag($event)"
			@dragover="dragOver($event, row)"
			@dragexit="dragExit($event, row)"
			@mouseout="mouseOut($event, row)"
			@mouseout.native="mouseOut($event, row)"
			@mouseover="mouseOver($event, row)"
			@mouseover.native="mouseOver($event, row)"
			@click.ctrl="goto($event, row)"
			@click.meta="goto($event, row)"
			@click.alt="$emit('select', row, null, 'row')"
			@click="clickOnRow(row, $event)"
			@click.native="clickOnRow(row, $event)"
			@contextmenu.ctrl="goto($event, row, null, 'layout')"
			@contextmenu.prevent.ctrl.native="goto($event, row, null, 'layout')"
			@click.alt.prevent.native="pasteArisStyling($event, row)"
			@contextmenu.prevent.alt.native="copyArisStyling($event, row)"
			:href="targetHref(row)"
			:placeholder="row.name ? row.name : null"
			:target="row"
			:edit="edit"
			:page="page"
			@close="close(row)"
			:child-components="$services.page.calculateArisComponents(row.aris, row.renderer, $self)"
			:parameters="getRendererParameters(row)"
			:anchor="row.customId && !row.renderer ? row.customId : null"
			class="page-row"
			v-auto-close="$services.page.isCloseable(row) && row.autocloseable ? function() { autocloseCell(row) } : null"
			>
		<div class="is-row-menu is-layout is-align-main-center is-align-cross-bottom is-spacing-vertical-xsmall" v-if="edit && false" @mouseenter="menuHover" @mouseleave="menuUnhover">
			<button class="is-button is-variant-primary is-size-xsmall has-tooltip is-wrap-none" v-if="!row.collapsed" @click="goto($event, row)"><icon name="cog"/><span class="is-text">{{row.renderer ? row.renderer : 'Row'}}</span></button>
		</div>
		
		<div class="is-row-content" v-if="row.customId && row.renderer" :id="row.customId" :anchor="row.customId"></div>
		
		<template v-for="cell in row.cells">
			<template v-if="edit">
				<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
						:draggable="isDraggable(cell)"
						v-if="cell.target != 'absolute' || !cell.targetInEdit"
						@update="updateEvent"
						v-show="!edit || !row.collapsed"
						:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
						:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
						:key="cellId(cell) + '_edit' + '_' + cell.alias"
						:cell-id="cell.id"
						@click="clickOnCell(row, cell, $event)"
						@click.ctrl="goto($event, row, cell)"
						@click.meta="goto($event, row, cell)"
						@click.alt.prevent="pasteArisStyling($event, cell)"
						@contextmenu.prevent.alt="copyArisStyling($event, cell)"
						@click.native="clickOnCell(row, cell, $event)"
						@click.ctrl.native="goto($event, row, cell)"
						@click.meta.native="goto($event, row, cell)"
						@click.alt.prevent.native="pasteArisStyling($event, cell)"
						@contextmenu.prevent.alt.native="copyArisStyling($event, cell)"
						@contextmenu.ctrl="goto($event, row, cell, 'layout')"
						@contextmenu.prevent.ctrl.native="goto($event, row, cell, 'layout')"
						@mouseout="mouseOut($event, row, cell)"
						@mouseout.native="mouseOut($event, row, cell)"
						@mouseover="mouseOver($event, row, cell)"
						@mouseover.native="mouseOver($event, row, cell)"
						@dragend="$services.page.clearDrag($event)"
						@dragover="dragOverCell($event, row, cell)"
						@dragexit="dragExitCell($event, row, cell)"
						@drop="dropCell($event, row, cell)"
						:href="targetHref(cell)"
						:target="cell"
						:edit="edit"
						:page="page"
						:placeholder="cell.name ? cell.name : (cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : null)"
						:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
						:parameters="getRendererParameters(cell)"
						v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { var rerender = cell.aris && cell.aris.rerender; if (cell.aris) cell.aris.rerender = false; return rerender; }, created: getCreatedComponent(row, cell) }"
						:anchor="cell.customId ? cell.customId : null"
						:slot="cell.rendererSlot"
						class="page-column"
						>
					
					<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" :key="'page_' + pageInstanceId + '_edit_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { var rerender = cell.aris && cell.aris.rerender; if (cell.aris) cell.aris.rerender = false; return rerender; }, created: getCreatedComponent(row, cell) }"></div>
					
					<n-page-row v-for="row in cell.rows"
						:active-views="activeViews"
						locked="true"
						:row="row"
						:page="page" 
						:edit="edit"
						:depth="depth + 1"
						:parameters="parameters"
						:ref="page.name + '_' + cell.id + '_rows'"
						:local-state="getLocalState(row, cell)"
						:page-instance-id="pageInstanceId"
						:stop-rerender="stopRerender"
						v-bubble:viewComponents
						v-bubble:select
						@update="updateEvent"
						:slot="row.rendererSlot"
						@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
					
					<div locked="true" class="is-column-menu is-layout is-align-main-center is-spacing-vertical-xsmall" @mouseenter="menuHover" @mouseleave="menuUnhover" v-if="true">
						<div v-if="isNoActiveView()">
							<button v-if="cell.alias" class="is-button is-variant-secondary is-size-xsmall has-tooltip is-wrap-none" @click="goto($event, row, cell)"><icon name="cog"/><span class="is-text">{{ cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : "Cell" }}</span></button>
							<button v-else class="is-button is-variant-secondary is-size-xsmall has-tooltip is-wrap-none" @click="goto($event, row, cell)"><icon name="magic"/><span class="is-text">{{ cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : "Cell" }}</span></button>
							<span class="is-badge is-color-danger" v-if="cell.condition">On condition</span>
							<span class="is-badge is-color-warning" v-if="cell.on">On event</span>
							<span class="is-badge is-color-neutral" v-if="cell.state.hideMode == 'toggle'">On toggle</span>
						</div>
						<div v-else-if="isActiveView('conditions')">
							<span class="is-badge is-color-danger" v-if="cell.condition">{{cell.condition}}</span>
							<span class="is-badge is-color-warning" v-if="cell.on">{{cell.on}}</span>
							<span class="is-badge is-color-neutral" v-if="cell.state.hideMode == 'toggle'">On toggle</span>
						</div>
						<div v-else-if="isActiveView('styling')">
							<div v-for="component in $services.page.getCellComponents(page, cell)" v-if="$services.aris.listActive(cell.aris, component).length">
								<span class="is-badge is-color-secondary">{{component.name}}</span><span v-for="option in $services.aris.listActive(cell.aris, component)" class="is-badge is-color-neutral"><span class="is-content is-variant-subscript">{{option.dimension}}</span><b>{{option.name}}</b><span v-if="option.condition" class="is-content is-color-danger-outline"> {{option.condition}}</span></span>
							</div>
						</div>
					</div>
				</component>
				
				<n-absolute :fixed="cell.fixed" :style="{'min-width': cell.minWidth}" :autoclose="cell.autoclose" v-else-if="cell.target == 'absolute'" @close="close(row, cell)" :top="cell.top" :bottom="cell.bottom" :left="cell.left" :right="cell.right" :snap-point="cell.snapPoint">          
					<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
							:draggable="isDraggable(cell)"
							@update="updateEvent"
							v-show="!edit || !row.collapsed"
							:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
							:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
							:key="cellId(cell)"
							:cell-id="cell.id"
							@close="close(row, cell)"
							@click="clickOnCell(row, cell, $event)"
							@click.ctrl="goto($event, row, cell)"
							@click.meta="goto($event, row, cell)"
							@click.alt.prevent="pasteArisStyling($event, cell)"
							@contextmenu.prevent.alt="copyArisStyling($event, cell)"
							@click.native="clickOnCell(row, cell, $event)"
							@click.ctrl.native="goto($event, row, cell)"
							@click.meta.native="goto($event, row, cell)"
							@click.alt.prevent.native="pasteArisStyling($event, cell)"
							@contextmenu.prevent.alt.native="copyArisStyling($event, cell)"
							@contextmenu.prevent.ctrl="goto($event, row, cell, 'layout')"
							@contextmenu.prevent.ctrl.native="goto($event, row, cell, 'layout')"
							@mouseout="mouseOut($event, row, cell)"
							@mouseout.native="mouseOut($event, row, cell)"
							@mouseover="mouseOver($event, row, cell)"
							@mouseover.native="mouseOver($event, row, cell)"
							@dragend="$services.page.clearDrag($event)"
							@dragover="dragOverCell($event, row, cell)"
							@dragexit="dragExitCell($event, row, cell)"
							@drop="dropCell($event, row, cell)"
							:href="targetHref(cell)"
							:target="cell"
							:edit="edit"
							:page="page"
							:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
							:parameters="getRendererParameters(cell)"
							:anchor="cell.customId ? cell.customId : null"
							v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: !cell.rows.length ? getParameters(row, cell) : {}, mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"
							:slot="cell.rendererSlot"
							>
						
						<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" @keyup.esc="close(cell)" :key="'page_' + pageInstanceId + '_rendered_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"></div>
						<n-page-row v-for="childRow in cell.rows"
							:row="childRow"
							:page="page" 
							:edit="edit"
							:depth="depth + 1"
							:parameters="parameters"
							:ref="page.name + '_' + cell.id + '_rows'"
							:local-state="getLocalState(childRow, cell)"
							:page-instance-id="pageInstanceId"
							:stop-rerender="stopRerender"
							v-bubble:viewComponents
							v-bubble:select
							@update="updateEvent"
							@close="close(row, cell, childRow)"
							:slot="childRow.rendererSlot"
							@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
							
						<div locked="true" class="is-column-menu is-layout is-align-main-center is-spacing-vertical-xsmall" @mouseenter="menuHover" @mouseleave="menuUnhover" v-if="true">
							<div v-if="isNoActiveView()">
								<button v-if="cell.alias" class="is-button is-variant-secondary is-size-xsmall has-tooltip is-wrap-none" @click="goto($event, row, cell)"><icon name="cog"/><span class="is-text">{{ cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : "Cell" }}</span></button>
								<button v-else class="is-button is-variant-secondary is-size-xsmall has-tooltip is-wrap-none" @click="goto($event, row, cell)"><icon name="magic"/><span class="is-text">{{ cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : "Cell" }}</span></button>
								<span class="is-badge is-color-danger" v-if="cell.condition">On condition</span>
								<span class="is-badge is-color-warning" v-if="cell.on">On event</span>
								<span class="is-badge is-color-neutral" v-if="cell.state.hideMode == 'toggle'">On toggle</span>
							</div>
							<div v-else-if="isActiveView('conditions')">
								<span class="is-badge is-color-danger" v-if="cell.condition">{{cell.condition}}</span>
								<span class="is-badge is-color-warning" v-if="cell.on">{{cell.on}}</span>
								<span class="is-badge is-color-neutral" v-if="cell.state.hideMode == 'toggle'">On toggle</span>
							</div>
							<div v-else-if="isActiveView('styling')">
								<div v-for="component in $services.page.getCellComponents(page, cell)" v-if="$services.aris.listActive(cell.aris, component).length">
									<span class="is-badge is-color-secondary">{{component.name}}</span><span v-for="option in $services.aris.listActive(cell.aris, component)" class="is-badge is-color-neutral"><span class="is-content is-variant-subscript">{{option.dimension}}</span><b>{{option.name}}</b><span v-if="option.condition" class="is-content is-color-danger-outline"> {{option.condition}}</span></span>
								</div>
							</div>
						</div>
					</component>
				</n-absolute>
			</template>
			<template v-else-if="shouldRenderCell(row, cell)">
				<n-sidebar v-if="cell.target == 'sidebar'" @close="close(row, cell)" :popout="false" :autocloseable="!cell.preventAutoClose" class="content-sidebar" :style="getSideBarStyles(cell)">
					<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
							:draggable="isDraggable(cell)"
							@update="updateEvent"
							v-show="!edit || !row.collapsed"
							:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
							:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
							:key="cellId(cell)"
							:cell-id="cell.id"
							@close="close(row, cell)"
							@click="clickOnCell(row, cell, $event)"
							@mouseover.native="mouseOver($event, row, cell)"
							@mouseout.native="mouseOut($event, row, cell)"
							@click.native="clickOnCell(row, cell, $event)"
							@click.ctrl="goto($event, row, cell)"
							@click.meta="goto($event, row, cell)"
							@mouseout="mouseOut($event, row, cell)"
							@mouseover="mouseOver($event, row, cell)"
							@dragend="$services.page.clearDrag($event)"
							@dragover="dragOverCell($event, row, cell)"
							@dragexit="dragExitCell($event, row, cell)"
							@drop="dropCell($event, row, cell)"
							:href="targetHref(cell)"
							:target="cell"
							:edit="edit"
							:page="page"
							:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
							:parameters="getRendererParameters(cell)"
							:anchor="cell.customId ? cell.customId : null"
							v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: !cell.rows.length ? getParameters(row, cell) : {}, mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"
							:slot="cell.rendererSlot"
							>

						<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" @keyup.esc="close(cell)" :key="'page_' + pageInstanceId + '_rendered_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"></div>
						
						<n-page-row v-for="childRow in cell.rows"
							:row="childRow"
							:page="page" 
							:edit="edit"
							:depth="depth + 1"
							:parameters="parameters"
							:ref="page.name + '_' + cell.id + '_rows'"
							:local-state="getLocalState(childRow, cell)"
							:page-instance-id="pageInstanceId"
							:stop-rerender="stopRerender"
							v-bubble:viewComponents
							v-bubble:select
							@update="updateEvent"
							@close="close(row, cell, childRow)"
							:slot="childRow.rendererSlot"
							@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
					</component>
				</n-sidebar>
				<n-prompt v-else-if="cell.target == 'prompt'" @close="close(row, cell)" :autoclose="cell.autoclose">
					<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
							:draggable="isDraggable(cell)"
							@update="updateEvent"
							v-show="!edit || !row.collapsed"
							:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
							:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
							:key="cellId(cell)"
							:cell-id="cell.id"
							@close="close(row, cell)"
							@click="clickOnCell(row, cell, $event)"
							@mouseover.native="mouseOver($event, row, cell)"
							@mouseout.native="mouseOut($event, row, cell)"
							@click.native="clickOnCell(row, cell, $event)"
							@click.ctrl="goto($event, row, cell)"
							@click.meta="goto($event, row, cell)"
							@mouseout="mouseOut($event, row, cell)"
							@mouseover="mouseOver($event, row, cell)"
							@dragend="$services.page.clearDrag($event)"
							@dragover="dragOverCell($event, row, cell)"
							@dragexit="dragExitCell($event, row, cell)"
							@drop="dropCell($event, row, cell)"
							:href="targetHref(cell)"
							:target="cell"
							:edit="edit"
							:page="page"
							:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
							:parameters="getRendererParameters(cell)"
							:anchor="cell.customId ? cell.customId : null"
							v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: !cell.rows.length ? getParameters(row, cell) : {}, mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"
							:slot="cell.rendererSlot"
							>
						
						<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" @keyup.esc="close(cell)" :key="'page_' + pageInstanceId + '_rendered_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"></div>
						<n-page-row v-for="childRow in cell.rows"
							:row="childRow"
							:page="page" 
							:edit="edit"
							:depth="depth + 1"
							:parameters="parameters"
							:ref="page.name + '_' + cell.id + '_rows'"
							:local-state="getLocalState(childRow, cell)"
							:page-instance-id="pageInstanceId"
							:stop-rerender="stopRerender"
							v-bubble:viewComponents
							v-bubble:select
							@update="updateEvent"
							@close="close(row, cell, childRow)"
							:slot="childRow.rendererSlot"
							@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
					</component>
				</n-prompt>
				<n-absolute :fixed="cell.fixed" :style="{'min-width': cell.minWidth}" :autoclose="cell.autocloseable" v-else-if="cell.target == 'absolute'" @close="close(row, cell)" :top="cell.top" :bottom="cell.bottom" :left="cell.left" :right="cell.right" :snap-point="cell.snapPoint">          
					<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
							:draggable="isDraggable(cell)"
							@update="updateEvent"
							v-show="!edit || !row.collapsed"
							:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
							:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
							:key="cellId(cell)"
							:cell-id="cell.id"
							@close="close(row, cell)"
							@click="clickOnCell(row, cell, $event)"
							@mouseover.native="mouseOver($event, row, cell)"
							@mouseout.native="mouseOut($event, row, cell)"
							@click.native="clickOnCell(row, cell, $event)"
							@click.ctrl="goto($event, row, cell)"
							@click.meta="goto($event, row, cell)"
							@mouseout="mouseOut($event, row, cell)"
							@mouseover="mouseOver($event, row, cell)"
							@dragend="$services.page.clearDrag($event)"
							@dragover="dragOverCell($event, row, cell)"
							@dragexit="dragExitCell($event, row, cell)"
							@drop="dropCell($event, row, cell)"
							:href="targetHref(cell)"
							:target="cell"
							:edit="edit"
							:page="page"
							:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
							:parameters="getRendererParameters(cell)"
							:anchor="cell.customId ? cell.customId : null"
							v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: !cell.rows.length ? getParameters(row, cell) : {}, mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"
							:slot="cell.rendererSlot"
							>
						
						<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" @keyup.esc="close(cell)" :key="'page_' + pageInstanceId + '_rendered_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"></div>
						<n-page-row v-for="childRow in cell.rows"
							:row="childRow"
							:page="page" 
							:edit="edit"
							:depth="depth + 1"
							:parameters="parameters"
							:ref="page.name + '_' + cell.id + '_rows'"
							:local-state="getLocalState(childRow, cell)"
							:page-instance-id="pageInstanceId"
							:stop-rerender="stopRerender"
							v-bubble:viewComponents
							v-bubble:select
							@update="updateEvent"
							@close="close(row, cell, childRow)"
							:slot="childRow.rendererSlot"
							@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
					</component>
				</n-absolute>
				<template v-else>
					<component :is="cellTagFor(row, cell)" :style="getStyles(cell)" 
							:draggable="isDraggable(cell)"
							@update="updateEvent"
							v-show="!isContentHidden(cell)"
							:id="cell.customId && !cell.alias ? cell.customId : page.name + '_' + row.id + '_' + cell.id"  
							:class="$window.nabu.utils.arrays.merge([{'clickable': hasCellClickEvent(cell)}, cell.class ? $services.page.interpret(cell.class, $self) : null, {'has-page': hasPageRoute(cell), 'is-root': root}, {'empty': edit && !cell.alias && (!cell.rows || !cell.rows.length) } ], cellClasses(cell))" 
							:key="cellId(cell)"
							:cell-id="cell.id"
							@close="close(row, cell)"
							@click="clickOnCell(row, cell, $event)"
							@mouseover.native="mouseOver($event, row, cell)"
							@mouseout.native="mouseOut($event, row, cell)"
							@click.native="clickOnCell(row, cell, $event)"
							@click.ctrl="goto($event, row, cell)"
							@click.meta="goto($event, row, cell)"
							@mouseout="mouseOut($event, row, cell)"
							@mouseover="mouseOver($event, row, cell)"
							@dragend="$services.page.clearDrag($event)"
							@dragover="dragOverCell($event, row, cell)"
							@dragexit="dragExitCell($event, row, cell)"
							@drop="dropCell($event, row, cell)"
							:href="targetHref(cell)"
							v-auto-close="$services.page.isCloseable(cell) && cell.autocloseable ? function() { autocloseCell(null, cell) } : null"
							:target="cell"
							:edit="edit"
							:page="page"
							:child-components="$services.page.calculateArisComponents(cell.aris, cell.renderer, $self)"
							:parameters="getRendererParameters(cell)"
							:anchor="cell.customId ? cell.customId : null"
							v-route-render.embedded="{ alias: !cell.rows.length && !cell.renderer ? cell.alias : null, parameters: !cell.rows.length ? getParameters(row, cell) : {}, mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"
							:slot="cell.rendererSlot"
							>
						
						<div class="is-column-content" v-if="cell.alias && (cell.renderer || cell.rows.length)" @click="clickOnContentCell(row, cell)" @keyup.esc="close(cell)" :key="'page_' + pageInstanceId + '_rendered_' + cell.id" v-route-render.embedded="{ alias: cell.alias, parameters: getParameters(row, cell), mounted: getMountedFor(cell, row), rerender: function() { return !stopRerender && !cell.stopRerender }, created: getCreatedComponent(row, cell) }"></div>
						<n-page-row v-for="childRow in cell.rows"
							:row="childRow"
							:page="page" 
							:edit="edit"
							:depth="depth + 1"
							:parameters="parameters"
							:ref="page.name + '_' + cell.id + '_rows'"
							:local-state="getLocalState(childRow, cell)"
							:page-instance-id="pageInstanceId"
							:stop-rerender="stopRerender"
							v-bubble:viewComponents
							v-bubble:select
							@update="updateEvent"
							@close="close(row, cell, childRow)"
							:slot="childRow.rendererSlot"
							@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
					</component>
				</template>
			</template>
		</template>
	</component>
</script>


<script type='x/templates' id="page-rows">
	<component :is="rowsTag()" class="is-grid">
		<n-page-row v-for="row in rows" :row="row" :page="page" :edit="edit" :parameters="parameters" :root="root" :stop-rerender="stopRerender" :depth="depth" @update="updateEvent"/>
	</component>
</script>

<script type='x/templates' id="n-prompt">
	<div class="is-modal">
		<div class="is-modal-content" v-auto-close="function() { if (autoclose) $emit('close') }">
			<slot></slot>
		</div>
	</div>
</script>

<script type='x/templates' id="n-absolute">
	<div class="n-absolute" :style="getStyles()" v-auto-close="function() { if (autoclose) $emit('close') }">
		<div class="n-absolute-content">
			<slot></slot>
		</div>
	</div>
</script>

<script type='x/templates' id="aris-editor">
	<div class="aris-editor">
		<div class="is-column is-spacing-medium">
			<n-form-text v-model="search" :timeout="600" placeholder="Search styling options"/>
			<n-form-switch v-if="$services.page.theme" label="Restrict to theme" v-model="$services.page.restrictToTheme"/>
		</div>
		<n-collapsible v-for="childComponent in childComponents" :only-one-open="true" class="is-highlight-left is-color-primary-lighter" :title="childComponent.title" :after="childComponent.component + getFormattedAmountOfAppliedOptions(childComponent)" ref="collapsibles">
			<ul class="is-menu is-variant-toolbar is-align-end is-spacing-horizontal-right-small" slot="buttons">
				<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall has-tooltip" @click="saveAsDefaultAris(childComponent)"><icon name="save"/><span class="is-tooltip is-position-left">Save as default</span></button></li>
				<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall has-tooltip" @click="clearOptions(childComponent)"><icon name="undo"/><span class="is-tooltip is-position-left">Clear settings</span></button></li>
			</ul>
			<div class="is-column is-spacing-medium">
				<n-form-combo v-model="container.components[childComponent.name].variant" label="Variant" :filter="getAvailableVariantNames.bind($self, childComponent)" after="Choose the main variant of this component"
					:placeholder="childComponent.defaultVariant ? childComponent.defaultVariant : childComponent.name"
					empty-value="No variants available"
					@input="container.components[childComponent.name].modifiers.splice(0)"/>
			</div>
			<n-collapsible v-if="getAvailableModifierNames(childComponent).length > 0" title="modifier" class="is-highlight-left is-color-secondary-lighter" 
					content-class="is-spacing-medium is-spacing-vertical-gap-xsmall is-color-background"
					:after="listActiveModifiers(childComponent)"
					@show="conditioning = null">
				<div class="is-row" v-for="(modifier, index) in getAvailableModifierNames(childComponent)">
					<n-form-checkbox v-if="conditioning != modifier" :value="isActiveModifier(childComponent, modifier)" :label="modifier"
						@input="function() { toggleModifier(childComponent, modifier) }"
						class="is-spacing-vertical-none"/>
					<n-form-text v-model="container.components[childComponent.name].conditions[modifier]" v-else class="is-size-small is-border-underline" placeholder="Condition"/>
					<div class="is-row is-position-right is-align-cross-end" v-if="isActiveModifier(childComponent, modifier)">
						<ul v-if="conditioning == modifier" class="is-menu is-variant-toolbar">
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="conditioning = null">Save</button></li>
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="container.components[childComponent.name].conditions[modifier] = null; conditioning = null">Clear</button></li>
						</ul>
						<ul v-else class="is-menu is-variant-toolbar">
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="conditioning = modifier">Set Condition</button></li>
							<li class="is-column" v-if="hasCondition(childComponent, modifier)"><button class="is-button is-size-xsmall is-variant-danger-outline has-tooltip" @click="container.components[childComponent.name].conditions[modifier] = null">Clear Condition</button></li>
						</ul>
					</div>
				</div>
			</n-collapsible>
			<n-collapsible v-for="dimension in getAvailableDimensions(childComponent)" :only-one-open="true" :title="dimension.name" class="is-highlight-left is-color-secondary-lighter" 
					v-if="hasAnySearchHits(dimension)"
					content-class="is-spacing-medium is-spacing-vertical-gap-none is-color-background"
					:after="listActiveOptions(childComponent, dimension)"
					@show="conditioning = null">
				<ul class="is-menu is-variant-toolbar is-align-end is-spacing-horizontal-right-small" slot="buttons" v-show="listActiveOptions(childComponent, dimension)">
					<li class="is-column"><button class="is-button is-variant-secondary-outline is-size-xsmall has-tooltip" @click="clearDimension(childComponent, dimension.name)"><icon name="undo"/><span class="is-tooltip is-position-left">Clear dimension</span></button></li>
				</ul>
				<div class="is-row" v-for="option in dimension.options" v-if="hasAnySearchHits(dimension, option)">
					<n-form-checkbox v-if="conditioning != dimension.name + '_' + option.name" :value="isActiveOption(childComponent, dimension, option.name)" @input="function() { toggleOption(childComponent, dimension, option.name) }"
						:label="prettifyOption(option.name)" :info="formatBody(option.body)"/>
					<n-form-text v-model="container.components[childComponent.name].conditions[dimension.name + '_' + option.name]" v-else class="is-size-small is-border-underline" placeholder="Condition"/>
					<div class="is-row is-position-right is-align-cross-end" v-if="isActiveOption(childComponent, dimension, option.name)">
						<ul v-if="conditioning == dimension.name + '_' + option.name" class="is-menu is-variant-toolbar">
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="conditioning = null">Save</button></li>
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="container.components[childComponent.name].conditions[dimension.name + '_' + option.name] = null; conditioning = null">Clear</button></li>
						</ul>
						<ul v-else class="is-menu is-variant-toolbar">
							<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="conditioning = dimension.name + '_' + option.name">Set Condition</button></li>
							<li class="is-column" v-if="hasCondition(childComponent, dimension.name + '_' + option.name)"><button class="is-button is-size-xsmall is-variant-danger-outline has-tooltip" @click="container.components[childComponent.name].conditions[dimension.name + '_' + option.name] = null">Clear Condition</button></li>
						</ul>
					</div>
				</div>
			</n-collapsible>
		</n-collapsible>
	</div>
</script>
<script type='x/templates' id="page-sidemenu">
	<div class="is-column is-pattern-basic-alternating">
		<div v-for="row in rows" class="is-column is-spacing-small is-spacing-horizontal-right-none is-spacing-vertical-gap-small" :class="{'is-selected': selected && selected.id == row.id}">
			<div class="is-row" :class="{'is-color-primary-outline':row.renderer}" :id="'layout-entry-' + row.id" :key="'layout-entry-' + row.id">
				<div @mouseout="mouseOut($event, row)"
						@dragover="acceptDragRow($event, row)"
						@dragend="$services.page.clearDrag($event)"
						@drop="dropRow($event, row)"
						@mouseover="mouseOver($event, row)" 
						@keydown.f2.prevent="function() { editing = null; aliasing = row.id; requestFocus() }"
						@keydown.delete.prevent="$emit('removeRow', row)"
						@keydown.c.ctrl.prevent="copyRow(row)"
						@keydown.c.meta.prevent="copyRow(row)"
						@keydown.v.ctrl.prevent="pasteCell(row)"
						@keydown.v.meta.prevent="pasteCell(row)"
						@keydown.up.ctrl.prevent="up(row)"
						@keydown.down.ctrl.prevent="down(row)"
						class="is-row is-fill-normal"
						tabindex="-10"
						@contextmenu="showMenu(row, null, $event)"
						>
					<button class="is-button is-variant-ghost is-size-xsmall" @click="toggleRow(row)"><icon :name="opened.indexOf(row.id) >= 0 ? 'chevron-down' : 'chevron-right'"/></button>
					<n-form-text v-if="aliasing == row.id" v-model="row.name" class="is-variant-inline is-size-xsmall" :placeholder="row.name ? row.name : ($services.page.getRenderer(row.renderer) ? $services.page.getRenderer(row.renderer).title : (row.class ? row.class : row.id))" :autofocus="true"
						:commit="true"
						@keydown.delete="function(e) { e.stopPropagation() }"
						@commit="function() { aliasing = null }"
						@keydown.escape="function() { aliasing = null }"/>
					<span class="is-content is-size-xsmall is-fill-normal is-position-cross-center" @click="selectRow(row)" 
						@dragstart="dragRow($event, row)"
						:draggable="true" 
						v-else
						@click.ctrl="scrollIntoView(row)">{{formatPageItem(row)}}</span>
						
					<div v-if="showMenuItem == row" class="contextmenu is-column" v-auto-close="closeMenu" :style="'left:' + offsetX + 'px;top:' + offsetY + 'px'">
						<button class="is-button is-variant-ghost is-size-small" @click="copyRow(row)" :auto-close="true"><icon name="copy"/><span class="is-text">Copy</span><shortkey :ctrl="true">C</shortkey></button>
						<button :disabled="!$services.page.copiedCell" class="is-button is-variant-ghost is-size-small" @click="pasteCell(row)" :auto-close="true"><icon name="paste"/><span class="is-text">Paste</span><shortkey :ctrl="true">V</shortkey></button>
						<button class="is-button is-variant-ghost is-size-small" @click="up(row)" :auto-close="true"><icon name="chevron-circle-up"/><span class="is-text">Up</span><shortkey :ctrl="true">UP</shortkey></button>
						<button class="is-button is-variant-ghost is-size-small" @click="down(row)" :auto-close="true"><icon name="chevron-circle-down"/><span class="is-text">Down</span><shortkey :ctrl="true">DOWN</shortkey></button>
						<button class="is-button is-variant-ghost is-size-small" @click="row.collapsed = !row.collapsed" :auto-close="true"><icon name="paste"/><span class="is-text">{{ row.collapsed ? "Show" : "Hide" }}</span></button>
						<button class="is-button is-variant-ghost is-size-small" @click="$emit('removeRow', row)" :auto-close="true"><icon name="times"/><span class="is-text">Delete</span><shortkey>DEL</shortkey></button>
						<button class="is-button is-variant-ghost is-size-small" @click="function() { editing = null; aliasing = row.id; requestFocus() }" :auto-close="true"><icon name="pencil-alt"/><span class="is-text">Rename</span><shortkey>F2</shortkey></button>
					</div>
				</div>
				<ul class="is-menu is-variant-toolbar is-position-right is-spacing-horizontal-right-small">
					<li class="is-column" v-if="$services.page.useAris"><button class="is-button is-variant-warning-outline is-size-xsmall has-tooltip" @click="rotate(row)"><icon name="undo"/><span class="is-tooltip is-position-bottom-reverse">Rotate row</span></button></li>
					<li class="is-column"><button class="is-button is-size-xsmall is-color-primary-outline has-tooltip" @click="addCell(row)"><icon name="plus"/><span class="is-tooltip is-position-bottom-reverse">Add cell</span></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="up(row)"><icon name="chevron-circle-up"/></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-variant-secondary-outline is-size-xsmall" @click="down(row)"><icon name="chevron-circle-down"/></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-size-xsmall is-color-primary-outline has-tooltip" @click="row.collapsed = !row.collapsed"><icon :name="row.collapsed ? 'eye-slash': 'eye'"/><span class="is-tooltip is-position-bottom">{{ row.collapsed ? "Show" : "Hide" }}</span></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-size-xsmall is-color-primary-outline has-tooltip" @click="copyRow(row)"><icon name="copy"/><span class="is-tooltip is-position-left">Copy row</span></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-variant-warning has-tooltip is-size-xsmall" v-if="$services.page.copiedCell" @click="pasteCell(row)"><icon name="paste"/><span class="is-tooltip is-position-left">Paste Cell</span></button></li>
					<li class="is-column" v-if="false"><button class="is-button is-size-xsmall is-color-danger-outline" @click="$emit('removeRow', row)"><icon name="times"/></button></li>
				</ul>
			</div>
			<div v-show="row.cells && row.cells.length && opened.indexOf(row.id) >= 0" class="is-column is-pattern-basic-alternating">
				<div v-for="cell in row.cells" class="is-column is-spacing-small is-sidemenu-cell is-spacing-horizontal-right-none" :class="{'is-selected': selected && selected.id == cell.id}">
					<div class="is-row" :class="{'is-color-primary-outline':cell.renderer}" :id="'layout-entry-' + cell.id">
						<div @mouseout="mouseOut($event, row, cell)" 
								:key="'sidemenu-' + row.id + '_' + cell.id"
								@dragend="$services.page.clearDrag($event)"
								@dragover="acceptDragCell($event, row, cell)"
								@drop="dropCell($event, row, cell)"
								@mouseover="mouseOver($event, row, cell)"
								class="is-row is-fill-normal is-spacing-horizontal-gap-small is-no-outline"
								@click.ctrl="scrollIntoView(row, cell)"
								@click="selectCell(row, cell)"
								@dragstart="dragCell($event, row, cell)"
								:draggable="true"
								@keydown.f2.prevent="function() { aliasing = null; editing = cell.id; requestFocus() }"
								@keydown.f3.prevent="function() { editing = null; aliasing = cell.id; requestFocus() }"
								@keydown.esc.prevent="function() { editing = null; aliasing = null }"
								@keydown.ctrl.up="left(row, cell)"
								@keydown.ctrl.down="right(row, cell)"
								@keydown.delete.prevent="removeCell(row.cells, cell)"
								@keydown.c.ctrl.prevent="copyCell(cell)"
								@keydown.c.meta.prevent="copyCell(cell)"
								@keydown.v.ctrl.prevent="pasteRow(cell)"
								@keydown.v.meta.prevent="pasteRow(cell)"
								@contextmenu="showMenu(row, cell, $event)"
								:ref="'cell_' + cell.id"
								tabindex="-10">
							<icon name="cube" class="is-size-xsmall is-position-cross-center" @click.native="function() { editing = null; aliasing = aliasing == cell.id ? null : cell.id }" v-if="false"/>
							<icon :name="getCellIcon(cell)" class="is-size-xsmall is-position-cross-center" />
							<n-form-text v-if="editing == cell.id" v-model="cell.name" class="is-variant-inline is-size-xsmall" :placeholder="cell.alias ? $services.page.prettifyRouteAlias(cell.alias) : cell.id" :autofocus="true"
								ref="editor"
								:commit="true"
								@keydown.delete="function(e) { e.stopPropagation() }"
								@commit="function() { editing = null; requestFocusCell(cell) }"
								@keydown.escape="function() { editing = null; requestFocusCell(cell) }"/>
							<n-form-combo v-if="aliasing == cell.id" class="is-variant-inline is-size-xsmall is-fill-normal is-spacing-horizontal-right-medium" :filter="$services.page.getNamedRoutes" v-model="cell.alias"
								ref="aliaser"
								:extracter="function(x) { return x.alias }"
								:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }"
								:key="'page_' + pageInstanceId + '_' + cell.id + '_alias'" 
								@keydown.escape="function() { aliasing = null; requestFocusCell(cell) }" 
								@input="$services.page.slowNormalizeAris(page, cell)"/>
							<span v-if="editing != cell.id && aliasing != cell.id" class="is-content is-size-xsmall is-position-cross-center" @click="selectCell(row, cell)" 
								>{{formatPageItem(cell)}}</span>
							<button class="is-button is-size-xxsmall is-variant-ghost is-position-cross-center" @click="function() { aliasing = null; editing = cell.id }" v-if="false && aliasing != cell.id && editing != cell.id"><icon name="pencil-alt"/></button>
						</div>
						<ul class="is-menu is-variant-toolbar is-position-right is-spacing-horizontal-right-small">
							<li class="is-column"><button class="is-button is-variant-warning-outline is-size-xsmall has-tooltip" @click="wrapCell(row, cell)"><icon name="chevron-circle-right"/><span class="is-tooltip is-position-bottom-reverse">Wrap cell</span></button></li>
							<li class="is-column"><button class="is-button is-color-primary-outline is-size-xsmall has-tooltip" @click="addRow(cell)" :disabled="cell.alias"><icon name="plus"/><span class="is-tooltip is-position-bottom-reverse">Add Row</span></button></li>
							<li v-if="false" class="is-column"><button class="is-button is-color-secondary-outline is-size-xsmall has-tooltip" @click="left(row, cell)" v-if="row.cells.length >= 2"><icon name="chevron-circle-up"/></button></li>
							<li v-if="false" class="is-column"><button class="is-button is-color-secondary-outline is-size-xsmall has-tooltip" @click="right(row, cell)" v-if="row.cells.length >= 2"><icon name="chevron-circle-down"/></button></li>
							<li v-if="false" class="is-column"><button class="is-button is-color-primary-outline is-size-xsmall has-tooltip" @click="copyCell(cell)"><icon name="copy"/><span class="is-tooltip">Copy Cell</span></button></li>
							<li v-if="false" class="is-column"><button class="is-button is-color-warning is-size-xsmall has-tooltip" @click="pasteRow(cell)" v-if="$services.page.copiedRow"><icon name="paste"/><span class="is-tooltip">Paste Row</span></button></li>
							<li v-if="false" class="is-column"><button class="is-button is-color-danger-outline is-size-xsmall" @click="removeCell(row.cells, cell)"><icon name="times"/></button></li>
						</ul>
						<div v-if="showMenuItem == cell" class="contextmenu is-column" v-auto-close="closeMenu" :style="'left:' + offsetX + 'px;top:' + offsetY + 'px'">
							<button class="is-button is-variant-ghost is-size-small" @click="copyCell(cell)" :auto-close="true"><icon name="copy"/><span class="is-text">Copy</span><shortkey :ctrl="true">C</shortkey></button>
							<button :disabled="!$services.page.copiedRow" class="is-button is-variant-ghost is-size-small" @click="pasteRow(cell)" :auto-close="true"><icon name="paste"/><span class="is-text">Paste</span><shortkey :ctrl="true">V</shortkey></button>
							<button class="is-button is-variant-ghost is-size-small" @click="left(row, cell)" :auto-close="true"><icon name="chevron-circle-up"/><span class="is-text">Up</span><shortkey :ctrl="true">UP</shortkey></button>
							<button class="is-button is-variant-ghost is-size-small" @click="right(row, cell)" :auto-close="true"><icon name="chevron-circle-down"/><span class="is-text">Down</span><shortkey :ctrl="true">DOWN</shortkey></button>
							<button class="is-button is-variant-ghost is-size-small" @click="removeCell(row.cells, cell)" :auto-close="true"><icon name="times"/><span class="is-text">Delete</span><shortkey>DEL</shortkey></button>
							<button class="is-button is-variant-ghost is-size-small" @click="function() { aliasing = null; editing = cell.id; requestFocus() }" :auto-close="true"><icon name="pencil-alt"/><span class="is-text">Rename</span><shortkey>F2</shortkey></button>
							<button class="is-button is-variant-ghost is-size-small" @click="function() { editing = null; aliasing = cell.id; requestFocus() }" :auto-close="true"><icon name="cubes"/><span class="is-text">Component</span><shortkey>F3</shortkey></button>
						
						</div>
					</div>
					<page-sidemenu v-show="cell.rows && cell.rows.length" :rows="cell.rows" :page="page" v-bubble:select :selected="selected"
						@open="function() { if (opened.indexOf(row) < 0) opened.push(row.id) }"
						v-bubble:open
						@removeRow="function(row) { $confirm({message:'Are you sure you want to remove this row?'}).then(function() { cell.rows.splice(cell.rows.indexOf(row), 1) }) }"/>
				</div>
			</div>
		</div>
	</div>
</script>

<script type='x/templates' id="renderer-bindings">
	<n-collapsible :title="'Data Binding'" class="is-color-primary-light" content-class="is-spacing-medium">
		<n-page-mapper :to="fields"
			:from="$services.page.getAvailableParameters(page, null, true)"
			v-model="target.rendererBindings"/>
		<div class="is-row is-align-end" v-if="target.renderer == 'form'">
			<n-form-combo class="is-size-small" :filter="$services.page.getAllAvailableKeys.bind($self, page, true)" v-model="automapFrom"/>
			<button @click="automap" class="is-button is-variant-primary-outline is-size-xsmall"><icon name="link"/><span class="is-text">Automap</span></button>
		</div>
	</n-collapsible>
</script>

<script type='x/templates' id="template-manager">
	<div>
		<div v-if="target.templateReferenceId">
			<p class="is-p is-spacing-horizontal-gap-small" v-if="target.templateVersion"><span class="is-text">This is an instance of template "{{target.templateTitle}}"</span><span class="is-badge is-variant-primary-outline is-size-xsmall">v{{target.templateVersion}}</span></p>
			<p class="is-p is-spacing-horizontal-gap-small" v-else><span class="is-text">This is part of a template instance</span><span class="is-badge is-variant-primary-outline is-size-xsmall" v-if="target.templateVersion">v{{target.templateVersion}}</span></p>
			<div v-if="target.templateVersion && latestAvailableVersion != null && target.templateVersion != latestAvailableVersion" class="is-column is-spacing-vertical-medium">
				<p class="is-p">A new version is available.</p>
				<div class="is-row is-align-end">
					<button class="is-button is-variant-primary-outline is-size-xsmall" @click="updateToLatest">Update to v{{latestAvailableVersion}}</button>
				</div>
			</div>
		</div>
		<div v-else-if="partOfTemplate">
			<p class="is-p" v-if="excluded">
				This is part of a template definition exclusion.
			</p>
			<div v-else class="is-column is-spacing-vertical-gap-medium">
				<p class="is-p">This is part of a template definition.</p>
				<n-form-switch label="Exclude from template" v-model="target.excludeFromTemplate" after="You can choose to not include this part into the template"/>
			</div>
		</div>
		<div v-else class="is-column is-spacing-vertical-medium">
			<n-form-switch label="Make template" v-model="target.isTemplate"/>
			<div v-if="target.isTemplate" class="is-column is-spacing-vertical-gap-medium">
				<n-form-text label="Template title" v-model="target.templateTitle" after="Keep the title short"/>
				<n-form-text label="Template category" v-model="target.templateCategory" after="The template category this belongs in"/>
				<n-form-text label="Template icon" v-model="target.templateIcon" />
				<n-form-text label="Template description" type="area" v-model="target.templateDescription"/>
				
				<p class="is-p">Current release: {{target.templateVersion ? target.templateVersion : "unreleased"}}</p>
				<div class="is-row is-align-end is-spacing-vertical-medium">
					<button class="is-button is-variant-primary-outline is-size-xsmall" @click="release">Create release</button>
				</div>
			</div>
		</div>
	</div>
</script>

<script type='x/templates' id="page-fields-edit">
	<div>
		<div class="list-actions" v-if="allowMultiple">
			<n-form-combo :filter="getKeys" v-model="addAllSelector" label="Add all"/>
		</div>
		<div class="list-actions" v-if="allowMultiple">
			<button @click="addAll" v-if="addAllSelector"><span class="fa fa-plus"></span>All</button>
			<button @click="addField(false)"><span class="fa fa-plus"></span>Field</button>
			<button @click="addField(true)"><span class="fa fa-plus"></span>Content</button>
		</div>
		<n-collapsible class="list-item dark" :title="field.label ? field.label : 'Unlabeled'" v-for="field in cell.state[fieldsName]" :after="field.arbitrary ? 'content' : 'field'">
			<div slot="buttons">
				<button v-if="allowMultiple" @click="fieldBeginning(field)"><span class="fa fa-chevron-circle-left"></span></button>
				<button v-if="allowMultiple" @click="fieldUp(field)"><span class="fa fa-chevron-circle-up"></span></button>
				<button v-if="allowMultiple" @click="fieldDown(field)"><span class="fa fa-chevron-circle-down"></span></button>
				<button v-if="allowMultiple" @click="fieldEnd(field)"><span class="fa fa-chevron-circle-right"></span></button>
				<button v-if="allowMultiple" @click="cell.state[fieldsName].splice(cell.state[fieldsName].indexOf(field), 1)"><span class="fa fa-trash"></span></button>
			</div>
			<div class="padded-content">
				<n-form-text v-model="field.label" label="Field Label"/>
				<n-form-text v-if="!basic" v-model="field.hidden" label="Hide field if"/>
				<n-form-text v-model="field.info" label="Info Content"/>
				<n-form-text v-model="field.infoIcon" label="Info Icon" v-if="field.info"/>
			</div>
			<div v-if="!field.arbitrary">
				<div class="list-item-actions">
					<button @click="addFragment(field)"><span class="fa fa-plus"></span>Fragment</button>
					<button v-if="$services.page.isCopied('page-field-fragment')" @click="field.fragments.push($services.page.pasteItem('page-field-fragment'))"><span class="fa fa-paste"></span>Paste Fragment</button>
				</div>
				<n-collapsible :title="fragment.key ? fragment.key : fragment.type" v-for="fragment in field.fragments" class="padded">
					<div slot="buttons">
						<button @click="$services.page.copyItem('page-field-fragment', fragment, true)"><span class="fa fa-copy"></span></button>
						<button @click="up(field, fragment)"><span class="fa fa-chevron-circle-up"></span></button>
						<button @click="down(field, fragment)"><span class="fa fa-chevron-circle-down"></span></button>
						<button @click="field.fragments.splice(field.fragments.indexOf(fragment), 1)"><span class="fa fa-trash"></span></button>
					</div>
					<n-form-combo v-model="fragment.type" label="Fragment Type" :items="fragmentTypes"/>
					<n-form-text v-if="!basic" v-model="fragment.hidden" label="Hide fragment if"/>
					<n-form-combo v-if="fragment.type == 'data'" v-model="fragment.key" label="Data Key" :filter="getKeys"/>
					<n-form-text v-if="!basic" v-model="fragment.class" label="Fragment Class"/>
					
					<component v-if="fragment.type" :cell="cell" :page="page" :keys="getKeys()"
						:fragment="fragment"
						:is="getProvidedConfiguration(fragment.type)"/>
						
					<page-event-value v-if="allowEvents" :page="page" :container="fragment" title="Click Event" name="clickEvent" v-bubble:resetEvents :inline="true"/>
				</n-collapsible>
			</div>
			<div v-else>
				<page-configure-arbitrary
					class="padded-content"
					:page="page"
					:cell="cell"
					:target="field"
					:keys="getKeys()"/>
			</div>

			<div class="list-item-actions">
				<button @click="addStyle(field)"><span class="fa fa-plus"></span>Style</button>
			</div>
			<div class="padded-content">
				<n-form-section class="list-row" v-for="style in field.styles">
					<n-form-text v-model="style.class" label="Class"/>
					<n-form-text v-model="style.condition" label="Condition"/>
					<button @click="field.styles.splice(field.styles.indexOf(style), 1)"><span class="fa fa-trash"></span></button>
				</n-form-section>
			</div>
		</n-collapsible>
	</div>
</script>

<script type='x/templates' id="page-formatted-configure">
	<div class="page-formatted-configure is-column is-spacing-vertical-gap-medium">
		<n-form-combo v-model="fragment.format" label="Format as" :items="types"/>
		<n-form-text label="Max Length" v-model="fragment.maxLength" v-if="fragment.format == 'text'"/>
		<n-form-text label="Link label" v-model="fragment.label" v-if="fragment.format == 'link'"/>
		<n-form-switch v-model="fragment.inverse" label="Inverse value" v-if="fragment.format == 'checkbox'"/>
		<n-form-switch v-model="fragment.compile" label="Compile content" v-if="!skipCompile && !mustCompile"/>
		<n-form-switch v-model="fragment.skipSanitize" :invert="true" label="Sanitize" v-if="false || fragment.compile"/>
		<n-form-ace v-if="fragment.format == 'javascript'" mode="javascript" v-model="fragment.javascript"/>
		<n-form-ace v-if="fragment.format == 'html'" mode="html" v-model="fragment.html"/>
		<n-form-text v-if="fragment.format == 'number'" v-model="fragment.amountOfDecimals" label="Amount of decimals"/>
		<n-form-switch v-if="fragment.format == 'number'" v-model="fragment.retainTrailing" label="Retain trailing 0"/>
		<n-form-combo label="Date Format" v-if="fragment.format == 'date'" v-model="fragment.dateFormat" :filter="function(value) { return [value, 'date', 'dateTime', 'yyyy MMM dd', 'yyyy MMM dd HH:mm', 'MMMM dd, yyyy', 'dd/MM/yyyy HH:mm:ss.S'] }"/>
		<n-form-switch label="Is timestamp in milliseconds?" v-model="fragment.isTimestamp" v-if="fragment.format == 'date' && !fragment.isSecondsTimestamp"/>
		<n-form-switch label="Is timestamp in seconds?" v-model="fragment.isSecondsTimestamp" v-if="fragment.format == 'date' && !fragment.isTimestamp"/>
		<n-form-combo label="Type" v-model="fragment.tag" :items="['span', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'div']"/>
		<component v-if="isProvided(fragment.format) && getConfiguration(fragment.format)"
			class="is-column is-spacing-gap-medium"
			:is="getConfiguration(fragment.format)"
			:page="page" 
			:cell="cell"
			:keys="keys"
			:fragment="fragment"/>
	</div>
</script>

<script type='x/templates' id="page-field">
	<div class="page-field" :class="getDynamicClasses(field)" @click="trigger(fieldAction)">
		<template v-if="label">
			<dt v-if="label && field.label">{{$services.page.translate($services.page.interpret(field.label,$self))}}</dt>
			<dd class="page-field-fragment" v-if="!field.arbitrary">
				<component v-if="fragment.type && !isHidden(fragment)" 
					:class="[$services.page.interpret(fragment.class, $self), {'clickable': hasClickEvent(fragment)}]" v-for="fragment in field.fragments"
					:is="getProvidedComponent(fragment.type)"
					:page="page" 
					:cell="cell"
					:data="data"
					:fragment="fragment"
					@click.native="handleClick(fragment)"
					@updated="function(value) { $emit('updated', value) }"/>
			</dd>
			<dd class="page-field-fragment" v-else>
				<page-arbitrary
					:edit="edit"
					:page="page"
					:cell="cell"
					:target="field"
					:component="$self"
					:record="data"/>
			</dd>
			<dd v-if="otherActions.length">
				<button v-if="!action.condition || $services.page.isCondition(action.condition, {record:data}, $self)" 
					class="p-button"
					v-for="action in otherActions" 
					@click="trigger(action)"
					:class="[action.class, {'has-icon': action.icon}, {'inline': !action.class }]"><span class="fa" v-if="action.icon" :class="action.icon"></span><label v-if="action.label">{{$services.page.translate(action.label)}}</label></button>
			</dd>
		</template>
		<template v-else-if="!field.arbitrary">
			<component v-if="!isHidden(fragment)"
				class="page-field-fragment" :class="[$services.page.interpret(fragment.class, $self), {'clickable': hasClickEvent(fragment)}]" v-for="fragment in field.fragments"
				:is="getProvidedComponent(fragment.type)"
				:page="page" 
				:cell="cell"
				:data="data"
				:fragment="fragment"
				@click.native="handleClick(fragment)"
				@updated="function(value) { $emit('updated', value) }"/>
			<span v-if="otherActions.length">
				<button v-if="!action.condition || $services.page.isCondition(action.condition, {record:data}, $self)" 
					class="p-button"
					v-for="action in otherActions" 
					@click="trigger(action)"
					:class="[action.class, {'has-icon': action.icon}, {'inline': !action.class }]"><span class="fa" v-if="action.icon" :class="action.icon"></span><label v-if="action.label">{{$services.page.translate(action.label)}}</label></button>
			</span>
		</template>
		<template v-else>
			<page-arbitrary
				:edit="edit"
				:page="page"
				:cell="cell"
				:target="field"
				:component="$self"
				:record="data"/>
			<span v-if="otherActions.length">
				<button v-if="!action.condition || $services.page.isCondition(action.condition, {record:data}, $self)" 
					class="p-button"
					v-for="action in otherActions" 
					@click="trigger(action)"
					:class="[action.class, {'has-icon': action.icon}, {'inline': !action.class }]"><span class="fa" v-if="action.icon" :class="action.icon"></span><label v-if="action.label">{{$services.page.translate(action.label)}}</label></button>
			</span>
		</template>
	</div>
</script>

<script type='x/templates' id="page-fields-edit-main">
	<div>
		<n-collapsible title="Field Settings" class="padded">
			<n-form-text v-model="cell.state.class" label="Class" v-if="false"/>
			<n-form-combo v-model="cell.state.class" label="Fields Class" 
					:filter="function(value) { return $services.page.classes('page-fields', value) }"/>
			<n-form-switch v-model="cell.state.hideLabel" label="Hide label" v-if="label == null"/>
		</n-collapsible>
		<page-fields-edit :cell="cell" :allow-multiple="true" :page="page" :data="data" :should-style="shouldStyle"/>
	</div>
</script>

<script type='x/templates' id="page-fields">
	<dl class="page-fields" :class="cell.state.class">
		<n-sidebar @close="configuring = false" v-if="configuring" class="settings" :inline="true">
			<n-form class="layout2">
				<n-collapsible title="Field Settings">
					<n-form-text v-model="cell.state.class" label="Class"/>
					<n-form-switch v-model="cell.state.hideLabel" label="Hide label" v-if="label == null"/>
				</n-collapsible>
				<page-fields-edit :cell="cell" :allow-multiple="true" :page="page" :data="data" :should-style="shouldStyle"/>
			</n-form>
		</n-sidebar>
		<page-field v-for="field in cell.state[fieldsName]" :field="field" :data="data ? data : $services.page.getPageInstance(page, $self).variables" :label="label == null ? !cell.state.hideLabel : label"
			v-if="!field.hidden || !$services.page.isCondition(field.hidden, data ? data : $services.page.getPageInstance(page, $self).variables, $self)"
			:edit="edit"
			:page="page"
			:cell="cell"
			:should-style="shouldStyle"
			@updated="function(value) { $emit('updated', value) }"/>
	</dl>
</script>

<script type='x/templates' id="page-fields-table">
	<div class="page-fields page-fields-table" :class="cell.state.class">
		<n-sidebar @close="configuring = false" v-if="configuring" class="settings" :inline="true">
			<n-form class="layout2">
				<n-collapsible title="Field Settings">
					<n-form-text v-model="cell.state.class" label="Class"/>
					<n-form-combo v-model="cell.state.display" label="Display modus" :items="['row', 'column']"/>
					<n-form-switch v-model="cell.state.hideLabel" label="Hide label" v-if="label == null"/>
				</n-collapsible>
				<page-fields-edit :cell="cell" :allow-multiple="true" :page="page" :data="data" :should-style="shouldStyle"/>
			</n-form>
		</n-sidebar>
		
		<table class="classic data table-display-row" cellspacing="0" cellpadding="0" v-if="cell.state.display == 'row'">
			<thead>
				<tr class="top-header">
					<td class="label" v-for="field in cell.state[fieldsName]">
						<span v-if="field.label">{{$services.page.translate($services.page.interpret(field.label,$self))}}</span>
						<span v-else>No label</span>
					</td>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="field" v-for="field in cell.state[fieldsName]">
						<page-field :field="field" :data="data ? data : state" :label="false"
							v-if="!field.hidden || !$services.page.isCondition(field.hidden, data ? data : state, $self)"
							:edit="edit"
							:page="page"
							:cell="cell"
							:should-style="shouldStyle"
							@updated="function(value) { $emit('updated', value) }"/>
					</td>
				</tr>
			</tbody>
		</table>
		
		<table class="classic data table-display-column" cellspacing="0" cellpadding="0" v-if="cell.state.display == 'column'">
			<tr v-for="field in cell.state[fieldsName]">
				<td class="label">
					<span v-if="field.label">{{$services.page.translate($services.page.interpret(field.label,$self))}}</span>
					<span v-else>No label</span>
				</td>
				<td class="field">
					<page-field :field="field" :data="data ? data : state" :label="false"
						v-if="!field.hidden || !$services.page.isCondition(field.hidden, data ? data : state, $self)"
						:edit="edit"
						:page="page"
						:cell="cell"
						:should-style="shouldStyle"
						@updated="function(value) { $emit('updated', value) }"/>
				</td>
			</tr>
		</table>
	</div>
</script><script type='x/templates' id="typography-template">
	<component :is="tag" class="is-content is-typography" :class="['is-' + tag, getChildComponentClasses('typography'), {'has-tooltip': cell.state.tooltip, 'has-icon': cell.state.icon, 'has-text': cell.state.content }]">
		<slot name="before"></slot>
		<img :src="icon.indexOf('http') == 0 ? icon : '/resources/' + icon" v-if="icon && icon.match(/^.*\.[^.]+$/)" class="is-icon"/>
		<icon :name="icon" v-if="icon"/>
		<span :class="getChildComponentClasses('tooltip')" class='is-tooltip' v-if='cell.state.tooltip' v-content.sanitize="$services.page.translate($services.page.interpret(cell.state.tooltip, $self))"></span>
		<span class="is-inline-editor" v-if="false && edit && !cell.state.highlight" :contenteditable="true"
			 @keyup="update" @blur="update" @input="update" ref="editor" v-html-once="cell.state.content ? cell.state.content : null"
			 :placeholder="placeholder ? placeholder : tag + ' placeholder'"></span>
		<n-form-richtext v-model="cell.state.content" :support-blocks="false" v-if="edit && !cell.state.highlight" :placeholder="placeholder ? placeholder : tag + ' placeholder'" :show-menu="$services.page.isActiveView('richtext')"/>
		<n-form-text type="area" v-else-if="edit && cell.state.highlight" v-model="cell.state.content"/>
		<span class="is-text" v-else-if="cell.state.content" 
			v-html="cell.state.highlight ? highlight(getContentWithVariables($services.page.translate($services.page.interpret(cell.state.content, $self)))) : getContentWithVariables($services.page.translate($services.page.interpret(cell.state.content, $self)))"></span>
		<slot name="after"></slot>
	</component>
</script>

<script type='x/templates' id="typography-variable-replacer">
	<div>
		<div v-for="variable in $services.typography.getVariables(content)" class="is-column is-color-body is-spacing-medium">
			<h4 class="is-h4">{{variable}}</h4>
			<n-form-combo v-model="container.fragments[variable].key" :filter="getAllKeys" label="Variable to bind"/>
			<n-form-text v-model="container.fragments[variable].placeholder" label="Placeholder"/>
			<n-form-switch v-model="container.fragments[variable].synchronous" label="Synchronous value" info="Synchronous values are injected raw but must be available at time of replacement"/>
			<page-formatted-configure :page="page" :cell="cell" 
				:fragment="container.fragments[variable]" 
				:allow-html="true"
				:keys="getAllKeys()"/>
		</div>
	</div>
</script>

<script type='x/templates' id="typography-template-configure">
	<div class="typography-template-configure is-column is-spacing-medium">
		<n-form-text v-model="cell.state.icon" label="Icon" v-if="icon"/>
		<n-form-text v-model="cell.state.tooltip" label="Tooltip"/>
		<n-form-ace v-model="cell.state.content" label="Raw content" mode="html"/>
		<n-form-switch v-model="cell.state.highlight" label="Highlight" v-if="highlightable" after="This will perform syntax highlighting, based on the format. If no format is configured, a best effort guess is made"/>
		<n-form-combo v-model="cell.state.highlightFormat" label="Highlight Format" v-if="cell.state.highlight" :items="['code', 'xml', 'markdown']" />
		<typography-variable-replacer :content="cell.state.content" :container="cell.state" :page="page"/>
	</div>
</script>


<script type='x/templates' id="page-actions-configure">
	<div>
		<ul class="is-menu is-variant-toolbar is-align-end is-spacing-medium is-spacing-horizontal-gap-none">
			<li class="is-column" v-if="$services.page.isCopied('page-action')"><button class="is-button is-variant-warning is-size-xsmall" @click="paste"><span class="fa fa-paste"></span></button></li>
			<li class="is-column"><button class="is-button is-variant-primary is-size-xsmall" @click="addAction(false)"><icon name="plus"/>Static</button></li>
			<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall" @click="addAction(true)"><icon name="plus"/>Dynamic</button></li>
			<li class="is-column"><button class="is-button is-variant-primary-outline is-size-xsmall" @click="addContent()"><icon name="plus"/>Content</button></li>
		</ul>
		<n-collapsible :only-one-open="true" title="Generic Settings" v-if="!actions" content-class="is-spacing-medium">
			<n-form-combo v-model="cell.state.class" label="Class" 
				:filter="function(value) { return $services.page.classes('page-actions', value) }"/>
			<n-form-text v-model="cell.state.activeClass" label="Active Class" info="The class that is set on the active action, this defaults to 'is-active'" :timeout="600"/>
			<n-form-text v-model="cell.state.analysisId" label="Analysis Group" info="For analysis purposes we can group all the actions together" :timeout="600" />
			<n-form-combo v-model="cell.state.defaultAction" label="Default Action" info="The default action will be activated upon first creation. You must fill in the name of the action to select it."
				:filter="function() { return cell.state.actions.map(function(x) { return x.name }) }"/>
			<n-form-switch v-model="cell.state.useButtons" label="Use Buttons"/>
			<n-form-switch v-model="cell.state.isFixedHeader" label="Fix as header"/>
			<n-form-switch v-model="cell.state.showOnlyOne" label="Only allow one open" v-if="cell.state.clickBased"/>
			<n-form-switch v-model="cell.state.leaveOpen" label="Leave Open" v-if="cell.state.clickBased"/>
			<n-form-switch v-model="cell.state.autoActions" label="Automatically generate actions for all pages"/>
			<n-form-text v-model="cell.state.clickBased" label="Use Clicks Instead of Hover" info="You can set a condition that will be evaluated"/>
			<n-form-text v-model="cell.state.title" label="Title" after="Add a title to your menu"/>
			<n-form-text v-model="cell.state.logo" label="Logo URL" after="Configure the url for your logo"/>
			<page-event-value :page="page" :container="cell.state" title="Handled Event" name="handledEvent" @resetEvents="resetEvents" :inline="true"/>
		</n-collapsible>
		<n-collapsible :only-one-open="true" :title="action.label ? action.label : action.name" v-for="action in getAllActions()">
			<ul slot="buttons" class="is-menu is-variant-toolbar is-spacing-horizontal-right-medium">
				<li class="is-column"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="up(action)"><icon name="chevron-circle-up"/></button></li>
				<li class="is-column"><button class="is-button is-size-xsmall is-variant-secondary-outline" @click="down(action)"><icon name="chevron-circle-down"/></button></li>
				<li class="is-column"><button class="is-button is-size-xsmall is-variant-primary-outline" @click="$services.page.copyItem('page-action', action)"><icon name="copy"/></button></li>
				<li class="is-column"><button class="is-button is-size-xsmall is-variant-danger-outline" @click="getAllActions().splice(getAllActions().indexOf(action), 1)"><icon name="times"/></button></li>
			</ul>
			
			<div v-if="action.arbitrary" class="is-column is-spacing-medium">
				<page-configure-arbitrary v-if="action.arbitrary" 
					:page="page"
					:cell="cell"
					:target="action"
					:keys="$services.page.getAvailableParameters(page, cell)"/>
			</div>
			<div v-else class="is-column is-spacing-medium">
				<div v-if="action.dynamic" class="is-column is-spacing-vertical-gap-medium">
					<n-form-combo v-model="action.operation" label="Operation" :filter="getActionOperations"/>
					<n-page-mapper :to="getInputParameters(action)" 
						:from="$services.page.getAvailableParameters(page, cell, true)" 
						v-if="action.operation"
						v-model="action.bindings"/>
					<n-form-combo label="Label" v-if="action.operation" v-model="action.label" :filter="getOperationProperties.bind($self, action)"/>
					<n-form-combo label="Icon" v-if="action.operation" v-model="action.icon" :filter="getOperationProperties.bind($self, action)"/>
					<n-form-switch label="Autotrigger" v-model="action.autotrigger"/>
				</div>
				<div class="is-column is-spacing-vertical-gap-medium" v-else>
					<n-form-text v-model="action.label" label="Label" v-if="!action.compileLabel" :timeout="600"/>
					<n-form-ace mode="html" v-model="action.label" label="Label" v-else/>
					<n-form-switch v-model="action.compileLabel" label="Label as html"/>
					<n-form-text v-model="action.icon" label="Icon" :timeout="600"/>
					<n-form-switch v-model="action.iconReverse" label="Reverse icon order" v-if="action.icon"/>
					<n-form-text v-model="action.badge" label="Badge" :timeout="600" info="Use the = syntax to interpret the badge dynamically"/>
				</div>

				<n-form-text v-if="false" v-model="action.id" label="Id" :timeout="600" after="Set an id on this action, can be useful for analytics"/>
				<n-form-text v-model="action.name" label="Name" after="The name is used for analytics purposes, check the console to see how this works" :timeout="600"/>
				
				<n-form-switch v-model="action.close" label="Close" after="When this action is triggered, send a close event as well"/>
				<n-form-switch v-model="action.skipHandleEvent" label="Don't send handled event" v-if="$window.nabu.page.event.getName(cell.state, 'handledEvent')" after="If this action does not constitute the final user interaction, we don't want to send the handled event"/>
				
				<div v-if="!action.dynamic" class="is-column is-spacing-vertical-gap-medium">
					<n-form-combo v-model="action.route" v-if="(!action.event || !action.event.name) && !action.url" 
						:filter="$services.page.getPageRoutes" 
						:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }" 
						:extracter="function(x) { return x.alias }" 
						label="Route to page"/>
					<n-form-combo v-model="action.anchor" v-if="action.route || action.url" label="Anchor" :filter="function(value) { return value ? [value, '$blank', '$window'] : ['$blank', '$window'] }"/>
					<n-form-switch v-model="action.absolute" v-if="action.route && !cell.state.useButtons" label="Absolute"/>
					<n-form-switch v-model="action.mask" label="Mask" v-if="action.route"/>
					<n-form-text v-model="action.url" label="URL" v-if="!action.route && (!action.event || !action.event.name)" :timeout="600"/>
					<n-form-combo v-model="action.anchor" v-if="action.url" label="Anchor" :items="['$blank', '$window']"/>
					<n-page-mapper v-if="action.route && $services.router.get(action.route)" :to="$services.page.getRouteParameters($services.router.get(action.route))"
						:from="$services.page.getAvailableParameters(page, cell)" 
						v-model="action.bindings"/>
					<page-event-value :inline="true" class="no-more-padding" :page="page" :container="action" title="Action Event" v-if="!action.dynamic && !action.route && !action.url" name="event" 
					 	@updatedEvents="$updateEvents()"/>
					 	
					<n-form-ace mode="javascript" v-model="action.disabled" label="Disabled if"/>
					<n-form-ace mode="javascript" v-model="action.condition" label="Show if"/>
					<n-form-combo v-model="action.validate" label="Only if valid" :filter="validatableItems" info="This action is only triggerable if the indicated item or group of items is valid"/>
					<n-form-text info="The event to send out if we have a validation error" v-if="action.validate" v-model="action.validationErrorEvent" label="Validation Error Event" :timeout="600" />
					<n-form-switch info="Whether we want to scroll to the first exception" v-if="action.validate" v-model="action.validationErrorScroll" label="Scroll to Validation Error" />
				</div>
			</div>
			
			<p class="is-p is-size-small is-spacing-medium">Triggers allow you to fire an action when another event occurs. You can also control whether triggers should still fire even if the button is hidden.</p>
			<div class="is-row is-align-end is-spacing-medium" v-if="!action.arbitrary">
				<button class="is-button is-variant-primary is-size-xsmall" @click="action.triggers ? action.triggers.push('') : $window.Vue.set(action, 'triggers', [''])"><icon name="plus"/>Trigger</button>
			</div>
			<div v-if="action.triggers" class="is-column is-spacing-medium">
				<div class="is-column has-button-close" v-for="i in Object.keys(action.triggers)">
					<n-form-combo v-model="action.triggers[i]" :items="$window.Object.keys($services.page.getAllAvailableParameters(page))"/>
					<button class="is-button is-variant-close is-spacing-horizontal-right-large" @click="action.triggers.splice(i, 1)"><icon name="times"/></button>
				</div>
				<n-form-switch v-model="action.triggerIfHidden" v-if="action.triggers.length && action.condition" label="Allow trigger if hidden"/>
			</div>
			
			<p class="is-p is-size-small is-spacing-medium">When the action triggers a certain route, it is considered active. However, you may want to highlight it as active for other routes as well.</p>
			<div class="is-row is-align-end is-spacing-medium" v-if="!action.arbitrary">
				<button class="is-button is-variant-primary is-size-xsmall" @click="action.activeRoutes.push('')"><icon name="plus"/>Active Route</button>
			</div>
			<div class="is-column has-button-close is-spacing-medium" v-for="i in Object.keys(action.activeRoutes)">
				<div class="is-column has-button-close">
					<n-form-combo v-model="action.activeRoutes[i]"
						:filter="$services.page.getPageRoutes" 
						:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }" 
						:extracter="function(x) { return x.alias }" />
					<button class="is-button is-variant-close is-spacing-horizontal-right-large" @click="action.activeRoutes.splice(i, 1)"><icon name="times"/></button>
				</div>
			</div>
			
			<aris-editor v-if="!action.arbitrary && $services.page.useAris && $services.page.normalizeAris(page, action, 'action', getActionComponents(action))" :child-components="getActionComponents(action)" :container="action.aris"/>			
			<n-collapsible title="Custom classes" content-class="is-spacing-medium">
				<n-form-text v-model="action.class" label="Menu Entry Class" :timeout="600" after="Set a custom css class on the menu entry" />
				<n-form-text v-model="action.buttonClass" label="Button Class" :timeout="600" after="Set a custom css class on the button" />
				<div class="is-row is-align-end is-spacing-vertical-medium">
					<button class="is-button is-variant-primary is-size-xsmall" @click="addStyle(action)"><icon name="plus"/>Style</button>
				</div>
				<div v-if="action.styles" class="is-column is-spacing-vertical-gap-medium">
					<div v-for="style in action.styles" class="is-column has-button-close is-spacing-medium is-color-body">
						<n-form-text v-model="style.class" label="CSS Class"/>
						<n-form-text v-model="style.condition" label="Condition"/>
						<button class="is-button is-variant-close" @click="action.styles.splice(action.styles.indexOf(style), 1)"><icon name="times"/></button>
					</div>
				</div>
			</n-collapsible>
		</n-collapsible>
	</div>
</script>

<script type='x/templates' id="page-actions">
	<ul :class="[cell.state.class, {'page-actions-root': actions == null }, {'page-actions-child': actions != null }, getAdditionalClasses(), {'is-empty-component': root && edit && (!cell.state.actions || !cell.state.actions.length)}]" 
			class="has-inline-component-menu"
			:placeholder="!actions || !actions.length ? 'Actions can be added here' : null"
			v-auto-close.actions="autoclose"
			v-fixed-header="cell.state.isFixedHeader != null && cell.state.isFixedHeader == true">
		<li class="is-column is-title" v-if="root && (cell.state.title || cell.state.logo)"><h2 class="is-h2" :class="getChildComponentClasses('actions-title')" @click="$services.router.route('home')"><img class="is-icon" v-if="cell.state.logo" :src="cell.state.logo"></span><span class="is-text" v-if="cell.state.title" v-html="$services.page.translate($services.page.interpret(cell.state.title, $self))"></span></h2></li>
		<li v-for="action in (isAutoCalculated ? autoActions : (edit ? getAllActions() : resolvedActions.filter(function(x) { return !x.dynamic})))" v-if="isVisible(action)"
				class="is-column"
				:class="[{ 'has-children': action.actions != null && action.actions.length }, action.class, {'click-based': cell.state.clickBased}, {'is-open': showing.indexOf(action) >= 0}, getDynamicWrapperClasses(action)]"
				@mouseover="show(action)" @mouseout="hide(action)"
				:sequence="(isAutoCalculated ? autoActions : (edit ? getAllActions() : resolvedActions)).indexOf(action) + 1">
			
			<n-sidebar class="page-settings" v-if="configuringAction" :inline="true" @close="configuringAction = null" :autocloseable="false">
				<component is="page-actions-configure" :cell="cell" :page="page" :edit="edit" :actions="configuringAction.actions"/>
			</n-sidebar>
			
			<page-arbitrary v-if="action.arbitrary"
				:edit="edit"
				:page="page"
				:cell="cell"
				:target="action"
				:component="$self"/>
			
			<template v-else>
				<span v-if="false && edit && !action.dynamic" class="fa fa-cog" @click="configureAction(action)"></span>
				<a :auto-close-actions="!action.skipHandleEvent" class="is-button" :href="getActionHref(action)"
					:data-event="action.name"
					:target="action.anchor == '$blank' && (action.url || action.route) ? '_blank' : null"
					:class="getDynamicClasses(action)"
					:sequence="(edit ? getAllActions() : resolvedActions).indexOf(action) + 1"
					:disabled="isDisabled(action)"
					:id="$services.page.interpret(action.id, $self)"
					@click="handle(action)"
					v-if="!cell.state.useButtons && (action.route || hasEvent(action) || action.url || action.close)"
						 rel="noopener noreferrer nofollow"><icon v-if="action.icon" :name="action.icon"
						/><span class="is-text" v-content.parameterized="{value:$services.page.translate($services.page.interpret(action.label, $self)), sanitize:!action.compileLabel, compile: !!action.compileLabel, plain: !action.compileLabel }"></span></a>
				<button :auto-close-actions="!action.skipHandleEvent" class="is-button"
					:data-event="action.name"
					:class="getDynamicClasses(action)"
					:sequence="(edit ? getAllActions() : resolvedActions).indexOf(action) + 1"
					:disabled="isDisabled(action)"
					:id="$services.page.interpret(action.id, $self)"
					@click="handle(action)" 
					v-else-if="cell.state.useButtons && (action.route || hasEvent(action) || action.url || action.close)"
						><icon v-if="action.icon" :name="action.icon"
						/><span class="is-text" v-content.parameterized="{value:$services.page.translate($services.page.interpret(action.label, $self)), sanitize:!action.compileLabel, compile: !!action.compileLabel, plain: !action.compileLabel }"></span
						><span v-if="action.badge" v-html="$services.page.translate($services.page.interpret(action.badge, $self))" class="is-badge" :class="action.badgeVariant ? 'is-variant-' + action.badgeVariant : null"></span></button>
				<span class="is-label page-action-entry is-button" 
					@click="toggle(action)"
					v-else
					:class="getDynamicClasses(action)"
					:sequence="(edit ? getAllActions() : resolvedActions).indexOf(action) + 1"
						><icon v-if="action.icon" :name="action.icon"
						/><span class="is-text" v-content.parameterized="{value:$services.page.translate($services.page.interpret(action.label, $self)), sanitize:!action.compileLabel, compile: !!action.compileLabel, plain: !action.compileLabel }"></span></span>
				<page-actions :ref="'action_' + (edit ? getAllActions() : resolvedActions).indexOf(action)"
					:root="false"
					v-if="(action.actions && action.actions.length) || configuringAction == action"
					:cell="cell"
					:page="page"
					:parameters="parameters"
					:edit="edit"
					:local-state="localState"
					:child-components="childComponents"
					:actions="action.actions"
					@close="$emit('close')"
					v-show="(edit && false) || showing.indexOf(action) >= 0"/>
			</template>
		</li>
		<ul v-if="root && edit" class="is-menu is-variant-toolbar is-variant-inline-component-menu">
			<li class="is-column"><button class="is-button is-variant-primary is-size-xsmall" @click="addAction(false);"><icon name="plus"/><span class="is-text">Static</span></button></li>
			<li class="is-column"><button class="is-button is-variant-secondary is-size-xsmall" @click="addAction(true);configure()"><icon name="plus"/><span class="is-text">Dynamic</span></button></li>
		</ul>
	</ul>
</script>
<script type='x/templates' id="page-tag">
	<div class="is-tag" :class="getChildComponentClasses('page-tag')" v-if="getValue() != null || edit">
		<img :src="icon.indexOf('http') == 0 ? icon : '/resources/' + icon" v-if="icon && icon.match(/^.*\.[^.]+$/)" class="is-icon" @click="reset"/>
		<icon :name="icon" v-if="icon" @click.native="reset"/>
		<span class="is-text">
			<span class="is-text-subscript" v-if="cell.state.content && !edit" v-html="$services.page.translate($services.page.interpret(cell.state.content, $self))"></span>
			<span class="is-text-subscript is-inline-editor" v-else-if="edit" 
				v-html-once="cell.state.content ? cell.state.content : null"
				ref="editor"
				@keyup="update" @blur="update" @input="update"
				:contenteditable="true"
				placeholder="Tag label"></span>
			<page-formatted :value="getValue()" :fragment="cell.state" :cell="cell" :page="page"/>
		</span>
	</div>
</script>

<script type='x/templates' id="page-tag-configure">
	<div class="is-column">
		<div class="is-column is-spacing-medium">
			<n-form-switch v-model="cell.state.useComputed" label="Use computed value" after="Instead of binding directly to a field, you can calculate the original value and update it through change listeners"/>
			<n-form-combo v-model="cell.state.field" :filter="$services.page.getAllAvailableKeys.bind($self, page, false)" label="Field value to show" v-if="!cell.state.useComputed"/>
			<n-form-ace v-model="cell.state.computed" label="Initial value for computed" v-else/>
			<n-form-text v-model="cell.state.icon" label="Icon" placeholder="times"/>
			<page-formatted-configure :page="page" :cell="cell" 
				:fragment="cell.state" 
				:allow-html="true"
				:keys="getAllKeys()"/>
		</div>
		<page-triggerable-configure :page="page" :target="cell.state" :triggers="{'remove': {}}" :allow-closing="true"/>
	</div>
</script><script type='x/templates' id="page-smart-check">
	<component :is="component" :value="checked" @input="toggle" :label="cell.state.label ? $services.page.interpret($services.page.translate(cell.state.label), $self) : null"
		:disabled="running || disabled"/>
</script>

<script type='x/templates' id="page-smart-check-configure">
	<div class="is-column">
		<div class="is-column is-spacing-medium">
			<n-form-text v-model="cell.state.label" label="Label" :timeout="600"/>
			<n-form-combo v-model="cell.state.component" label="Component"
				:items="[{name: 'n-form-checkbox', title: 'Checkbox'},{name:'n-form-switch', title: 'Switch'}]"
				:formatter="function(x) { return x.title }"
				:extracter="function(x) { return x.name }"/>
			<n-form-ace v-model="cell.state.checkCondition" label="Checked when"/>
			<n-form-ace v-model="cell.state.disabledCondition" label="Disabled when"/>
		</div>
		<page-triggerable-configure :page="page" :target="cell.state" :triggers="{'check': {}, 'clear': {}}" :allow-closing="true"/>
	</div>
</script><script type='x/templates' id="page-button">
	<component :href="getHref()" :is='tagName' class="is-button" @click="handle($event)" @click.middle="handle($event, true)" @keydown.space="hitSpace" :disabled="running || disabled" :class="[getChildComponentClasses('page-button'), {'is-running': running, 'is-active': active || activated, 'has-tooltip': !!tooltip, 'has-icon': cell.state.icon, 'has-text': cell.state.content}]" 
			:component-group="cell.state.componentGroup"
			:type="cell.state.buttonType ? cell.state.buttonType : guessButtonType()"
			:id="cell.customId ? cell.customId : null">
		<img :src="cell.state.icon.indexOf('http') == 0 ? cell.state.icon : $window.application.configuration.root + 'resources/' + cell.state.icon" v-if="cell.state.icon && cell.state.icon.match(/^.*\.[^.]+$/)" class="is-icon"/>
		<icon :name="cell.state.icon" v-if="cell.state.icon"/>
		<span class="is-text" v-if="cell.state.content && !edit" v-html="$services.page.translate(getContentWithVariables($services.page.interpret(cell.state.content, $self)))"></span>
		<span class="is-text is-inline-editor" v-else-if="edit" 
			v-html-once="cell.state.content ? cell.state.content : null"
			ref="editor"
			@keyup="update" @blur="update" @input="update"
			:contenteditable="true"
			placeholder="Button label"></span>
		<span class="is-badge" v-if="cell.state.badge" v-html="badge" :class="getChildComponentClasses('page-button-badge')"></span>
		<span v-if="tooltip" class="is-tooltip" v-html="tooltip" :class="getChildComponentClasses('page-button-tooltip')"></span>
	</component>
</script>

<script type='x/templates' id="page-button-configure">
	<div class="is-column">
		
		<div class="is-column is-spacing-medium">
			<n-form-text v-model="cell.state.icon" label="Icon" :timeout="600"/>
			<n-form-text v-model="cell.state.tooltip" label="Tooltip" :timeout="600"/>
			<n-form-text v-model="cell.state.badge" label="Badge" :timeout="600"/>
			<n-form-switch v-model="cell.state.stopPropagation" label="Stop click propagation"/>
			<n-form-switch v-model="cell.state.emitClose" label="Emit close on click" v-if="false"/>
			
			<n-form-ace v-model="cell.state.content" label="Raw content" mode="html"/>
			
			<n-form-combo label="Activation Type" v-model="cell.state.activationType" :items="['group', 'condition', 'route']"/>
			
			<n-form-text v-model="cell.state.componentGroup" label="Button group" after="You can add this button to a button group which will determine group behavior"
				placeholder="E.g. myTabs"
				v-if="cell.state.activationType == 'group'"
				:timeout="600"/>
				
			<n-form-switch v-model="cell.state.activateByDefault" v-if="cell.state.activationType == 'group' && !cell.state.activeInitial" label="Have this button active by default"/>
			<n-form-ace mode="javascript" v-model="cell.state.activeInitial" label="Start as active if" v-if="cell.state.activationType == 'group' && !cell.state.activateByDefault"/>
			<n-form-ace mode="javascript" v-model="cell.state.active" label="Active if" v-if="cell.state.activationType == 'condition'"/>
			<div v-if="cell.state.activationType == 'route'" class="is-column is-spacing-gap-small">
				<div v-for="(activeRoute, index) in cell.state.activeRoutes" class="is-column is-spacing-medium is-spacing-gap-small has-button-close is-spacing-vertical-top-large is-color-body">
					<n-form-combo v-model="activeRoute.route" 
						:filter="$services.page.getPageRoutes" 
						:formatter="function(x) { return $services.page.prettifyRouteAlias(x.alias) }" 
						:extracter="function(x) { return x.alias }" 
						label="Route"
						key="button-route"/>
					<n-form-text v-model="activeRoute.condition" label="Condition on route parameters"/>
					<button class="is-button is-variant-close is-size-small" @click="cell.state.activeRoutes.splice(index, 1)"><icon name="times"/></button>
				</div>
				<div class="is-row is-align-end">
					<button class="is-button is-variant-primary-outline is-size-xsmall" @click="cell.state.activeRoutes.push({condition:null,route:null})"><icon name="plus"/><span class="is-text">Route</span></button>
				</div>
			</div>
			
			<n-form-ace mode="javascript" v-model="cell.state.disabled" label="Disabled if"/>
			<n-form-combo v-model="cell.state.buttonType" :items="['submit', 'reset', 'button']" label="Button type"/>
			
		</div>
		
		<page-triggerable-configure :page="page" :target="cell.state" :triggers="triggers" :allow-closing="true" v-if="cell.state.triggers && cell.state.triggers.length"/>
		
		<typography-variable-replacer :content="cell.state.content" :container="cell.state" :page="page"/>
	</div>
</script><script type='x/templates' id="page-button-sort">
	<button class="is-button" @click="handle($event)" :disabled="running || disabled" :class="[getChildComponentClasses('page-button-sort')]">
		<img :src="icon.indexOf('http') == 0 ? icon : $window.application.configuration.root + 'resources/' + icon" v-if="icon && icon.match(/^.*\.[^.]+$/)" class="is-icon"/>
		<icon :name="icon" v-if="icon"/>
		<span class="is-text" v-if="cell.state.content && !edit" v-html="$services.page.translate(getContentWithVariables($services.page.interpret(cell.state.content, $self)))"></span>
		<span class="is-text is-inline-editor" v-else-if="edit" 
			v-html-once="cell.state.content ? cell.state.content : null"
			ref="editor"
			@keyup="update" @blur="update" @input="update"
			:contenteditable="true"
			placeholder="Button label"></span>
		<span class="is-badge" v-if="cell.state.badge" v-html="cell.state.badge"></span>
	</button>
</script>

<script type='x/templates' id="page-button-sort-configure">
	<div class="is-column">
		<div class="is-column is-spacing-medium">
			<n-form-combo v-model="cell.state.target"
				label="Sorting target"
				:filter="$services.page.getSpecificationTargets.bind($self, $services.page.getPageInstance(page, $self), 'orderable')"
				:formatter="function(x) { return x.name  ? x.name : (x.alias ? $services.page.prettifyRouteAlias(x.alias) : x.id) }"
				:extracter="function(x) { return x.id }"
				empty-value="No sorting targets available"
				/>
			
			<n-form-text v-model="cell.state.iconAsc" label="Icon when ascending" placeholder="sort-up"/>
			<n-form-text v-model="cell.state.iconDesc" label="Icon when descending" placeholder="sort-down"/>
			<n-form-switch v-model="cell.state.hideNoneIcon" label="Hide icon if no sorting is active"/>
			<n-form-switch v-model="cell.state.reverse" label="Reverse cycling, by default it is: asc, desc, none"/>
			<n-form-text v-if="!cell.state.hideNoneIcon" v-model="cell.state.iconNone" label="Icon when no sorting" placeholder="sort"/>
			<div v-for="(sortField, index) in cell.state.sortFields" class="has-button-close">
				<n-form-combo v-model="sortField.name" :filter="getAvailableFields" placeholder="Sort by"/>
				<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="cell.state.sortFields.splice(index, 1)"><icon name="times"/></button>
			</div>
			<div class="is-row is-align-end">
				<button @click="cell.state.sortFields.push({name:null, direction: null, nullsLast: null})" class="is-button is-size-small"><icon name="plus"/><span class="is-title">Order by</span></button>
			</div>
			<n-form-ace mode="javascript" v-model="cell.state.disabled" label="Disabled if"/>
			<n-form-ace mode="javascript" v-model="cell.state.active" label="Active if"/>
		</div>
		
		<typography-variable-replacer :content="cell.state.content" :container="cell.state" :page="page"/>
	</div>
</script><script type='x/templates' id="page-badge">
	<div class="is-badge" :class="[getChildComponentClasses('page-badge'), {'has-tooltip': !!tooltip}]">
		<img :src="cell.state.icon.indexOf('http') == 0 ? cell.state.icon : $window.application.configuration.root + 'resources/' + cell.state.icon" v-if="cell.state.icon && cell.state.icon.match(/^.*\.[^.]+$/)" class="is-icon"/>
		<icon :name="cell.state.icon" v-if="cell.state.icon"/>
		<span class="is-text" v-if="cell.state.content && !edit" v-html="$services.page.translate(getContentWithVariables($services.page.interpret(cell.state.content, $self)))"></span>
		<span class="is-text is-inline-editor" v-else-if="edit" 
			v-html-once="cell.state.content ? cell.state.content : null"
			ref="editor"
			@keyup="update" @blur="update" @input="update"
			:contenteditable="true"
			placeholder="Badge label"></span>
		<span v-if="tooltip" class="is-tooltip" v-html="tooltip"></span>
	</div>
</script>

<script type='x/templates' id="page-badge-configure">
	<div class="is-column">
		
		<div class="is-column is-spacing-medium">
			<n-form-text v-model="cell.state.icon" label="Icon"/>
			<n-form-text v-model="cell.state.tooltip" label="Tooltip" :timeout="600"/>
			<n-form-switch v-model="cell.state.stopPropagation" label="Stop click propagation"/>
			<n-form-switch v-model="cell.state.emitClose" label="Emit close on click" v-if="false"/>
			<n-form-ace mode="javascript" v-model="cell.state.disabled" label="Disabled if"/>
		</div>
		
		<typography-variable-replacer :content="cell.state.content" :container="cell.state" :page="page"/>
	</div>
</script><script type='x/templates' id="page-skeleton-email">
	<e-root class="page-skeleton-email" :inline-all="true">
		<e-wrapper id="main"></e-wrapper>
	</e-root>
</script><script type='x/templates' id="page-paging">
	<n-paging :value="paging.current" :total="paging.total" :load="load" :initialize="false"
		:class="getChildComponentClasses('paging-menu')"
		:button-classes="getChildComponentClasses('paging-button')"
		:show-empty="edit"/>
</script>

<script type='x/templates' id="page-paging-configure">
	<div class="is-column is-spacing-medium">
		<n-form-combo v-model="cell.state.target"
			label="Paging target"
			:filter="$services.page.getSpecificationTargets.bind($self, $services.page.getPageInstance(page, $self), 'pageable')"
			:formatter="function(x) { return x.name  ? x.name : (x.alias ? $services.page.prettifyRouteAlias(x.alias) : x.id) }"
			:extracter="function(x) { return x.id }"
			/>
	</div>
</script><script type='x/templates' id="page-paging-next">
	<ul class="is-menu" :class="getChildComponentClasses('paging-menu')">
		<li class="is-column"><button :class="getChildComponentClasses('paging-button')" class="is-button" @click="load(pageNumber - 1)" :disabled="pageNumber <= 0 || loading"><icon name="chevron-left"/></button></li>
		<li class="is-column"><n-form-text :value="pageNumber + 1" :minimum="1" :class="getChildComponentClasses('paging-page-number')" type="number" :disabled="loading" :timeout="600" @input="function(value) { load(Math.max(0, value - 1)) }"/></li>
		<li class="is-column"><button :class="getChildComponentClasses('paging-button')" class="is-button" @click="load(pageNumber + 1)" :disabled="loading"><icon name="chevron-right"/></button></li>
	</ul>
</script>

<script type='x/templates' id="page-paging-next-configure">
	<div class="is-column is-spacing-medium">
		<n-form-combo v-model="cell.state.target"
			label="Paging target"
			:filter="$services.page.getSpecificationTargets.bind($self, $services.page.getPageInstance(page, $self), 'pageable')"
			:formatter="function(x) { return x.name  ? x.name : (x.alias ? $services.page.prettifyRouteAlias(x.alias) : x.id) }"
			:extracter="function(x) { return x.id }"
			/>
	</div>
</script><script type='x/templates' id="page-field-fragment-image-configure">
	<n-form-section>
		<n-form-switch v-model="fragment.dataUrl" label="Is data url" v-if="!fragment.operationParameter" info="If the content in the record is actually a blob or base64 encoded byte array, check this"/>
		<n-form-switch v-model="fragment.operationParameter" label="Is operation parameter" v-if="!fragment.dataUrl" info="If you need have an operation that returns the byte stream based on parameters, use this"/>
		<n-form-switch v-model="fragment.fixedHref" label="Is href fixed?" info="If you have a fixed href, use this"/>
		<n-form-combo v-if="!fragment.fixedHref && !fragment.dataUrl && !fragment.operationParameter" :items="keys" :label="fragment.dataUrl ? 'Data url field' : 'Image Href'" v-model="fragment.imageHref"/>
		<n-form-text v-else-if="!fragment.dataUrl && !fragment.operationParameter" v-model="fragment.imageHref" label="Image Href"/>
		<n-form-text v-model="fragment.imageTitle" label="Image Title"/>
		<n-form-text v-model="fragment.imageHeight" label="Image Height"/>
		<n-form-combo v-model="fragment.imageSize" label="Image Sizing"
			:nillable="false"
			:items="['cover', 'contain']"/>
		<n-form-combo v-if="fragment.dataUrl" v-model="fragment.contentType" label="Content type" :items="keys"/>
		<n-form-combo v-if="fragment.operationParameter" v-model="fragment.operation" :filter="getOperations" label="Operation" :formatter="function(x) { return x.id }" :extracter="function(x) { return x.id }"/>
		<n-page-mapper v-if="fragment.operation && fragment.operationParameter" :to="getOperationParameters(fragment.operation)"
			:from="getAvailableParameters()" 
			v-model="fragment.bindings"/>
	</n-form-section>
</script>
<script type='x/templates' id="page-renderer-slider">
	<div class="page-renderer-slider">
		<div class="buttons">
			<button @click="previous">Previous</button>
			<button @click="next">Next</button>
		</div>
		<transition-group :name="group" :tag="tag ? tag : 'div'" class="items">
			<slot></slot>
		</transition-group>
	</div>
</script><script type='x/templates' id="enumeration-provider-configure">
	<div class="enumeration-provider-configure is-column">
		<h2 class="section-title">Data Source</h2>
		<div class="is-column is-spacing-medium">
			<n-form-combo v-model="field.provider" :items="['operation', 'array', 'provider', 'fixed']" label="Data source" />
		</div>
		<template v-if="field.provider == 'operation'">
			<h2 class="section-title">Operation</h2>
			<div class="is-column is-spacing-medium">
				<n-form-combo v-model='field.enumerationOperation'
					label='Enumeration Operation'
					:filter='getEnumerationServices'/>
			
				<n-page-mapper v-if='field.enumerationOperation && hasMappableEnumerationParameters(field)'
					v-model='field.enumerationOperationBinding'
					:from='availableParameters'
					:to='getMappableEnumerationParameters(field)'/>
					
				<n-form-combo v-if='field.enumerationOperation' 
					:filter='function() { return getEnumerationFields(field.enumerationOperation) }' 
					v-model='field.enumerationCachingKey' 
					label='Enumeration Caching Key'/>
			</div>
		</template>
		<template v-if="field.provider == 'operation'">
			<h2 class="section-title">Fields</h2>	
			<div class="is-column is-spacing-medium">
				<n-form-switch v-model='field.enumerationFieldLabelComplex' label='Complex Enumeration Label'/>
				
				<n-form-switch v-model='field.enumerationFieldPrettyLabelComplex' label='Complex Pretty Enumeration Label'/>
				<n-form-combo v-if='field.enumerationArray && !field.enumerationFieldPrettyLabelComplex' v-model='field.enumerationFieldPrettyLabel' label='Pretty enumeration Label'
					:filter='function(value) { return getEnumerationFields(field.enumerationArray, value) }'/>
				<n-form-ace v-model='field.complexPrettyLabel' label='The complex pretty label' v-if='field.enumerationFieldPrettyLabelComplex'/>				
				
				<n-form-combo 
					v-if='field.enumerationOperation && !field.enumerationFieldLabelComplex' 
					label='Enumeration Label'
					v-model='field.enumerationFieldLabel' 
					:filter='function(value) { return getEnumerationFields(field.enumerationOperation, value) }'/>
				
				<n-form-combo 
					v-if='field.enumerationOperation' 
					label='Enumeration Value'
					v-model='field.enumerationFieldValue' 
					:filter='function(value) { return getEnumerationFields(field.enumerationOperation, value) }' 
					info='If nothing is selected, the entire document becomes the value'/>
					
				<n-form-combo 
					v-if='field.enumerationOperation' 
					label='Enumeration Query'
					v-model='field.enumerationOperationQuery' 
					:filter='function(value) { return getEnumerationParameters(field.enumerationOperation, value) }'/>
					
				<n-form-combo 
					v-if='field.enumerationOperation && field.enumerationFieldValue' 
					label='Resolve Field'
					v-model='field.enumerationOperationResolve' 
					:filter='function(value) { return getEnumerationParameters(field.enumerationOperation, value) }' />
					
				<n-form-ace mode="html" v-model='field.complexLabel' label='The complex text label' v-if='field.enumerationOperation && field.enumerationFieldLabelComplex'/>
				<typography-variable-replacer v-if='field.enumerationOperation && field.enumerationFieldLabelComplex && field.complexLabel' :content='field.complexLabel' :page='page' :container='field' :keys='getEnumerationFields(field.enumerationOperation)' />
			</div>
		</template>
		<template v-if="field.provider == 'operation'">	
			<h2 class="section-title">Copywriting</h2>	
			<div class="is-column is-spacing-medium">
				<n-form-text v-model='field.emptyValue' label='Empty Value Text'/>
				<n-form-text v-model='field.calculatingValue' label='Calculating Value Text' info='The text to show while the result is being calculated'/>
				<n-form-text v-model='field.resetValue' label='Reset Value Text' info='The text to show to reset the current value'/>
				<n-form-text v-model='field.selectAllValue' label='Select all value' info='The text to show to select all values or deselect all'/>
			</div>
		</template>
		<template v-if="field.provider == 'array'">
			<n-form-combo v-model='field.enumerationArray'
				label='Enumeration Array'
				:filter='getEnumerationArrays'/>
			<n-form-ace v-if='field.enumerationArray' label='Filter' v-model='field.filter'/>
			<n-form-switch v-model='field.enumerationFieldLabelComplex' label='Complex Enumeration Label'/>
			<n-form-combo v-if='field.enumerationArray && !field.enumerationFieldLabelComplex' v-model='field.enumerationFieldLabel' label='Enumeration Label'
				:filter='function(value) { return getEnumerationFields(field.enumerationArray, value) }'/>
			<n-form-switch v-model='field.enumerationFieldPrettyLabelComplex' label='Complex Pretty Enumeration Label'/>
			<n-form-combo v-if='field.enumerationArray && !field.enumerationFieldPrettyLabelComplex' v-model='field.enumerationFieldPrettyLabel' label='Pretty enumeration Label'
				:filter='function(value) { return getEnumerationFields(field.enumerationArray, value) }'/>
			<n-form-ace v-model='field.complexPrettyLabel' label='The complex pretty label' v-if='field.enumerationFieldPrettyLabelComplex'/>
			<n-form-combo v-if='field.enumerationArray' v-model='field.enumerationFieldValue' label='Enumeration Value'
				:filter='function(value) { return getEnumerationFields(field.enumerationArray, value) }' info='If nothing is selected, the entire document becomes the value'/>
			<n-form-ace mode="html" v-model='field.complexLabel' label='The complex text label' v-if='field.enumerationFieldLabelComplex'/>
			<typography-variable-replacer v-if='field.enumerationFieldLabelComplex && field.complexLabel' :content='field.complexLabel' :page='page' :container='field' :keys='getEnumerationFields(field.enumerationArray)' />
			<typography-variable-replacer v-if='field.enumerationFieldPrettyLabelComplex && field.complexPrettyLabel' :content='field.complexPrettyLabel' :page='page' :container='field' :keys='getEnumerationFields(field.enumerationArray)' />
			<n-form-combo v-if='field.enumerationArray' :filter='function() { return getEnumerationFields(field.enumerationArray) }' v-model='field.enumerationCachingKey' label='Enumeration Caching Key'/>
		</template>
		<div class="is-column is-spacing-medium" v-if="field.provider == 'fixed'">	
			<n-form-switch v-model='field.complex' label='Complex Values' v-if='!field.allowCustom'/>
			<n-form-switch v-if='!field.complex' v-model='field.allowCustom' label='Allow Custom Values'/>
			<div class='is-row is-align-end'>
				<button class='is-button is-size-xsmall is-variant-primary-outline' @click='addEnumeration'><icon name='plus'/><span class='text'>Enumeration</span></button>
			</div>
			<div v-if='!field.complex' class='is-column is-spacing-gap-small'>
				<n-form-section class='has-button-close' v-for='i in Object.keys(field.enumerations)' :key="field.name + 'enumeration_' + i">
					<n-form-text v-model='field.enumerations[i]'/>
					<button class='is-button is-variant-close is-size-small' @click='field.enumerations.splice(i, 1)'><icon name='times'/></button>
				</n-form-section>
			</div>
			<div v-else class='is-column is-spacing-gap-small'>
				<n-form-section class='is-column is-spacing-medium is-spacing-vertical-top-large is-color-body has-button-close' v-for='i in Object.keys(field.enumerations)' :key="field.name + 'enumeration_' + i">
					<n-form-text v-model='field.enumerations[i].key' placeholder='Value' :timeout='600'/>
					<n-form-text v-model='field.enumerations[i].value' placeholder='Label' :timeout='600'/>
					<button class='is-button is-variant-close is-size-small' @click='field.enumerations.splice(i, 1)'><icon name='times'/></button>
				</n-form-section>
			</div>
		</div>
		<div class="is-column is-spacing-medium" v-if="field.provider == 'provider'">
			<n-form-combo v-model='field.enumerationProvider' :filter='getEnumerationProviders' label='Enumeration Provider'/>
			<n-form-combo v-if='providerValueOptions' :items='providerValueOptions' v-model='field.enumerationFieldValue' label='Value Field'/>
			<n-form-combo v-if='providerLabelOptions && !field.enumerationFieldLabelComplex' :items='providerLabelOptions' v-model='field.enumerationFieldLabel' label='Label Field'/>
			<n-form-switch v-model='field.enumerationFieldLabelComplex' label='Complex Enumeration Label'/>
			<n-form-ace v-if='field.enumerationArray' label='Filter' v-model='field.filter'/>
			<n-form-ace mode="html" v-model='field.complexLabel' label='The complex text label' v-if='field.enumerationProvider && field.enumerationFieldLabelComplex'/>
			<typography-variable-replacer v-if='field.enumerationProvider && field.enumerationFieldLabelComplex && field.complexLabel' :content='field.complexLabel' :page='page' :container='field' :keys='getEnumerationFields(field.enumerationProvider)' />
		</div>
	</div>
</script>

<script type='x/templates' id="page-form-combo-configure">
	<div class="page-form-combo-configure">
		<template v-if="$services.page.activeSubTab == 'component'">
			<h2 class="section-title">Combo box</h2>
			<div class="is-column is-spacing-medium">
				<n-form-text v-model="field.placeholderSelected" label="Placeholder with items selected" info="Use {amount} as variable if you want"/>
				<n-form-switch v-model='field.useCheckbox' label='Add checkboxes' info="Each entry will have a checkbox as will the select all and reset value"/>
				<n-form-switch v-model='field.showTags' label='Show selected tags' info="Visualize the currently selected items with tags"/>
				<n-form-text v-if="field.showTags" v-model='field.maxAmountOfTags' label='Max amount of tags visible' placeholder='3' info='Choose how many tags should maximum be visible at any given time, set to 0 to show all tags'/>
				<n-form-switch v-model='field.showAmount' label='Show selected amount' info="Show a counter of how many items are selected"/>
				<n-form-switch :invert='true' v-model='field.allowTyping' label='Disable typing' info='Can the user type to search?'/>
				<n-form-switch v-model='field.selectFirstIfEmpty' label='Select the first value if none has been selected yet'/>
				<n-form-switch v-model='field.loadOnFocus' label='Reload on focus'/>
				<n-form-switch v-model="field.searchInDropdown" label="Show search in dropdown" info="This will also use the rich formatter (if possible) for displaying the current item"/>
			</div>
		</template>
		<template v-else-if="$services.page.activeSubTab == 'data'">
			<enumeration-provider-configure :field="field" :page="page" :cell="cell"/>		
		</template>
	</div>
</script>

<script type='x/templates' id="page-form-combo">
	<n-form-combo combo-type="n-input-combo2"
		ref="combo"
		:load-on-focus="field.loadOnFocus"
		:class="getChildComponentClasses('page-form-combo')"
		:filter="enumerationFilter"
		:resolver="enumerationResolver"
		:formatter="enumerationFormatter"
		:pretty-formatter="enumerationPrettyFormatter"
		:extracter="enumerationExtracter"
		:search-in-dropdown="field.searchInDropdown"
		:edit='!readOnly'
		:placeholder='placeholder'
		:placeholder-selected='field.placeholderSelected'
		@input="function(newValue, label, rawValue, selectedLabel) { $emit('input', newValue, label, rawValue, selectedLabel) }"
		v-bubble:label
		:timeout='600'
		v-bubble:blur
		:label='label'
		:value='value'
		:nillable="!required"
		:required="required"
		:allow-typing='field.allowTyping'
		:empty-value='field.emptyValue ? $services.page.translate($services.page.interpret(field.emptyValue)) : null'
		:calculating-value='field.calculatingValue ? $services.page.translate($services.page.interpret(field.calculatingValue)) : null'
		:reset-value='field.resetValue ? $services.page.translate($services.page.interpret(field.resetValue)) : null'
		:info='field.info ? $services.page.translate(field.info) : null'
		:before='field.before ? $services.page.translate(field.before) : null'
		:after='field.after ? $services.page.translate(field.after) : null'
		:suffix='field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'
		:schema='schema'
		:disabled='disabled'
		:select-all-value='field.selectAllValue ? $services.page.translate($services.page.interpret(field.selectAllValue)) : null'
		:use-checkbox='field.useCheckbox'
		:show-tags='field.showTags'
		:show-amount='field.showAmount'
		:max-amount-of-tags='field.maxAmountOfTags'
		/>
</script><script type='x/templates' id="page-form-checkbox-list-configure">
	<div class="page-form-checkbox-list-configure">
		<template v-if="$services.page.activeSubTab == 'component'">
			<h2 class="section-title">Checkbox list</h2>
			<div class="is-column is-spacing-medium">
				
			</div>
		</template>
		<template v-else-if="$services.page.activeSubTab == 'data'">
			<enumeration-provider-configure :field="field" :page="page" :cell="cell"/>		
		</template>
	</div>
</script>

<script type='x/templates' id="page-form-checkbox-list">
	<n-form-checkbox-list
		ref="checkbox-list"
		:load-on-focus="field.loadOnFocus"
		:class="getChildComponentClasses('page-form-checkbox-list')"
		:filter='enumerationFilter'
		:formatter="enumerationFormatter"
		:extracter="enumerationExtracter"
		:edit='!readOnly'
		@input="function(newValue, label, rawValue, selectedLabel) { $emit('input', newValue, label, rawValue, selectedLabel) }"
		v-bubble:label
		:timeout='600'
		v-bubble:blur
		:label='label'
		:value='value'
		:nillable="!required"
		:required="required"
		:info='field.info ? $services.page.translate(field.info) : null'
		:before='field.before ? $services.page.translate(field.before) : null'
		:after='field.after ? $services.page.translate(field.after) : null'
		:schema='schema'
		:disabled='disabled'
		/>
</script><script type='x/templates' id="page-form-radio-configure">
	<div class="page-form-radio-configure">
		<template v-if="$services.page.activeSubTab == 'component'">
			<h2 class="section-title">Radio box</h2>
			<div class="is-column is-spacing-medium">
				<n-form-ace v-model="field.disableEntryCondition" label="Disable entry condition"/>
			</div>
		</template>
		<template v-else-if="$services.page.activeSubTab == 'data'">
			<enumeration-provider-configure :field="field" :page="page" :cell="cell"/>		
		</template>
	</div>
</script>

<script type='x/templates' id="page-form-radio">
	<n-form-radio
		ref="radio"
		:load-on-focus="field.loadOnFocus"
		:class="getChildComponentClasses('page-form-radio')"
		:filter='enumerationFilter'
		:formatter="enumerationFormatter"
		:extracter="enumerationExtracter"
		:disabler="disabler"
		:edit='!readOnly'
		@input="function(newValue, label, rawValue, selectedLabel) { $emit('input', newValue, label, rawValue, selectedLabel) }"
		v-bubble:label
		:timeout='600'
		v-bubble:blur
		:label='label'
		:value='value'
		:nillable="!required"
		:required="required"
		:info='field.info ? $services.page.translate(field.info) : null'
		:before='field.before ? $services.page.translate(field.before) : null'
		:after='field.after ? $services.page.translate(field.after) : null'
		:suffix='field.suffixIcon ? $services.page.getIconHtml(field.suffixIcon) : field.suffix'
		:schema='schema'
		:disabled='disabled'
		/>
</script><script type='x/templates' id="page-form-list-input-predefined">
	<div class="page-form-list-input-predefined">
		<n-form-section ref='form'>
			<n-form-section v-for="field in fields">
				<n-form-date :label="field.label" v-model="field.value" v-if="field.type == 'date'" v-bind="field.additional"
					:placeholder="field.placeholder"
					:required="!field.optional"
					@input="function(value) { updateField(field, value) }"/>
				<n-form-checkbox :label="field.label" v-model="field.value" v-else-if="field.type == 'boolean'" v-bind="field.additional"
					:placeholder="field.placeholder"
					:required="!field.optional"
					@input="function(value) { updateField(field, value) }"/>
				<n-form-text :label="field.label" v-model="field.value" v-else v-bind="field.additional"
					:placeholder="field.placeholder"
					:type="field.type"
					:required="!field.optional"
					@input="function(value) { updateField(field, value) }"/>
			</n-form-section>
			<div v-if="!fields.length && field.emptyPlaceholder">{{$services.page.translate(field.emptyPlaceholder)}}</div>
		</n-form-section>
	</div>	
</script>

<script type='x/templates' id="page-form-list-input-predefined-configure">
	<n-form-section>
		<n-form-combo  v-model="field.resultKeyField" label="Resulting name field"
			:items="availableResultFields"/>
		<n-form-combo v-model="field.resultValueField" label="Resulting value field"
			:items="availableResultFields"/>
			
		<n-form-text v-model="field.emptyPlaceholder" label="Empty placeholder"/>
		<n-form-combo :filter="listOperations" label="Field Provider Operation" v-model="field.fieldProviderOperation"/>
		<n-form-combo v-model="field.nameField" label="Provider Name Field" :required="true" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-form-combo v-model="field.labelField" label="Provider Label Field" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-form-combo v-model="field.typeField" label="Provider Type Field" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-form-combo v-model="field.valueField" label="Provider (Existing) Value Field" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-form-combo v-model="field.optionalField" label="Provider Optional Field" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-form-combo v-model="field.placeholderField" label="Placeholder Field" :required="false" v-if="field.fieldProviderOperation"
			:items="availableFields"/>
		<n-page-mapper v-if='field.fieldProviderOperation && hasMappableParameters(field)'
			v-model='field.fieldOperationBinding'
			:from='$services.page.getAvailableParameters(page, cell, true)'
			:to='getMappableParameters(field)'/>
	</n-form-section>
</script><script type='x/templates' id="default-login">
	<div class="is-row is-align-center is-height-fixed-max is-fill-normal">
		<n-form ref="form" class="is-form is-width-min-xsmall is-spacing-large is-variant-underline is-color-background is-shadow-xsmall is-border-radius-medium" content-class="is-spacing-gap-large">
			<h1 class="is-h3">{{$services.page.translate("Login")}}</h1>
			<n-form-text name="username" v-focus v-timeout:input.form="validate" placeholder="Username" v-model="username" :required="true"/>
			<n-form-text name="password" type="password" v-timeout:input.form="validate" placeholder="Password" v-model="password" :required="true"/>
			<n-form-switch label="Remember me" v-model="remember" />
			<div class="is-row is-align-end">
				<button :disabled="working" class="is-button is-variant-primary" v-action="login">{{$services.page.translate("Login")}}</button>
			</div>
			<n-messages v-if="messages.length" :messages="messages"/>
		</n-form>
	</div>
</script><script type='x/templates' id="default-challenge">
	<div class="is-row is-align-center is-height-fixed-max is-fill-normal">
		<n-form ref="form" class="is-form is-width-min-xsmall is-spacing-large is-variant-underline is-color-background is-shadow-xsmall is-border-radius-medium" content-class="is-spacing-gap-large">
			<h1 class="is-h3">{{$services.page.translate("Challenge")}}</h1>
			<n-form-text name="challenge" v-focus v-timeout:input.form="validate" placeholder="Challenge" v-model="challenge" :required="true"/>
			<div class="is-row is-align-end">
				<button :disabled="working" class="is-button is-variant-primary" v-action="login">{{$services.page.translate("Login")}}</button>
			</div>
			<n-messages v-if="messages.length" :messages="messages"/>
		</n-form>
	</div>
</script><script type='x/templates' id="default-error">
	<div class="is-column is-align-center is-spacing-medium is-height-fixed-max">
		<h1 class="is-h1 is-size-xxxlarge">{{$services.page.translate(title)}}</h1>
		<h6 class="is-h6" v-content.compile="$services.page.translate(message)"></h6>
		<p class="is-p is-spacing-vertical-top-large" v-content.compile="$services.page.translate(recover)"></p>
	</div>
</script><script type='x/templates' id="default-unknown">
	<div class="is-column is-align-center is-spacing-medium is-height-fixed-max">
		<h1 class="is-h1 is-size-xxxlarge">{{$services.page.translate("That page doesn&#39;t exist!")}}</h1>
		<h6 class="is-h6">{{$services.page.translate(message)}}</h6>
		<p class="is-p is-spacing-vertical-top-large" v-content.compile="$services.page.translate(recover)"></p>
	</div>
</script><script type='x/templates' id="renderer-form">
	<n-form :class="getChildComponentClasses('form')" :content-class="getChildComponentClasses('form-container')" :mode="mode" @submit="submit" @update="update">
		<slot @update="update"></slot>
		<n-messages :messages="messages" slot="footer" v-if="messages.length"/>
	</n-form>
</script>

<script type='x/templates' id="renderer-form-configure">
	<div class="renderer-form-configure is-column is-spacing-gap-medium">
		
		<n-form-switch v-model="target.form.readOnly" label="Read only"/>
		
		<n-form-combo 
			name="form-type"
			v-model="target.form.formType"
			:items="[{name: 'page', title: 'Page form'}, {name:'operation', title: 'Operation Form'}, {name: 'array', title: 'Array form'}, {name: 'function', title: 'Function form'}]"
			:formatter="function(x) { return x.title }"
			:extracter="function(x) { return x.name }"
			label="What type of form do you want?"/>
		
		
		<div v-if="target.form.formType == 'operation'">
			<n-form-combo label="Operation" v-model="target.form.operation" 
				:filter="getOperations"
				:formatter="function(x) { return x.id }"
				:extracter="function(x) { return x.id }"/>
		</div>
		
		<div class="is-column is-spacing-medium">
			<div class="is-row is-align-end">
				<button class="is-button is-variant-primary-outline is-size-xsmall" @click="target.form.fields.push({})"><icon name="plus"/><span class="is-text">Add state field</span></button>
			</div>
			<div v-for="field in target.form.fields" class="is-column is-color-body is-spacing-medium has-button-close">
				<n-form-text v-model="field.name" label="Field name"/>
				<n-form-combo v-model="field.type" label="Field type" :filter="getParameterTypes"/>
				<button class="is-button is-variant-close is-size-xsmall" @click="target.form.fields.splice(target.form.fields.indexOf(field), 1)"><icon name="times"/></button>
			</div>
		</div>
		
		<div v-if="target.form.formType == 'array'" class="is-column is-spacing-medium">
			<n-form-combo 
				label="Array" 
				v-model="target.form.array"
				:filter="function(value) { return $services.page.getAllArrays(page) }"
				/>
		</div>
		
		<div v-else-if="target.form.formType == 'function'" class="is-column is-spacing-medium">
			<n-form-combo v-model="target.form.function" label="Function" :filter="$services.page.listFunctions" />
		</div>

		<div v-if="false && (target.form.formType == 'operation' || (target.form.formType == 'page' && target.form.submitType == 'staged'))">
			<n-form-text v-model="target.form.submitEvent" label="Submit event" after="Emitted once the form has been submitted, the response at that point may still be positive or negative"/>
			<n-form-text v-model="target.form.successEvent" label="Success event" after="Emitted once the form has been successfully submitted"/>
			<n-form-text v-model="target.form.errorEvent" label="Error event" after="Emitted if the form could not be submitted correctly"/>
		</div>
		
		<n-form-switch v-model="target.form.synchronize" label="Synchronize changes back to binding" v-if="target.form.formType != 'page'"/>
		<n-form-switch v-model="target.form.bindingByReference" label="Perform input parameter binding by reference"/>
		<n-form-switch v-model="target.form.submitOnChange" label="Submit on change"/>
		<n-form-switch v-model="target.form.enableParameterWatching" label="Watch bound values for change"/>

		<n-form-switch v-model="target.form.translatable" label="Translatable" after="Add a language switching capability to the form, mostly to manage translations of operational data" />
		
		<div v-if="target.form.formType">
			<n-form-switch v-model="target.form.noInlineErrors" label="Disable inline error message" after="By default, validation errors will be shown inline."/>
		</div>
		
		<div class="is-column is-spacing-medium">
			<h3 class="is-h3">Validation Messages</h3>
			<p class="is-p is-size-small">You can remap specific validation codes for the whole form to provide the user with a different message than the default message available for that code.</p>
			<div v-if='target.form.codes' class="is-column is-spacing-vertical-gap-medium">
				<div class="is-column is-color-body is-spacing-medium has-button-close" v-for='code in target.form.codes' :timeout='600'>
					<n-form-text v-model='code.code' label='Code' :timeout='600' after="The code you want to remap, for example 'required'"/>
					<n-form-text v-model='code.title' label='Title' :timeout='600' after="The message you want to show the user"/>
					<button class="is-button is-variant-close" @click='target.form.codes.splice(target.form.codes.indexOf(code), 1)'><icon name="times"/></button>
				</div>
			</div>
			<div class="is-row is-align-end">
				<button class="is-button is-size-xsmall is-variant-primary-outline" @click="target.form.codes ? target.form.codes.push({code:null,title:null}) : $window.Vue.set(target.form, 'codes', [{code:null,title:null}])"><icon name="plus"/><span class="is-text">Message</span></button>
			</div>
		</div>
	</div>
</script>

<script type='x/templates' id="page-collapsible">
	<div class="is-collapsible" :class="[getChildComponentClasses('collapsible'), {'is-open': show || edit, 'is-closed': !show && !edit}]">
		<typography-h3 :page="page" :cell="target" :parameters="parameters" :edit="edit" :child-components="childComponents" @click.native="toggle" class="is-title">
			<icon slot="after" :name="show || edit ? iconOpen : iconClosed"></icon>
		</typography-h3>
		<div class="is-collapsible-content" :class="contentClass" v-if="show || edit" @click.native="checkPrevent">
			<slot></slot>
		</div>
	</div>
</script>

<script type='x/templates' id="page-collapsible-configure">
	<div>
		<n-form-text v-model="target.collapsible.iconClosed" label="Icon closed" placeholder="chevron-down"/>
		<n-form-text v-model="target.collapsible.iconOpen" label="Icon open" placeholder="chevron-up"/>
		<n-form-switch v-model="target.collapsible.startOpen" label="Start open"/>
		<n-form-switch v-model="target.collapsible.closeSiblings" label="Close siblings"/>
		<n-form-switch v-model="target.collapsible.stopPropagation" label="Stop click propagation"/>
	</div>
</script><script type='x/templates' id="renderer-menu">
	<ul class="is-menu" :class="[{'is-editing': edit, 'is-expanded': edit || !state.collapsed, 'is-collapsed': !edit && state.collapsed}, getChildComponentClasses('renderer-menu')]" @click="handle" @mouseover="expand" @mouseout="collapse" v-auto-close.menu="autoclose">
		<slot v-if="edit || state.collapsed" name="collapsed"></slot>
		<slot></slot>
		<slot v-if="edit || !state.collapsed" name="expanded"></slot>
	</ul>
</script>

<script type='x/templates' id="renderer-menu-configure">
	<div class="is-column is-spacing-gap-medium">
		<n-form-switch v-model="target.state.collapsible" label="Is collapsible"/>
		<n-form-switch v-if="target.state.collapsible" v-model="target.state.expandOnHover" label="Open on hover"/>
		<n-form-ace v-if="target.state.collapsible" v-model="target.state.initialCollapsed" label="Initial collapsed value"/>
		<page-event-value :page="page" :container="target.state" title="Handled Event" name="handledEvent" @resetEvents="resetEvents" :inline="true"/>
	</div>
</script><script type='x/templates' id="renderer-repeat">
	<div v-fragment>
		<template v-if="!edit && !loading && state.records.length">
			<template v-if="fragmentPage.content.repeatType == 'cell'">
				<template v-for="(record, index) in state.records">
					<component :is="getComponent()" :class="getCellClasses()" :page="page" :target="target" v-visible="lazyLoad.bind($self, record)">
						<template v-if="!edit && !loading && state.records.length && fragmentPage.content.rows.length >= 2">
							<n-page v-fragment
								:$set-value="repeatSetter"
								:page="fragmentPage"
								@update="function() { update(record) }"
								@click.native="handleClick($event, record)"
								:fragment-parent="getPageInstance()"
								:record-index="index" class="is-repeat-content" 
								:draggable="target.repeat.enableDrag"
								@dragstart.native="onDragStart($event, record)"
								:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
								:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record)"
								:parameters="getParameters(record)"
								@beforeMount="beforeMount"
								@ready="mounted"/>
						</template>
						<template v-else-if="!edit && !loading && state.records.length">
							<n-page-optimized :page="fragmentPage"
								:$set-value="repeatSetter"
								@update="function() { update(record) }"
								@click.native="handleClick($event, record)"
								:fragment-parent="getPageInstance()"
								:record-index="index" class="is-repeat-content" 
								:draggable="target.repeat.enableDrag"
								@dragstart.native="onDragStart($event, record)"
								:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
								:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record)"
								:parameters="getParameters(record)"
								@beforeMount="beforeMount"
								@ready="mounted"/>
						</template>
					</component>
					<component :is="getComponent()" :cell="getCellClasses()" :page="page" :target="target" v-for="slot in getAdditionalSlots(index)">
						<template v-if="!edit && !loading && state.records.length && fragmentPages[slot].content.rows.length >= 2">
							<n-page :page="fragmentPages[slot]"
								:$set-value="repeatSetter"
								@update="function() { update(record) }"
								@click.native="handleClick($event, record)"
								:fragment-parent="getPageInstance()"
								:record-index="index" class="is-repeat-content" 
								:draggable="target.repeat.enableDrag"
								@dragstart.native="onDragStart($event, record)"
								:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
								:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record) + '_' + slot"
								:parameters="getParameters(record)"
								@beforeMount="beforeMount"
								@ready="mounted"/>
						</template>
						<template v-else-if="!edit && !loading && state.records.length">
							<n-page-optimized :page="fragmentPages[slot]"
								:$set-value="repeatSetter"
								@update="function() { update(record) }"
								@click.native="handleClick($event, record)"
								:fragment-parent="getPageInstance()"
								:record-index="index" class="is-repeat-content" 
								:draggable="target.repeat.enableDrag"
								@dragstart.native="onDragStart($event, record)"
								:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
								:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record) + '_' + slot"
								:parameters="getParameters(record)"
								@beforeMount="beforeMount"
								@ready="mounted"/>
						</template>
					</component>
				</template>
				<slot name="appendLoading" v-if="appendLoading"></slot>
			</template>
			<template v-else>
				<template v-if="!edit && !loading && state.records.length && fragmentPage.content.rows.length >= 2">
					<template v-for="(record, index) in state.records">
						<n-page :page="fragmentPage"
							v-visible="lazyLoad.bind($self, record)"
							:$set-value="repeatSetter"
							@update="function() { update(record) }"
							@click.native="handleClick($event, record)"
							:fragment-parent="getPageInstance()"
							:record-index="index" class="is-repeat-content" 
							:draggable="target.repeat.enableDrag"
							@dragstart.native="onDragStart($event, record)"
							:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
							:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record)"
							:parameters="getParameters(record)"
							@beforeMount="beforeMount"
							@ready="mounted"/>
						<n-page 
							:$set-value="repeatSetter"
							v-for="slot in getAdditionalSlots(index)"
							:page="fragmentPages[slot]"
							@update="function() { update(record) }"
							@click.native="handleClick($event, record)"
							:fragment-parent="getPageInstance()"
							:record-index="index" class="is-repeat-content" 
							:draggable="target.repeat.enableDrag"
							@dragstart.native="onDragStart($event, record)"
							:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
							:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record) + '_' + slot"
							:parameters="getParameters(record)"
							@beforeMount="beforeMount"
							@ready="mounted"/>
					</template>
					<slot name="appendLoading" v-if="appendLoading"></slot>
				</template>
				<template v-else-if="!edit && !loading && state.records.length">
					<template v-for="(record, index) in state.records">
						<n-page-optimized :page="fragmentPage"
							v-visible="lazyLoad.bind($self, record)"
							:$set-value="repeatSetter"
							@update="function() { update(record) }"
							@click.native="handleClick($event, record)"
							:fragment-parent="getPageInstance()"
							:record-index="index" class="is-repeat-content" 
							:draggable="target.repeat.enableDrag"
							@dragstart.native="onDragStart($event, record)"
							:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
							:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record)"
							:parameters="getParameters(record)"
							@beforeMount="beforeMount"
							@ready="mounted"/>
						<n-page-optimized
							:$set-value="repeatSetter"
							v-for="slot in getAdditionalSlots(index)"
							:page="fragmentPages[slot]"
							@update="function() { update(record) }"
							@click.native="handleClick($event, record)"
							:fragment-parent="getPageInstance()"
							:record-index="index" class="is-repeat-content" 
							:draggable="target.repeat.enableDrag"
							@dragstart.native="onDragStart($event, record)"
							:class="[getChildComponentClasses('repeat-content'), {'is-selected': state.selected.indexOf(record) >= 0 }, {'is-selectable': target.repeat.selectable}]"
							:key="'repeat_' + instanceCounter + '_rendered_' + getKey(record) + '_' + slot"
							:parameters="getParameters(record)"
							@beforeMount="beforeMount"
							@ready="mounted"/>
					</template>
					<slot name="appendLoading" v-if="appendLoading"></slot>
				</template>
			</template>
		</template>
		<template v-else-if="edit && getComponent()">
			<component :is="getComponent()" :page="page" :target="target" :class="getComponentClassesForEdit()">
				<slot></slot>
				<slot name="appendLoading"></slot>
			</component>
		</template>
		<template v-else-if="edit">
			<slot></slot>
			<slot name="appendLoading"></slot>
		</template>
		<template v-if="edit && target.repeat.customSlots">
			<slot v-for="customSlot in target.repeat.customSlots" :name="customSlot.name"></slot>
		</template>
		<template v-if="edit || (created && !loading && !state.records.length)">
			<component :is="getMessageComponent()" v-if="target.repeat.emptyPlaceholder" :class="[getComponentClassesForMessage(), getChildComponentClasses('repeat-message'), getChildComponentClasses('repeat-empty')]"><span class="is-text" v-html="$services.page.translate(target.repeat.emptyPlaceholder)"></span></component>
			<slot name="empty"></slot>
		</template>
		<template v-if="edit || loading">
			<component :is="getMessageComponent()" v-if="target.repeat.loadingPlaceholder" :class="[getComponentClassesForMessage(), getChildComponentClasses('repeat-message'), getChildComponentClasses('repeat-loading')]"><span class="is-text" v-html="$services.page.translate(target.repeat.loadingPlaceholder)"></span></component>
			<slot name="loading"></slot>
		</template>
	</div>
</script>

<script type='x/templates' id="renderer-repeat-configure">
	<div class="is-column is-spacing-vertical-gap-medium">
		<n-form-combo label="Repeat over" 
			v-model="target.repeat.type" :filter="getRepeatTypes"
			:formatter="function(x) { return x.title }"
			:extracter="function(x) { return x.name }"/>
			
		<n-form-combo label="Operation" v-model="target.repeat.operation" 
			:filter="$services.page.getArrayOperations"
			v-if="target.repeat.type == 'operation'"
			:formatter="function(x) { return x.id }"
			:extracter="function(x) { return x.id }"/>
			
		<n-form-combo label="Array" v-model="target.repeat.array"
			:filter="function(value) { return $services.page.suggestArray(page, value) }"
			v-else-if="target.repeat.type == 'array'"
			/>
			
		<component v-if="getRepeatConfigurator()" :is="getRepeatConfigurator()" :target="target.repeat" :page="page"/>
			
		<n-form-ace v-model="target.repeat.arrayFilter" label="Filter the array">
			<code>
			function(record) {<br/>
			&nbsp;&nbsp;&nbsp;&nbsp;return !record.myField;<br/>
			}
			</code>
		</n-form-ace>
		
		<n-form-text v-model="target.repeat.emptyPlaceholder" label="Empty Place Holder"/>
		<n-form-text v-model="target.repeat.loadingPlaceholder" label="Loading Place Holder" v-if="target.repeat.operation"/>
		<n-form-text v-model="target.repeat.refreshInterval" label="Refresh interval" :timeout="600" v-if="target.repeat.operation"/>
		
		<n-form-switch v-model="target.repeat.enableParameterWatching" label="Watch bound values for change"/>
		<n-form-switch v-model="target.repeat.waitForPageLoad" label="Wait for page rendering to complete"
			after="The repeat will only load data once the full page has been rendered, this makes sure that all filters have finished all calculations"/>
		
		<n-form-switch v-model="target.repeat.enableDrag" label="Enable dragging"/>
		<n-form-text v-model="target.repeat.dragName" label="Drag source name" v-if="target.repeat.enableDrag" placeholder="default"/>
		
		<n-form-switch v-model="target.repeat.selectable" label="Enable item selection"/>
		<n-form-switch v-model="target.repeat.multiSelectable" v-if="target.repeat.selectable" label="Enable multiselect"/>
		<n-form-switch v-model="target.repeat.alwaysMultiselect" v-if="target.repeat.selectable && target.repeat.multiSelectable" label="Multiselect without ctrl/cmd" after="If you enable this switch, multiselection can be done by clicking without the need for holding ctrl/cmd"/>
		<n-form-switch v-model="target.repeat.disableMouseSelection" v-if="target.repeat.selectable" label="Disable mouse selection"/>
		
		<n-form-switch v-model="target.repeat.raw" label="Add raw data"/>
			
		<n-form-switch v-if="target.repeat.type == 'operation'" v-model="target.repeat.scrollLoad" label="Lazy Loading"/> 
			
		<div v-for="(defaultOrderBy, index) in target.repeat.defaultOrderBy" class="has-button-close">
			<div class="is-row">
				<n-form-combo v-model="defaultOrderBy.name" :filter="getOrderByFields" placeholder="Order by field"/>
				<n-form-combo v-model="defaultOrderBy.direction" :items="['asc', 'desc']" placeholder="Direction"/>
				<n-form-combo v-model="defaultOrderBy.nulls" :items="['nulls first', 'nulls last']"/>
			</div>
			<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="target.repeat.defaultOrderBy.splice(index, 1)"><icon name="times"/></button>
		</div>
		<div class="is-row is-align-end" v-if="getOrderByFields().length">
			<button @click="target.repeat.defaultOrderBy.push({name: null, direction: 'asc'})" class="is-button is-size-small"><icon name="plus"/><span class="is-title">Order by</span></button>
		</div>
		<p v-else class="is-p is-size-small is-variant-danger-outline">Order by not supported</p>
			
		<div v-for="(customSlot, index) in target.repeat.customSlots" class="is-column has-button-close">
			<n-form-text v-model="customSlot.name" placeholder="Slot name"/>
			<n-form-switch v-model="customSlot.singleOpen" label="Only one open at a time"/>
			<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="target.repeat.customSlots.splice(index, 1)"><icon name="times"/></button>
		</div>
		<div class="is-row is-align-end">
			<button @click="target.repeat.customSlots.push({name: null, singleOpen: false})" class="is-button is-size-small"><icon name="plus"/><span class="is-title">Custom slot</span></button>
		</div>
		
		<template v-if="target.repeat.localVariables">
			<div v-for="(localVariable, index) in target.repeat.localVariables" class="has-button-close">
				<div class="is-column is-spacing-medium">
					<n-form-text label="Name" v-model="localVariable.name" />
					<n-form-text label="Type" v-model="localVariable.definition" placeholder="string"/>
					<n-form-switch label="Is an array" v-model="localVariable.isArray"/>
					<n-form-ace v-model="localVariable.defaultValue" label="Default value"/>
					<n-form-ace v-if="!localVariable.definition" v-model="localVariable.template" label="Template value" info="Add an object that represents the final structure of the resultset"/>
				</div>
				<button class="is-button is-variant-close is-size-small is-spacing-horizontal-right-large" @click="target.repeat.localVariables.splice(index, 1)"><icon name="times"/></button>
			</div>
			<div class="is-row is-align-end" v-if="getOrderByFields().length">
				<button @click="target.repeat.localVariables.push({name: null, definition: null})" class="is-button is-size-small"><icon name="plus"/><span class="is-title">Local variable</span></button>
			</div>
		</template>
			
		<n-page-mapper v-if="false && target.repeat.operation && operationParameters.length > 0 && Object.keys($services.page.getPageParameters(page)).length" 
			:to="operationParameters"
			:from="{page:$services.page.getPageParameters(page)}" 
			v-model="target.repeat.bindings"/>
	</div>
</script> 



<script type='x/templates' id="renderer-table">
	<table class="is-table" :class="getChildComponentClasses('table')">
		<thead><slot name="header"></slot></thead>
		<tbody v-if="hasDefaultElements()"><slot></slot></tbody>
		<slot name="body"></slot>
		<tfoot><slot name="footer"></slot></tfoot>
	</table>
</script>

<script type='x/templates' id="renderer-table-body-cell">
	<td :colspan="colspan" :label="label"><slot></slot></td>
</script>

<script type='x/templates' id="renderer-table-header-cell">
	<th :colspan="colspan"><slot></slot></th>
</script>

<script type='x/templates' id="renderer-table-configure">
	<div class="is-column is-spacing-vertical-gap-medium">
		
	</div>
</script>

<script type='x/templates' id="renderer-table-cell-configure">
	<div class="is-column is-spacing-vertical-gap-medium">
		<n-form-text label="Colspan" v-model="target.table.colspan"/>
		<n-form-text label="Embedded label" v-model="target.table.embeddedLabel" />
	</div>
</script>


<script type='x/templates' id="renderer-table-message">
	<tr>
		<td colspan="100"><slot></slot></td>
	</tr>
</script><script type='x/templates' id="data-field-picker">
	<n-form class="data-field-picker is-column is-color-background is-spacing-large is-overflow-auto is-variant-vertical">
		<h1>Table settings</h1>
		<n-form-text v-model="value.repeatName" label="Name of the repeat"/>
		<n-form-checkbox v-if="!allChecked" label="Check all" :value="false" @input="checkAll"/>
		<n-form-checkbox v-else label="Uncheck all" :value="true" @input="uncheckAll"/>
		<div v-for="field in result" class="is-row">
			<n-form-checkbox v-model="field.checked" :label="field.name" class="is-column is-fill-normal"/>
			<button class="is-button is-size-small is-primary-outline" @click="upAll(field)"><icon name="chevron-circle-up"/></button>
			<button class="is-button is-size-small is-primary-outline" @click="up(field)"><icon name="chevron-up"/></button>
			<button class="is-button is-size-small is-primary-outline" @click="down(field)"><icon name="chevron-down"/></button>
			<button class="is-button is-size-small is-primary-outline" @click="downAll(field)"><icon name="chevron-circle-down"/></button>
		</div>
		<div class="is-row is-spacing-vertical-medium">
			<button class="is-button is-variant-link" @click="$reject()">Cancel</button>
			<button class="is-button is-variant-primary is-position-right" @click="$resolve()">Generate</button>
		</div>
	</n-form>
</script>
<script type='x/templates' id="cms-login">
	<n-form ref="form">
		<n-form-section>
			<n-form-text name="username" v-focus v-timeout:input.form="validate" label="Username" placeholder="email@example.com" v-model="username" :required="true"/>
			<n-form-text name="password" type="password" v-timeout:input.form="validate" placeholder="Password" label="Password" v-model="password" :required="true"/>
			<n-form-switch label="Remember me" v-model="remember"/>
		</n-form-section>
		<footer>
			<slot name="footer" :messages="messages" :finalize="login">
				<div class="actions">
					<button :disabled="working" class="primary" v-action="login">Login</button>
				</div>
				<n-messages :messages="messages"/>
			</slot>
		</footer>
	</n-form>
</script>
<script type='x/templates' id="page-settings-oauth2">
	<div class="page-settings-oauth2">
		done!
	</div>
</script>
<script type='x/templates' id="blog-toc">
	<ul class="is-list is-variant-toc">
		<li v-for="header in headers" class="is-row is-variant-toc" :class="'toc-item-' + header.depth">
			<button @click="jumpTo(header)" class="is-button is-variant-toc" :class="getChildComponentClasses('toc-button-' + header.depth)">{{header.content}}</button>
		</li>
	</ul>
</script>
<script type='x/templates' id="attachment-uploader">
	<div class="attachment-uploader is-row" :class="getChildComponentClasses('attachment-uploader-container')">
		<div v-for="attachment in attachments" class="is-column has-button-close">
			<img class="is-image" :class="getChildComponentClasses('attachment-uploader-image')" v-if="attachment.$url" :src="attachment.$url"/>
			<img class="is-image" :class="getChildComponentClasses('attachment-uploader-image')" v-else :src="$window.application.configuration.root + 'resources/modules/image/placeholder.svg'"/>
			<button v-if="edit" class="is-button is-variant-close is-color-danger" @click="deleteAttachment(attachment)"><icon name="times"/></button>
		</div>
		<n-input-file v-if="edit" v-model="files" @change="upload" :disabled="uploading"/>
	</div>
</script>	</head>
	<body class='n-default'>
<div id='body'><div class="page-loader-container"><div class="page-loader"></div></div></div>	</body>
</html>